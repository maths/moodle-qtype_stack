define("qtype_stack/edityaml",["exports","qtype_stack/js-yaml-lazy"],(function(_exports,yaml){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setup=void 0,yaml=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}
/**
   * A javascript module to allow editing of PRTs in YAML format.
   *
   * @module     qtype_stack/edityaml
   * @copyright  2025 The University of Edinburgh
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */(yaml);function changeCallback(){document.querySelector("#id_updatebutton").addEventListener("mousedown",yamlChanged),document.querySelector("#id_submitbutton").addEventListener("mousedown",yamlChanged),document.querySelector("#id_yamlinput").removeEventListener("change",changeCallback)}function changeRemove(){document.querySelector("#id_updatebutton").removeEventListener("mousedown",yamlChanged),document.querySelector("#id_submitbutton").removeEventListener("mousedown",yamlChanged),document.querySelector("#id_yamlinput").addEventListener("change",changeCallback)}function yamlRevert(){let yamltext=yamlParse();document.querySelector("#id_yamlinput").value=yamltext,changeRemove()}function yamlParse(){let json=document.querySelector('input[name="stack-yamloriginal"]').value,prtsObject=JSON.parse(json);return Object.values(prtsObject).forEach((prt=>{delete prt.name,delete prt.id,delete prt.questionid,delete prt.firstnodename,prt.nodes.forEach((node=>{delete node.id,delete node.questionid,delete node.prtname}))})),yaml.dump(prtsObject,{lineWidth:-1})}function yamlChanged(event){event.preventDefault(),event.returnValue=""}function yamlConvert(){let yamltext=document.querySelector("#id_yamlinput").value,prtsObject=yaml.load(yamltext);const errorDiv=document.querySelector("#id_error_yamlinput");errorDiv.innerHTML="",errorDiv.style.display="none";let isError=!1;for(const prtkey in prtsObject){if(!document.querySelector("#id_"+prtkey+"prtheader")){errorDiv.innerHTML+="No such PRT: "+prtkey+"<br>",errorDiv.style.display="block",isError=!0;continue}const currentPrt=prtsObject[prtkey];for(const currentNode of currentPrt.nodes){const nodeKey=currentNode.nodename;document.querySelector("#id_"+prtkey+"description_"+nodeKey)||(errorDiv.innerHTML+="No such node: PRT: "+prtkey+" Node: "+nodeKey+"<br>",errorDiv.style.display="block",isError=!0)}}if(!isError){for(const prtkey in prtsObject){const currentPrt=prtsObject[prtkey];"value"in currentPrt&&(document.querySelector("#id_"+prtkey+"value").value=currentPrt.value),"autosimplify"in currentPrt&&(document.querySelector("#id_"+prtkey+"autosimplify").value=currentPrt.autosimplify),"feedbackstyle"in currentPrt&&(document.querySelector("#id_"+prtkey+"feedbackstyle").value=currentPrt.feedbackstyle),"feedbackvariables"in currentPrt&&(document.querySelector("#id_"+prtkey+"feedbackvariables").value=currentPrt.feedbackvariables);for(const currentNode of currentPrt.nodes){const nodeKey=currentNode.nodename;"description"in currentNode&&(document.querySelector("#id_"+prtkey+"description_"+nodeKey).value=currentNode.description),"answertest"in currentNode&&(document.querySelector("#id_"+prtkey+"answertest_"+nodeKey).value=currentNode.answertest),"sans"in currentNode&&(document.querySelector("#id_"+prtkey+"sans_"+nodeKey).value=currentNode.sans),"tans"in currentNode&&(document.querySelector("#id_"+prtkey+"tans_"+nodeKey).value=currentNode.tans),"testoptions"in currentNode&&(document.querySelector("#id_"+prtkey+"testoptions_"+nodeKey).value=currentNode.testoptions),"quiet"in currentNode&&(document.querySelector("#id_"+prtkey+"quiet_"+nodeKey).value=currentNode.quiet),"truescoremode"in currentNode&&(document.querySelector("#id_"+prtkey+"truescoremode_"+nodeKey).value=currentNode.truescoremode),"truescore"in currentNode&&(document.querySelector("#id_"+prtkey+"truescore_"+nodeKey).value=currentNode.truescore),"truepenalty"in currentNode&&(document.querySelector("#id_"+prtkey+"truepenalty_"+nodeKey).value=currentNode.truepenalty),"truenextnode"in currentNode&&(document.querySelector("#id_"+prtkey+"truenextnode_"+nodeKey).value=currentNode.truenextnode),"trueanswernote"in currentNode&&(document.querySelector("#id_"+prtkey+"trueanswernote_"+nodeKey).value=currentNode.trueanswernote),"truefeedback"in currentNode&&(document.querySelector("#id_"+prtkey+"truefeedback_"+nodeKey+"editable")?document.querySelector("#id_"+prtkey+"truefeedback_"+nodeKey+"editable").value=currentNode.truefeedback:document.querySelector("#id_"+prtkey+"truefeedback_"+nodeKey)&&(document.querySelector("#id_"+prtkey+"truefeedback_"+nodeKey).value=currentNode.truefeedback)),"truefeedbackformat"in currentNode&&document.querySelector("#id_"+prtkey+"truefeedbackformat_"+nodeKey)&&(document.querySelector("#id_"+prtkey+"truefeedbackformat_"+nodeKey).value=currentNode.truefeedbackformat),"falsescoremode"in currentNode&&(document.querySelector("#id_"+prtkey+"falsescoremode_"+nodeKey).value=currentNode.falsescoremode),"falsescore"in currentNode&&(document.querySelector("#id_"+prtkey+"falsescore_"+nodeKey).value=currentNode.falsescore),"falsepenalty"in currentNode&&(document.querySelector("#id_"+prtkey+"falsepenalty_"+nodeKey).value=currentNode.falsepenalty),"falsenextnode"in currentNode&&(document.querySelector("#id_"+prtkey+"falsenextnode_"+nodeKey).value=currentNode.falsenextnode),"falseanswernote"in currentNode&&(document.querySelector("#id_"+prtkey+"falseanswernote_"+nodeKey).value=currentNode.falseanswernote),"falsefeedback"in currentNode&&(document.querySelector("#id_"+prtkey+"falsefeedback_"+nodeKey+"editable")?document.querySelector("#id_"+prtkey+"falsefeedback_"+nodeKey+"editable").value=currentNode.falsefeedback:document.querySelector("#id_"+prtkey+"falsefeedback_"+nodeKey)&&(document.querySelector("#id_"+prtkey+"falsefeedback_"+nodeKey).value=currentNode.falsefeedback)),"falsefeedbackformat"in currentNode&&document.querySelector("#id_"+prtkey+"falsefeedbackformat_"+nodeKey)&&(document.querySelector("#id_"+prtkey+"falsefeedbackformat_"+nodeKey).value=currentNode.falsefeedbackformat)}}changeRemove()}}_exports.setup=()=>{document.querySelector("#id_yamlinput").value?document.querySelector("#id_yamlinput").value!=yamlParse()?changeCallback():document.querySelector("#id_yamlinput").addEventListener("change",changeCallback):yamlRevert(),document.querySelector("#id_stack-revert-yaml").addEventListener("click",yamlRevert),document.querySelector("#id_stack-convert-yaml").addEventListener("click",yamlConvert)}}));

//# sourceMappingURL=edityaml.min.js.map