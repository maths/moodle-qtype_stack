{"version":3,"file":"edityaml.min.js","sources":["../src/edityaml.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A javascript module to allow editing of PRTs in YAML format.\n *\n * @module     qtype_stack/edityaml\n * @copyright  2025 The University of Edinburgh\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as yaml from 'qtype_stack/js-yaml-lazy';\n\nexport const setup = () => {\n    yamlRevert();\n    document.querySelector('#id_stack-revert-yaml').addEventListener('click', yamlRevert);\n    document.querySelector('#id_stack-convert-yaml').addEventListener('click', yamlConvert);\n};\n\n/**\n * Copy original YAML of PRTs from hidden field to the text edit area.\n */\nfunction yamlRevert() {\n    let json = document.querySelector('input[name=\"stack-yamloriginal\"]').value;\n    let obj = JSON.parse(json);\n    let yamltext = yaml.dump(obj, { lineWidth: -1 });\n    document.querySelector('#id_yamlinput').value = yamltext;\n}\n\n/**\n * Convert YAML in the text area to an object and put the values in the PRT fields.\n */\nfunction yamlConvert() {\n    // Will need to submit verify question text, submit add node multiple times?\n    let yamltext = document.querySelector('#id_yamlinput').value;\n    let prtsObject = yaml.load(yamltext);\n    const errorDiv = document.querySelector('#id_error_yamlinput');\n    errorDiv.style.display = 'none';\n    for (const prt in prtsObject) {\n        if (!document.querySelector('#id_' + prt + 'prtheader')) {\n            // No such PRT in the form.\n            // How to translate this?\n            errorDiv.innerHTML = 'No such PRT: ' + prt;\n            errorDiv.style.display = 'block';\n            break;\n        }\n        let currentPrt = prtsObject[prt];\n        if ('value' in currentPrt) {\n            document.querySelector('#id_' + prt + 'value').value = currentPrt.value;\n        }\n    }\n}\n"],"names":["yamlRevert","json","document","querySelector","value","obj","JSON","parse","yamltext","yaml","dump","lineWidth","yamlConvert","prtsObject","load","errorDiv","style","display","prt","innerHTML","currentPrt","addEventListener"],"mappings":";;;;;;;qBAkCSA,iBACDC,KAAOC,SAASC,cAAc,oCAAoCC,MAClEC,IAAMC,KAAKC,MAAMN,MACjBO,SAAWC,KAAKC,KAAKL,IAAK,CAAEM,WAAY,IAC5CT,SAASC,cAAc,iBAAiBC,MAAQI,kBAM3CI,kBAEDJ,SAAWN,SAASC,cAAc,iBAAiBC,MACnDS,WAAaJ,KAAKK,KAAKN,gBACrBO,SAAWb,SAASC,cAAc,uBACxCY,SAASC,MAAMC,QAAU,WACpB,MAAMC,OAAOL,WAAY,KACrBX,SAASC,cAAc,OAASe,IAAM,aAAc,CAGrDH,SAASI,UAAY,gBAAkBD,IACvCH,SAASC,MAAMC,QAAU,kBAGzBG,WAAaP,WAAWK,KACxB,UAAWE,aACXlB,SAASC,cAAc,OAASe,IAAM,SAASd,MAAQgB,WAAWhB,uBAnCzD,KACjBJ,aACAE,SAASC,cAAc,yBAAyBkB,iBAAiB,QAASrB,YAC1EE,SAASC,cAAc,0BAA0BkB,iBAAiB,QAAST"}