define ("qtype_stack/jsxgraph",["qtype_stack/jsxgraphcore-lazy"],function(a){var m={},n={},o={},p=[],q={},r={},s=!1;function b(a){if(!(a in m)){m[a]={};n[a]=[];var b=document.getElementById(a);b.addEventListener("input",function(){return l(a)});b.addEventListener("change",function(){return l(a)});b.addEventListener("change",function(){M.core_formchangechecker.set_form_changed()})}}function c(a){if(!(a.id in r)){a.board.on("update",function(){return k(a.id)});r[a.id]=a}}function d(a){return JSON.stringify([a.X(),a.Y()])}function e(b,c){try{var d=JSON.parse(c);if("number"==typeof d[0]&&"number"==typeof d[1]){b.setPosition(a.COORDS_BY_USER,d);b.board.update();b.update()}}catch(a){}}function f(b,c){try{if("number"==typeof c[0]&&"number"==typeof c[1]){b.setPosition(a.COORDS_BY_USER,c);b.board.update();b.update()}}catch(a){}}function g(a){return JSON.stringify(a.Value())}function h(a,b){try{a.setValue(JSON.parse(b));a.board.update();a.update()}catch(a){}}function j(a){k(a.id)}function k(a){if(!s){s=!0;try{var b=[];if(a in q){for(var c=0,d;c<q[a].length;c++){d=q[a][c];if(-1===b.indexOf(d)){b.push(d);var f=document.getElementById(d),g=m[d][a]();if(g!==o[d]){o[d]=null;f.value=g}else{s=!1;return}}}}for(var h=0,j;h<p.length;h++){j=p[h];if(-1!==j.indexOf(a)){for(var k=0,l;k<j.length;k++){l=j[k];if(l!==a){if(l in q){for(var c=0,d;c<q[l].length;c++){d=q[l][c];if(-1===b.indexOf(d)){o[d]=null;b.push(d);var f=document.getElementById(d);f.value=m[d][l]()}}}}}}}for(var c=0,f;c<b.length;c++){f=document.getElementById(b[c]);if(-1===window.location.pathname.indexOf("preview.php")){var n=new Event("change");f.dispatchEvent(n)}var n=new Event("input");f.dispatchEvent(n)}}catch(a){}s=!1}}function l(a){if(a in n){for(var b=document.getElementById(a),c=Object.keys(m[a]),d=!1,e=0,f;e<c.length;e++){f=m[a][c[e]]();if(f!==b.value){d=!0;e=c.length+1}}if(d){for(var e=0;e<n[a].length;e++){n[a][e](b.value)}}}}return{find_input_id:function find_input_id(a,b){var c=document.getElementById(a);while((c=c.parentElement)&&!(c.classList.contains("formulation")&&c.parentElement.classList.contains("content"))){}c=c.querySelector("input[id$=\"_"+b+"\"]");c.addEventListener("change",function(){M.core_formchangechecker.set_form_changed()});return c.id},define_group:function define_group(a){for(var b=[],c=0;c<a.length;c++){if(-1===b.indexOf(a[c].id)){b.push(a[c].id)}}p.push(b)},starts_moved:function starts_moved(a){if(a.id in q){for(var b=0;b<q[a.id].length;b++){o[q[a.id][b]]=null}j(a)}},custom_bind:function custom_bind(a,c,d,e){b(a);o[a]=c();var f=document.getElementById(a);if(f.value&&""!=f.value){d(f.value)}n[a].push(d);for(var g=0;g<e.length;g++){this.register_object(a,e[g],c)}},register_object:function register_object(a,b,d){if(b.id in q){if(!(a in q[b.id])){q[b.id].push(a)}}else{q[b.id]=[a]}m[a][b.id]=d;c(b)},bind_point:function bind_point(a,b){this.custom_bind(a,function serializer(){return d(b)},function deserializer(a){return e(b,a)},[b])},bind_point_dual:function bind_point_dual(a,b,c){this.custom_bind(a,function serializer(){return JSON.stringify([[b.X(),b.Y()],[c.X(),c.Y()]])},function deserializer(a){var d=JSON.parse(a);f(b,d[0]);f(c,d[1])},[b,c])},bind_point_relative:function bind_point_relative(a,b,c){this.custom_bind(a,function serializer(){return JSON.stringify([[b.X(),b.Y()],[c.X()-b.X(),c.Y()-b.Y()]])},function deserializer(a){var d=JSON.parse(a);f(b,d[0]);d[1][0]=d[1][0]+d[0][0];d[1][1]=d[1][1]+d[0][1];f(c,d[1])},[b,c])},bind_point_direction:function bind_point_direction(a,b,c){this.custom_bind(a,function serializer(){return JSON.stringify([[b.X(),b.Y()],[Math.atan2(c.Y()-b.Y(),c.X()-b.X()),Math.sqrt((c.X()-b.X())*(c.X()-b.X())+(c.Y()-b.Y())*(c.Y()-b.Y()))]])},function deserializer(a){var d=JSON.parse(a);f(b,d[0]);var e=d[1][0],g=d[1][1];d[1][0]=d[0][0]+g*Math.cos(e);d[1][1]=d[0][1]+g*Math.sin(e);f(c,d[1])},[b,c])},bind_slider:function bind_slider(a,b){this.custom_bind(a,function serializer(){return g(b)},function deserializer(a){return h(b,a)},[b])},bind_list_of:function bind_list_of(a,b){this.custom_bind(a,function serializer(){for(var a="[",c=0,e;c<b.length;c++){e=b[c];if("slider"===e.getType()){a=a+JSON.stringify(e.Value())+","}else{a=a+d(e)+","}}a=a.substring(0,a.length-1);return a+"]"},function deserializer(a){for(var c=JSON.parse(a),d=0,e;d<b.length&&d<c.length;d++){e=b[d];if("slider"===e.getType()){e.setValue(c[d])}else{f(e,c[d])}}},b)}}});
//# sourceMappingURL=jsxgraph.min.js.map
