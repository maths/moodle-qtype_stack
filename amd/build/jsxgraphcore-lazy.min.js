function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("qtype_stack/jsxgraphcore-lazy",function(){
/**
   * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
   * Released under MIT license, http://github.com/requirejs/almond/LICENSE
   */
var requirejs,require,define;return function(undef){var main,_req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name){for(lastIndex=(name=name.split("/")).length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),"."===name[0].charAt(0)&&baseParts&&(name=baseParts.slice(0,baseParts.length-1).concat(name)),i=0;i<name.length;i++)if("."===(part=name[i]))name.splice(i,1),i-=1;else if(".."===part){if(0===i||1===i&&".."===name[2]||".."===name[i-1])continue;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}if((baseParts||starMap)&&map){for(i=(nameParts=name.split("/")).length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if((mapValue=map[baseParts.slice(0,j).join("/")])&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);return"string"!=typeof args[0]&&1===args.length&&args.push(null),_req.apply(undefined,args.concat([relName,forceSync]))}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undefined,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeRelParts(relName){return relName?splitPrefix(relName):[]}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}makeMap=function(name,relParts){var plugin,relName,parts=splitPrefix(name),prefix=parts[0],relResourceName=relParts[1];return name=parts[1],prefix&&(plugin=callDep(prefix=normalize(prefix,relResourceName))),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,(relName=relResourceName,function(name){return normalize(name,relName)})):normalize(name,relResourceName):(prefix=(parts=splitPrefix(name=normalize(name,relResourceName)))[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return void 0!==e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,relParts,usingExports,args=[],callbackType=_typeof(callback);if(relParts=makeRelParts(relName=relName||name),"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if("require"===(depName=(map=makeMap(deps[i],relParts)).f))args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&undefined!==cjsModule.exports&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:undefined===ret&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=_req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,makeRelParts(callback)).f);if(!deps.splice){if((config=deps).deps&&_req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=undefined}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(undefined,deps,callback,relName):setTimeout((function(){main(undefined,deps,callback,relName)}),4),_req},_req.config=function(cfg){return _req(cfg)},requirejs._defined=defined,(define=function(name,deps,callback){if("string"!=typeof name)throw new Error("See almond README: incorrect module build, no module name");deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])}).amd={jQuery:!0}}(),define("../node_modules/almond/almond",(function(){})),define("jxg",[],(function(){var jxg={};return"object"!==("undefined"==typeof JXG?"undefined":_typeof(JXG))||JXG.extend||(jxg=JXG),jxg.extend=function(object,extension,onlyOwn,toLower){var e;for(e in onlyOwn=onlyOwn||!1,toLower=toLower||!1,extension)(!onlyOwn||onlyOwn&&extension.hasOwnProperty(e))&&(object[toLower?e.toLowerCase():e]=extension[e])},jxg.defineConstant=function(object,name,value,ignoreRedefine){(ignoreRedefine=ignoreRedefine||!1)&&jxg.exists(object[name])||Object.defineProperty(object,name,{value:value,writable:!1,enumerable:!0,configurable:!1})},jxg.extendConstants=function(object,constants,onlyOwn,toUpper){var e,e2;for(e in onlyOwn=onlyOwn||!1,toUpper=toUpper||!1,constants)(!onlyOwn||onlyOwn&&constants.hasOwnProperty(e))&&(e2=toUpper?e.toUpperCase():e,this.defineConstant(object,e2,constants[e]))},jxg.extend(jxg,{boards:{},readers:{},elements:{},registerElement:function(element,creator){element=element.toLowerCase(),this.elements[element]=creator},registerReader:function(reader,ext){var i,e;for(i=0;i<ext.length;i++)e=ext[i].toLowerCase(),"function"!=typeof this.readers[e]&&(this.readers[e]=reader)},shortcut:function(object,fun){return function(){return object[fun].apply(this,arguments)}},getRef:function(board,s){return jxg.deprecated("JXG.getRef()","Board.select()"),board.select(s)},getReference:function(board,s){return jxg.deprecated("JXG.getReference()","Board.select()"),board.select(s)},getBoardByContainerId:function(s){var b;for(b in JXG.boards)if(JXG.boards.hasOwnProperty(b)&&JXG.boards[b].container===s)return JXG.boards[b];return null},deprecated:function(what,replacement){var warning=what+" is deprecated.";replacement&&(warning+=" Please use "+replacement+" instead."),jxg.warn(warning)},warn:function(warning){"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.console&&console.warn?console.warn("WARNING:",warning):"object"===("undefined"==typeof document?"undefined":_typeof(document))&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+warning+"<br />")},debugInt:function(s){var i,p;for(i=0;i<arguments.length;i++)p=arguments[i],"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.console&&console.log?console.log(p):"object"===("undefined"==typeof document?"undefined":_typeof(document))&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=p+"<br/>")},debugWST:function(s){var e=new Error;jxg.debugInt.apply(this,arguments),e&&e.stack&&(jxg.debugInt("stacktrace"),jxg.debugInt(e.stack.split("\n").slice(1).join("\n")))},debugLine:function(s){var e=new Error;jxg.debugInt.apply(this,arguments),e&&e.stack&&jxg.debugInt("Called from",e.stack.split("\n").slice(2,3).join("\n"))},debug:function(s){jxg.debugInt.apply(this,arguments)}}),jxg})),define("base/constants",["jxg"],(function(JXG){var constants;return constants={version:"1.4.4",licenseText:"JSXGraph v1.4.4 Copyright (C) see https://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_TYPE_FOREIGNOBJECT:31,OBJECT_TYPE_VIEW3D:32,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_REFLECTION_ON_LINE:4,GENTYPE_REFLECTION_ON_POINT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_POLYGONCOPY:48,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},JXG.extendConstants(JXG,constants),constants})),define("utils/type",["jxg","base/constants"],(function(JXG,Const){return JXG.extend(JXG,{isId:function(board,s){return"string"==typeof s&&!!board.objects[s]},isName:function(board,s){return"string"==typeof s&&!!board.elementsByName[s]},isGroup:function(board,s){return"string"==typeof s&&!!board.groups[s]},isString:function(v){return"string"==typeof v},isNumber:function(v){return"number"==typeof v||"[Object Number]"===Object.prototype.toString.call(v)},isFunction:function(v){return"function"==typeof v},isArray:function(v){return Array.isArray?Array.isArray(v):null!==v&&"object"===_typeof(v)&&"function"==typeof v.splice&&"function"==typeof v.join},isObject:function(v){return"object"===_typeof(v)&&!this.isArray(v)},isPoint:function(v){return null!==v&&"object"===_typeof(v)&&v.elementClass===Const.OBJECT_CLASS_POINT},isPointType:function(board,v){var val,p;return!!this.isArray(v)||(!!(this.isFunction(v)&&(val=v(),this.isArray(val)&&val.length>1))||(p=board.select(v),this.isPoint(p)))},isTransformationOrArray:function(v){if(null!==v){if(this.isArray(v)&&v.length>0)return this.isTransformationOrArray(v[0]);if("object"===_typeof(v))return v.type===Const.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(v,checkEmptyString){var result=!(null==v||null===v);return(checkEmptyString=checkEmptyString||!1)?result&&""!==v:result},isEmpty:function(v){return 0===Object.keys(v).length},def:function(v,d){return this.exists(v)?v:d},str2Bool:function(s){return!this.exists(s)||("boolean"==typeof s?s:!!this.isString(s)&&"true"===s.toLowerCase())},createEvalFunction:function(board,param,n){var i,f=[];for(i=0;i<n;i++)f[i]=JXG.createFunction(param[i],board,"",!0);return function(k){return f[k]()}},createFunction:function(term,board,variableName,evalGeonext){var f=null;return this.exists(evalGeonext)&&!evalGeonext||!this.isString(term)?this.isFunction(term)?f=term:(this.isNumber(term)||this.isString(term))&&(f=function(){return term}):f=board.jc.snippet(term,!0,variableName,!0),null!==f&&(f.origin=term),f},providePoints:function(board,parents,attributes,attrClass,attrArray){var i,j,len,attr,val,lenAttr=0,points=[];for(this.isArray(parents)||(parents=[parents]),len=parents.length,this.exists(attrArray)&&(lenAttr=attrArray.length),0===lenAttr&&(attr=this.copyAttributes(attributes,board.options,attrClass)),i=0;i<len;++i)if(lenAttr>0&&(j=Math.min(i,lenAttr-1),attr=this.copyAttributes(attributes,board.options,attrClass,attrArray[j])),this.isArray(parents[i])&&parents[i].length>1?(points.push(board.create("point",parents[i],attr)),points[points.length-1]._is_new=!0):this.isFunction(parents[i])?(val=parents[i](),this.isArray(val)&&val.length>1&&(points.push(board.create("point",[parents[i]],attr)),points[points.length-1]._is_new=!0)):points.push(board.select(parents[i])),!this.isPoint(points[i]))return!1;return points},bind:function(fn,owner){return function(){return fn.apply(owner,arguments)}},evaluate:function(val){return this.isFunction(val)?val():val},indexOf:function(array,value,sub){var i,s=this.exists(sub);if(Array.indexOf&&!s)return array.indexOf(value);for(i=0;i<array.length;i++)if(s&&array[i][sub]===value||!s&&array[i]===value)return i;return-1},eliminateDuplicates:function(a){var i,len=a.length,result=[],obj={};for(i=0;i<len;i++)obj[a[i]]=0;for(i in obj)obj.hasOwnProperty(i)&&result.push(i);return result},swap:function(arr,i,j){var tmp;return tmp=arr[i],arr[i]=arr[j],arr[j]=tmp,arr},uniqueArray:function(arr){var i,j,isArray,ret=[];if(0===arr.length)return[];for(i=0;i<arr.length;i++)if(isArray=this.isArray(arr[i]),this.exists(arr[i]))for(j=i+1;j<arr.length;j++)isArray&&JXG.cmpArrays(arr[i],arr[j])?arr[i]=[]:isArray||arr[i]!==arr[j]||(arr[i]="");else arr[i]="";for(j=0,i=0;i<arr.length;i++)(isArray=this.isArray(arr[i]))||""===arr[i]?isArray&&0!==arr[i].length&&(ret[j]=arr[i].slice(0),j++):(ret[j]=arr[i],j++);return arr=ret,ret},isInArray:function(arr,val){return JXG.indexOf(arr,val)>-1},coordsArrayToMatrix:function(coords,split){var i,x=[],m=[];for(i=0;i<coords.length;i++)split?(x.push(coords[i].usrCoords[1]),m.push(coords[i].usrCoords[2])):m.push([coords[i].usrCoords[1],coords[i].usrCoords[2]]);return split&&(m=[x,m]),m},cmpArrays:function(a1,a2){var i;if(a1===a2)return!0;if(a1.length!==a2.length)return!1;for(i=0;i<a1.length;i++)if(this.isArray(a1[i])&&this.isArray(a2[i])){if(!this.cmpArrays(a1[i],a2[i]))return!1}else if(a1[i]!==a2[i])return!1;return!0},removeElementFromArray:function(ar,el){var i;for(i=0;i<ar.length;i++)if(ar[i]===el)return ar.splice(i,1),ar;return ar},trunc:function(n,p){return p=JXG.def(p,0),this.toFixed(n,p)},_decimalAdjust:function(type,value,exp){return void 0===exp||0==+exp?Math[type](value):(value=+value,exp=+exp,isNaN(value)||"number"!=typeof exp||exp%1!=0?NaN:(value=value.toString().split("e"),+((value=(value=Math[type](+(value[0]+"e"+(value[1]?+value[1]-exp:-exp)))).toString().split("e"))[0]+"e"+(value[1]?+value[1]+exp:exp))))},_round10:function(value,exp){return this._decimalAdjust("round",value,exp)},_floor10:function(value,exp){return this._decimalAdjust("floor",value,exp)},_ceil10:function(value,exp){return this._decimalAdjust("ceil",value,exp)},toFixed:function(num,digits){return this._round10(num,-digits).toFixed(digits)},autoDigits:function(val){var x=Math.abs(val);return x>.1?this.toFixed(val,2):x>=.01?this.toFixed(val,4):x>=1e-4?this.toFixed(val,6):val},keys:function(object,onlyOwn){var property,keys=[];for(property in object)onlyOwn?object.hasOwnProperty(property)&&keys.push(property):keys.push(property);return keys},clone:function(obj){var cObj={};return cObj.prototype=obj,cObj},cloneAndCopy:function(obj,obj2){var r,cObj=function(){};for(r in cObj.prototype=obj,obj2)cObj[r]=obj2[r];return cObj},merge:function(obj1,obj2){var i,j;for(i in obj2)if(obj2.hasOwnProperty(i))if(this.isArray(obj2[i]))for(obj1[i]||(obj1[i]=[]),j=0;j<obj2[i].length;j++)"object"===_typeof(obj2[i][j])?obj1[i][j]=this.merge(obj1[i][j],obj2[i][j]):obj1[i][j]=obj2[i][j];else"object"===_typeof(obj2[i])?(obj1[i]||(obj1[i]={}),obj1[i]=this.merge(obj1[i],obj2[i])):obj1[i]=obj2[i];return obj1},deepCopy:function(obj,obj2,toLower){var c,i,prop,i2;if(toLower=toLower||!1,"object"!==_typeof(obj)||null===obj)return obj;if(this.isArray(obj))for(c=[],i=0;i<obj.length;i++)"object"===_typeof(prop=obj[i])?this.exists(prop.board)?c[i]=prop.id:c[i]=this.deepCopy(prop):c[i]=prop;else{for(i in c={},obj)obj.hasOwnProperty(i)&&(i2=toLower?i.toLowerCase():i,null!==(prop=obj[i])&&"object"===_typeof(prop)?this.exists(prop.board)?c[i2]=prop.id:c[i2]=this.deepCopy(prop):c[i2]=prop);for(i in obj2)obj2.hasOwnProperty(i)&&(i2=toLower?i.toLowerCase():i,"object"===_typeof(prop=obj2[i])?this.isArray(prop)||!this.exists(c[i2])?c[i2]=this.deepCopy(prop):c[i2]=this.deepCopy(c[i2],prop,toLower):c[i2]=prop)}return c},copyAttributes:function(attributes,options,s){var a,i,len,o,isAvail,primitives={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(a=(len=arguments.length)<3||primitives[s]?JXG.deepCopy(options.elements,null,!0):{},len<4&&this.exists(s)&&this.exists(options.layer[s])&&(a.layer=options.layer[s]),o=options,isAvail=!0,i=2;i<len;i++){if(!this.exists(o[arguments[i]])){isAvail=!1;break}o=o[arguments[i]]}for(isAvail&&(a=JXG.deepCopy(a,o,!0)),o="object"===_typeof(attributes)?attributes:{},isAvail=!0,i=3;i<len;i++){if(!this.exists(o[arguments[i]])){isAvail=!1;break}o=o[arguments[i]]}if(isAvail&&this.extend(a,o,null,!0),"board"===arguments[2])return a;for(o=options,isAvail=!0,i=2;i<len;i++){if(!this.exists(o[arguments[i]])){isAvail=!1;break}o=o[arguments[i]]}return isAvail&&this.exists(o.label)&&(a.label=JXG.deepCopy(o.label,a.label)),a.label=JXG.deepCopy(options.label,a.label),a},copyPrototypeMethods:function(subObject,superObject,constructorName){var key;for(key in subObject.prototype[constructorName]=superObject.prototype.constructor,superObject.prototype)superObject.prototype.hasOwnProperty(key)&&(subObject.prototype[key]=superObject.prototype[key])},toJSON:function(obj,noquote){var list,prop,i,val;if(noquote=JXG.def(noquote,!1),("undefined"==typeof JSON||_typeof(JSON))&&JSON.stringify&&!noquote)try{return JSON.stringify(obj)}catch(e){}switch(_typeof(obj)){case"object":if(obj){if(list=[],this.isArray(obj)){for(i=0;i<obj.length;i++)list.push(JXG.toJSON(obj[i],noquote));return"["+list.join(",")+"]"}for(prop in obj)if(obj.hasOwnProperty(prop)){try{val=JXG.toJSON(obj[prop],noquote)}catch(e2){val=""}noquote?list.push(prop+":"+val):list.push('"'+prop+'":'+val)}return"{"+list.join(",")+"} "}return"null";case"string":return"'"+obj.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return obj.toString()}return"0"},clearVisPropOld:function(el){return el.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",tabindex:-1e5,transitionduration:0,top:-1e5,visible:null},el},isInObject:function(obj,val){var el;for(el in obj)if(obj.hasOwnProperty(el)&&obj[el]===val)return!0;return!1},escapeHTML:function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(str){return str.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(str){return str.charAt(0).toUpperCase()+str.substring(1).toLowerCase()},trimNumber:function(str){return"."!==(str=(str=str.replace(/^0+/,"")).replace(/0+$/,""))[str.length-1]&&","!==str[str.length-1]||(str=str.slice(0,-1)),"."!==str[0]&&","!==str[0]||(str="0"+str),str},filterElements:function(list,filter){var i,f,item,flower,value,visPropValue,pass,l=list.length,result=[];if("function"!=typeof filter&&"object"!==_typeof(filter))return result;for(i=0;i<l;i++){if(pass=!0,item=list[i],"object"===_typeof(filter)){for(f in filter)if(filter.hasOwnProperty(f)&&(flower=f.toLowerCase(),value="function"==typeof item[f]?item[f]():item[f],visPropValue=item.visProp&&"function"==typeof item.visProp[flower]?item.visProp[flower]():item.visProp&&item.visProp[flower],!(pass="function"==typeof filter[f]?filter[f](value)||filter[f](visPropValue):value===filter[f]||visPropValue===filter[f])))break}else"function"==typeof filter&&(pass=filter(item));pass&&result.push(item)}return result},trim:function(str){return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(str,caja){return"function"==typeof html_sanitize&&caja?html_sanitize(str,(function(){}),(function(id){return id})):(str&&"string"==typeof str&&(str=str.replace(/</g,"&lt;").replace(/>/g,"&gt;")),str)},evalSlider:function(s){return s&&s.type===Const.OBJECT_TYPE_GLIDER&&"function"==typeof s.Value?s.Value():s}}),JXG})),define("utils/env",["jxg","utils/type"],(function(JXG,Type){return JXG.extendConstants(JXG,{touchProperty:"touches"}),JXG.extend(JXG,{isTouchEvent:function(evt){return JXG.exists(evt[JXG.touchProperty])},isPointerEvent:function(evt){return JXG.exists(evt.pointerId)},isMouseEvent:function(evt){return!JXG.isTouchEvent(evt)&&!JXG.isPointerEvent(evt)},getNumberOfTouchPoints:function(evt){var n=-1;return JXG.isTouchEvent(evt)&&(n=evt[JXG.touchProperty].length),n},isFirstTouch:function(evt){var touchPoints=JXG.getNumberOfTouchPoints(evt);return JXG.isPointerEvent(evt)?evt.isPrimary:1===touchPoints},isBrowser:"object"===("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof document?"undefined":_typeof(document)),supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch(err){return!1}},supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var hasCanvas=!1;if(this.isNode())try{hasCanvas=!!("object"===("undefined"==typeof module?"undefined":_typeof(module))?module.require("canvas"):require("canvas"))}catch(err){}return hasCanvas||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&("object"===("undefined"==typeof module?"undefined":_typeof(module))&&!!module.exports||"object"===("undefined"==typeof global?"undefined":_typeof(global))&&global.requirejsVars&&!global.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&"object"===("undefined"==typeof self?"undefined":_typeof(self))&&"function"==typeof self.postMessage},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&void 0!==window.ontouchstart},isAndroid:function(){return Type.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return Type.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z.]*Safari/)>-1},isMetroApp:function(){return"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return Type.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&-1===navigator.userAgent.toLowerCase().indexOf("apple")},isFirefoxOS:function(){return Type.exists(navigator)&&-1===navigator.userAgent.toLowerCase().indexOf("android")&&-1===navigator.userAgent.toLowerCase().indexOf("apple")&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var div,all,v=3;if("object"!==("undefined"==typeof document?"undefined":_typeof(document)))return 0;all=(div=document.createElement("div")).getElementsByTagName("i");do{div.innerHTML="\x3c!--[if gt IE "+ ++v+"]><i></i><![endif]--\x3e"}while(all[0]);return v>4?v:void 0}(),getDimensions:function(elementId,doc){var element,display,els,originalVisibility,originalPosition,originalDisplay,originalWidth,originalHeight,style,pixelDimRegExp=/\d+(\.\d*)?px/;if(!this.isBrowser||null===elementId)return{width:500,height:500};if(element=(doc=doc||document).getElementById(elementId),!Type.exists(element))throw new Error("\nJSXGraph: HTML container element '"+elementId+"' not found.");return"none"!==(display=element.style.display)&&null!==display?element.clientWidth>0&&element.clientHeight>0?{width:element.clientWidth,height:element.clientHeight}:(style=window.getComputedStyle?window.getComputedStyle(element):element.style,{width:pixelDimRegExp.test(style.width)?parseFloat(style.width):0,height:pixelDimRegExp.test(style.height)?parseFloat(style.height):0}):(originalVisibility=(els=element.style).visibility,originalPosition=els.position,originalDisplay=els.display,els.visibility="hidden",els.position="absolute",els.display="block",originalWidth=element.clientWidth,originalHeight=element.clientHeight,els.display=originalDisplay,els.position=originalPosition,els.visibility=originalVisibility,{width:originalWidth,height:originalHeight})},addEvent:function(obj,type,fn,owner){var el=function(){return fn.apply(owner,arguments)};el.origin=fn,owner["x_internal"+type]=owner["x_internal"+type]||[],owner["x_internal"+type].push(el),Type.exists(obj)&&Type.exists(obj.addEventListener)&&obj.addEventListener(type,el,!1),Type.exists(obj)&&Type.exists(obj.attachEvent)&&obj.attachEvent("on"+type,el)},removeEvent:function(obj,type,fn,owner){var i;if(Type.exists(owner))if(Type.exists(owner["x_internal"+type]))if(Type.isArray(owner["x_internal"+type]))if(-1!==(i=Type.indexOf(owner["x_internal"+type],fn,"origin"))){try{Type.exists(obj)&&Type.exists(obj.removeEventListener)&&obj.removeEventListener(type,owner["x_internal"+type][i],!1),Type.exists(obj)&&Type.exists(obj.detachEvent)&&obj.detachEvent("on"+type,owner["x_internal"+type][i])}catch(e){JXG.debug("event not registered in browser: ("+type+" -- "+fn+")")}owner["x_internal"+type].splice(i,1)}else JXG.debug("removeEvent: no such event function in internal list: "+fn);else JXG.debug("owner[x_internal + "+type+"] is not an array");else JXG.debug("no such type: "+type);else JXG.debug("no such owner")},removeAllEvents:function(obj,type,owner){var i;if(owner["x_internal"+type]){for(i=owner["x_internal"+type].length-1;i>=0;i--)JXG.removeEvent(obj,type,owner["x_internal"+type][i].origin,owner);owner["x_internal"+type].length>0&&JXG.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(e,index,doc){var i,len,evtTouches,posx=0,posy=0;if(e||(e=window.event),doc=doc||document,evtTouches=e[JXG.touchProperty],Type.exists(evtTouches)&&0===evtTouches.length&&(evtTouches=e.changedTouches),Type.exists(index)&&Type.exists(evtTouches))if(-1===index){for(len=evtTouches.length,i=0;i<len;i++)if(evtTouches[i]){e=evtTouches[i];break}}else e=evtTouches[index];return e.clientX&&(posx=e.clientX,posy=e.clientY),[posx,posy]},getOffset:function(obj){var cPos,o=obj,o2=obj,l=o.offsetLeft-o.scrollLeft,t=o.offsetTop-o.scrollTop;for(l=(cPos=this.getCSSTransform([l,t],o))[0],t=cPos[1],o=o.offsetParent;o;){for(l+=o.offsetLeft,t+=o.offsetTop,o.offsetParent&&(l+=o.clientLeft-o.scrollLeft,t+=o.clientTop-o.scrollTop),l=(cPos=this.getCSSTransform([l,t],o))[0],t=cPos[1],o2=o2.parentNode;o2!==o;)l+=o2.clientLeft-o2.scrollLeft,t+=o2.clientTop-o2.scrollTop,l=(cPos=this.getCSSTransform([l,t],o2))[0],t=cPos[1],o2=o2.parentNode;o=o.offsetParent}return[l,t]},getStyle:function(obj,stylename){var r,doc=obj.ownerDocument;return doc.defaultView&&doc.defaultView.getComputedStyle?r=doc.defaultView.getComputedStyle(obj,null).getPropertyValue(stylename):obj.currentStyle&&JXG.ieVersion>=9?r=obj.currentStyle[stylename]:obj.style&&(stylename=stylename.replace(/-([a-z]|[0-9])/gi,(function(all,letter){return letter.toUpperCase()})),r=obj.style[stylename]),r},getProp:function(el,css){var n=parseInt(this.getStyle(el,css),10);return isNaN(n)?0:n},getCSSTransform:function(cPos,obj){var i,j,str,start,len,len2,arr,t=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(len=t.length,i=0,str="";i<len;i++)if(Type.exists(obj.style[t[i]])){str=obj.style[t[i]];break}if(""!==str&&(start=str.indexOf("("))>0){for(len=str.length,j=0,len2=(arr=str.substring(start+1,len-1).split(",")).length;j<len2;j++)arr[j]=parseFloat(arr[j]);0===str.indexOf("matrix")?(cPos[0]+=arr[4],cPos[1]+=arr[5]):0===str.indexOf("translateX")?cPos[0]+=arr[0]:0===str.indexOf("translateY")?cPos[1]+=arr[0]:0===str.indexOf("translate")&&(cPos[0]+=arr[0],cPos[1]+=arr[1])}return Type.exists(obj.style.zoom)&&""!==(str=obj.style.zoom)&&(cPos[0]*=parseFloat(str),cPos[1]*=parseFloat(str)),cPos},getCSSTransformMatrix:function(obj){var i,j,str,start,len,len2,arr,st,doc=obj.ownerDocument,t=["transform","webkitTransform","MozTransform","msTransform","oTransform"],mat=[[1,0,0],[0,1,0],[0,0,1]];if(doc.defaultView&&doc.defaultView.getComputedStyle)str=(st=doc.defaultView.getComputedStyle(obj,null)).getPropertyValue("-webkit-transform")||st.getPropertyValue("-moz-transform")||st.getPropertyValue("-ms-transform")||st.getPropertyValue("-o-transform")||st.getPropertyValue("transform");else for(len=t.length,i=0,str="";i<len;i++)if(Type.exists(obj.style[t[i]])){str=obj.style[t[i]];break}if(""!==str&&(start=str.indexOf("("))>0){for(len=str.length,j=0,len2=(arr=str.substring(start+1,len-1).split(",")).length;j<len2;j++)arr[j]=parseFloat(arr[j]);0===str.indexOf("matrix")?mat=[[1,0,0],[0,arr[0],arr[1]],[0,arr[2],arr[3]]]:0===str.indexOf("scaleX")?mat[1][1]=arr[0]:0===str.indexOf("scaleY")?mat[2][2]=arr[0]:0===str.indexOf("scale")&&(mat[1][1]=arr[0],mat[2][2]=arr[1])}return Type.exists(obj.style.zoom)&&""!==(str=obj.style.zoom)&&(mat[1][1]*=parseFloat(str),mat[2][2]*=parseFloat(str)),mat},timedChunk:function(items,process,context,callback){var todo=items.concat();window.setTimeout((function timerFun(){var start=+new Date;do{process.call(context,todo.shift())}while(todo.length>0&&+new Date-start<300);todo.length>0?window.setTimeout(timerFun,1):callback(items)}),1)},_getScaleFactors:function(node){var width=node.getBoundingClientRect().width,height=node.getBoundingClientRect().height,r_w=window.screen.width/width,r_h=window.screen.height/height,vshift=.5*(window.screen.height-height),scale=Math.min(r_w,r_h);return window.matchMedia&&window.matchMedia("(orientation:landscape)").matches&&window.screen.width<window.screen.height&&(r_w=window.screen.height/width,r_h=window.screen.width/height,scale=Math.min(r_w,r_h),vshift=.5*(window.screen.width-height)),{scale:scale*=.85,vshift:vshift,width:width}},scaleJSXGraphDiv:function(wrap_id,inner_id,scale,vshift){var style,i,len=document.styleSheets.length,pseudo_keys=[":fullscreen",":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"],len_pseudo=pseudo_keys.length,rule_inner="{margin:0 auto;transform:matrix("+scale+",0,0,"+scale+",0,"+vshift+");}",regex=new RegExp(".*#"+wrap_id+":.*full.*screen.*#"+inner_id+".*auto;.*transform:.*matrix");for(0===len&&((style=document.createElement("style")).appendChild(document.createTextNode("")),document.body.appendChild(style),len=document.styleSheets.length),document.styleSheets[len-1].cssRules.length>0&&regex.test(document.styleSheets[len-1].cssRules[0].cssText)&&document.styleSheets[len-1].deleteRule&&document.styleSheets[len-1].deleteRule(0),i=0;i<len_pseudo;i++)try{document.styleSheets[len-1].insertRule("#"+wrap_id+pseudo_keys[i]+" #"+inner_id+rule_inner,0);break}catch(err){}i===len_pseudo&&(console.log("JXG.scaleJSXGraphDiv: Could not add any CSS rule."),console.log("One possible reason could be that the id of the JSXGraph container does not start with a letter."))}}),JXG})),define("utils/xml",["jxg","utils/type"],(function(JXG,Type){return JXG.XML={cleanWhitespace:function(el){for(var cur=el.firstChild;Type.exists(cur);)3!==cur.nodeType||/\S/.test(cur.nodeValue)?1===cur.nodeType&&this.cleanWhitespace(cur):el.removeChild(cur),cur=cur.nextSibling},parse:function(str){var tree,DP;return DP="function"==typeof DOMParser||"object"===("undefined"==typeof DOMParser?"undefined":_typeof(DOMParser))?DOMParser:function(){this.parseFromString=function(str){var d;return"function"==typeof ActiveXObject&&(d=new ActiveXObject("MSXML.DomDocument")).loadXML(str),d}},tree=(new DP).parseFromString(str,"text/xml"),this.cleanWhitespace(tree),tree}},JXG.XML})),define("utils/event",["jxg","utils/type"],(function(JXG,Type){return JXG.EventEmitter={eventHandlers:{},suspended:{},trigger:function(event,args){var i,j,h,evt,len1,len2;for(len1=event.length,j=0;j<len1;j++)if(evt=this.eventHandlers[event[j]],!this.suspended[event[j]]){if(this.suspended[event[j]]=!0,evt)for(len2=evt.length,i=0;i<len2;i++)(h=evt[i]).handler.apply(h.context,args);this.suspended[event[j]]=!1}return this},on:function(event,handler,context){return Type.isArray(this.eventHandlers[event])||(this.eventHandlers[event]=[]),context=Type.def(context,this),this.eventHandlers[event].push({handler:handler,context:context}),this},off:function(event,handler){var i;return event&&Type.isArray(this.eventHandlers[event])?(handler?((i=Type.indexOf(this.eventHandlers[event],handler,"handler"))>-1&&this.eventHandlers[event].splice(i,1),0===this.eventHandlers[event].length&&delete this.eventHandlers[event]):delete this.eventHandlers[event],this):this},eventify:function(o){o.eventHandlers={},o.on=this.on,o.off=this.off,o.triggerEventHandlers=this.trigger,o.trigger=this.trigger,o.suspended={}}},JXG.EventEmitter})),define("math/math",["jxg","utils/type"],(function(JXG,Type){var memoizer=function(f){var cache,join;return f.memo||(cache={},join=Array.prototype.join,f.memo=function(){var key=join.call(arguments);return undefined!==cache[key]?cache[key]:cache[key]=f.apply(this,arguments)}),f.memo};return JXG.Math={eps:1e-6,relDif:function(a,b){var c=Math.abs(a),d=Math.abs(b);return 0===(d=Math.max(c,d))?0:Math.abs(a-b)/d},mod:function(a,m){return a-Math.floor(a/m)*m},vector:function(n,init){var r,i;for(init=init||0,r=[],i=0;i<n;i++)r[i]=init;return r},matrix:function(n,m,init){var r,i,j;for(init=init||0,m=m||n,r=[],i=0;i<n;i++)for(r[i]=[],j=0;j<m;j++)r[i][j]=init;return r},identity:function(n,m){var r,i;for(undefined===m&&"number"!=typeof m&&(m=n),r=this.matrix(n,m),i=0;i<Math.min(n,m);i++)r[i][i]=1;return r},frustum:function(l,r,b,t,n,f){var ret=this.matrix(4,4);return ret[0][0]=2*n/(r-l),ret[0][1]=0,ret[0][2]=(r+l)/(r-l),ret[0][3]=0,ret[1][0]=0,ret[1][1]=2*n/(t-b),ret[1][2]=(t+b)/(t-b),ret[1][3]=0,ret[2][0]=0,ret[2][1]=0,ret[2][2]=-(f+n)/(f-n),ret[2][3]=-f*n*2/(f-n),ret[3][0]=0,ret[3][1]=0,ret[3][2]=-1,ret[3][3]=0,ret},projection:function(fov,ratio,n,f){var t=n*Math.tan(fov/2),r=t*ratio;return this.frustum(-r,r,-t,t,n,f)},matVecMult:function(mat,vec){var i,s,k,m=mat.length,n=vec.length,res=[];if(3===n)for(i=0;i<m;i++)res[i]=mat[i][0]*vec[0]+mat[i][1]*vec[1]+mat[i][2]*vec[2];else for(i=0;i<m;i++){for(s=0,k=0;k<n;k++)s+=mat[i][k]*vec[k];res[i]=s}return res},matMatMult:function(mat1,mat2){var i,j,s,k,m=mat1.length,n=m>0?mat2[0].length:0,m2=mat2.length,res=this.matrix(m,n);for(i=0;i<m;i++)for(j=0;j<n;j++){for(s=0,k=0;k<m2;k++)s+=mat1[i][k]*mat2[k][j];res[i][j]=s}return res},transpose:function(M){var MT,i,j,m,n;for(m=M.length,n=M.length>0?M[0].length:0,MT=this.matrix(n,m),i=0;i<n;i++)for(j=0;j<m;j++)MT[i][j]=M[j][i];return MT},inverse:function(Ain){var i,j,k,s,ma,r,swp,n=Ain.length,A=[],p=[],hv=[];for(i=0;i<n;i++){for(A[i]=[],j=0;j<n;j++)A[i][j]=Ain[i][j];p[i]=i}for(j=0;j<n;j++){for(ma=Math.abs(A[j][j]),r=j,i=j+1;i<n;i++)Math.abs(A[i][j])>ma&&(ma=Math.abs(A[i][j]),r=i);if(ma<=this.eps)return[];if(r>j){for(k=0;k<n;k++)swp=A[j][k],A[j][k]=A[r][k],A[r][k]=swp;swp=p[j],p[j]=p[r],p[r]=swp}for(s=1/A[j][j],i=0;i<n;i++)A[i][j]*=s;for(A[j][j]=s,k=0;k<n;k++)if(k!==j){for(i=0;i<n;i++)i!==j&&(A[i][k]-=A[i][j]*A[j][k]);A[j][k]=-s*A[j][k]}}for(i=0;i<n;i++){for(k=0;k<n;k++)hv[p[k]]=A[i][k];for(k=0;k<n;k++)A[i][k]=hv[k]}return A},innerProduct:function(a,b,n){var i,s=0;for(undefined!==n&&Type.isNumber(n)||(n=a.length),i=0;i<n;i++)s+=a[i]*b[i];return s},crossProduct:function(c1,c2){return[c1[1]*c2[2]-c1[2]*c2[1],c1[2]*c2[0]-c1[0]*c2[2],c1[0]*c2[1]-c1[1]*c2[0]]},norm:function(a,n){var i,sum=0;for(undefined!==n&&Type.isNumber(n)||(n=a.length),i=0;i<n;i++)sum+=a[i]*a[i];return Math.sqrt(sum)},axpy:function(a,x,y){var i,le=x.length,p=[];for(i=0;i<le;i++)p[i]=a*x[i]+y[i];return p},factorial:memoizer((function(n){return n<0?NaN:0===(n=Math.floor(n))||1===n?1:n*this.factorial(n-1)})),binomial:memoizer((function(n,k){var b,i;if(k>n||k<0)return NaN;if(k=Math.round(k),n=Math.round(n),0===k||k===n)return 1;for(b=1,i=0;i<k;i++)b*=n-i,b/=i+1;return b})),cosh:Math.cosh||function(x){return.5*(Math.exp(x)+Math.exp(-x))},sinh:Math.sinh||function(x){return.5*(Math.exp(x)-Math.exp(-x))},acosh:Math.acosh||function(x){return Math.log(x+Math.sqrt(x*x-1))},asinh:Math.asinh||function(x){return x===-1/0?x:Math.log(x+Math.sqrt(x*x+1))},cot:function(x){return 1/Math.tan(x)},acot:function(x){return(x>=0?.5:-.5)*Math.PI-Math.atan(x)},nthroot:function(x,n){var inv=1/n;return n<=0||Math.floor(n)!==n?NaN:0===x?0:x>0?Math.exp(inv*Math.log(x)):n%2==1?-Math.exp(inv*Math.log(-x)):NaN},cbrt:Math.cbrt||function(x){return this.nthroot(x,3)},pow:function(base,exponent){return 0===base?0===exponent?1:0:Math.floor(exponent)===exponent?Math.pow(base,exponent):base>0?Math.exp(exponent*Math.log(base)):NaN},ratpow:function(base,m,n){var g;return 0===m?1:0===n?NaN:(g=this.gcd(m,n),this.nthroot(this.pow(base,m/g),n/g))},log10:function(x){return Math.log(x)/Math.log(10)},log2:function(x){return Math.log(x)/Math.log(2)},log:function(x,b){return void 0!==b&&Type.isNumber(b)?Math.log(x)/Math.log(b):Math.log(x)},sign:Math.sign||function(x){return 0===(x=+x)||isNaN(x)?x:x>0?1:-1},squampow:function(base,exponent){var result;if(Math.floor(exponent)===exponent){for(result=1,exponent<0&&(base=1/base,exponent*=-1);0!==exponent;)1&exponent&&(result*=base),exponent>>=1,base*=base;return result}return this.pow(base,exponent)},gcd:function(a,b){if(a=Math.abs(a),b=Math.abs(b),!Type.isNumber(a)||!Type.isNumber(b))return NaN;if(b>a){var temp=a;a=b,b=temp}for(;;){if(0===(a%=b))return b;if(0===(b%=a))return a}},lcm:function(a,b){var ret;return Type.isNumber(a)&&Type.isNumber(b)?0!==(ret=a*b)?ret/this.gcd(a,b):0:NaN},erf:function(x){return this.ProbFuncs.erf(x)},erfc:function(x){return this.ProbFuncs.erfc(x)},erfi:function(x){return this.ProbFuncs.erfi(x)},ndtr:function(x){return this.ProbFuncs.ndtr(x)},ndtri:function(x){return this.ProbFuncs.ndtri(x)},lt:function(a,b){return a<b},leq:function(a,b){return a<=b},gt:function(a,b){return a>b},geq:function(a,b){return a>=b},eq:function(a,b){return a===b},neq:function(a,b){return a!==b},and:function(a,b){return a&&b},not:function(a){return!a},or:function(a,b){return a||b},xor:function(a,b){return(a||b)&&!(a&&b)},normalize:function(stdform){var n,signr,a2=2*stdform[3],r=stdform[4]/a2;return stdform[5]=r,stdform[6]=-stdform[1]/a2,stdform[7]=-stdform[2]/a2,isFinite(r)?Math.abs(r)>=1?(stdform[0]=(stdform[6]*stdform[6]+stdform[7]*stdform[7]-r*r)/(2*r),stdform[1]=-stdform[6]/r,stdform[2]=-stdform[7]/r,stdform[3]=1/(2*r),stdform[4]=1):(signr=r<=0?-1:1,stdform[0]=signr*(stdform[6]*stdform[6]+stdform[7]*stdform[7]-r*r)*.5,stdform[1]=-signr*stdform[6],stdform[2]=-signr*stdform[7],stdform[3]=signr/2,stdform[4]=signr*r):(n=Math.sqrt(stdform[1]*stdform[1]+stdform[2]*stdform[2]),stdform[0]/=n,stdform[1]/=n,stdform[2]/=n,stdform[3]=0,stdform[4]=1),stdform},toGL:function(m){var v,i,j;if(v="function"==typeof Float32Array?new Float32Array(16):new Array(16),4!==m.length&&4!==m[0].length)return v;for(i=0;i<4;i++)for(j=0;j<4;j++)v[i+4*j]=m[i][j];return v},Vieta:function(x){var m,k,y,n=x.length,s=[];for(s=x.slice(),m=1;m<n;++m){for(y=s[m],s[m]*=s[m-1],k=m-1;k>=1;--k)s[k]+=s[k-1]*y;s[0]+=y}return s}},JXG.Math})),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],(function(JXG,Const,EventEmitter,Type,Mat){return JXG.Coords=function(method,coordinates,board,emitter){this.board=board,this.usrCoords=[],this.scrCoords=[],this.emitter=!Type.exists(emitter)||emitter,this.emitter&&EventEmitter.eventify(this),this.setCoordinates(method,coordinates,!1,!0)},JXG.extend(JXG.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>Mat.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(doRound){var mround=Math.round,b=this.board,uc=this.usrCoords,oc=b.origin.scrCoords;!0===doRound?(this.scrCoords[0]=mround(uc[0]),this.scrCoords[1]=mround(uc[0]*oc[1]+uc[1]*b.unitX),this.scrCoords[2]=mround(uc[0]*oc[2]-uc[2]*b.unitY)):(this.scrCoords[0]=uc[0],this.scrCoords[1]=uc[0]*oc[1]+uc[1]*b.unitX,this.scrCoords[2]=uc[0]*oc[2]-uc[2]*b.unitY)},screen2usr:function(){var o=this.board.origin.scrCoords,sc=this.scrCoords,b=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(sc[1]-o[1])/b.unitX,this.usrCoords[2]=(o[2]-sc[2])/b.unitY},distance:function(coord_type,coordinates){var c,f,sum=0,ucr=this.usrCoords,scr=this.scrCoords;if(coord_type===Const.COORDS_BY_USER){if(c=coordinates.usrCoords,(sum=(f=ucr[0]-c[0])*f)>Mat.eps*Mat.eps)return Number.POSITIVE_INFINITY;sum+=(f=ucr[1]-c[1])*f,sum+=(f=ucr[2]-c[2])*f}else c=coordinates.scrCoords,sum+=(f=scr[1]-c[1])*f,sum+=(f=scr[2]-c[2])*f;return Math.sqrt(sum)},setCoordinates:function(coord_type,coordinates,doRound,noevent){var uc=this.usrCoords,sc=this.scrCoords,ou=[uc[0],uc[1],uc[2]],os=[sc[0],sc[1],sc[2]];return coord_type===Const.COORDS_BY_USER?(2===coordinates.length?(uc[0]=1,uc[1]=coordinates[0],uc[2]=coordinates[1]):(uc[0]=coordinates[0],uc[1]=coordinates[1],uc[2]=coordinates[2],this.normalizeUsrCoords()),this.usr2screen(doRound)):(2===coordinates.length?(sc[1]=coordinates[0],sc[2]=coordinates[1]):(sc[1]=coordinates[1],sc[2]=coordinates[2]),this.screen2usr()),!this.emitter||noevent||os[1]===sc[1]&&os[2]===sc[2]||this.triggerEventHandlers(["update"],[ou,os]),this},copy:function(obj,offset){return void 0===offset&&(offset=0),this[obj].slice(offset)},isReal:function(){return!isNaN(this.usrCoords[1]+this.usrCoords[2])&&Math.abs(this.usrCoords[0])>Mat.eps},__evt__update:function(ou,os){},__evt:function(){}}),JXG.Coords})),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],(function(JXG,Type,Const,Coords){var Expect={each:function(a,format,copy){var i,len,r=[];if(Type.exists(a.length))for(len=a.length,i=0;i<len;i++)r.push(format.call(this,a[i],copy));return r},coords:function(c,copy){var coord=c;return c&&c.elementClass===Const.OBJECT_CLASS_POINT?coord=c.coords:c.usrCoords&&c.scrCoords&&c.usr2screen&&(coord=c),copy&&(coord=new Coords(Const.COORDS_BY_USER,coord.usrCoords,coord.board)),coord},coordsArray:function(c,copy){var coord;return(coord=Type.isArray(c)?c:this.coords(c).usrCoords).length<3&&coord.unshift(1),copy&&(coord=[coord[0],coord[1],coord[2]]),coord}};return JXG.Expect=Expect,Expect})),define("math/probfuncs",["math/math","utils/type"],(function(Mat,Type){return Mat.ProbFuncs={MAXNUM:17014118346046923e22,SQRTH:.7071067811865476,SQRT2:1.4142135623730951,MAXLOG:708.3964185322641,P:[2.461969814735305e-10,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],Q:[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],R:[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],S:[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],T:[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],U:[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],M:128,MINV:.0078125,expx2:function(x,sign){var u,u1,m,f;return x=Math.abs(x),sign<0&&(x=-x),u=(m=this.MINV*Math.floor(this.M*x+.5))*m,u1=2*m*(f=x-m)+f*f,sign<0&&(u=-u,u1=-u1),u+u1>this.MAXLOG?1/0:u=Math.exp(u)*Math.exp(u1)},polevl:function(x,coef,N){var ans,i;if(Type.exists(coef.reduce))return coef.reduce((function(acc,c){return acc*x+c}),0);for(i=0,ans=0;i<=N;i++)ans=ans*x+coef[i];return ans},p1evl:function(x,coef,N){var ans,i;if(Type.exists(coef.reduce))return coef.reduce((function(acc,c){return acc*x+c}),1);for(i=0,ans=1;i<N;i++)ans=ans*x+coef[i];return ans},ndtr:function(a){var x,y,z;return x=a*this.SQRTH,(z=Math.abs(x))<1?y=.5+.5*this.erf(x):(y=.5*this.erfce(z),z=this.expx2(a,-1),y*=Math.sqrt(z),x>0&&(y=1-y)),y},_underflow:function(a){return console.log("erfc","UNDERFLOW"),a<0?2:0},erfc:function(a){var p,q,x,y,z;return(x=a<0?-a:a)<1?1-this.erf(a):(z=-a*a)<-this.MAXLOG?this._underflow(a):(z=this.expx2(a,-1),x<8?(p=this.polevl(x,this.P,8),q=this.p1evl(x,this.Q,8)):(p=this.polevl(x,this.R,5),q=this.p1evl(x,this.S,6)),y=z*p/q,a<0&&(y=2-y),0===y?this._underflow(a):y)},erfce:function(x){var p,q;return x<8?(p=this.polevl(x,this.P,8),q=this.p1evl(x,this.Q,8)):(p=this.polevl(x,this.R,5),q=this.p1evl(x,this.S,6)),p/q},erf:function(x){var z;return Math.abs(x)>1?1-this.erfc(x):(z=x*x,x*this.polevl(z,this.T,4)/this.p1evl(z,this.U,5))},s2pi:2.5066282746310007,P0:[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],Q0:[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],P1:[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],Q1:[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],P2:[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6.239745391849833e-9],Q2:[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6.790194080099813e-9],ndtri:function(y0){var x,y,z,y2,code;return y0<=0?-1/0:y0>=1?1/0:(code=1,(y=y0)>.8646647167633873&&(y=1-y,code=0),y>.1353352832366127?(x=(y-=.5)+y*((y2=y*y)*this.polevl(y2,this.P0,4)/this.p1evl(y2,this.Q0,8)),x*=this.s2pi):(z=1/(x=Math.sqrt(-2*Math.log(y))),x=x-Math.log(x)/x-(x<8?z*this.polevl(z,this.P1,8)/this.p1evl(z,this.Q1,8):z*this.polevl(z,this.P2,8)/this.p1evl(z,this.Q2,8)),0!==code&&(x=-x),x))},erfi:function(x){return this.ndtri(.5*(x+1))*this.SQRTH}},Mat.ProbFuncs})),define("math/ia",["jxg","math/math","utils/type"],(function(JXG,Mat,Type){JXG.Math.DoubleBits=function(){var doubleBitsLE,toDoubleLE,lowUintLE,highUintLE,doubleBitsBE,toDoubleBE,lowUintBE,highUintBE,DOUBLE_VIEW=new Float64Array(1),UINT_VIEW=new Uint32Array(DOUBLE_VIEW.buffer);void 0!==Float64Array&&(DOUBLE_VIEW[0]=1,!0,1072693248===UINT_VIEW[1]?(doubleBitsLE=function(n){return DOUBLE_VIEW[0]=n,[UINT_VIEW[0],UINT_VIEW[1]]},toDoubleLE=function(lo,hi){return UINT_VIEW[0]=lo,UINT_VIEW[1]=hi,DOUBLE_VIEW[0]},lowUintLE=function(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[0]},highUintLE=function(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[1]},this.doubleBits=doubleBitsLE,this.pack=toDoubleLE,this.lo=lowUintLE,this.hi=highUintLE):1072693248===UINT_VIEW[0]&&(doubleBitsBE=function(n){return DOUBLE_VIEW[0]=n,[UINT_VIEW[1],UINT_VIEW[0]]},toDoubleBE=function(lo,hi){return UINT_VIEW[1]=lo,UINT_VIEW[0]=hi,DOUBLE_VIEW[0]},lowUintBE=function(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[1]},highUintBE=function(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[0]},this.doubleBits=doubleBitsBE,this.pack=toDoubleBE,this.lo=lowUintBE,this.hi=highUintBE))},JXG.extend(JXG.Math.DoubleBits.prototype,{sign:function(n){return this.hi(n)>>>31},exponent:function(n){return(this.hi(n)<<1>>>21)-1023},fraction:function(n){var lo=this.lo(n),hi=this.hi(n),b=1048575&hi;return 2146435072&hi&&(b+=1<<20),[lo,b]},denormalized:function(n){return!(2146435072&this.hi(n))}});var doubleBits=new JXG.Math.DoubleBits,MatInterval=function MatInterval(lo,hi){if(void 0!==lo&&void 0!==hi){if(Mat.IntervalArithmetic.isInterval(lo)){if(!Mat.IntervalArithmetic.isSingleton(lo))throw new TypeError("JXG.Math.IntervalArithmetic: interval `lo` must be a singleton");this.lo=lo.lo}else this.lo=lo;if(Mat.IntervalArithmetic.isInterval(hi)){if(!Mat.IntervalArithmetic.isSingleton(hi))throw new TypeError("JXG.Math.IntervalArithmetic: interval `hi` must be a singleton");this.hi=hi.hi}else this.hi=hi}else{if(void 0!==lo)return Array.isArray(lo)?new MatInterval(lo[0],lo[1]):new MatInterval(lo,lo);this.lo=this.hi=0}};return JXG.extend(MatInterval.prototype,{print:function(){console.log("[",this.lo,this.hi,"]")},set:function(lo,hi){return this.lo=lo,this.hi=hi,this},bounded:function(lo,hi){return this.set(Mat.IntervalArithmetic.prev(lo),Mat.IntervalArithmetic.next(hi))},boundedSingleton:function(v){return this.bounded(v,v)},assign:function(lo,hi){if("number"!=typeof lo||"number"!=typeof hi)throw new TypeError("JXG.Math.Interval#assign: arguments must be numbers");return isNaN(lo)||isNaN(hi)||lo>hi?this.setEmpty():this.set(lo,hi)},setEmpty:function(){return this.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},setWhole:function(){return this.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)},open:function(lo,hi){return this.assign(Mat.IntervalArithmetic.next(lo),Mat.IntervalArithmetic.prev(hi))},halfOpenLeft:function(lo,hi){return this.assign(Mat.IntervalArithmetic.next(lo),hi)},halfOpenRight:function(lo,hi){return this.assign(lo,Mat.IntervalArithmetic.prev(hi))},toArray:function(){return[this.lo,this.hi]},clone:function(){return(new MatInterval).set(this.lo,this.hi)}}),JXG.Math.IntervalArithmetic={Interval:function(lo,hi){return new MatInterval(lo,hi)},isInterval:function(i){return null!==i&&"object"===_typeof(i)&&"number"==typeof i.lo&&"number"==typeof i.hi},isSingleton:function(i){return i.lo===i.hi},add:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),new MatInterval(this.addLo(x.lo,y.lo),this.addHi(x.hi,y.hi))},sub:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),new MatInterval(this.subLo(x.lo,y.hi),this.subHi(x.hi,y.lo))},mul:function(x,y){var xl,xh,yl,yh,out;return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),this.isEmpty(x)||this.isEmpty(y)?this.EMPTY.clone():(xl=x.lo,xh=x.hi,yl=y.lo,yh=y.hi,out=new MatInterval,xl<0?xh>0?yl<0?yh>0?(out.lo=Math.min(this.mulLo(xl,yh),this.mulLo(xh,yl)),out.hi=Math.max(this.mulHi(xl,yl),this.mulHi(xh,yh))):(out.lo=this.mulLo(xh,yl),out.hi=this.mulHi(xl,yl)):yh>0?(out.lo=this.mulLo(xl,yh),out.hi=this.mulHi(xh,yh)):(out.lo=0,out.hi=0):yl<0?yh>0?(out.lo=this.mulLo(xl,yh),out.hi=this.mulHi(xl,yl)):(out.lo=this.mulLo(xh,yh),out.hi=this.mulHi(xl,yl)):yh>0?(out.lo=this.mulLo(xl,yh),out.hi=this.mulHi(xh,yl)):(out.lo=0,out.hi=0):xh>0?yl<0?yh>0?(out.lo=this.mulLo(xh,yl),out.hi=this.mulHi(xh,yh)):(out.lo=this.mulLo(xh,yl),out.hi=this.mulHi(xl,yh)):yh>0?(out.lo=this.mulLo(xl,yl),out.hi=this.mulHi(xh,yh)):(out.lo=0,out.hi=0):(out.lo=0,out.hi=0),out)},div:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),this.isEmpty(x)||this.isEmpty(y)?this.EMPTY.clone():this.zeroIn(y)?0!==y.lo?0!==y.hi?this.divZero(x):this.divNegative(x,y.lo):0!==y.hi?this.divPositive(x,y.hi):this.EMPTY.clone():this.divNonZero(x,y)},positive:function(x){return new MatInterval(x.lo,x.hi)},negative:function(x){return Type.isNumber(x)?new MatInterval(-x):new MatInterval(-x.hi,-x.lo)},isEmpty:function(i){return i.lo>i.hi},isWhole:function(i){return i.lo===-1/0&&i.hi===1/0},zeroIn:function(i){return this.hasValue(i,0)},hasValue:function(i,value){return!this.isEmpty(i)&&(i.lo<=value&&value<=i.hi)},hasInterval:function(x,y){return!!this.isEmpty(x)||!this.isEmpty(y)&&y.lo<=x.lo&&x.hi<=y.hi},intervalsOverlap:function(x,y){return!this.isEmpty(x)&&!this.isEmpty(y)&&(x.lo<=y.lo&&y.lo<=x.hi||y.lo<=x.lo&&x.lo<=y.hi)},divNonZero:function(x,y){var xl=x.lo,xh=x.hi,yl=y.lo,yh=y.hi,out=new MatInterval;return xh<0?yh<0?(out.lo=this.divLo(xh,yl),out.hi=this.divHi(xl,yh)):(out.lo=this.divLo(xl,yl),out.hi=this.divHi(xh,yh)):xl<0?yh<0?(out.lo=this.divLo(xh,yh),out.hi=this.divHi(xl,yh)):(out.lo=this.divLo(xl,yl),out.hi=this.divHi(xh,yl)):yh<0?(out.lo=this.divLo(xh,yh),out.hi=this.divHi(xl,yl)):(out.lo=this.divLo(xl,yh),out.hi=this.divHi(xh,yl)),out},divPositive:function(x,v){return 0===x.lo&&0===x.hi?x:this.zeroIn(x)?this.WHOLE:x.hi<0?new MatInterval(Number.NEGATIVE_INFINITY,this.divHi(x.hi,v)):new MatInterval(this.divLo(x.lo,v),Number.POSITIVE_INFINITY)},divNegative:function(x,v){return 0===x.lo&&0===x.hi?x:this.zeroIn(x)?this.WHOLE:x.hi<0?new MatInterval(this.divLo(x.hi,v),Number.POSITIVE_INFINITY):new MatInterval(Number.NEGATIVE_INFINITY,this.divHi(x.lo,v))},divZero:function(x){return 0===x.lo&&0===x.hi?x:this.WHOLE},fmod:function(x,y){var yb,n;return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),this.isEmpty(x)||this.isEmpty(y)?this.EMPTY.clone():(yb=x.lo<0?y.lo:y.hi,n=(n=x.lo/yb)<0?Math.ceil(n):Math.floor(n),this.sub(x,this.mul(y,new MatInterval(n))))},multiplicativeInverse:function(x){return Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x)?this.EMPTY.clone():this.zeroIn(x)?0!==x.lo?0!==x.hi?this.WHOLE:new MatInterval(Number.NEGATIVE_INFINITY,this.divHi(1,x.lo)):0!==x.hi?new MatInterval(this.divLo(1,x.hi),Number.POSITIVE_INFINITY):this.EMPTY.clone():new MatInterval(this.divLo(1,x.hi),this.divHi(1,x.lo))},pow:function(x,power){var yl,yh;if(Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x))return this.EMPTY.clone();if(this.isInterval(power)){if(!this.isSingleton(power))return this.EMPTY.clone();power=power.lo}return 0===power?0===x.lo&&0===x.hi?this.EMPTY.clone():this.ONE.clone():power<0?this.pow(this.multiplicativeInverse(x),-power):power%1==0?x.hi<0?(yl=this.powLo(-x.hi,power),yh=this.powHi(-x.lo,power),1==(1&power)?new MatInterval(-yh,-yl):new MatInterval(yl,yh)):x.lo<0?1==(1&power)?new MatInterval(-this.powLo(-x.lo,power),this.powHi(x.hi,power)):new MatInterval(0,this.powHi(Math.max(-x.lo,x.hi),power)):new MatInterval(this.powLo(x.lo,power),this.powHi(x.hi,power)):(console.warn("power is not an integer, you should use nth-root instead, returning an empty interval"),this.EMPTY.clone())},sqrt:function(x){return Type.isNumber(x)&&(x=this.Interval(x)),this.nthRoot(x,2)},nthRoot:function(x,n){var power,yl,yh,yp,yn;if(Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x)||n<0)return this.EMPTY.clone();if(this.isInterval(n)){if(!this.isSingleton(n))return this.EMPTY.clone();n=n.lo}return power=1/n,x.hi<0?n%1==0&&1==(1&n)?(yl=this.powHi(-x.lo,power),yh=this.powLo(-x.hi,power),new MatInterval(-yl,-yh)):this.EMPTY.clone():x.lo<0?(yp=this.powHi(x.hi,power),n%1==0&&1==(1&n)?(yn=-this.powHi(-x.lo,power),new MatInterval(yn,yp)):new MatInterval(0,yp)):new MatInterval(this.powLo(x.lo,power),this.powHi(x.hi,power))},exp:function(x){return Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x)?this.EMPTY.clone():new MatInterval(this.expLo(x.lo),this.expHi(x.hi))},log:function(x){var l;return Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x)?this.EMPTY.clone():(l=x.lo<=0?Number.NEGATIVE_INFINITY:this.logLo(x.lo),new MatInterval(l,this.logHi(x.hi)))},ln:function(x){return this.log(x)},log10:function(x){return this.isEmpty(x)?this.EMPTY.clone():this.div(this.log(x),this.log(new MatInterval(10,10)))},log2:function(x){return this.isEmpty(x)?this.EMPTY.clone():this.div(this.log(x),this.log(new MatInterval(2,2)))},hull:function(x,y){var badX=this.isEmpty(x),badY=this.isEmpty(y);return badX&&badY?this.EMPTY.clone():badX?y.clone():badY?x.clone():new MatInterval(Math.min(x.lo,y.lo),Math.max(x.hi,y.hi))},intersection:function(x,y){var lo,hi;return this.isEmpty(x)||this.isEmpty(y)?this.EMPTY.clone():(lo=Math.max(x.lo,y.lo))<=(hi=Math.min(x.hi,y.hi))?new MatInterval(lo,hi):this.EMPTY.clone()},union:function(x,y){if(!this.intervalsOverlap(x,y))throw new Error("Interval#unions do not overlap");return new MatInterval(Math.min(x.lo,y.lo),Math.max(x.hi,y.hi))},difference:function(x,y){if(this.isEmpty(x)||this.isWhole(y))return this.EMPTY.clone();if(this.intervalsOverlap(x,y)){if(x.lo<y.lo&&y.hi<x.hi)throw new Error("Interval.difference: difference creates multiple intervals");return y.lo<=x.lo&&y.hi===1/0||y.hi>=x.hi&&y.lo===-1/0?this.EMPTY.clone():y.lo<=x.lo?(new MatInterval).halfOpenLeft(y.hi,x.hi):(new MatInterval).halfOpenRight(x.lo,y.lo)}return x.clone()},width:function(x){return this.isEmpty(x)?0:this.subHi(x.hi,x.lo)},abs:function(x){return Type.isNumber(x)&&(x=this.Interval(x)),this.isEmpty(x)?this.EMPTY.clone():x.lo>=0?x.clone():x.hi<=0?this.negative(x):new MatInterval(0,Math.max(-x.lo,x.hi))},max:function(x,y){var badX=this.isEmpty(x),badY=this.isEmpty(y);return badX&&badY?this.EMPTY.clone():badX?y.clone():badY?x.clone():new MatInterval(Math.max(x.lo,y.lo),Math.max(x.hi,y.hi))},min:function(x,y){var badX=this.isEmpty(x),badY=this.isEmpty(y);return badX&&badY?this.EMPTY.clone():badX?y.clone():badY?x.clone():new MatInterval(Math.min(x.lo,y.lo),Math.min(x.hi,y.hi))},onlyInfinity:function(x){return!isFinite(x.lo)&&x.lo===x.hi},_handleNegative:function(interval){var n;return interval.lo<0&&(interval.lo===-1/0?(interval.lo=0,interval.hi=1/0):(n=Math.ceil(-interval.lo/this.piTwiceLow),interval.lo+=this.piTwiceLow*n,interval.hi+=this.piTwiceLow*n)),interval},cos:function(x){var cache,pi2,t,cosv,lo,hi,rlo,rhi;return this.isEmpty(x)||this.onlyInfinity(x)?this.EMPTY.clone():(cache=(new MatInterval).set(x.lo,x.hi),this._handleNegative(cache),pi2=this.PI_TWICE,t=this.fmod(cache,pi2),this.width(t)>=pi2.lo?new MatInterval(-1,1):t.lo>=this.piHigh?(cosv=this.cos(this.sub(t,this.PI)),this.negative(cosv)):(lo=t.lo,hi=t.hi,rlo=this.cosLo(hi),rhi=this.cosHi(lo),hi<=this.piLow?new MatInterval(rlo,rhi):hi<=pi2.lo?new MatInterval(-1,Math.max(rlo,rhi)):new MatInterval(-1,1)))},sin:function(x){return this.isEmpty(x)||this.onlyInfinity(x)?this.EMPTY.clone():this.cos(this.sub(x,this.PI_HALF))},tan:function(x){var cache,t,pi;return this.isEmpty(x)||this.onlyInfinity(x)?this.EMPTY.clone():(cache=(new MatInterval).set(x.lo,x.hi),this._handleNegative(cache),pi=this.PI,(t=this.fmod(cache,pi)).lo>=this.piHalfLow&&(t=this.sub(t,pi)),t.lo<=-this.piHalfLow||t.hi>=this.piHalfLow?this.WHOLE.clone():new MatInterval(this.tanLo(t.lo),this.tanHi(t.hi)))},asin:function(x){var lo,hi;return this.isEmpty(x)||x.hi<-1||x.lo>1?this.EMPTY.clone():(lo=x.lo<=-1?-this.piHalfHigh:this.asinLo(x.lo),hi=x.hi>=1?this.piHalfHigh:this.asinHi(x.hi),new MatInterval(lo,hi))},acos:function(x){var lo,hi;return this.isEmpty(x)||x.hi<-1||x.lo>1?this.EMPTY.clone():(lo=x.hi>=1?0:this.acosLo(x.hi),hi=x.lo<=-1?this.piHigh:this.acosHi(x.lo),new MatInterval(lo,hi))},atan:function(x){return this.isEmpty(x)?this.EMPTY.clone():new MatInterval(this.atanLo(x.lo),this.atanHi(x.hi))},sinh:function(x){return this.isEmpty(x)?this.EMPTY.clone():new MatInterval(this.sinhLo(x.lo),this.sinhHi(x.hi))},cosh:function(x){return this.isEmpty(x)?this.EMPTY.clone():x.hi<0?new MatInterval(this.coshLo(x.hi),this.coshHi(x.lo)):x.lo>=0?new MatInterval(this.coshLo(x.lo),this.coshHi(x.hi)):new MatInterval(1,this.coshHi(-x.lo>x.hi?x.lo:x.hi))},tanh:function(x){return this.isEmpty(x)?this.EMPTY.clone():new MatInterval(this.tanhLo(x.lo),this.tanhHi(x.hi))},equal:function(x,y){return this.isEmpty(x)?this.isEmpty(y):!this.isEmpty(y)&&x.lo===y.lo&&x.hi===y.hi},notEqual:function(x,y){return this.isEmpty(x)?!this.isEmpty(y):this.isEmpty(y)||x.hi<y.lo||x.lo>y.hi},lt:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),!this.isEmpty(x)&&!this.isEmpty(y)&&x.hi<y.lo},gt:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),!this.isEmpty(x)&&!this.isEmpty(y)&&x.lo>y.hi},leq:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),!this.isEmpty(x)&&!this.isEmpty(y)&&x.hi<=y.lo},geq:function(x,y){return Type.isNumber(x)&&(x=this.Interval(x)),Type.isNumber(y)&&(y=this.Interval(y)),!this.isEmpty(x)&&!this.isEmpty(y)&&x.lo>=y.hi},piLow:3.141592653589793,piHigh:3.1415926535897936,piHalfLow:1.5707963267948966,piHalfHigh:1.5707963267948968,piTwiceLow:6.283185307179586,piTwiceHigh:6.283185307179587,identity:function(v){return v},_prev:function(v){return v===1/0?v:this.nextafter(v,-1/0)},_next:function(v){return v===-1/0?v:this.nextafter(v,1/0)},prev:function(v){return this._prev(v)},next:function(v){return this._next(v)},toInteger:function(x){return x<0?Math.ceil(x):Math.floor(x)},addLo:function(x,y){return this.prev(x+y)},addHi:function(x,y){return this.next(x+y)},subLo:function(x,y){return this.prev(x-y)},subHi:function(x,y){return this.next(x-y)},mulLo:function(x,y){return this.prev(x*y)},mulHi:function(x,y){return this.next(x*y)},divLo:function(x,y){return this.prev(x/y)},divHi:function(x,y){return this.next(x/y)},intLo:function(x){return this.toInteger(this.prev(x))},intHi:function(x){return this.toInteger(this.next(x))},logLo:function(x){return this.prev(Math.log(x))},logHi:function(x){return this.next(Math.log(x))},expLo:function(x){return this.prev(Math.exp(x))},expHi:function(x){return this.next(Math.exp(x))},sinLo:function(x){return this.prev(Math.sin(x))},sinHi:function(x){return this.next(Math.sin(x))},cosLo:function(x){return this.prev(Math.cos(x))},cosHi:function(x){return this.next(Math.cos(x))},tanLo:function(x){return this.prev(Math.tan(x))},tanHi:function(x){return this.next(Math.tan(x))},asinLo:function(x){return this.prev(Math.asin(x))},asinHi:function(x){return this.next(Math.asin(x))},acosLo:function(x){return this.prev(Math.acos(x))},acosHi:function(x){return this.next(Math.acos(x))},atanLo:function(x){return this.prev(Math.atan(x))},atanHi:function(x){return this.next(Math.atan(x))},sinhLo:function(x){return this.prev(Mat.sinh(x))},sinhHi:function(x){return this.next(Mat.sinh(x))},coshLo:function(x){return this.prev(Mat.cosh(x))},coshHi:function(x){return this.next(Mat.cosh(x))},tanhLo:function(x){return this.prev(Mat.tanh(x))},tanhHi:function(x){return this.next(Mat.tanh(x))},sqrtLo:function(x){return this.prev(Math.sqrt(x))},sqrtHi:function(x){return this.next(Math.sqrt(x))},powLo:function(x,power){var y;if(power%1!=0)return this.prev(Math.pow(x,power));for(y=1==(1&power)?x:1,power>>=1;power>0;)x=this.mulLo(x,x),1==(1&power)&&(y=this.mulLo(x,y)),power>>=1;return y},powHi:function(x,power){var y;if(power%1!=0)return this.next(Math.pow(x,power));for(y=1==(1&power)?x:1,power>>=1;power>0;)x=this.mulHi(x,x),1==(1&power)&&(y=this.mulHi(x,y)),power>>=1;return y},disable:function(){this.next=this.prev=this.identity},enable:function(){this.prev=function(v){return this._prev(v)},this.next=function(v){return this._next(v)}},SMALLEST_DENORM:Math.pow(2,-1074),UINT_MAX:-1>>>0,nextafter:function(x,y){var lo,hi;return isNaN(x)||isNaN(y)?NaN:x===y?x:0===x?y<0?-this.SMALLEST_DENORM:this.SMALLEST_DENORM:(hi=doubleBits.hi(x),lo=doubleBits.lo(x),y>x==x>0?lo===this.UINT_MAX?(hi+=1,lo=0):lo+=1:0===lo?(lo=this.UINT_MAX,hi-=1):lo-=1,doubleBits.pack(lo,hi))}},JXG.Math.IntervalArithmetic.PI=new MatInterval(Mat.IntervalArithmetic.piLow,Mat.IntervalArithmetic.piHigh),JXG.Math.IntervalArithmetic.PI_HALF=new MatInterval(Mat.IntervalArithmetic.piHalfLow,Mat.IntervalArithmetic.piHalfHigh),JXG.Math.IntervalArithmetic.PI_TWICE=new MatInterval(Mat.IntervalArithmetic.piTwiceLow,Mat.IntervalArithmetic.piTwiceHigh),JXG.Math.IntervalArithmetic.ZERO=new MatInterval(0),JXG.Math.IntervalArithmetic.ONE=new MatInterval(1),JXG.Math.IntervalArithmetic.WHOLE=(new MatInterval).setWhole(),JXG.Math.IntervalArithmetic.EMPTY=(new MatInterval).setEmpty(),JXG.Math.IntervalArithmetic})),define("math/extrapolate",["math/math"],(function(Mat){return Mat.Extrapolate={upper:15,infty:1e4,wynnEps:function(s_n,n,e){var j,aux1,aux2,diff,estlim;if(e[n]=s_n,0===n)estlim=s_n;else{for(aux2=0,j=n;j>0;j--)aux1=aux2,aux2=e[j-1],diff=e[j]-aux2,Math.abs(diff)<=1e-15?e[j-1]=1e20:(1,e[j-1]=1*aux1+1/diff);estlim=e[n%2]}return estlim},aitken:function(s_n,n,a){var estlim,denom,v,lowmax,j,m;if(a[n]=s_n,n<2)estlim=s_n;else{for(lowmax=n/2,j=1;j<=lowmax;j++)denom=a[(m=n-2*j)+2]-2*a[m+1]+a[m],Math.abs(denom)<1e-15?a[m]=1e20:(v=a[m]-a[m+1],a[m]-=v*v/denom);estlim=a[n%2]}return estlim},brezinski:function(s_n,n,a){var estlim,denom,d0,d1,d2,lowmax,j,m;if(a[n]=s_n,n<3)estlim=s_n;else{for(lowmax=n/3,m=n,j=1;j<=lowmax;j++)d0=a[(m-=3)+1]-a[m],d1=a[m+2]-a[m+1],denom=(d2=a[m+3]-a[m+2])*(d1-d0)-d0*(d2-d1),Math.abs(denom)<1e-15?a[m]=1e20:a[m]=a[m+1]-d0*d1*(d2-d1)/denom;estlim=a[n%3]}return estlim},iteration:function(x0,h0,f,method,step_type){var n,v,w,diff,estlim=NaN,E=[],result="finite",h=h0;for(step_type=step_type||0,n=1;n<=this.upper;n++){if(v=f(x0+(h=0===step_type?h0/(n+1):.5*h),!0),w=this[method](v,n-1,E),isNaN(w)){result="NaN";break}if(0!==v&&w/v>this.infty){estlim=w,result="infinite";break}if(diff=w-estlim,Math.abs(diff)<1e-7)break;estlim=w}return[estlim,result,1-(n-1)/this.upper]},levin:function(s_n,n,omega,beta,numer,denom){var j,fact,ratio,term;if(term=1/(beta+n),numer[n]=s_n/omega,denom[n]=1/omega,n>0&&(numer[n-1]=numer[n]-numer[n-1],denom[n-1]=denom[n]-denom[n-1],n>1))for(ratio=(beta+n-1)*term,j=2;j<=n;j++)fact=(beta+n-j)*Math.pow(ratio,j-2)*term,numer[n-j]=numer[n-j+1]-fact*numer[n-j],denom[n-j]=denom[n-j+1]-fact*denom[n-j],term*=ratio;return Math.abs(denom[0])<1e-15?1e20:numer[0]/denom[0]},iteration_levin:function(x0,h0,f,step_type){var n,v,w,v_prev,delta,diff,omega,estlim=NaN,numer=[],denom=[],result="finite",h=h0;for(step_type=step_type||0,v_prev=f(x0+h0,!0),n=1;n<=this.upper;n++){if(delta=(v=f(x0+(h=0===step_type?h0/(n+1):.5*h),!0))-v_prev,omega="u"===(Math.abs(delta)<1?"u":"t")?(1+n)*delta:delta,v_prev=v,diff=(w=this.levin(v,n-1,omega,1,numer,denom))-estlim,isNaN(w)){result="NaN";break}if(0!==v&&w/v>this.infty){estlim=w,result="infinite";break}if(Math.abs(diff)<1e-7)break;estlim=w}return[estlim,result,1-(n-1)/this.upper]},limit:function(x0,h0,f){return this.iteration_levin(x0,h0,f,0)}},Mat.Extrapolate})),define("math/qdt",["math/math","utils/type"],(function(Mat,Type){return Mat.Quadtree=function(bbox){this.capacity=10,this.points=[],this.xlb=bbox[0],this.xub=bbox[2],this.ylb=bbox[3],this.yub=bbox[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null},Type.extend(Mat.Quadtree.prototype,{contains:function(x,y){return this.xlb<x&&x<=this.xub&&this.ylb<y&&y<=this.yub},insert:function(p){return!!this.contains(p.usrCoords[1],p.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(p),!0):(null===this.northWest&&this.subdivide(),!!this.northWest.insert(p)||(!!this.northEast.insert(p)||(!!this.southEast.insert(p)||!!this.southWest.insert(p)))))},subdivide:function(){var i,l=this.points.length,mx=this.xlb+(this.xub-this.xlb)/2,my=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new Mat.Quadtree([this.xlb,this.yub,mx,my]),this.northEast=new Mat.Quadtree([mx,this.yub,this.xub,my]),this.southEast=new Mat.Quadtree([this.xlb,my,mx,this.ylb]),this.southWest=new Mat.Quadtree([mx,my,this.xub,this.ylb]),i=0;i<l;i+=1)this.northWest.insert(this.points[i]),this.northEast.insert(this.points[i]),this.southEast.insert(this.points[i]),this.southWest.insert(this.points[i])},_query:function(x,y){var r;if(this.contains(x,y)){if(null===this.northWest)return this;if(r=this.northWest._query(x,y))return r;if(r=this.northEast._query(x,y))return r;if(r=this.southEast._query(x,y))return r;if(r=this.southWest._query(x,y))return r}return!1},query:function(xp,y){var _x,_y;return Type.exists(y)?(_x=xp,_y=y):(_x=xp.usrCoords[1],_y=xp.usrCoords[2]),this._query(_x,_y)}}),Mat.Quadtree})),define("math/numerics",["jxg","utils/type","utils/env","math/math"],(function(JXG,Type,Env,Mat){var predefinedButcher={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return Mat.Numerics={Gauss:function(A,b){var i,j,k,Acopy,x,eps=Mat.eps,n=A.length>0?A[0].length:0;if(n!==b.length||n!==A.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(Acopy=[],x=b.slice(0,n),i=0;i<n;i++)Acopy[i]=A[i].slice(0,n);for(j=0;j<n;j++){for(i=n-1;i>j;i--)if(Math.abs(Acopy[i][j])>eps)if(Math.abs(Acopy[j][j])<eps)Type.swap(Acopy,i,j),Type.swap(x,i,j);else for(Acopy[i][j]/=Acopy[j][j],x[i]-=Acopy[i][j]*x[j],k=j+1;k<n;k++)Acopy[i][k]-=Acopy[i][j]*Acopy[j][k];if(Math.abs(Acopy[j][j])<eps)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(Acopy,x,!0),x},backwardSolve:function(R,b,canModify){var x,m,n,i,j;for(x=canModify?b:b.slice(0,b.length),m=R.length,n=R.length>0?R[0].length:0,i=m-1;i>=0;i--){for(j=n-1;j>i;j--)x[i]-=R[i][j]*x[j];x[i]/=R[i][i]}return x},gaussBareiss:function(mat){var k,c,s,i,j,p,n,M,t,eps=Mat.eps;if((n=mat.length)<=0)return 0;for(mat[0].length<n&&(n=mat[0].length),M=[],i=0;i<n;i++)M[i]=mat[i].slice(0,n);for(c=1,s=1,k=0;k<n-1;k++){if(p=M[k][k],Math.abs(p)<eps){for(i=k+1;i<n&&!(Math.abs(M[i][k])>=eps);i++);if(i===n)return 0;for(j=k;j<n;j++)t=M[i][j],M[i][j]=M[k][j],M[k][j]=t;s=-s,p=M[k][k]}for(i=k+1;i<n;i++)for(j=k+1;j<n;j++)t=p*M[i][j]-M[i][k]*M[k][j],M[i][j]=t/c;c=p}return s*M[n-1][n-1]},det:function(mat){return 2===mat.length&&2===mat[0].length?mat[0][0]*mat[1][1]-mat[1][0]*mat[0][1]:this.gaussBareiss(mat)},Jacobi:function(Ain){var i,j,k,aa,si,co,tt,ssum,amax,eps=Mat.eps*Mat.eps,sum=0,n=Ain.length,V=[[0,0,0],[0,0,0],[0,0,0]],A=[[0,0,0],[0,0,0],[0,0,0]],nloops=0;for(i=0;i<n;i++){for(j=0;j<n;j++)V[i][j]=0,A[i][j]=Ain[i][j],sum+=Math.abs(A[i][j]);V[i][i]=1}if(1===n)return[A,V];if(sum<=0)return[A,V];sum/=n*n;do{for(ssum=0,amax=0,j=1;j<n;j++)for(i=0;i<j;i++)if((aa=Math.abs(A[i][j]))>amax&&(amax=aa),ssum+=aa,aa>=eps){for(aa=.5*Math.atan2(2*A[i][j],A[i][i]-A[j][j]),si=Math.sin(aa),co=Math.cos(aa),k=0;k<n;k++)tt=A[k][i],A[k][i]=co*tt+si*A[k][j],A[k][j]=-si*tt+co*A[k][j],tt=V[k][i],V[k][i]=co*tt+si*V[k][j],V[k][j]=-si*tt+co*V[k][j];for(A[i][i]=co*A[i][i]+si*A[j][i],A[j][j]=-si*A[i][j]+co*A[j][j],A[i][j]=0,k=0;k<n;k++)A[i][k]=A[k][i],A[j][k]=A[k][j]}nloops+=1}while(Math.abs(ssum)/sum>eps&&nloops<2e3);return[A,V]},NewtonCotes:function(interval,f,config){var evaluation_point,i,number_of_intervals,integral_value=0,number_of_nodes=config&&Type.isNumber(config.number_of_nodes)?config.number_of_nodes:28,available_types={trapez:!0,simpson:!0,milne:!0},integration_type=config&&config.integration_type&&available_types.hasOwnProperty(config.integration_type)&&available_types[config.integration_type]?config.integration_type:"milne",step_size=(interval[1]-interval[0])/number_of_nodes;switch(integration_type){case"trapez":for(integral_value=.5*(f(interval[0])+f(interval[1])),evaluation_point=interval[0],i=0;i<number_of_nodes-1;i++)integral_value+=f(evaluation_point+=step_size);integral_value*=step_size;break;case"simpson":if(number_of_nodes%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(number_of_intervals=number_of_nodes/2,integral_value=f(interval[0])+f(interval[1]),evaluation_point=interval[0],i=0;i<number_of_intervals-1;i++)integral_value+=2*f(evaluation_point+=2*step_size);for(evaluation_point=interval[0]-step_size,i=0;i<number_of_intervals;i++)integral_value+=4*f(evaluation_point+=2*step_size);integral_value*=step_size/3;break;default:if(number_of_nodes%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(number_of_intervals=.25*number_of_nodes,integral_value=7*(f(interval[0])+f(interval[1])),evaluation_point=interval[0],i=0;i<number_of_intervals-1;i++)integral_value+=14*f(evaluation_point+=4*step_size);for(evaluation_point=interval[0]-3*step_size,i=0;i<number_of_intervals;i++)integral_value+=32*(f(evaluation_point+=4*step_size)+f(evaluation_point+2*step_size));for(evaluation_point=interval[0]-2*step_size,i=0;i<number_of_intervals;i++)integral_value+=12*f(evaluation_point+=4*step_size);integral_value*=2*step_size/45}return integral_value},Romberg:function(interval,f,config){var a,b,h,s,n,k,i,q,p=[],integral=0,last=1/0,m=config&&Type.isNumber(config.max_iterations)?config.max_iterations:20,eps=config&&Type.isNumber(config.eps)?config.eps:config.eps||1e-7;for(a=interval[0],h=(b=interval[1])-a,n=1,p[0]=.5*h*(f(a)+f(b)),k=0;k<m;++k){for(s=0,h*=.5,n*=2,q=1,i=1;i<n;i+=2)s+=f(a+i*h);for(p[k+1]=.5*p[k]+s*h,integral=p[k+1],i=k-1;i>=0;--i)q*=4,p[i]=p[i+1]+(p[i+1]-p[i])/(q-1),integral=p[i];if(Math.abs(integral-last)<eps*Math.abs(integral))break;last=integral}return integral},GaussLegendre:function(interval,f,config){var a,b,i,m,xp,xm,xi,w,result=0,table_xi=[],table_w=[],n=config&&Type.isNumber(config.n)?config.n:12;if(n>18&&(n=18),table_xi[2]=[.5773502691896257],table_w[2]=[1],table_xi[4]=[.33998104358485626,.8611363115940526],table_w[4]=[.6521451548625461,.34785484513745385],table_xi[6]=[.2386191860831969,.6612093864662645,.932469514203152],table_w[6]=[.46791393457269104,.3607615730481386,.17132449237917036],table_xi[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],table_w[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],table_xi[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],table_w[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],table_xi[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],table_w[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],table_xi[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],table_w[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],table_xi[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],table_w[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],table_xi[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],table_w[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],table_xi[3]=[0,.7745966692414834],table_w[3]=[.8888888888888888,.5555555555555556],table_xi[5]=[0,.5384693101056831,.906179845938664],table_w[5]=[.5688888888888889,.47862867049936647,.23692688505618908],table_xi[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],table_w[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],table_xi[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],table_w[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],table_xi[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],table_w[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],table_xi[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],table_w[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],table_xi[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],table_w[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],table_xi[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],table_w[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],a=interval[0],b=interval[1],m=n+1>>1,xi=table_xi[n],w=table_w[n],xm=.5*(b-a),xp=.5*(b+a),!0&n)for(result=w[0]*f(xp),i=1;i<m;++i)result+=w[i]*(f(xp+xm*xi[i])+f(xp-xm*xi[i]));else for(result=0,i=0;i<m;++i)result+=w[i]*(f(xp+xm*xi[i])+f(xp-xm*xi[i]));return xm*result},_rescale_error:function(err,result_abs,result_asc){var scale,min_err;return err=Math.abs(err),0!==result_asc&&0!==err&&(err=(scale=Math.pow(200*err/result_asc,1.5))<1?result_asc*scale:result_asc),result_abs>20041683600089728e-310&&(min_err=11102230246251565e-30*result_abs)>err&&(err=min_err),err},_gaussKronrod:function(interval,f,n,xgk,wg,wgk,resultObj){var up,result,mean,err,j,jtw,abscissa,fval1,fval2,fsum,jtwm1,a=interval[0],b=interval[1],center=.5*(a+b),half_length=.5*(b-a),abs_half_length=Math.abs(half_length),f_center=f(center),result_gauss=0,result_kronrod=f_center*wgk[n-1],result_abs=Math.abs(result_kronrod),result_asc=0,fv1=[],fv2=[];for(n%2==0&&(result_gauss=f_center*wg[n/2-1]),up=Math.floor((n-1)/2),j=0;j<up;j++)fsum=(fval1=f(center-(abscissa=half_length*xgk[jtw=2*j+1])))+(fval2=f(center+abscissa)),fv1[jtw]=fval1,fv2[jtw]=fval2,result_gauss+=wg[j]*fsum,result_kronrod+=wgk[jtw]*fsum,result_abs+=wgk[jtw]*(Math.abs(fval1)+Math.abs(fval2));for(up=Math.floor(n/2),j=0;j<up;j++)fval1=f(center-(abscissa=half_length*xgk[jtwm1=2*j])),fval2=f(center+abscissa),fv1[jtwm1]=fval1,fv2[jtwm1]=fval2,result_kronrod+=wgk[jtwm1]*(fval1+fval2),result_abs+=wgk[jtwm1]*(Math.abs(fval1)+Math.abs(fval2));for(mean=.5*result_kronrod,result_asc=wgk[n-1]*Math.abs(f_center-mean),j=0;j<n-1;j++)result_asc+=wgk[j]*(Math.abs(fv1[j]-mean)+Math.abs(fv2[j]-mean));return err=(result_kronrod-result_gauss)*half_length,result_abs*=abs_half_length,result_asc*=abs_half_length,result=result_kronrod*=half_length,resultObj.abserr=this._rescale_error(err,result_abs,result_asc),resultObj.resabs=result_abs,resultObj.resasc=result_asc,result},GaussKronrod15:function(interval,f,resultObj){return this._gaussKronrod(interval,f,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],resultObj)},GaussKronrod21:function(interval,f,resultObj){return this._gaussKronrod(interval,f,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],resultObj)},GaussKronrod31:function(interval,f,resultObj){return this._gaussKronrod(interval,f,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],resultObj)},_workspace:function(interval,n){return{limit:n,size:0,nrmax:0,i:0,alist:[interval[0]],blist:[interval[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var errmax,errmin,i,k,top,last=this.size-1,limit=this.limit,i_nrmax=this.nrmax,i_maxerr=this.order[i_nrmax];if(last<2)return this.order[0]=0,this.order[1]=1,void(this.i=i_maxerr);for(errmax=this.elist[i_maxerr];i_nrmax>0&&errmax>this.elist[this.order[i_nrmax-1]];)this.order[i_nrmax]=this.order[i_nrmax-1],i_nrmax--;for(top=last<limit/2+2?last:limit-last+1,i=i_nrmax+1;i<top&&errmax<this.elist[this.order[i]];)this.order[i-1]=this.order[i],i++;for(this.order[i-1]=i_maxerr,errmin=this.elist[last],k=top-1;k>i-2&&errmin>=this.elist[this.order[k]];)this.order[k+1]=this.order[k],k--;this.order[k+1]=last,i_maxerr=this.order[i_nrmax],this.i=i_maxerr,this.nrmax=i_nrmax},set_initial_result:function(result,error){this.size=1,this.rlist[0]=result,this.elist[0]=error},update:function(a1,b1,area1,error1,a2,b2,area2,error2){var i_max=this.i,i_new=this.size,new_level=this.level[this.i]+1;error2>error1?(this.alist[i_max]=a2,this.rlist[i_max]=area2,this.elist[i_max]=error2,this.level[i_max]=new_level,this.alist[i_new]=a1,this.blist[i_new]=b1,this.rlist[i_new]=area1,this.elist[i_new]=error1,this.level[i_new]=new_level):(this.blist[i_max]=b1,this.rlist[i_max]=area1,this.elist[i_max]=error1,this.level[i_max]=new_level,this.alist[i_new]=a2,this.blist[i_new]=b2,this.rlist[i_new]=area2,this.elist[i_new]=error2,this.level[i_new]=new_level),this.size++,new_level>this.maximum_level&&(this.maximum_level=new_level),this.qpsrt()},retrieve:function(){var i=this.i;return{a:this.alist[i],b:this.blist[i],r:this.rlist[i],e:this.elist[i]}},sum_results:function(){var k,nn=this.size,result_sum=0;for(k=0;k<nn;k++)result_sum+=this.rlist[k];return result_sum},subinterval_too_small:function(a1,a2,b2){var tmp=1.0000000000000222*(Math.abs(a2)+22250738585072014e-321);return Math.abs(a1)<=tmp&&Math.abs(b2)<=tmp}}},Qag:function(interval,f,config){var area,errsum,result0,abserr0,resabs0,resasc0,tolerance,a1,b1,a2,b2,a_i,b_i,r_i,e_i,resasc1,wsObj,delta,ws=this._workspace(interval,1e3),limit=config&&Type.isNumber(config.limit)?config.limit:15,epsrel=config&&Type.isNumber(config.epsrel)?config.epsrel:1e-7,epsabs=config&&Type.isNumber(config.epsabs)?config.epsabs:1e-7,q=config&&Type.isFunction(config.q)?config.q:this.GaussKronrod15,resultObj={},iteration=0,roundoff_type1=0,roundoff_type2=0,error_type=0,area1=0,area2=0,area12=0,error1=0,error2=0,error12=0;if(limit>ws.limit&&JXG.warn("iteration limit exceeds available workspace"),epsabs<=0&&(epsrel<50*Mat.eps||epsrel<5e-29)&&JXG.warn("tolerance cannot be acheived with given epsabs and epsrel"),result0=q.apply(this,[interval,f,resultObj]),abserr0=resultObj.abserr,resabs0=resultObj.resabs,resasc0=resultObj.resasc,ws.set_initial_result(result0,abserr0),tolerance=Math.max(epsabs,epsrel*Math.abs(result0)),abserr0<=11102230246251565e-30*resabs0&&abserr0>tolerance)return result0,JXG.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(abserr0<=tolerance&&abserr0!==resasc0||0===abserr0)return result0;if(1===limit)return result0,JXG.warn("a maximum of one iteration was insufficient"),-1/0;area=result0,errsum=abserr0,iteration=1;do{area1=0,area2=0,area12=0,error1=0,error2=0,error12=0,a_i=(wsObj=ws.retrieve()).a,b_i=wsObj.b,r_i=wsObj.r,e_i=wsObj.e,a1=a_i,a2=b1=.5*(a_i+b_i),b2=b_i,area1=q.apply(this,[[a1,b1],f,resultObj]),error1=resultObj.abserr,resasc1=resultObj.resasc,area2=q.apply(this,[[a2,b2],f,resultObj]),errsum+=(error12=error1+(error2=resultObj.abserr))-e_i,area+=(area12=area1+area2)-r_i,resasc1!==error1&&resultObj.resasc!==error2&&(delta=r_i-area12,Math.abs(delta)<=1e-5*Math.abs(area12)&&error12>=.99*e_i&&roundoff_type1++,iteration>=10&&error12>e_i&&roundoff_type2++),errsum>(tolerance=Math.max(epsabs,epsrel*Math.abs(area)))&&((roundoff_type1>=6||roundoff_type2>=20)&&(error_type=2),ws.subinterval_too_small(a1,a2,b2)&&(error_type=3)),ws.update(a1,b1,area1,error1,a2,b2,area2,error2),a_i=(wsObj=ws.retrieve()).a_i,b_i=wsObj.b_i,r_i=wsObj.r_i,e_i=wsObj.e_i,iteration++}while(iteration<limit&&!error_type&&errsum>tolerance);return ws.sum_results()},I:function(interval,f){return this.Qag(interval,f,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(f,x,context){var df,i=0,h=Mat.eps,newf=f.apply(context,[x]);for(Type.isArray(x)&&(x=x[0]);i<50&&Math.abs(newf)>h;)df=this.D(f,context)(x),Math.abs(df)>h?x-=newf/df:x+=.2*Math.random()-1,newf=f.apply(context,[x]),i+=1;return x},root:function(f,x,context){return this.chandrupatla(f,x,context)},generalizedNewton:function(c1,c2,t1ini,t2ini){var t1,t2,a,b,c,d,disc,e,f,F,D00,D01,D10,D11,count=0;for(this.generalizedNewton.t1memo?(t1=this.generalizedNewton.t1memo,t2=this.generalizedNewton.t2memo):(t1=t1ini,t2=t2ini),F=(e=c1.X(t1)-c2.X(t2))*e+(f=c1.Y(t1)-c2.Y(t2))*f,D00=this.D(c1.X,c1),D01=this.D(c2.X,c2),D10=this.D(c1.Y,c1),D11=this.D(c2.Y,c2);F>Mat.eps&&count<10;)a=D00(t1),b=-D01(t2),c=D10(t1),t1-=((d=-D11(t2))*e-b*f)/(disc=a*d-b*c),t2-=(a*f-c*e)/disc,F=(e=c1.X(t1)-c2.X(t2))*e+(f=c1.Y(t1)-c2.Y(t2))*f,count+=1;return this.generalizedNewton.t1memo=t1,this.generalizedNewton.t2memo=t2,Math.abs(t1)<Math.abs(t2)?[c1.X(t1),c1.Y(t1)]:[c2.X(t2),c2.Y(t2)]},Neville:function(p){var w=[],makeFct=function(fun){return function(t,suspendedUpdate){var i,d,s,bin=Mat.binomial,len=p.length,len1=len-1,num=0,denom=0;if(!suspendedUpdate)for(s=1,i=0;i<len;i++)w[i]=bin(len1,i)*s,s*=-1;for(d=t,i=0;i<len;i++){if(0===d)return p[i][fun]();s=w[i]/d,d-=1,num+=p[i][fun]()*s,denom+=s}return num/denom}};return[makeFct("X"),makeFct("Y"),0,function(){return p.length-1}]},splineDef:function(x,y){var pair,i,l,n=Math.min(x.length,y.length),diag=[],z=[],data=[],dx=[],delta=[],F=[];if(2===n)return[0,0];for(i=0;i<n;i++)pair={X:x[i],Y:y[i]},data.push(pair);for(data.sort((function(a,b){return a.X-b.X})),i=0;i<n;i++)x[i]=data[i].X,y[i]=data[i].Y;for(i=0;i<n-1;i++)dx.push(x[i+1]-x[i]);for(i=0;i<n-2;i++)delta.push(6*(y[i+2]-y[i+1])/dx[i+1]-6*(y[i+1]-y[i])/dx[i]);for(diag.push(2*(dx[0]+dx[1])),z.push(delta[0]),i=0;i<n-3;i++)l=dx[i+1]/diag[i],diag.push(2*(dx[i+1]+dx[i+2])-l*dx[i+1]),z.push(delta[i+1]-l*z[i]);for(F[n-3]=z[n-3]/diag[n-3],i=n-4;i>=0;i--)F[i]=(z[i]-dx[i+1]*F[i+1])/diag[i];for(i=n-3;i>=0;i--)F[i+1]=F[i];return F[0]=0,F[n-1]=0,F},splineEval:function(x0,x,y,F){var i,j,a,b,c,d,x_,n=Math.min(x.length,y.length),l=1,asArray=!1,y0=[];for(Type.isArray(x0)?(l=x0.length,asArray=!0):x0=[x0],i=0;i<l;i++){if(x0[i]<x[0]||x[i]>x[n-1])return NaN;for(j=1;j<n&&!(x0[i]<=x[j]);j++);a=y[j-=1],b=(y[j+1]-y[j])/(x[j+1]-x[j])-(x[j+1]-x[j])/6*(F[j+1]+2*F[j]),c=F[j]/2,d=(F[j+1]-F[j])/(6*(x[j+1]-x[j])),x_=x0[i]-x[j],y0.push(a+(b+(c+d*x_)*x_)*x_)}return asArray?y0:y0[0]},generatePolynomialTerm:function(coeffs,deg,varname,prec){var i,t=[];for(i=deg;i>=0;i--)t=t.concat(["(",coeffs[i].toPrecision(prec),")"]),i>1?t=t.concat(["*",varname,"<sup>",i,"<","/sup> + "]):1===i&&(t=t.concat(["*",varname," + "]));return t.join("")},lagrangePolynomial:function(p){var w=[],that=this,fct=function(x,suspendedUpdate){var i,k,xi,s,len=p.length,num=0,denom=0;if(!suspendedUpdate)for(i=0;i<len;i++){for(w[i]=1,xi=p[i].X(),k=0;k<len;k++)k!==i&&(w[i]*=xi-p[k].X());w[i]=1/w[i]}for(i=0;i<len;i++){if(x===(xi=p[i].X()))return p[i].Y();denom+=s=w[i]/(x-xi),num+=s*p[i].Y()}return num/denom};return fct.getTerm=function(digits,param,dot){return that.lagrangePolynomialTerm(p,digits,param,dot)()},fct},lagrangePolynomialTerm:function(points,digits,param,dot){return function(){var n,t,i,j,c,p,len=points.length,zeroes=[],coeffs=[],coeffs_sum=[],isLeading=!0;for(param=param||"x",void 0===dot&&(dot=" * "),n=len-1,j=0;j<len;j++)coeffs_sum[j]=0;for(i=0;i<len;i++){for(c=points[i].Y(),p=points[i].X(),zeroes=[],j=0;j<len;j++)j!==i&&(c/=p-points[j].X(),zeroes.push(points[j].X()));for(coeffs=[1].concat(Mat.Vieta(zeroes)),j=0;j<coeffs.length;j++)coeffs_sum[j]+=(j%2==1?-1:1)*coeffs[j]*c}for(t="",j=0;j<coeffs_sum.length;j++)c=coeffs_sum[j],Math.abs(c)<Mat.eps||(JXG.exists(digits)&&(c=Env._round10(c,-digits)),isLeading?(t+=c>0?c:"-"+-c,isLeading=!1):t+=c>0?" + "+c:" - "+-c,n-j>1?t+=dot+param+"^"+(n-j):n-j==1&&(t+=dot+param));return t}},_initCubicPoly:function(x1,x2,t1,t2){return[x1,t1,-3*x1+3*x2-2*t1-t2,2*x1-2*x2+t1+t2]},CardinalSpline:function(points,tau_param,type){var p,makeFct,tau,_tau,coeffs=[],that=this;return _tau=Type.isFunction(tau_param)?tau_param:function(){return tau_param},void 0===type&&(type="uniform"),makeFct=function(which){return function(t,suspendedUpdate){var s,c,first,last,t1,t2,dt0,dt1,dt2,len;if(points.length<2)return NaN;if(!suspendedUpdate)for(tau=_tau(),first={X:function(){return 2*points[0].X()-points[1].X()},Y:function(){return 2*points[0].Y()-points[1].Y()},Dist:function(p){var dx=this.X()-p.X(),dy=this.Y()-p.Y();return Math.sqrt(dx*dx+dy*dy)}},last={X:function(){return 2*points[points.length-1].X()-points[points.length-2].X()},Y:function(){return 2*points[points.length-1].Y()-points[points.length-2].Y()},Dist:function(p){var dx=this.X()-p.X(),dy=this.Y()-p.Y();return Math.sqrt(dx*dx+dy*dy)}},len=(p=[first].concat(points,[last])).length,coeffs[which]=[],s=0;s<len-3;s++)"centripetal"===type?(dt0=p[s].Dist(p[s+1]),dt1=p[s+2].Dist(p[s+1]),dt2=p[s+3].Dist(p[s+2]),dt0=Math.sqrt(dt0),dt1=Math.sqrt(dt1),dt2=Math.sqrt(dt2),dt1<Mat.eps&&(dt1=1),dt0<Mat.eps&&(dt0=dt1),dt2<Mat.eps&&(dt2=dt1),t1=(p[s+1][which]()-p[s][which]())/dt0-(p[s+2][which]()-p[s][which]())/(dt1+dt0)+(p[s+2][which]()-p[s+1][which]())/dt1,t2=(p[s+2][which]()-p[s+1][which]())/dt1-(p[s+3][which]()-p[s+1][which]())/(dt2+dt1)+(p[s+3][which]()-p[s+2][which]())/dt2,t1*=dt1,t2*=dt1,coeffs[which][s]=that._initCubicPoly(p[s+1][which](),p[s+2][which](),tau*t1,tau*t2)):coeffs[which][s]=that._initCubicPoly(p[s+1][which](),p[s+2][which](),tau*(p[s+2][which]()-p[s][which]()),tau*(p[s+3][which]()-p[s+1][which]()));return isNaN(t)?NaN:(len=points.length,t<=0?points[0][which]():t>=len?points[len-1][which]():(s=Math.floor(t))===t?points[s][which]():(t-=s,void 0===(c=coeffs[which][s])?NaN:((c[3]*t+c[2])*t+c[1])*t+c[0]))}},[makeFct("X"),makeFct("Y"),0,function(){return points.length-1}]},CatmullRomSpline:function(points,type){return this.CardinalSpline(points,.5,type)},regressionPolynomial:function(degree,dataX,dataY){var coeffs,deg,dX,dY,inputType,fct,term="";if(Type.isPoint(degree)&&Type.isFunction(degree.Value))deg=function(){return degree.Value()};else if(Type.isFunction(degree))deg=degree;else{if(!Type.isNumber(degree))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+_typeof(degree)+"'.");deg=function(){return degree}}if(3===arguments.length&&Type.isArray(dataX)&&Type.isArray(dataY))inputType=0;else if(2===arguments.length&&Type.isArray(dataX)&&dataX.length>0&&Type.isPoint(dataX[0]))inputType=1;else{if(!(2===arguments.length&&Type.isArray(dataX)&&dataX.length>0&&dataX[0].usrCoords&&dataX[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");inputType=2}return(fct=function(x,suspendedUpdate){var i,j,M,MT,y,B,c,s,d,len=dataX.length;if(d=Math.floor(deg()),!suspendedUpdate){if(1===inputType)for(dX=[],dY=[],i=0;i<len;i++)dX[i]=dataX[i].X(),dY[i]=dataX[i].Y();if(2===inputType)for(dX=[],dY=[],i=0;i<len;i++)dX[i]=dataX[i].usrCoords[1],dY[i]=dataX[i].usrCoords[2];if(0===inputType)for(dX=[],dY=[],i=0;i<len;i++)Type.isFunction(dataX[i])?dX.push(dataX[i]()):dX.push(dataX[i]),Type.isFunction(dataY[i])?dY.push(dataY[i]()):dY.push(dataY[i]);for(M=[],j=0;j<len;j++)M.push([1]);for(i=1;i<=d;i++)for(j=0;j<len;j++)M[j][i]=M[j][i-1]*dX[j];y=dY,MT=Mat.transpose(M),B=Mat.matMatMult(MT,M),c=Mat.matVecMult(MT,y),coeffs=Mat.Numerics.Gauss(B,c),term=Mat.Numerics.generatePolynomialTerm(coeffs,d,"x",3)}for(s=coeffs[d],i=d-1;i>=0;i--)s=s*x+coeffs[i];return s}).getTerm=function(){return term},fct},bezier:function(points){var len,flen,makeFct=function(which){return function(t,suspendedUpdate){var z=3*Math.floor(t),t0=t%1,t1=1-t0;return suspendedUpdate||(flen=3*Math.floor((points.length-1)/3),len=Math.floor(flen/3)),t<0?points[0][which]():t>=len?points[flen][which]():isNaN(t)?NaN:t1*t1*(t1*points[z][which]()+3*t0*points[z+1][which]())+(3*t1*points[z+2][which]()+t0*points[z+3][which]())*t0*t0}};return[makeFct("X"),makeFct("Y"),0,function(){return Math.floor(points.length/3)}]},bspline:function(points,order){var knots,makeFct=function(which){return function(t,suspendedUpdate){var y,j,s,N,len=points.length,n=len-1,k=order;if(n<=0)return NaN;if(n+2<=k&&(k=n+1),t<=0)return points[0][which]();if(t>=n-k+2)return points[n][which]();for(s=Math.floor(t)+k-1,knots=function(n,k){var j,kn=[];for(j=0;j<n+k+1;j++)kn[j]=j<k?0:j<=n?j-k+1:n-k+2;return kn}(n,k),N=function(t,kn,k,s){var i,j,a,b,den,N=[];for(kn[s]<=t&&t<kn[s+1]?N[s]=1:N[s]=0,i=2;i<=k;i++)for(j=s-i+1;j<=s;j++)a=j<=s-i+1||j<0?0:N[j],b=j>=s?0:N[j+1],den=kn[j+i-1]-kn[j],N[j]=0===den?0:(t-kn[j])/den*a,0!=(den=kn[j+i]-kn[j+1])&&(N[j]+=(kn[j+i]-t)/den*b);return N}(t,knots,k,s),y=0,j=s-k+1;j<=s;j++)j<len&&j>=0&&(y+=points[j][which]()*N[j]);return y}};return[makeFct("X"),makeFct("Y"),0,function(){return points.length-1}]},D:function(f,obj){return Type.exists(obj)?function(x,suspendedUpdate){var h=1e-5;return(f.apply(obj,[x+h,suspendedUpdate])-f.apply(obj,[x-h,suspendedUpdate]))/2e-5}:function(x,suspendedUpdate){var h=1e-5;return(f(x+h,suspendedUpdate)-f(x-h,suspendedUpdate))/2e-5}},_riemannValue:function(x,f,type,delta){var y,y1,x1,delta1;if(delta<0&&("trapezoidal"!==type&&(x+=delta),delta*=-1,"lower"===type?type="upper":"upper"===type&&(type="lower")),delta1=.01*delta,"right"===type)y=f(x+delta);else if("middle"===type)y=f(x+.5*delta);else if("left"===type||"trapezoidal"===type)y=f(x);else if("lower"===type){for(y=f(x),x1=x+delta1;x1<=x+delta;x1+=delta1)(y1=f(x1))<y&&(y=y1);(y1=f(x+delta))<y&&(y=y1)}else if("upper"===type){for(y=f(x),x1=x+delta1;x1<=x+delta;x1+=delta1)(y1=f(x1))>y&&(y=y1);(y1=f(x+delta))>y&&(y=y1)}else y="random"===type?f(x+delta*Math.random()):"simpson"===type?(f(x)+4*f(x+.5*delta)+f(x+delta))/6:f(x);return y},riemann:function(gf,n,type,start,end){var i,delta,y,f,g,ylow,yup,xarr=[],yarr=[],j=0,x=start,sum=0;if(Type.isArray(gf)?(g=gf[0],f=gf[1]):f=gf,(n=Math.floor(n))<=0)return[xarr,yarr,sum];for(delta=(end-start)/n,i=0;i<n;i++)y=this._riemannValue(x,f,type,delta),xarr[j]=x,yarr[j]=y,j+=1,x+=delta,"trapezoidal"===type&&(y=f(x)),xarr[j]=x,yarr[j]=y,j+=1;for(i=0;i<n;i++)y=g?this._riemannValue(x,g,type,-delta):0,xarr[j]=x,yarr[j]=y,j+=1,x-=delta,"trapezoidal"===type&&g&&(y=g(x)),xarr[j]=x,yarr[j]=y,"trapezoidal"!==type?(ylow=y,yup=yarr[2*(n-1)-2*i]):(yup=.5*(f(x+delta)+f(x)),ylow=g?.5*(g(x+delta)+g(x)):0),sum+=(yup-ylow)*delta,xarr[j+=1]=x,yarr[j]=yarr[2*(n-1)-2*i],j+=1;return[xarr,yarr,sum]},riemannsum:function(f,n,type,start,end){return JXG.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(f,n,type,start,end)[2]},rungeKutta:function(butcher,x0,I,N,f){var e,i,j,k,l,s,x=[],y=[],h=(I[1]-I[0])/N,t=I[0],dim=x0.length,result=[],r=0;for(Type.isString(butcher)&&(butcher=predefinedButcher[butcher]||predefinedButcher.euler),s=butcher.s,e=0;e<dim;e++)x[e]=x0[e];for(i=0;i<N;i++){for(result[r]=[],e=0;e<dim;e++)result[r][e]=x[e];for(r+=1,k=[],j=0;j<s;j++){for(e=0;e<dim;e++)y[e]=0;for(l=0;l<j;l++)for(e=0;e<dim;e++)y[e]+=butcher.A[j][l]*h*k[l][e];for(e=0;e<dim;e++)y[e]+=x[e];k.push(f(t+butcher.c[j]*h,y))}for(e=0;e<dim;e++)y[e]=0;for(l=0;l<s;l++)for(e=0;e<dim;e++)y[e]+=butcher.b[l]*k[l][e];for(e=0;e<dim;e++)x[e]=x[e]+h*y[e];t+=h}return result},maxIterationsRoot:80,maxIterationsMinimize:500,findBracket:function(f,x0,object){var a,aa,fa,blist,b,fb,u,fu,i,len;if(Type.isArray(x0))return x0;for(a=x0,fa=f.call(object,a),len=(blist=[a-.1*(aa=0===a?1:a),a+.1*aa,a-1,a+1,a-.5*aa,a+.5*aa,a-.6*aa,a+.6*aa,a-1*aa,a+1*aa,a-2*aa,a+2*aa,a-5*aa,a+5*aa,a-10*aa,a+10*aa,a-50*aa,a+50*aa,a-100*aa,a+100*aa]).length,i=0;i<len&&(b=blist[i],!(fa*(fb=f.call(object,b))<=0));i++);return b<a&&(u=a,a=b,b=u,fu=fa,fa=fb,fb=fu),[a,fa,b,fb]},fzero:function(f,x0,object){var a,b,c,fa,fb,fc,res,prev_step,t1,cb,t2,tol_act,p,q,new_step,eps=Mat.eps,maxiter=this.maxIterationsRoot,niter=0;if(Type.isArray(x0)){if(x0.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");a=x0[0],fa=f.call(object,a),b=x0[1],fb=f.call(object,b)}else a=(res=this.findBracket(f,x0,object))[0],fa=res[1],b=res[2],fb=res[3];if(Math.abs(fa)<=eps)return a;if(Math.abs(fb)<=eps)return b;if(fa*fb>0)return Type.isArray(x0)?this.fminbr(f,[a,b],object):this.Newton(f,a,object);for(c=a,fc=fa;niter<maxiter;){if(prev_step=b-a,Math.abs(fc)<Math.abs(fb)&&(a=b,b=c,c=a,fa=fb,fb=fc,fc=fa),tol_act=2*eps*Math.abs(b)+.5*eps,new_step=.5*(c-b),Math.abs(new_step)<=tol_act||Math.abs(fb)<=eps)return b;Math.abs(prev_step)>=tol_act&&Math.abs(fa)>Math.abs(fb)&&(cb=c-b,a===c?(p=cb*(t1=fb/fa),q=1-t1):(p=(t2=fb/fa)*(cb*(q=fa/fc)*(q-(t1=fb/fc))-(b-a)*(t1-1)),q=(q-1)*(t1-1)*(t2-1)),p>0?q=-q:p=-p,p<.75*cb*q-.5*Math.abs(tol_act*q)&&p<Math.abs(prev_step*q*.5)&&(new_step=p/q)),Math.abs(new_step)<tol_act&&(new_step=new_step>0?tol_act:-tol_act),a=b,fa=fb,b+=new_step,((fb=f.call(object,b))>0&&fc>0||fb<0&&fc<0)&&(c=a,fc=fa),niter++}return b},chandrupatla:function(f,x0,object){var a,fa,b,fb,res,x1,x2,x3,x,f1,f2,f3,y,xm,fm,tl,xi,ph,fl,fh,niter=0,maxiter=this.maxIterationsRoot,rand=1+.001*Math.random(),t=.5*rand,eps=Mat.eps;if(Type.isArray(x0)){if(x0.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");a=x0[0],fa=f.call(object,a),b=x0[1],fb=f.call(object,b)}else a=(res=this.findBracket(f,x0,object))[0],fa=res[1],b=res[2],fb=res[3];if(fa*fb>0)return Type.isArray(x0)?this.fminbr(f,[a,b],object):this.Newton(f,a,object);x1=a,x2=b,f1=fa,f2=fb;do{if(x=x1+t*(x2-x1),y=f.call(object,x),Math.sign(y)===Math.sign(f1)?(x3=x1,x1=x,f3=f1,f1=y):(x3=x2,x2=x1,f3=f2,f2=f1),xm=x1=x,fm=f1=y,Math.abs(f2)<Math.abs(f1)&&(xm=x2,fm=f2),(tl=(2*eps*Math.abs(xm)+5e-6)/Math.abs(x2-x1))>.5||0===fm)break;xi=(x1-x2)/(x3-x2),ph=(f1-f2)/(f3-f2),fl=1-Math.sqrt(1-xi),fh=Math.sqrt(xi),(t=fl<ph&&ph<fh?f1/(f2-f1)*(f3/(f2-f3))+f1/(f3-f1)*(f2/(f3-f2))*((x3-x1)/(x2-x1)):.5*rand)<tl&&(t=tl),t>1-tl&&(t=1-tl),niter++}while(niter<=maxiter);return xm},fminbr:function(f,x0,context){var a,b,x,v,w,fx,fv,fw,range,middle_range,tol_act,new_step,p,q,t,ft,r=.5*(3-Math.sqrt(5)),tol=Mat.eps,sqrteps=Mat.eps,maxiter=this.maxIterationsMinimize,niter=0;if(!Type.isArray(x0)||x0.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(x=v=(a=x0[0])+r*((b=x0[1])-a),w=v,fx=fv=f.call(context,v),fw=fv;niter<maxiter;){if(range=b-a,middle_range=.5*(a+b),tol_act=sqrteps*Math.abs(x)+tol/3,Math.abs(x-middle_range)+.5*range<=2*tol_act)return x;new_step=r*(x<middle_range?b-x:a-x),Math.abs(x-w)>=tol_act&&(p=(x-v)*(q=(x-v)*(fx-fw))-(x-w)*(t=(x-w)*(fx-fv)),(q=2*(q-t))>0?p=-p:q=-q,Math.abs(p)<Math.abs(new_step*q)&&p>q*(a-x+2*tol_act)&&p<q*(b-x-2*tol_act)&&(new_step=p/q)),Math.abs(new_step)<tol_act&&(new_step=new_step>0?tol_act:-tol_act),t=x+new_step,(ft=f.call(context,t))<=fx?(t<x?b=x:a=x,v=w,w=x,x=t,fv=fw,fw=fx,fx=ft):(t<x?a=t:b=t,ft<=fw||w===x?(v=w,w=t,fv=fw,fw=ft):(ft<=fv||v===x||v===w)&&(v=t,fv=ft)),niter+=1}return x},RamerDouglasPeucker:function(pts,eps){var i,k,len,allPts=[],newPts=[],RDP=function RDP(pts,i,j,eps,newPts){var result=function(pts,i,j){var d,k,ci,cj,ck,x0,y0,x1,y1,den,lbda,dist=0,f=i;if(j-i<2)return[-1,0];if(ci=pts[i].scrCoords,cj=pts[j].scrCoords,isNaN(ci[1])||isNaN(ci[2]))return[NaN,i];if(isNaN(cj[1])||isNaN(cj[2]))return[NaN,j];for(k=i+1;k<j;k++){if(ck=pts[k].scrCoords,isNaN(ck[1])||isNaN(ck[2]))return[NaN,k];x0=(x0=(x0=ck[1]-ci[1])==1/0?1e4:x0)===-1/0?-1e4:x0,y0=(y0=(y0=ck[2]-ci[2])==1/0?1e4:y0)===-1/0?-1e4:y0,(den=(x1=(x1=(x1=cj[1]-ci[1])==1/0?1e4:x1)===-1/0?-1e4:x1)*x1+(y1=(y1=(y1=cj[2]-ci[2])==1/0?1e4:y1)===-1/0?-1e4:y1)*y1)>=Mat.eps?((lbda=(x0*x1+y0*y1)/den)<0?lbda=0:lbda>1&&(lbda=1),d=(x0-=lbda*x1)*x0+(y0-=lbda*y1)*y0):(lbda=0,d=x0*x0+y0*y0),d>dist&&(dist=d,f=k)}return[Math.sqrt(dist),f]}(pts,i,j),k=result[1];if(isNaN(result[0])){RDP(pts,i,k-1,eps,newPts),newPts.push(pts[k]);do{++k}while(k<=j&&isNaN(pts[k].scrCoords[1]+pts[k].scrCoords[2]));k<=j&&newPts.push(pts[k]),RDP(pts,k+1,j,eps,newPts)}else result[0]>eps?(RDP(pts,i,k,eps,newPts),RDP(pts,k,j,eps,newPts)):newPts.push(pts[j])};for(len=pts.length,i=0;;){for(;i<len&&isNaN(pts[i].scrCoords[1]+pts[i].scrCoords[2]);)i+=1;for(k=i+1;k<len&&!isNaN(pts[k].scrCoords[1]+pts[k].scrCoords[2]);)k+=1;if(k--,i<len&&k>i&&((newPts=[])[0]=pts[i],RDP(pts,i,k,eps,newPts),allPts=allPts.concat(newPts)),i>=len)break;k<len-1&&allPts.push(pts[k+1]),i=k+1}return allPts},RamerDouglasPeuker:function(pts,eps){return JXG.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(pts,eps)},Visvalingam:function(pts,numPoints){var i,len,vol,lastVol,lft,rt,lft2,rt2,obj,linkedList=[],heap=[],points=[];if((len=pts.length)<=2)return pts;for(linkedList[0]={used:!0,lft:null,node:null},lft=0,i=1;i<len-1;i++)vol=Math.abs(JXG.Math.Numerics.det([pts[i-1].usrCoords,pts[i].usrCoords,pts[i+1].usrCoords])),isNaN(vol)||(obj={v:vol,idx:i},heap.push(obj),linkedList[i]={used:!0,lft:lft,node:obj},linkedList[lft].rt=i,lft=i);for(linkedList[len-1]={used:!0,rt:null,lft:lft,node:null},linkedList[lft].rt=len-1,lastVol=-1/0;heap.length>numPoints;)heap.sort((function(a,b){return b.v-a.v})),linkedList[i=heap.pop().idx].used=!1,lastVol=linkedList[i].node.v,lft=linkedList[i].lft,rt=linkedList[i].rt,linkedList[lft].rt=rt,linkedList[rt].lft=lft,null!==(lft2=linkedList[lft].lft)&&(vol=Math.abs(JXG.Math.Numerics.det([pts[lft2].usrCoords,pts[lft].usrCoords,pts[rt].usrCoords])),linkedList[lft].node.v=vol>=lastVol?vol:lastVol),null!==(rt2=linkedList[rt].rt)&&(vol=Math.abs(JXG.Math.Numerics.det([pts[lft].usrCoords,pts[rt].usrCoords,pts[rt2].usrCoords])),linkedList[rt].node.v=vol>=lastVol?vol:lastVol);points=[pts[i=0]];do{i=linkedList[i].rt,points.push(pts[i])}while(null!==linkedList[i].rt);return points}},Mat.Numerics})),define("math/nlp",["jxg"],(function(JXG){return JXG.Math.Nlp={arr:function(n){var i,a=new Array(n);for(i=0;i<n;i++)a[i]=0;return a},arr2:function(n,m){for(var i=0,a=new Array(n);i<n;)a[i]=this.arr(m),i++;return a},arraycopy:function(x,a,iox,b,n){for(var i=0;i<n;)iox[i+b]=x[i+a],i++},Normal:0,MaxIterationsReached:1,DivergingRoundingErrors:2,FindMinimum:function(calcfc,n,m,x,rhobeg,rhoend,iprint,maxfun){var status,fcalcfc,mpp=m+2,iox=this.arr(n+1),that=this;return iox[0]=0,this.arraycopy(x,0,iox,1,n),fcalcfc=function(n,m,thisx,con){var ocon,f,ix=that.arr(n);return that.arraycopy(thisx,1,ix,0,n),ocon=that.arr(m),f=calcfc(n,m,ix,ocon),that.arraycopy(ocon,0,con,1,m),f},status=this.cobylb(fcalcfc,n,m,mpp,iox,rhobeg,rhoend,iprint,maxfun),this.arraycopy(iox,1,x,0,n),status},cobylb:function(calcfc,n,m,mpp,x,rhobeg,rhoend,iprint,maxfun){var total,i,j,k,l,temp,tempa,nfvals,jdrop,ibrnch,skipVertexIdent,phimin,nbest,error,pareta,wsig,weta,cvmaxp,cvmaxm,dxsign,resnew,barmu,phi,trured,ratio,edgmax,cmin,cmax,denom,status=-1,f=0,resmax=0,np=n+1,mp=m+1,rho=rhobeg,parmu=0,iflag=!1,ifull=!1,parsig=0,prerec=0,prerem=0,con=this.arr(1+mpp),sim=this.arr2(1+n,1+np),simi=this.arr2(1+n,1+n),datmat=this.arr2(1+mpp,1+np),a=this.arr2(1+n,1+mp),vsig=this.arr(1+n),veta=this.arr(1+n),sigbar=this.arr(1+n),dx=this.arr(1+n),w=this.arr(1+n);for(iprint>=2&&console.log("The initial value of RHO is "+rho+" and PARMU is set to zero."),nfvals=0,temp=1/rho,i=1;i<=n;++i)sim[i][np]=x[i],sim[i][i]=rho,simi[i][i]=temp;jdrop=np,ibrnch=!1;L_40:for(;;){if(nfvals>=maxfun&&nfvals>0){status=this.MaxIterationsReached;break L_40}for(++nfvals,f=calcfc(n,m,x,con),resmax=0,k=1;k<=m;++k)resmax=Math.max(resmax,-con[k]);if(nfvals!==iprint-1&&3!==iprint||this.PrintIterationResult(nfvals,f,resmax,x,n,iprint),con[mp]=f,con[mpp]=resmax,skipVertexIdent=!0,!ibrnch){for(skipVertexIdent=!1,i=1;i<=mpp;++i)datmat[i][jdrop]=con[i];if(nfvals<=np){if(jdrop<=n)if(datmat[mp][np]<=f)x[jdrop]=sim[jdrop][np];else{for(sim[jdrop][np]=x[jdrop],k=1;k<=mpp;++k)datmat[k][jdrop]=datmat[k][np],datmat[k][np]=con[k];for(k=1;k<=jdrop;++k){for(sim[jdrop][k]=-rho,temp=0,i=k;i<=jdrop;++i)temp-=simi[i][k];simi[jdrop][k]=temp}}if(nfvals<=n){x[jdrop=nfvals]+=rho;continue L_40}}ibrnch=!0}L_140:for(;;){L_550:do{if(!skipVertexIdent){for(phimin=datmat[mp][np]+parmu*datmat[mpp][np],nbest=np,j=1;j<=n;++j)(temp=datmat[mp][j]+parmu*datmat[mpp][j])<phimin?(nbest=j,phimin=temp):temp===phimin&&0===parmu&&datmat[mpp][j]<datmat[mpp][nbest]&&(nbest=j);if(nbest<=n){for(i=1;i<=mpp;++i)temp=datmat[i][np],datmat[i][np]=datmat[i][nbest],datmat[i][nbest]=temp;for(i=1;i<=n;++i){for(temp=sim[i][nbest],sim[i][nbest]=0,sim[i][np]+=temp,tempa=0,k=1;k<=n;++k)sim[i][k]-=temp,tempa-=simi[k][i];simi[nbest][i]=tempa}}for(error=0,i=1;i<=n;++i)for(j=1;j<=n;++j)temp=this.DOT_PRODUCT(this.PART(this.ROW(simi,i),1,n),this.PART(this.COL(sim,j),1,n))-(i===j?1:0),error=Math.max(error,Math.abs(temp));if(error>.1){status=this.DivergingRoundingErrors;break L_40}for(k=1;k<=mp;++k){for(con[k]=-datmat[k][np],j=1;j<=n;++j)w[j]=datmat[k][j]+con[k];for(i=1;i<=n;++i)a[i][k]=(k===mp?-1:1)*this.DOT_PRODUCT(this.PART(w,1,n),this.PART(this.COL(simi,i),1,n))}for(iflag=!0,parsig=.25*rho,pareta=2.1*rho,j=1;j<=n;++j){for(wsig=0,k=1;k<=n;++k)wsig+=simi[j][k]*simi[j][k];for(weta=0,k=1;k<=n;++k)weta+=sim[k][j]*sim[k][j];vsig[j]=1/Math.sqrt(wsig),veta[j]=Math.sqrt(weta),(vsig[j]<parsig||veta[j]>pareta)&&(iflag=!1)}if(!ibrnch&&!iflag){for(jdrop=0,temp=pareta,j=1;j<=n;++j)veta[j]>temp&&(jdrop=j,temp=veta[j]);if(0===jdrop)for(j=1;j<=n;++j)vsig[j]<temp&&(jdrop=j,temp=vsig[j]);for(temp=.5*rho*vsig[jdrop],k=1;k<=n;++k)dx[k]=temp*simi[jdrop][k];for(cvmaxp=0,cvmaxm=0,total=0,k=1;k<=mp;++k)total=this.DOT_PRODUCT(this.PART(this.COL(a,k),1,n),this.PART(dx,1,n)),k<mp&&(temp=datmat[k][np],cvmaxp=Math.max(cvmaxp,-total-temp),cvmaxm=Math.max(cvmaxm,total-temp));for(dxsign=parmu*(cvmaxp-cvmaxm)>2*total?-1:1,temp=0,i=1;i<=n;++i)dx[i]=dxsign*dx[i],sim[i][jdrop]=dx[i],temp+=simi[jdrop][i]*dx[i];for(k=1;k<=n;++k)simi[jdrop][k]/=temp;for(j=1;j<=n;++j){if(j!==jdrop)for(temp=this.DOT_PRODUCT(this.PART(this.ROW(simi,j),1,n),this.PART(dx,1,n)),k=1;k<=n;++k)simi[j][k]-=temp*simi[jdrop][k];x[j]=sim[j][np]+dx[j]}continue L_40}if(!(ifull=this.trstlp(n,m,a,con,rho,dx))){for(temp=0,k=1;k<=n;++k)temp+=dx[k]*dx[k];if(temp<.25*rho*rho){ibrnch=!0;break L_550}}for(total=0,resnew=0,con[mp]=0,k=1;k<=mp;++k)total=con[k]-this.DOT_PRODUCT(this.PART(this.COL(a,k),1,n),this.PART(dx,1,n)),k<mp&&(resnew=Math.max(resnew,total));if(parmu<1.5*(barmu=(prerec=datmat[mpp][np]-resnew)>0?total/prerec:0))for(parmu=2*barmu,iprint>=2&&console.log("Increase in PARMU to "+parmu),phi=datmat[mp][np]+parmu*datmat[mpp][np],j=1;j<=n;++j)if((temp=datmat[mp][j]+parmu*datmat[mpp][j])<phi||temp===phi&&0===parmu&&datmat[mpp][j]<datmat[mpp][np])continue L_140;for(prerem=parmu*prerec-total,k=1;k<=n;++k)x[k]=sim[k][np]+dx[k];ibrnch=!0;continue L_40}for(skipVertexIdent=!1,trured=datmat[mp][np]+parmu*datmat[mpp][np]-(f+parmu*resmax),0===parmu&&f===datmat[mp][np]&&(prerem=prerec,trured=datmat[mpp][np]-resmax),ratio=trured<=0?1:0,jdrop=0,j=1;j<=n;++j)(temp=Math.abs(this.DOT_PRODUCT(this.PART(this.ROW(simi,j),1,n),this.PART(dx,1,n))))>ratio&&(jdrop=j,ratio=temp),sigbar[j]=temp*vsig[j];for(edgmax=1.1*rho,l=0,j=1;j<=n;++j)if(sigbar[j]>=parsig||sigbar[j]>=vsig[j]){if(temp=veta[j],trured>0){for(temp=0,k=1;k<=n;++k)temp+=Math.pow(dx[k]-sim[k][j],2);temp=Math.sqrt(temp)}temp>edgmax&&(l=j,edgmax=temp)}if(l>0&&(jdrop=l),0!==jdrop){for(temp=0,i=1;i<=n;++i)sim[i][jdrop]=dx[i],temp+=simi[jdrop][i]*dx[i];for(k=1;k<=n;++k)simi[jdrop][k]/=temp;for(j=1;j<=n;++j)if(j!==jdrop)for(temp=this.DOT_PRODUCT(this.PART(this.ROW(simi,j),1,n),this.PART(dx,1,n)),k=1;k<=n;++k)simi[j][k]-=temp*simi[jdrop][k];for(k=1;k<=mpp;++k)datmat[k][jdrop]=con[k];if(trured>0&&trured>=.1*prerem)continue L_140}}while(0);if(iflag){if(rho<=rhoend){status=this.Normal;break L_40}if(cmin=0,cmax=0,(rho*=.5)<=1.5*rhoend&&(rho=rhoend),parmu>0){for(denom=0,k=1;k<=mp;++k){for(cmax=cmin=datmat[k][np],i=1;i<=n;++i)cmin=Math.min(cmin,datmat[k][i]),cmax=Math.max(cmax,datmat[k][i]);k<=m&&cmin<.5*cmax&&(temp=Math.max(cmax,0)-cmin,denom=denom<=0?temp:Math.min(denom,temp))}0===denom?parmu=0:cmax-cmin<parmu*denom&&(parmu=(cmax-cmin)/denom)}iprint>=2&&console.log("Reduction in RHO to "+rho+"  and PARMU = "+parmu),2===iprint&&this.PrintIterationResult(nfvals,datmat[mp][np],datmat[mpp][np],this.COL(sim,np),n,iprint)}else ibrnch=!1}}switch(status){case this.Normal:if(iprint>=1&&console.log("%nNormal return from subroutine COBYLA%n"),ifull)return iprint>=1&&this.PrintIterationResult(nfvals,f,resmax,x,n,iprint),status;break;case this.MaxIterationsReached:iprint>=1&&console.log("%nReturn from subroutine COBYLA because the MAXFUN limit has been reached.%n");break;case this.DivergingRoundingErrors:iprint>=1&&console.log("%nReturn from subroutine COBYLA because rounding errors are becoming damaging.%n")}for(k=1;k<=n;++k)x[k]=sim[k][np];return f=datmat[mp][np],resmax=datmat[mpp][np],iprint>=1&&this.PrintIterationResult(nfvals,f,resmax,x,n,iprint),status},trstlp:function(n,m,a,b,rho,dx){var icon,resmax,i,k,first,optold,icount,step,stpful,optnew,ratio,isave,vsave,total,kp,kk,sp,alpha,beta,tot,spabs,acca,accb,zdotv,zdvabs,kw,dd,ss,sd,zdotw,zdwabs,sumabs,tempa,temp=0,nactx=0,resold=0,z=this.arr2(1+n,1+n),zdota=this.arr(2+m),vmultc=this.arr(2+m),sdirn=this.arr(1+n),dxnew=this.arr(1+n),vmultd=this.arr(2+m),iact=this.arr(2+m),mcon=m,nact=0;for(i=1;i<=n;++i)z[i][i]=1,dx[i]=0;if(icon=0,resmax=0,m>=1){for(k=1;k<=m;++k)b[k]>resmax&&(resmax=b[k],icon=k);for(k=1;k<=m;++k)iact[k]=k,vmultc[k]=resmax-b[k]}first=!0;do{L_60:for(;;){(!first||first&&0===resmax)&&(icon=mcon=m+1,iact[mcon]=mcon,vmultc[mcon]=0),first=!1,optold=0,icount=0,step=0,stpful=0;L_70:do{if(optnew=mcon===m?resmax:-this.DOT_PRODUCT(this.PART(dx,1,n),this.PART(this.COL(a,mcon),1,n)),0===icount||optnew<optold?(optold=optnew,nactx=nact,icount=3):nact>nactx?(nactx=nact,icount=3):--icount,0===icount)break L_60;if(ratio=0,icon<=nact){if(icon<nact){isave=iact[icon],vsave=vmultc[icon],k=icon;do{for(kk=iact[kp=k+1],sp=this.DOT_PRODUCT(this.PART(this.COL(z,k),1,n),this.PART(this.COL(a,kk),1,n)),temp=Math.sqrt(sp*sp+zdota[kp]*zdota[kp]),alpha=zdota[kp]/temp,beta=sp/temp,zdota[kp]=alpha*zdota[k],zdota[k]=temp,i=1;i<=n;++i)temp=alpha*z[i][kp]+beta*z[i][k],z[i][kp]=alpha*z[i][k]-beta*z[i][kp],z[i][k]=temp;iact[k]=kk,vmultc[k]=vmultc[kp],k=kp}while(k<nact);iact[k]=isave,vmultc[k]=vsave}if(--nact,mcon>m)for(temp=1/zdota[nact],k=1;k<=n;++k)sdirn[k]=temp*z[k][nact];else for(temp=this.DOT_PRODUCT(this.PART(sdirn,1,n),this.PART(this.COL(z,nact+1),1,n)),k=1;k<=n;++k)sdirn[k]-=temp*z[k][nact+1]}else{for(kk=iact[icon],k=1;k<=n;++k)dxnew[k]=a[k][kk];for(tot=0,k=n;k>nact;){for(sp=0,spabs=0,i=1;i<=n;++i)sp+=temp=z[i][k]*dxnew[i],spabs+=Math.abs(temp);if(acca=spabs+.1*Math.abs(sp),accb=spabs+.2*Math.abs(sp),(spabs>=acca||acca>=accb)&&(sp=0),0===tot)tot=sp;else for(kp=k+1,alpha=sp/(temp=Math.sqrt(sp*sp+tot*tot)),beta=tot/temp,tot=temp,i=1;i<=n;++i)temp=alpha*z[i][k]+beta*z[i][kp],z[i][kp]=alpha*z[i][kp]-beta*z[i][k],z[i][k]=temp;--k}if(0===tot){ratio=-1,k=nact;do{for(zdotv=0,zdvabs=0,i=1;i<=n;++i)zdotv+=temp=z[i][k]*dxnew[i],zdvabs+=Math.abs(temp);if(acca=zdvabs+.1*Math.abs(zdotv),accb=zdvabs+.2*Math.abs(zdotv),zdvabs<acca&&acca<accb){if((temp=zdotv/zdota[k])>0&&iact[k]<=m&&(tempa=vmultc[k]/temp,(ratio<0||tempa<ratio)&&(ratio=tempa)),k>=2)for(kw=iact[k],i=1;i<=n;++i)dxnew[i]-=temp*a[i][kw];vmultd[k]=temp}else vmultd[k]=0}while(--k>0);if(ratio<0)break L_60;for(k=1;k<=nact;++k)vmultc[k]=Math.max(0,vmultc[k]-ratio*vmultd[k]);if(icon<nact){isave=iact[icon],vsave=vmultc[icon],k=icon;do{for(kw=iact[kp=k+1],sp=this.DOT_PRODUCT(this.PART(this.COL(z,k),1,n),this.PART(this.COL(a,kw),1,n)),temp=Math.sqrt(sp*sp+zdota[kp]*zdota[kp]),alpha=zdota[kp]/temp,beta=sp/temp,zdota[kp]=alpha*zdota[k],zdota[k]=temp,i=1;i<=n;++i)temp=alpha*z[i][kp]+beta*z[i][k],z[i][kp]=alpha*z[i][k]-beta*z[i][kp],z[i][k]=temp;iact[k]=kw,vmultc[k]=vmultc[kp],k=kp}while(k<nact);iact[k]=isave,vmultc[k]=vsave}if(0===(temp=this.DOT_PRODUCT(this.PART(this.COL(z,nact),1,n),this.PART(this.COL(a,kk),1,n))))break L_60;zdota[nact]=temp,vmultc[icon]=0,vmultc[nact]=ratio}else zdota[++nact]=tot,vmultc[icon]=vmultc[nact],vmultc[nact]=0;if(iact[icon]=iact[nact],iact[nact]=kk,mcon>m&&kk!==mcon){for(k=nact-1,sp=this.DOT_PRODUCT(this.PART(this.COL(z,k),1,n),this.PART(this.COL(a,kk),1,n)),temp=Math.sqrt(sp*sp+zdota[nact]*zdota[nact]),alpha=zdota[nact]/temp,beta=sp/temp,zdota[nact]=alpha*zdota[k],zdota[k]=temp,i=1;i<=n;++i)temp=alpha*z[i][nact]+beta*z[i][k],z[i][nact]=alpha*z[i][k]-beta*z[i][nact],z[i][k]=temp;iact[nact]=iact[k],iact[k]=kk,temp=vmultc[k],vmultc[k]=vmultc[nact],vmultc[nact]=temp}if(mcon>m)for(temp=1/zdota[nact],k=1;k<=n;++k)sdirn[k]=temp*z[k][nact];else for(kk=iact[nact],temp=(this.DOT_PRODUCT(this.PART(sdirn,1,n),this.PART(this.COL(a,kk),1,n))-1)/zdota[nact],k=1;k<=n;++k)sdirn[k]-=temp*z[k][nact]}for(dd=rho*rho,sd=0,ss=0,i=1;i<=n;++i)Math.abs(dx[i])>=1e-6*rho&&(dd-=dx[i]*dx[i]),sd+=dx[i]*sdirn[i],ss+=sdirn[i]*sdirn[i];if(dd<=0)break L_60;if(temp=Math.sqrt(ss*dd),Math.abs(sd)>=1e-6*temp&&(temp=Math.sqrt(ss*dd+sd*sd)),step=stpful=dd/(temp+sd),mcon===m){if(accb=step+.2*resmax,step>=(acca=step+.1*resmax)||acca>=accb)break L_70;step=Math.min(step,resmax)}for(k=1;k<=n;++k)dxnew[k]=dx[k]+step*sdirn[k];if(mcon===m)for(resold=resmax,resmax=0,k=1;k<=nact;++k)temp=b[kk=iact[k]]-this.DOT_PRODUCT(this.PART(this.COL(a,kk),1,n),this.PART(dxnew,1,n)),resmax=Math.max(resmax,temp);k=nact;do{for(zdotw=0,zdwabs=0,i=1;i<=n;++i)zdotw+=temp=z[i][k]*dxnew[i],zdwabs+=Math.abs(temp);if(acca=zdwabs+.1*Math.abs(zdotw),accb=zdwabs+.2*Math.abs(zdotw),(zdwabs>=acca||acca>=accb)&&(zdotw=0),vmultd[k]=zdotw/zdota[k],k>=2)for(kk=iact[k],i=1;i<=n;++i)dxnew[i]-=vmultd[k]*a[i][kk]}while(k-- >=2);for(mcon>m&&(vmultd[nact]=Math.max(0,vmultd[nact])),k=1;k<=n;++k)dxnew[k]=dx[k]+step*sdirn[k];if(mcon>nact)for(k=nact+1;k<=mcon;++k){for(total=resmax-b[kk=iact[k]],sumabs=resmax+Math.abs(b[kk]),i=1;i<=n;++i)total+=temp=a[i][kk]*dxnew[i],sumabs+=Math.abs(temp);acca=sumabs+.1*Math.abs(total),accb=sumabs+.2*Math.abs(total),(sumabs>=acca||acca>=accb)&&(total=0),vmultd[k]=total}for(ratio=1,icon=0,k=1;k<=mcon;++k)vmultd[k]<0&&(temp=vmultc[k]/(vmultc[k]-vmultd[k]))<ratio&&(ratio=temp,icon=k);for(temp=1-ratio,k=1;k<=n;++k)dx[k]=temp*dx[k]+ratio*dxnew[k];for(k=1;k<=mcon;++k)vmultc[k]=Math.max(0,temp*vmultc[k]+ratio*vmultd[k]);mcon===m&&(resmax=resold+ratio*(resmax-resold))}while(icon>0);if(step===stpful)return!0}}while(mcon===m);return!1},PrintIterationResult:function(nfvals,f,resmax,x,n,iprint){iprint>1&&console.log("NFVALS = "+nfvals+"  F = "+f+"  MAXCV = "+resmax),iprint>1&&console.log("X = "+this.PART(x,1,n))},ROW:function(src,rowidx){return src[rowidx].slice()},COL:function(src,colidx){var row,rows=src.length,dest=this.arr(rows);for(row=0;row<rows;++row)dest[row]=src[row][colidx];return dest},PART:function(src,from,to){return src.slice(from,to+1)},FORMAT:function(x){return x.join(",")},DOT_PRODUCT:function(lhs,rhs){var i,sum=0,len=lhs.length;for(i=0;i<len;++i)sum+=lhs[i]*rhs[i];return sum}},JXG.Math.Nlp})),define("math/statistics",["jxg","math/math","utils/type"],(function(JXG,Mat,Type){return Mat.Statistics={sum:function(arr){var i,len=arr.length,res=0;for(i=0;i<len;i++)res+=arr[i];return res},prod:function(arr){var i,len=arr.length,res=1;for(i=0;i<len;i++)res*=arr[i];return res},mean:function(arr){return arr.length>0?this.sum(arr)/arr.length:0},median:function(arr){var tmp,len;return arr.length>0?(ArrayBuffer.isView(arr)?(tmp=new Float64Array(arr)).sort():(tmp=arr.slice(0)).sort((function(a,b){return a-b})),1&(len=tmp.length)?tmp[parseInt(.5*len,10)]:.5*(tmp[.5*len-1]+tmp[.5*len])):0},percentile:function(arr,_percentile){var tmp,len,i,p,per,res=[];if(arr.length>0){for(ArrayBuffer.isView(arr)?(tmp=new Float64Array(arr)).sort():(tmp=arr.slice(0)).sort((function(a,b){return a-b})),len=tmp.length,p=Type.isArray(_percentile)?_percentile:[_percentile],i=0;i<p.length;i++)per=len*p[i]*.01,parseInt(per,10)===per?res.push(.5*(tmp[per-1]+tmp[per])):res.push(tmp[parseInt(per,10)]);return Type.isArray(_percentile)?res:res[0]}return 0},variance:function(arr){var m,res,i,len=arr.length;if(len>1){for(m=this.mean(arr),res=0,i=0;i<len;i++)res+=(arr[i]-m)*(arr[i]-m);return res/(arr.length-1)}return 0},sd:function(arr){return Math.sqrt(this.variance(arr))},weightedMean:function(arr,w){if(arr.length!==w.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return arr.length>0?this.mean(this.multiply(arr,w)):0},max:function(arr){return Math.max.apply(this,arr)},min:function(arr){return Math.min.apply(this,arr)},range:function(arr){return[this.min(arr),this.max(arr)]},abs:function(arr){var i,len,res;if(Type.isArray(arr))if(arr.map)res=arr.map(Math.abs);else for(len=arr.length,res=[],i=0;i<len;i++)res[i]=Math.abs(arr[i]);else res=ArrayBuffer.isView(arr)?arr.map(Math.abs):Math.abs(arr);return res},add:function(arr1,arr2){var i,len,res=[];if(arr1=Type.evalSlider(arr1),arr2=Type.evalSlider(arr2),Type.isArray(arr1)&&Type.isNumber(arr2))for(len=arr1.length,i=0;i<len;i++)res[i]=arr1[i]+arr2;else if(Type.isNumber(arr1)&&Type.isArray(arr2))for(len=arr2.length,i=0;i<len;i++)res[i]=arr1+arr2[i];else if(Type.isArray(arr1)&&Type.isArray(arr2))for(len=Math.min(arr1.length,arr2.length),i=0;i<len;i++)res[i]=arr1[i]+arr2[i];else res=arr1+arr2;return res},div:function(arr1,arr2){var i,len,res=[];if(arr1=Type.evalSlider(arr1),arr2=Type.evalSlider(arr2),Type.isArray(arr1)&&Type.isNumber(arr2))for(len=arr1.length,i=0;i<len;i++)res[i]=arr1[i]/arr2;else if(Type.isNumber(arr1)&&Type.isArray(arr2))for(len=arr2.length,i=0;i<len;i++)res[i]=arr1/arr2[i];else if(Type.isArray(arr1)&&Type.isArray(arr2))for(len=Math.min(arr1.length,arr2.length),i=0;i<len;i++)res[i]=arr1[i]/arr2[i];else res=arr1/arr2;return res},divide:function(){JXG.deprecated("Statistics.divide()","Statistics.div()"),Mat.Statistics.div.apply(Mat.Statistics,arguments)},mod:function(arr1,arr2,math){var i,len,res=[],mod=function(a,m){return a%m};if((math=Type.def(math,!1))&&(mod=Mat.mod),arr1=Type.evalSlider(arr1),arr2=Type.evalSlider(arr2),Type.isArray(arr1)&&Type.isNumber(arr2))for(len=arr1.length,i=0;i<len;i++)res[i]=mod(arr1[i],arr2);else if(Type.isNumber(arr1)&&Type.isArray(arr2))for(len=arr2.length,i=0;i<len;i++)res[i]=mod(arr1,arr2[i]);else if(Type.isArray(arr1)&&Type.isArray(arr2))for(len=Math.min(arr1.length,arr2.length),i=0;i<len;i++)res[i]=mod(arr1[i],arr2[i]);else res=mod(arr1,arr2);return res},multiply:function(arr1,arr2){var i,len,res=[];if(arr1=Type.evalSlider(arr1),arr2=Type.evalSlider(arr2),Type.isArray(arr1)&&Type.isNumber(arr2))for(len=arr1.length,i=0;i<len;i++)res[i]=arr1[i]*arr2;else if(Type.isNumber(arr1)&&Type.isArray(arr2))for(len=arr2.length,i=0;i<len;i++)res[i]=arr1*arr2[i];else if(Type.isArray(arr1)&&Type.isArray(arr2))for(len=Math.min(arr1.length,arr2.length),i=0;i<len;i++)res[i]=arr1[i]*arr2[i];else res=arr1*arr2;return res},subtract:function(arr1,arr2){var i,len,res=[];if(arr1=Type.evalSlider(arr1),arr2=Type.evalSlider(arr2),Type.isArray(arr1)&&Type.isNumber(arr2))for(len=arr1.length,i=0;i<len;i++)res[i]=arr1[i]-arr2;else if(Type.isNumber(arr1)&&Type.isArray(arr2))for(len=arr2.length,i=0;i<len;i++)res[i]=arr1-arr2[i];else if(Type.isArray(arr1)&&Type.isArray(arr2))for(len=Math.min(arr1.length,arr2.length),i=0;i<len;i++)res[i]=arr1[i]-arr2[i];else res=arr1-arr2;return res},TheilSenRegression:function(coords){var i,j,slopes=[],tmpslopes=[],yintercepts=[];for(i=0;i<coords.length;i++){for(tmpslopes.length=0,j=0;j<coords.length;j++)Math.abs(coords[j].usrCoords[1]-coords[i].usrCoords[1])>Mat.eps&&(tmpslopes[j]=(coords[j].usrCoords[2]-coords[i].usrCoords[2])/(coords[j].usrCoords[1]-coords[i].usrCoords[1]));slopes[i]=this.median(tmpslopes),yintercepts.push(coords[i].usrCoords[2]-slopes[i]*coords[i].usrCoords[1])}return[this.median(yintercepts),this.median(slopes),-1]},generateGaussian:function(mean,stdDev){var u,v,s;if(this.hasSpare)return this.hasSpare=!1,this.spare*stdDev+mean;do{s=(u=2*Math.random()-1)*u+(v=2*Math.random()-1)*v}while(s>=1||0===s);return s=Math.sqrt(-2*Math.log(s)/s),this.spare=v*s,this.hasSpare=!0,mean+stdDev*u*s}},Mat.Statistics})),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],(function(JXG,Const,Coords,Mat,Numerics,Type,Expect){return Mat.Geometry={},JXG.extend(Mat.Geometry,{angle:function(A,B,C){var u,v,s,t,a=[],b=[],c=[];return JXG.deprecated("Geometry.angle()","Geometry.rad()"),A.coords?(a[0]=A.coords.usrCoords[1],a[1]=A.coords.usrCoords[2]):(a[0]=A[0],a[1]=A[1]),B.coords?(b[0]=B.coords.usrCoords[1],b[1]=B.coords.usrCoords[2]):(b[0]=B[0],b[1]=B[1]),C.coords?(c[0]=C.coords.usrCoords[1],c[1]=C.coords.usrCoords[2]):(c[0]=C[0],c[1]=C[1]),u=a[0]-b[0],v=a[1]-b[1],s=c[0]-b[0],t=c[1]-b[1],Math.atan2(u*t-v*s,u*s+v*t)},trueAngle:function(A,B,C){return 57.29577951308232*this.rad(A,B,C)},rad:function(A,B,C){var ax,ay,bx,by,cx,cy,phi;return A.coords?(ax=A.coords.usrCoords[1],ay=A.coords.usrCoords[2]):(ax=A[0],ay=A[1]),B.coords?(bx=B.coords.usrCoords[1],by=B.coords.usrCoords[2]):(bx=B[0],by=B[1]),C.coords?(cx=C.coords.usrCoords[1],cy=C.coords.usrCoords[2]):(cx=C[0],cy=C[1]),(phi=Math.atan2(cy-by,cx-bx)-Math.atan2(ay-by,ax-bx))<0&&(phi+=6.283185307179586),phi},angleBisector:function(A,B,C,board){var phiA,phiC,phi,x,y,Ac=A.coords.usrCoords,Bc=B.coords.usrCoords,Cc=C.coords.usrCoords;return Type.exists(board)||(board=A.board),0===Bc[0]?new Coords(Const.COORDS_BY_USER,[1,.5*(Ac[1]+Cc[1]),.5*(Ac[2]+Cc[2])],board):(x=Ac[1]-Bc[1],y=Ac[2]-Bc[2],phiA=Math.atan2(y,x),x=Cc[1]-Bc[1],y=Cc[2]-Bc[2],phi=.5*(phiA+(phiC=Math.atan2(y,x))),phiA>phiC&&(phi+=Math.PI),x=Math.cos(phi)+Bc[1],y=Math.sin(phi)+Bc[2],new Coords(Const.COORDS_BY_USER,[1,x,y],board))},reflection:function(line,point,board){var x0,x1,y1,v,w,mu,pc=point.coords.usrCoords,p1c=line.point1.coords.usrCoords,p2c=line.point2.coords.usrCoords;return Type.exists(board)||(board=point.board),v=p2c[1]-p1c[1],w=p2c[2]-p1c[2],x0=pc[1]-p1c[1],mu=(v*(pc[2]-p1c[2])-w*x0)/(v*v+w*w),x1=pc[1]+2*mu*w,y1=pc[2]-2*mu*v,new Coords(Const.COORDS_BY_USER,[x1,y1],board)},rotation:function(rotpoint,point,phi,board){var x0,y0,c,s,x1,y1,pc=point.coords.usrCoords,rotpc=rotpoint.coords.usrCoords;return Type.exists(board)||(board=point.board),x0=pc[1]-rotpc[1],y0=pc[2]-rotpc[2],x1=x0*(c=Math.cos(phi))-y0*(s=Math.sin(phi))+rotpc[1],y1=x0*s+y0*c+rotpc[2],new Coords(Const.COORDS_BY_USER,[x1,y1],board)},perpendicular:function(line,point,board){var x,y,change,c,z,A=line.point1.coords.usrCoords,B=line.point2.coords.usrCoords,C=point.coords.usrCoords;return Type.exists(board)||(board=point.board),point===line.point1?(x=A[1]+B[2]-A[2],y=A[2]-B[1]+A[1],z=A[0]*B[0],Math.abs(z)<Mat.eps&&(x=B[2],y=-B[1]),c=[z,x,y],change=!0):point===line.point2?(x=B[1]+A[2]-B[2],y=B[2]-A[1]+B[1],z=A[0]*B[0],Math.abs(z)<Mat.eps&&(x=A[2],y=-A[1]),c=[z,x,y],change=!1):Math.abs(Mat.innerProduct(C,line.stdform,3))<Mat.eps?(x=C[1]+B[2]-C[2],y=C[2]-B[1]+C[1],z=B[0],Math.abs(z)<Mat.eps&&(x=B[2],y=-B[1]),change=!0,Math.abs(z)>Mat.eps&&Math.abs(x-C[1])<Mat.eps&&Math.abs(y-C[2])<Mat.eps&&(x=C[1]+A[2]-C[2],y=C[2]-A[1]+C[1],change=!1),c=[z,x,y]):(c=[0,line.stdform[1],line.stdform[2]],c=Mat.crossProduct(c,C),c=Mat.crossProduct(c,line.stdform),change=!0),[new Coords(Const.COORDS_BY_USER,c,board),change]},circumcenterMidpoint:function(){JXG.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(point1,point2,point3,board){var u,v,m1,m2,A=point1.coords.usrCoords,B=point2.coords.usrCoords,C=point3.coords.usrCoords;return Type.exists(board)||(board=point1.board),u=[B[0]-A[0],-B[2]+A[2],B[1]-A[1]],v=[.5*(A[0]+B[0]),.5*(A[1]+B[1]),.5*(A[2]+B[2])],m1=Mat.crossProduct(u,v),u=[C[0]-B[0],-C[2]+B[2],C[1]-B[1]],v=[.5*(B[0]+C[0]),.5*(B[1]+C[1]),.5*(B[2]+C[2])],m2=Mat.crossProduct(u,v),new Coords(Const.COORDS_BY_USER,Mat.crossProduct(m1,m2),board)},distance:function(array1,array2,n){var i,sum=0;for(n||(n=Math.min(array1.length,array2.length)),i=0;i<n;i++)sum+=(array1[i]-array2[i])*(array1[i]-array2[i]);return Math.sqrt(sum)},affineDistance:function(array1,array2,n){var d;return(d=this.distance(array1,array2,n))>Mat.eps&&(Math.abs(array1[0])<Mat.eps||Math.abs(array2[0])<Mat.eps)?1/0:d},affineRatio:function(a,b,c){var dx;return Type.exists(a.usrCoords)&&(a=a.usrCoords),Type.exists(b.usrCoords)&&(b=b.usrCoords),Type.exists(c.usrCoords)&&(c=c.usrCoords),dx=b[1]-a[1],Math.abs(dx)>Mat.eps?(c[1]-a[1])/dx:(c[2]-a[2])/(b[2]-a[2])},sortVertices:function(p){for(var ll,ps=Expect.each(p,Expect.coordsArray),N=ps.length,lastPoint=null;ps[0][0]===ps[N-1][0]&&ps[0][1]===ps[N-1][1]&&ps[0][2]===ps[N-1][2];)lastPoint=ps.pop(),N--;return ll=ps[0],ps.sort((function(a,b){return(a[2]===ll[2]&&a[1]===ll[1]?-1/0:Math.atan2(a[2]-ll[2],a[1]-ll[1]))-(b[2]===ll[2]&&b[1]===ll[1]?-1/0:Math.atan2(b[2]-ll[2],b[1]-ll[1]))})),null!==lastPoint&&ps.push(lastPoint),ps},signedTriangle:function(p1,p2,p3){var A=Expect.coordsArray(p1),B=Expect.coordsArray(p2),C=Expect.coordsArray(p3);return.5*((B[1]-A[1])*(C[2]-A[2])-(B[2]-A[2])*(C[1]-A[1]))},signedPolygon:function(p,sort){var i,N,A=0,ps=Expect.each(p,Expect.coordsArray);for(void 0===sort&&(sort=!0),sort?ps.unshift(ps[ps.length-1]):ps=this.sortVertices(ps),N=ps.length,i=1;i<N;i++)A+=ps[i-1][1]*ps[i][2]-ps[i][1]*ps[i-1][2];return.5*A},GrahamScan:function(points){var i,M=1,ps=Expect.each(points,Expect.coordsArray),N=ps.length;for(N=(ps=this.sortVertices(ps)).length,i=2;i<N;i++){for(;this.signedTriangle(ps[M-1],ps[M],ps[i])<=0;){if(M>1)M-=1;else if(i===N-1)break;i+=1}M+=1,ps=Type.swap(ps,M,i)}return ps.slice(0,M)},calcStraight:function(el,point1,point2,margin){var takePoint1,takePoint2,intersection,intersect1,intersect2,straightFirst,straightLast,c,p1,p2;if(Type.exists(margin)||(margin=10),straightFirst=Type.evaluate(el.visProp.straightfirst),straightLast=Type.evaluate(el.visProp.straightlast),Math.abs(point1.scrCoords[0])<Mat.eps&&(straightFirst=!0),Math.abs(point2.scrCoords[0])<Mat.eps&&(straightLast=!0),(straightFirst||straightLast)&&((c=[])[0]=el.stdform[0]-el.stdform[1]*el.board.origin.scrCoords[1]/el.board.unitX+el.stdform[2]*el.board.origin.scrCoords[2]/el.board.unitY,c[1]=el.stdform[1]/el.board.unitX,c[2]=-el.stdform[2]/el.board.unitY,!isNaN(c[0]+c[1]+c[2]))){if(!1,!1,takePoint1=!straightFirst&&Math.abs(point1.usrCoords[0])>=Mat.eps&&point1.scrCoords[1]>=0&&point1.scrCoords[1]<=el.board.canvasWidth&&point1.scrCoords[2]>=0&&point1.scrCoords[2]<=el.board.canvasHeight,takePoint2=!straightLast&&Math.abs(point2.usrCoords[0])>=Mat.eps&&point2.scrCoords[1]>=0&&point2.scrCoords[1]<=el.board.canvasWidth&&point2.scrCoords[2]>=0&&point2.scrCoords[2]<=el.board.canvasHeight,intersect1=(intersection=this.meetLineBoard(c,el.board,margin))[0],intersect2=intersection[1],!takePoint1&&!takePoint2){if(!straightFirst&&straightLast&&!this.isSameDirection(point1,point2,intersect1)&&!this.isSameDirection(point1,point2,intersect2))return;if(straightFirst&&!straightLast&&!this.isSameDirection(point2,point1,intersect1)&&!this.isSameDirection(point2,point1,intersect2))return}takePoint1?takePoint2||(p2=this.isSameDir(point1,point2,intersect1,intersect2)?intersect2:intersect1):takePoint2?p1=this.isSameDir(point1,point2,intersect1,intersect2)?intersect1:intersect2:this.isSameDir(point1,point2,intersect1,intersect2)?(p1=intersect1,p2=intersect2):(p2=intersect1,p1=intersect2),p1&&point1.setCoordinates(Const.COORDS_BY_USER,p1.usrCoords),p2&&point2.setCoordinates(Const.COORDS_BY_USER,p2.usrCoords)}},calcLineDelimitingPoints:function(el,point1,point2){var distP1P2,boundingBox,intersect1,intersect2,straightFirst,straightLast,c,p1,p2,takePoint1,takePoint2;if(straightFirst=Type.evaluate(el.visProp.straightfirst),straightLast=Type.evaluate(el.visProp.straightlast),Math.abs(point1.scrCoords[0])<Mat.eps&&(straightFirst=!0),Math.abs(point2.scrCoords[0])<Mat.eps&&(straightLast=!0),(c=[])[0]=el.stdform[0]-el.stdform[1]*el.board.origin.scrCoords[1]/el.board.unitX+el.stdform[2]*el.board.origin.scrCoords[2]/el.board.unitY,c[1]=el.stdform[1]/el.board.unitX,c[2]=-el.stdform[2]/el.board.unitY,!isNaN(c[0]+c[1]+c[2])){if(takePoint1=!straightFirst,takePoint2=!straightLast,boundingBox=el.board.getBoundingBox(),el.getSlope()>=0?(intersect1=this.projectPointToLine({coords:{usrCoords:[1,boundingBox[2],boundingBox[1]]}},el,el.board),intersect2=this.projectPointToLine({coords:{usrCoords:[1,boundingBox[0],boundingBox[3]]}},el,el.board)):(intersect1=this.projectPointToLine({coords:{usrCoords:[1,boundingBox[0],boundingBox[1]]}},el,el.board),intersect2=this.projectPointToLine({coords:{usrCoords:[1,boundingBox[2],boundingBox[3]]}},el,el.board)),!takePoint1&&!takePoint2){if(!straightFirst&&!straightLast){if(distP1P2=point1.distance(Const.COORDS_BY_USER,point2),Math.abs(point1.distance(Const.COORDS_BY_USER,intersect1)+intersect1.distance(Const.COORDS_BY_USER,point2)-distP1P2)>Mat.eps)return;if(Math.abs(point1.distance(Const.COORDS_BY_USER,intersect2)+intersect2.distance(Const.COORDS_BY_USER,point2)-distP1P2)>Mat.eps)return}if(!straightFirst&&straightLast&&!this.isSameDirection(point1,point2,intersect1)&&!this.isSameDirection(point1,point2,intersect2))return;if(straightFirst&&!straightLast&&!this.isSameDirection(point2,point1,intersect1)&&!this.isSameDirection(point2,point1,intersect2))return}takePoint1?takePoint2||(p2=this.isSameDir(point1,point2,intersect1,intersect2)?intersect2:intersect1):takePoint2?p1=this.isSameDir(point1,point2,intersect1,intersect2)?intersect1:intersect2:this.isSameDir(point1,point2,intersect1,intersect2)?(p1=intersect1,p2=intersect2):(p2=intersect1,p1=intersect2),p1&&point1.setCoordinates(Const.COORDS_BY_USER,p1.usrCoords),p2&&point2.setCoordinates(Const.COORDS_BY_USER,p2.usrCoords)}},calcLabelQuadrant:function(angle){return angle<0&&(angle+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((angle+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(p1,p2,i1,i2){var dpx=p2.usrCoords[1]-p1.usrCoords[1],dpy=p2.usrCoords[2]-p1.usrCoords[2],dix=i2.usrCoords[1]-i1.usrCoords[1],diy=i2.usrCoords[2]-i1.usrCoords[2];return Math.abs(p2.usrCoords[0])<Mat.eps&&(dpx=p2.usrCoords[1],dpy=p2.usrCoords[2]),Math.abs(p1.usrCoords[0])<Mat.eps&&(dpx=-p1.usrCoords[1],dpy=-p1.usrCoords[2]),dpx*dix+dpy*diy>=0},isSameDirection:function(start,p,s){var dx,dy,sx,sy,r=!1;return dx=p.usrCoords[1]-start.usrCoords[1],dy=p.usrCoords[2]-start.usrCoords[2],sx=s.usrCoords[1]-start.usrCoords[1],sy=s.usrCoords[2]-start.usrCoords[2],Math.abs(dx)<Mat.eps&&(dx=0),Math.abs(dy)<Mat.eps&&(dy=0),Math.abs(sx)<Mat.eps&&(sx=0),Math.abs(sy)<Mat.eps&&(sy=0),(dx>=0&&sx>=0||dx<=0&&sx<=0)&&(r=dy>=0&&sy>=0||dy<=0&&sy<=0),r},intersectionFunction:function(board,el1,el2,i,j,alwaysintersect){var el1_isArcType,el2_isArcType,that=this;return el1_isArcType=el1.elementClass===Const.OBJECT_CLASS_CURVE&&(el1.type===Const.OBJECT_TYPE_ARC||el1.type===Const.OBJECT_TYPE_SECTOR),el2_isArcType=el2.elementClass===Const.OBJECT_CLASS_CURVE&&(el2.type===Const.OBJECT_TYPE_ARC||el2.type===Const.OBJECT_TYPE_SECTOR),el1.elementClass!==Const.OBJECT_CLASS_CURVE&&el2.elementClass!==Const.OBJECT_CLASS_CURVE||el1.elementClass!==Const.OBJECT_CLASS_CURVE&&el1.elementClass!==Const.OBJECT_CLASS_CIRCLE||el2.elementClass!==Const.OBJECT_CLASS_CURVE&&el2.elementClass!==Const.OBJECT_CLASS_CIRCLE?el1.elementClass===Const.OBJECT_CLASS_CURVE&&!el1_isArcType&&el2.elementClass===Const.OBJECT_CLASS_LINE||el2.elementClass===Const.OBJECT_CLASS_CURVE&&!el2_isArcType&&el1.elementClass===Const.OBJECT_CLASS_LINE?function(){return that.meetCurveLine(el1,el2,i,el1.board,alwaysintersect)}:el1.type===Const.OBJECT_TYPE_POLYGON||el2.type===Const.OBJECT_TYPE_POLYGON?el1.elementClass===Const.OBJECT_CLASS_LINE?function(){return that.meetPolygonLine(el2,el1,i,el1.board,alwaysintersect)}:el2.elementClass===Const.OBJECT_CLASS_LINE?function(){return that.meetPolygonLine(el1,el2,i,el1.board,alwaysintersect)}:function(){return that.meetPathPath(el1,el2,i,el1.board)}:el1.elementClass===Const.OBJECT_CLASS_LINE&&el2.elementClass===Const.OBJECT_CLASS_LINE?function(){var res,c,first1=Type.evaluate(el1.visProp.straightfirst),last1=Type.evaluate(el1.visProp.straightlast),first2=Type.evaluate(el2.visProp.straightfirst),last2=Type.evaluate(el2.visProp.straightlast);return Type.evaluate(alwaysintersect)||first1&&last1&&first2&&last2?that.meet(el1.stdform,el2.stdform,i,el1.board):(res=that.meetSegmentSegment(el1.point1.coords.usrCoords,el1.point2.coords.usrCoords,el2.point1.coords.usrCoords,el2.point2.coords.usrCoords),c=!first1&&res[1]<0||!last1&&res[1]>1||!first2&&res[2]<0||!last2&&res[2]>1?[0,NaN,NaN]:res[0],new Coords(Const.COORDS_BY_USER,c,el1.board))}:function(){var first,last,r,res=that.meet(el1.stdform,el2.stdform,i,el1.board),has=!0;return alwaysintersect?res:(el1.elementClass!==Const.OBJECT_CLASS_LINE||(first=Type.evaluate(el1.visProp.straightfirst),last=Type.evaluate(el1.visProp.straightlast),first&&last||(r=that.affineRatio(el1.point1.coords,el1.point2.coords,res),!(!last&&r>1+Mat.eps||!first&&r<0-Mat.eps))))&&(el2.elementClass!==Const.OBJECT_CLASS_LINE||(first=Type.evaluate(el2.visProp.straightfirst),last=Type.evaluate(el2.visProp.straightlast),first&&last||(r=that.affineRatio(el2.point1.coords,el2.point2.coords,res),!(!last&&r>1+Mat.eps||!first&&r<0-Mat.eps))))?el1_isArcType&&((has=that.coordsOnArc(el1,res))&&el2_isArcType&&(has=that.coordsOnArc(el2,res)),!has)?new Coords(JXG.COORDS_BY_USER,[0,NaN,NaN],el1.board):res:new Coords(JXG.COORDS_BY_USER,[0,NaN,NaN],el1.board)}:function(){return that.meetCurveCurve(el1,el2,i,j,el1.board)}},coordsOnArc:function(arc,coords){var angle=this.rad(arc.radiuspoint,arc.center,coords.usrCoords.slice(1)),alpha=0,beta=this.rad(arc.radiuspoint,arc.center,arc.anglepoint),ev_s=Type.evaluate(arc.visProp.selection);return("minor"===ev_s&&beta>Math.PI||"major"===ev_s&&beta<Math.PI)&&(alpha=beta,beta=2*Math.PI),!(angle<alpha||angle>beta)},meet:function(el1,el2,i,board){var eps=Mat.eps;return Math.abs(el1[3])<eps&&Math.abs(el2[3])<eps?this.meetLineLine(el1,el2,i,board):Math.abs(el1[3])>=eps&&Math.abs(el2[3])<eps?this.meetLineCircle(el2,el1,i,board):Math.abs(el1[3])<eps&&Math.abs(el2[3])>=eps?this.meetLineCircle(el1,el2,i,board):this.meetCircleCircle(el1,el2,i,board)},meetLineBoard:function(line,board,margin){var intersect1,intersect2,i,j,s=[];for(Type.exists(margin)||(margin=0),s[0]=Mat.crossProduct(line,[margin,0,1]),s[1]=Mat.crossProduct(line,[margin,1,0]),s[2]=Mat.crossProduct(line,[-margin-board.canvasHeight,0,1]),s[3]=Mat.crossProduct(line,[-margin-board.canvasWidth,1,0]),i=0;i<4;i++)if(Math.abs(s[i][0])>Mat.eps){for(j=2;j>0;j--)s[i][j]/=s[i][0];s[i][0]=1}return Math.abs(s[1][0])<Mat.eps?(intersect1=s[0],intersect2=s[2]):Math.abs(s[0][0])<Mat.eps?(intersect1=s[1],intersect2=s[3]):s[1][2]<0?(intersect1=s[0],intersect2=s[3][2]>board.canvasHeight?s[2]:s[3]):s[1][2]>board.canvasHeight?(intersect1=s[2],intersect2=s[3][2]<0?s[0]:s[3]):(intersect1=s[1],intersect2=s[3][2]<0?s[0]:s[3][2]>board.canvasHeight?s[2]:s[3]),[intersect1=new Coords(Const.COORDS_BY_SCREEN,intersect1.slice(1),board),intersect2=new Coords(Const.COORDS_BY_SCREEN,intersect2.slice(1),board)]},meetLineLine:function(l1,l2,i,board){var s=isNaN(l1[5]+l2[5])?[0,0,0]:Mat.crossProduct(l1,l2);return new Coords(Const.COORDS_BY_USER,s,board)},meetLineCircle:function(lin,circ,i,board){var a,b,c,d,n,A,B,k,t;return circ[4]<Mat.eps?Math.abs(Mat.innerProduct([1,circ[6],circ[7]],lin,3))<Mat.eps?new Coords(Const.COORDS_BY_USER,circ.slice(6,8),board):new Coords(Const.COORDS_BY_USER,[NaN,NaN],board):(c=circ[0],b=circ.slice(1,3),a=circ[3],d=lin[0],n=lin.slice(1,3),A=a,(k=(B=b[0]*n[1]-b[1]*n[0])*B-4*A*(a*d*d-(b[0]*n[0]+b[1]*n[1])*d+c))>-Mat.eps*Mat.eps?(t=[(-B+(k=Math.sqrt(Math.abs(k))))/(2*A),(-B-k)/(2*A)],new Coords(Const.COORDS_BY_USER,0===i?[-t[0]*-n[1]-d*n[0],-t[0]*n[0]-d*n[1]]:[-t[1]*-n[1]-d*n[0],-t[1]*n[0]-d*n[1]],board)):new Coords(Const.COORDS_BY_USER,[0,0,0],board))},meetCircleCircle:function(circ1,circ2,i,board){var radicalAxis;return circ1[4]<Mat.eps?Math.abs(this.distance(circ1.slice(6,2),circ2.slice(6,8))-circ2[4])<Mat.eps?new Coords(Const.COORDS_BY_USER,circ1.slice(6,8),board):new Coords(Const.COORDS_BY_USER,[0,0,0],board):circ2[4]<Mat.eps?Math.abs(this.distance(circ2.slice(6,2),circ1.slice(6,8))-circ1[4])<Mat.eps?new Coords(Const.COORDS_BY_USER,circ2.slice(6,8),board):new Coords(Const.COORDS_BY_USER,[0,0,0],board):(radicalAxis=[circ2[3]*circ1[0]-circ1[3]*circ2[0],circ2[3]*circ1[1]-circ1[3]*circ2[1],circ2[3]*circ1[2]-circ1[3]*circ2[2],0,1,1/0,1/0,1/0],radicalAxis=Mat.normalize(radicalAxis),this.meetLineCircle(radicalAxis,circ1,i,board))},meetCurveCurve:function(c1,c2,nr,t2ini,board,method){var co;return co=Type.exists(method)&&"newton"===method?Numerics.generalizedNewton(c1,c2,nr,t2ini):3===c1.bezierDegree||3===c2.bezierDegree?this.meetBezierCurveRedBlueSegments(c1,c2,nr):this.meetCurveRedBlueSegments(c1,c2,nr),new Coords(Const.COORDS_BY_USER,co,board)},meetCurveLine:function(el1,el2,nr,board,alwaysIntersect){var cu,li;return Type.exists(board)||(board=el1.board),el1.elementClass===Const.OBJECT_CLASS_CURVE?(cu=el1,li=el2):(cu=el2,li=el1),this.meetCurveLineDiscrete(cu,li,nr,board,!alwaysIntersect)},meetCurveLineContinuous:function(cu,li,nr,board,testSegment){var t,func0,func1,v,x,y,z,delta,tnew,i,tmin,fmin,ft,eps=Mat.eps,epsLow=Mat.eps;for(v=this.meetCurveLineDiscrete(cu,li,nr,board,testSegment),x=v.usrCoords[1],y=v.usrCoords[2],func0=function(t){var c1,c2;return t>cu.maxX()||t<cu.minX()?1/0:(c1=x-cu.X(t))*c1+(c2=y-cu.Y(t))*c2},func1=function(t){var v=li.stdform[0]+li.stdform[1]*cu.X(t)+li.stdform[2]*cu.Y(t);return v*v},50,delta=(cu.maxX()-cu.minX())/50,tnew=cu.minX(),fmin=1e-4,tmin=NaN,i=0;i<50&&(t=Numerics.root(func0,[Math.max(tnew,cu.minX()),Math.min(tnew+delta,cu.maxX())]),!((ft=Math.abs(func0(t)))<=fmin&&(tmin=t,(fmin=ft)<eps)));i++)tnew+=delta;return t=tmin,ft=func1(t=Numerics.root(func1,[Math.max(t-delta,cu.minX()),Math.min(t+delta,cu.maxX())])),z=isNaN(ft)||Math.abs(ft)>epsLow?0:1,new Coords(Const.COORDS_BY_USER,[z,cu.X(t),cu.Y(t)],board)},meetCurveLineDiscrete:function(cu,li,nr,board,testSegment){var i,j,p1,p2,p,q,res,lip1=li.point1.coords.usrCoords,lip2=li.point2.coords.usrCoords,cnt=0,len=cu.numberPoints,ev_sf=Type.evaluate(li.visProp.straightfirst),ev_sl=Type.evaluate(li.visProp.straightlast);for(q=new Coords(Const.COORDS_BY_USER,[0,NaN,NaN],board),0===lip1[0]?lip1=[1,lip2[1]+li.stdform[2],lip2[2]-li.stdform[1]]:0===lip2[0]&&(lip2=[1,lip1[1]+li.stdform[2],lip1[2]-li.stdform[1]]),p2=cu.points[0].usrCoords,i=1;i<len;i+=cu.bezierDegree)if(p1=p2.slice(0),p2=cu.points[i].usrCoords,this.distance(p1,p2)>Mat.eps)for(res=3===cu.bezierDegree?this.meetBeziersegmentBeziersegment([cu.points[i-1].usrCoords.slice(1),cu.points[i].usrCoords.slice(1),cu.points[i+1].usrCoords.slice(1),cu.points[i+2].usrCoords.slice(1)],[lip1.slice(1),lip2.slice(1)],testSegment):[this.meetSegmentSegment(p1,p2,lip1,lip2)],j=0;j<res.length;j++)if(0<=(p=res[j])[1]&&p[1]<=1){if(cnt===nr)return testSegment&&(!ev_sf&&p[2]<0||!ev_sl&&p[2]>1)?q:q=new Coords(Const.COORDS_BY_USER,p[0],board);cnt+=1}return q},meetCurveRedBlueSegments:function(red,blue,nr){var i,j,red1,red2,blue1,blue2,m,minX,maxX,iFound=0,lenBlue=blue.numberPoints,lenRed=red.numberPoints;if(lenBlue<=1||lenRed<=1)return[0,NaN,NaN];for(i=1;i<lenRed;i++)for(red1=red.points[i-1].usrCoords,red2=red.points[i].usrCoords,minX=Math.min(red1[1],red2[1]),maxX=Math.max(red1[1],red2[1]),blue2=blue.points[0].usrCoords,j=1;j<lenBlue;j++)if(blue1=blue2,blue2=blue.points[j].usrCoords,Math.min(blue1[1],blue2[1])<maxX&&Math.max(blue1[1],blue2[1])>minX&&(m=this.meetSegmentSegment(red1,red2,blue1,blue2))[1]>=0&&m[2]>=0&&(m[1]<1&&m[2]<1||i===lenRed-1&&1===m[1]||j===lenBlue-1&&1===m[2])){if(iFound===nr)return m[0];iFound++}return[0,NaN,NaN]},meetSegmentSegment:function(p1,p2,q1,q2){var t,i,d,li1=Mat.crossProduct(p1,p2),li2=Mat.crossProduct(q1,q2),c=Mat.crossProduct(li1,li2);return Math.abs(c[0])<Mat.eps?[c,1/0,1/0]:(c[1]/=c[0],c[2]/=c[0],c[0]/=c[0],d=p1[i=Math.abs(p2[1]-p2[0]*p1[1])<Mat.eps?2:1]/p1[0],t=(c[i]-d)/(0!==p2[0]?p2[i]/p2[0]-d:p2[i]),d=q1[i=Math.abs(q2[1]-q2[0]*q1[1])<Mat.eps?2:1]/q1[0],[c,t,(c[i]-d)/(0!==q2[0]?q2[i]/q2[0]-d:q2[i])])},meetPathPath:function(path1,path2,nr,board){var S,C,len,intersections;return(len=(S=JXG.Math.Clip._getPath(path1,board)).length)>0&&this.distance(S[0].coords.usrCoords,S[len-1].coords.usrCoords,3)<Mat.eps&&S.pop(),(len=(C=JXG.Math.Clip._getPath(path2,board)).length)>0&&this.distance(C[0].coords.usrCoords,C[len-1].coords.usrCoords,3)<Mat.eps*Mat.eps&&C.pop(),nr<0||JXG.Math.Clip.isEmptyCase(S,C,"intersection")?new Coords(Const.COORDS_BY_USER,[0,0,0],board):(JXG.Math.Clip.makeDoublyLinkedList(S),JXG.Math.Clip.makeDoublyLinkedList(C),nr<(intersections=JXG.Math.Clip.findIntersections(S,C,board)[0]).length?intersections[nr].coords:new Coords(Const.COORDS_BY_USER,[0,0,0],board))},meetPolygonLine:function(path,line,nr,board,alwaysIntersect){var i,res,border,crds=[0,0,0],len=path.borders.length,intersections=[];for(i=0;i<len;i++)border=path.borders[i],res=this.meetSegmentSegment(border.point1.coords.usrCoords,border.point2.coords.usrCoords,line.point1.coords.usrCoords,line.point2.coords.usrCoords),(!alwaysIntersect||res[2]>=0&&res[2]<1)&&res[1]>=0&&res[1]<1&&intersections.push(res[0]);return nr>=0&&nr<intersections.length&&(crds=intersections[nr]),new Coords(Const.COORDS_BY_USER,crds,board)},_bezierSplit:function(curve){var p0,p1,p2,p00,p22,p000;return p0=[.5*(curve[0][0]+curve[1][0]),.5*(curve[0][1]+curve[1][1])],p1=[.5*(curve[1][0]+curve[2][0]),.5*(curve[1][1]+curve[2][1])],p2=[.5*(curve[2][0]+curve[3][0]),.5*(curve[2][1]+curve[3][1])],p000=[.5*((p00=[.5*(p0[0]+p1[0]),.5*(p0[1]+p1[1])])[0]+(p22=[.5*(p1[0]+p2[0]),.5*(p1[1]+p2[1])])[0]),.5*(p00[1]+p22[1])],[[curve[0],p0,p00,p000],[p000,p22,p2,curve[3]]]},_bezierBbox:function(curve){var bb=[];return 4===curve.length?(bb[0]=Math.min(curve[0][0],curve[1][0],curve[2][0],curve[3][0]),bb[1]=Math.max(curve[0][1],curve[1][1],curve[2][1],curve[3][1]),bb[2]=Math.max(curve[0][0],curve[1][0],curve[2][0],curve[3][0]),bb[3]=Math.min(curve[0][1],curve[1][1],curve[2][1],curve[3][1])):(bb[0]=Math.min(curve[0][0],curve[1][0]),bb[1]=Math.max(curve[0][1],curve[1][1]),bb[2]=Math.max(curve[0][0],curve[1][0]),bb[3]=Math.min(curve[0][1],curve[1][1])),bb},_bezierOverlap:function(bb1,bb2){return bb1[2]>=bb2[0]&&bb1[0]<=bb2[2]&&bb1[1]>=bb2[3]&&bb1[3]<=bb2[1]},_bezierListConcat:function(L,Lnew,t1,t2){var i,t2exists=Type.exists(t2),start=0,len=Lnew.length,le=L.length;for(le>0&&len>0&&(1===L[le-1][1]&&0===Lnew[0][1]||t2exists&&1===L[le-1][2]&&0===Lnew[0][2])&&(start=1),i=start;i<len;i++)t2exists&&(Lnew[i][2]*=.5,Lnew[i][2]+=t2),Lnew[i][1]*=.5,Lnew[i][1]+=t1,L.push(Lnew[i])},_bezierMeetSubdivision:function(red,blue,level){var bbb,bbr,ar,b0,b1,r0,r1,m,p0,p1,q0,q1,L=[];return bbr=this._bezierBbox(blue),bbb=this._bezierBbox(red),this._bezierOverlap(bbr,bbb)?level<5?(r0=(ar=this._bezierSplit(red))[0],r1=ar[1],b0=(ar=this._bezierSplit(blue))[0],b1=ar[1],this._bezierListConcat(L,this._bezierMeetSubdivision(r0,b0,level+1),0,0),this._bezierListConcat(L,this._bezierMeetSubdivision(r0,b1,level+1),0,.5),this._bezierListConcat(L,this._bezierMeetSubdivision(r1,b0,level+1),.5,0),this._bezierListConcat(L,this._bezierMeetSubdivision(r1,b1,level+1),.5,.5),L):(q0=[1].concat(red[0]),q1=[1].concat(red[3]),p0=[1].concat(blue[0]),p1=[1].concat(blue[3]),(m=this.meetSegmentSegment(q0,q1,p0,p1))[1]>=0&&m[2]>=0&&m[1]<=1&&m[2]<=1?[m]:[]):[]},_bezierLineMeetSubdivision:function(red,blue,level,testSegment){var bbb,bbr,ar,r0,r1,m,p0,p1,q0,q1,L=[];return bbb=this._bezierBbox(blue),bbr=this._bezierBbox(red),testSegment&&!this._bezierOverlap(bbr,bbb)?[]:level<5?(r0=(ar=this._bezierSplit(red))[0],r1=ar[1],this._bezierListConcat(L,this._bezierLineMeetSubdivision(r0,blue,level+1),0),this._bezierListConcat(L,this._bezierLineMeetSubdivision(r1,blue,level+1),.5),L):(q0=[1].concat(red[0]),q1=[1].concat(red[3]),p0=[1].concat(blue[0]),p1=[1].concat(blue[1]),(m=this.meetSegmentSegment(q0,q1,p0,p1))[1]>=0&&m[1]<=1&&(!testSegment||m[2]>=0&&m[2]<=1)?[m]:[])},meetBeziersegmentBeziersegment:function(red,blue,testSegment){var L,L2,i;for((L=4===red.length&&4===blue.length?this._bezierMeetSubdivision(red,blue,0):this._bezierLineMeetSubdivision(red,blue,0,testSegment)).sort((function(a,b){return 1e7*(a[1]-b[1])+(a[2]-b[2])})),L2=[],i=0;i<L.length;i++)0!==i&&L[i][1]===L[i-1][1]&&L[i][2]===L[i-1][2]||L2.push(L[i]);return L2},meetBezierCurveRedBlueSegments:function(red,blue,nr){var p,i,j,k,po,redArr,blueArr,bbr,bbb,intersections,startRed=0,startBlue=0,lenBlue=blue.numberPoints,lenRed=red.numberPoints,L=[];if(lenBlue<blue.bezierDegree+1||lenRed<red.bezierDegree+1)return[0,NaN,NaN];for(lenBlue-=blue.bezierDegree,lenRed-=red.bezierDegree,red.type===Const.OBJECT_TYPE_SECTOR&&(startRed=3,lenRed-=3),blue.type===Const.OBJECT_TYPE_SECTOR&&(startBlue=3,lenBlue-=3),i=startRed;i<lenRed;i+=red.bezierDegree)for(redArr=[(p=red.points)[i].usrCoords.slice(1),p[i+1].usrCoords.slice(1)],3===red.bezierDegree&&(redArr[2]=p[i+2].usrCoords.slice(1),redArr[3]=p[i+3].usrCoords.slice(1)),bbr=this._bezierBbox(redArr),j=startBlue;j<lenBlue;j+=blue.bezierDegree)if(blueArr=[(p=blue.points)[j].usrCoords.slice(1),p[j+1].usrCoords.slice(1)],3===blue.bezierDegree&&(blueArr[2]=p[j+2].usrCoords.slice(1),blueArr[3]=p[j+3].usrCoords.slice(1)),bbb=this._bezierBbox(blueArr),this._bezierOverlap(bbr,bbb)){if(0===(intersections=this.meetBeziersegmentBeziersegment(redArr,blueArr)).length)continue;for(k=0;k<intersections.length;k++)(po=intersections[k])[1]<-Mat.eps||po[1]>1+Mat.eps||po[2]<-Mat.eps||po[2]>1+Mat.eps||L.push(po);if(L.length>nr)return L[nr][0]}return L.length>nr?L[nr][0]:[0,NaN,NaN]},bezierSegmentEval:function(t,curve){var f,x,y,t1=1-t;return x=0,y=0,x+=(f=t1*t1*t1)*curve[0][0],y+=f*curve[0][1],x+=(f=3*t*t1*t1)*curve[1][0],y+=f*curve[1][1],x+=(f=3*t*t*t1)*curve[2][0],y+=f*curve[2][1],[1,x+=(f=t*t*t)*curve[3][0],y+=f*curve[3][1]]},bezierArc:function(A,B,C,withLegs,sgn){var p1,p2,p3,p4,r,phi,beta,co,si,ax,ay,bx,by,k,v,d,matrix,PI2=.5*Math.PI,x=B[1],y=B[2],z=B[0],dataX=[],dataY=[];for(r=this.distance(B,A),x/=z,y/=z,phi=this.rad(A.slice(1),B.slice(1),C.slice(1)),-1===sgn&&(phi=2*Math.PI-phi),(p1=A)[1]/=p1[0],p1[2]/=p1[0],p1[0]/=p1[0],p4=p1.slice(0),withLegs?(dataX=[x,x+.333*(p1[1]-x),x+.666*(p1[1]-x),p1[1]],dataY=[y,y+.333*(p1[2]-y),y+.666*(p1[2]-y),p1[2]]):(dataX=[p1[1]],dataY=[p1[2]]);phi>Mat.eps;)phi>PI2?(beta=PI2,phi-=PI2):(beta=phi,phi=0),matrix=[[1,0,0],[x*(1-(co=Math.cos(sgn*beta)))+y*(si=Math.sin(sgn*beta)),co,-si],[y*(1-co)-x*si,si,co]],p4=[(v=Mat.matVecMult(matrix,p1))[0]/v[0],v[1]/v[0],v[2]/v[0]],ax=p1[1]-x,ay=p1[2]-y,bx=p4[1]-x,by=p4[2]-y,d=Math.sqrt((ax+bx)*(ax+bx)+(ay+by)*(ay+by)),k=Math.abs(by-ay)>Mat.eps?(ax+bx)*(r/d-.5)/(by-ay)*8/3:(ay+by)*(r/d-.5)/(ax-bx)*8/3,p2=[1,p1[1]-k*ay,p1[2]+k*ax],p3=[1,p4[1]+k*by,p4[2]-k*bx],dataX=dataX.concat([p2[1],p3[1],p4[1]]),dataY=dataY.concat([p2[2],p3[2],p4[2]]),p1=p4.slice(0);return withLegs&&(dataX=dataX.concat([p4[1]+.333*(x-p4[1]),p4[1]+.666*(x-p4[1]),x]),dataY=dataY.concat([p4[2]+.333*(y-p4[2]),p4[2]+.666*(y-p4[2]),y])),[dataX,dataY]},projectPointToCircle:function(point,circle,board){var dist,P,x,y,factor,M=circle.center.coords.usrCoords;return Type.exists(board)||(board=point.board),Type.isPoint(point)?(dist=point.coords.distance(Const.COORDS_BY_USER,circle.center.coords),P=point.coords.usrCoords):(dist=point.distance(Const.COORDS_BY_USER,circle.center.coords),P=point.usrCoords),Math.abs(dist)<Mat.eps&&(dist=Mat.eps),factor=circle.Radius()/dist,x=M[1]+factor*(P[1]-M[1]),y=M[2]+factor*(P[2]-M[2]),new Coords(Const.COORDS_BY_USER,[x,y],board)},projectPointToLine:function(point,line,board){var coords,v=[0,line.stdform[1],line.stdform[2]];return Type.exists(board)||(board=Type.exists(point.coords)?point.board:line.board),coords=Type.exists(point.coords)?point.coords.usrCoords:point.usrCoords,v=Mat.crossProduct(v,coords),new Coords(Const.COORDS_BY_USER,Mat.crossProduct(v,line.stdform),board)},projectCoordsToSegment:function(p,q1,q2){var t,s=[q2[1]-q1[1],q2[2]-q1[2]],v=[p[1]-q1[1],p[2]-q1[2]];return Math.abs(s[0])<Mat.eps&&Math.abs(s[1])<Mat.eps?[q1,0]:(t=Mat.innerProduct(v,s),[[1,(t/=Mat.innerProduct(s,s))*s[0]+q1[1],t*s[1]+q1[2]],t])},projectCoordsToBeziersegment:function(pos,curve,start){var t0;return t0=JXG.Math.Numerics.fminbr((function(t){var z=[1,curve.X(start+t),curve.Y(start+t)];return z[1]-=pos[1],z[2]-=pos[2],z[1]*z[1]+z[2]*z[2]}),[0,1]),[[1,curve.X(t0+start),curve.Y(t0+start)],t0]},projectPointToCurve:function(point,curve,board){Type.exists(board)||(board=point.board);var x=point.X(),y=point.Y(),t=point.position||0;return this.projectCoordsToCurve(x,y,t,curve,board)},projectCoordsToCurve:function(x,y,t,curve,board){var newCoords,newCoordsObj,i,j,mindist,dist,lbda,v,coords,d,p1,p2,res,minfunc,t_new,f_new,f_old,delta,minX,maxX,infty=Number.POSITIVE_INFINITY;if(Type.exists(board)||(board=curve.board),"plot"===Type.evaluate(curve.visProp.curvetype)){if(t=0,mindist=infty,newCoords=0===curve.numberPoints?[0,1,1]:[curve.Z(0),curve.X(0),curve.Y(0)],curve.numberPoints>1)for(v=[1,x,y],3===curve.bezierDegree?j=0:p1=[curve.Z(0),curve.X(0),curve.Y(0)],i=0;i<curve.numberPoints-1;i++)3===curve.bezierDegree?res=this.projectCoordsToBeziersegment(v,curve,j):(p2=[curve.Z(i+1),curve.X(i+1),curve.Y(i+1)],res=this.projectCoordsToSegment(v,p1,p2)),lbda=res[1],coords=res[0],0<=lbda&&lbda<=1?(dist=this.distance(coords,v),d=i+lbda):lbda<0?(coords=p1,dist=this.distance(p1,v),d=i):lbda>1&&i===curve.numberPoints-2&&(coords=p2,dist=this.distance(coords,v),d=curve.numberPoints-1),dist<mindist&&(mindist=dist,t=d,newCoords=coords),3===curve.bezierDegree?(j++,i+=2):p1=p2;newCoordsObj=new Coords(Const.COORDS_BY_USER,newCoords,board)}else{for(minfunc=function(t){var dx,dy;return t<curve.minX()||t>curve.maxX()?1/0:(dx=x-curve.X(t))*dx+(dy=y-curve.Y(t))*dy},f_old=minfunc(t),50,minX=curve.minX(),delta=((maxX=curve.maxX())-minX)/50,t_new=minX,i=0;i<50;i++)((f_new=minfunc(t_new))<f_old||f_old===1/0)&&(t=t_new,f_old=f_new),t_new+=delta;t=(t=(t=Numerics.fminbr(minfunc,[Math.max(t-delta,minX),Math.min(t+delta,maxX)]))<minX?minX:t)>maxX?maxX:t,newCoordsObj=new Coords(Const.COORDS_BY_USER,[curve.X(t),curve.Y(t)],board)}return[curve.updateTransform(newCoordsObj),t]},projectCoordsToPolygon:function(p,pol){var i,d,projection,proj,bestprojection,len=pol.vertices.length,d_best=1/0;for(i=0;i<len-1;i++)0<=(projection=JXG.Math.Geometry.projectCoordsToSegment(p,pol.vertices[i].coords.usrCoords,pol.vertices[i+1].coords.usrCoords))[1]&&projection[1]<=1?(d=JXG.Math.Geometry.distance(projection[0],p,3),proj=projection[0]):projection[1]<0?(d=JXG.Math.Geometry.distance(pol.vertices[i].coords.usrCoords,p,3),proj=pol.vertices[i].coords.usrCoords):(d=JXG.Math.Geometry.distance(pol.vertices[i+1].coords.usrCoords,p,3),proj=pol.vertices[i+1].coords.usrCoords),d<d_best&&(bestprojection=proj.slice(0),d_best=d);return bestprojection},projectPointToTurtle:function(point,turtle,board){var newCoords,t,x,y,i,dist,el,minEl,res,newPos,np=0,npmin=0,mindist=Number.POSITIVE_INFINITY,len=turtle.objects.length;for(Type.exists(board)||(board=point.board),i=0;i<len;i++)(el=turtle.objects[i]).elementClass===Const.OBJECT_CLASS_CURVE&&(newCoords=(res=this.projectPointToCurve(point,el))[0],newPos=res[1],(dist=this.distance(newCoords.usrCoords,point.coords.usrCoords))<mindist&&(x=newCoords.usrCoords[1],y=newCoords.usrCoords[2],t=newPos,mindist=dist,minEl=el,npmin=np),np+=el.numberPoints);return newCoords=new Coords(Const.COORDS_BY_USER,[x,y],board),[minEl.updateTransform(newCoords),t+npmin]},projectPointToPoint:function(point,dest){return dest.coords},projectPointToBoard:function(point,board){var i,l,c,brd=board||point.board,config=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],coords=point.coords||point,bbox=brd.getBoundingBox();for(i=0;i<4;i++)(c=config[i])[0]*coords.usrCoords[c[1]]<c[0]*bbox[c[2]]&&((l=Mat.crossProduct([1,bbox[c[3]],bbox[c[4]]],[1,bbox[c[5]],bbox[c[6]]]))[3]=0,l=Mat.normalize(l),coords=this.projectPointToLine({coords:coords},{stdform:l},brd));return coords},distPointLine:function(point,line){var nom,a=line[1],b=line[2],c=line[0];return Math.abs(a)+Math.abs(b)<Mat.eps?Number.POSITIVE_INFINITY:(nom=a*point[1]+b*point[2]+c,a*=a,b*=b,Math.abs(nom)/Math.sqrt(a+b))},reuleauxPolygon:function(points,nr){var beta,pi2=2*Math.PI,pi2_n=pi2/nr,diag=(nr-1)/2,d=0,makeFct=function(which,trig){return function(t,suspendUpdate){var t1=(t%pi2+pi2)%pi2,j=Math.floor(t1/pi2_n)%nr;return suspendUpdate||(d=points[0].Dist(points[diag]),beta=Mat.Geometry.rad([points[0].X()+1,points[0].Y()],points[0],points[diag%nr])),isNaN(j)?j:(t1=.5*t1+j*pi2_n*.5+beta,points[j][which]()+d*Math[trig](t1))}};return[makeFct("X","cos"),makeFct("Y","sin"),0,pi2]},meet3Planes:function(n1,d1,n2,d2,n3,d3){var n31,n12,n23,denom,i,p=[0,0,0];for(n31=Mat.crossProduct(n3,n1),n12=Mat.crossProduct(n1,n2),n23=Mat.crossProduct(n2,n3),denom=Mat.innerProduct(n1,n23,3),i=0;i<3;i++)p[i]=(d1*n23[i]+d2*n31[i]+d3*n12[i])/denom;return p},meetPlanePlane:function(v11,v12,v21,v22){var i,no1,no2,v=[0,0,0],w=[0,0,0];for(i=0;i<3;i++)v[i]=Type.evaluate(v11[i]),w[i]=Type.evaluate(v12[i]);for(no1=Mat.crossProduct(v,w),i=0;i<3;i++)v[i]=Type.evaluate(v21[i]),w[i]=Type.evaluate(v22[i]);return no2=Mat.crossProduct(v,w),Mat.crossProduct(no1,no2)},project3DTo3DPlane:function(point,normal,foot){var le,lbda;return foot=foot||[0,0,0],le=Mat.norm(normal),lbda=(Mat.innerProduct(point,normal,3)-Mat.innerProduct(foot,normal,3))/le,Mat.axpy(-lbda,normal,point)},getPlaneBounds:function(v1,v2,q,s,e){var s1,s2,mat,rhs,sol;return v1[2]+v2[0]!==0?(mat=[[v1[0],v2[0]],[v1[1],v2[1]]],rhs=[s-q[0],s-q[1]],s1=(sol=Numerics.Gauss(mat,rhs))[0],s2=sol[1],rhs=[e-q[0],e-q[1]],[s1,(sol=Numerics.Gauss(mat,rhs))[0],s2,sol[1]]):null}}),Mat.Geometry})),define("math/plot",["jxg","base/constants","base/coords","math/math","math/extrapolate","math/numerics","math/statistics","math/geometry","math/ia","utils/type"],(function(JXG,Const,Coords,Mat,Extrapolate,Numerics,Statistics,Geometry,IntervalArithmetic,Type){return Mat.Plot={checkReal:function(points){var i,p,b=!1,len=points.length;for(i=0;i<len;i++)if(p=points[i].usrCoords,!isNaN(p[1])&&!isNaN(p[2])&&Math.abs(p[0])>Mat.eps){b=!0;break}return b},updateParametricCurveNaive:function(curve,mi,ma,len){var i,t,suspendUpdate=!1,stepSize=(ma-mi)/len;for(i=0;i<len;i++)t=mi+i*stepSize,curve.points[i].setCoordinates(Const.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1),curve.points[i]._t=t,suspendUpdate=!0;return curve},isSegmentOutside:function(x0,y0,x1,y1,board){return y0<0&&y1<0||y0>board.canvasHeight&&y1>board.canvasHeight||x0<0&&x1<0||x0>board.canvasWidth&&x1>board.canvasWidth},isDistOK:function(dx,dy,MAXX,MAXY){return Math.abs(dx)<MAXX&&Math.abs(dy)<MAXY&&!isNaN(dx+dy)},isSegmentDefined:function(x0,y0,x1,y1){return!(isNaN(x0+y0)&&isNaN(x1+y1))},updateParametricCurveOld:function(curve,mi,ma){var i,t,x,y,x0,y0,top,depth,MAX_DEPTH,MAX_XDIST,MAX_YDIST,suspendUpdate=!1,po=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),dyadicStack=[],depthStack=[],pointStack=[],divisors=[],distOK=!1,j=0,distFromLine=function(p1,p2,p0){var lbda,d,x0=p0[1]-p1[1],y0=p0[2]-p1[2],x1=p2[0]-p1[1],y1=p2[1]-p1[2],den=x1*x1+y1*y1;return den>=Mat.eps&&(lbda=(x0*x1+y0*y1)/den)>0&&(lbda<=1?(x0-=lbda*x1,y0-=lbda*y1):(x0-=x1,y0-=y1)),d=x0*x0+y0*y0,Math.sqrt(d)};for(JXG.deprecated("Curve.updateParametricCurveOld()"),curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW?(MAX_DEPTH=15,MAX_XDIST=10,MAX_YDIST=10):(MAX_DEPTH=21,MAX_XDIST=.7,MAX_YDIST=.7),divisors[0]=ma-mi,i=1;i<MAX_DEPTH;i++)divisors[i]=.5*divisors[i-1];i=1,dyadicStack[0]=1,depthStack[0]=0,t=mi,po.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1),suspendUpdate=!0,x0=po.scrCoords[1],y0=po.scrCoords[2],t=ma,po.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1),x=po.scrCoords[1],y=po.scrCoords[2],pointStack[0]=[x,y],top=1,depth=0,curve.points=[],curve.points[j++]=new Coords(Const.COORDS_BY_SCREEN,[x0,y0],curve.board,!1);do{for(distOK=this.isDistOK(x-x0,y-y0,MAX_XDIST,MAX_YDIST)||this.isSegmentOutside(x0,y0,x,y,curve.board);depth<MAX_DEPTH&&(!distOK||depth<6)&&(depth<=7||this.isSegmentDefined(x0,y0,x,y));)dyadicStack[top]=i,depthStack[top]=depth,pointStack[top]=[x,y],top+=1,t=mi+(i=2*i-1)*divisors[++depth],po.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1,!0),x=po.scrCoords[1],y=po.scrCoords[2],distOK=this.isDistOK(x-x0,y-y0,MAX_XDIST,MAX_YDIST)||this.isSegmentOutside(x0,y0,x,y,curve.board);j>1&&distFromLine(curve.points[j-2].scrCoords,[x,y],curve.points[j-1].scrCoords)<.015&&(j-=1),curve.points[j]=new Coords(Const.COORDS_BY_SCREEN,[x,y],curve.board,!1),curve.points[j]._t=t,j+=1,x0=x,y0=y,t,x=pointStack[top-=1][0],y=pointStack[top][1],depth=depthStack[top]+1,i=2*dyadicStack[top]}while(top>0&&j<5e5);return curve.numberPoints=curve.points.length,curve},_insertPoint_v2:function(curve,pnt,t){var lastReal=!isNaN(this._lastCrds[1]+this._lastCrds[2]),newReal=!isNaN(pnt.scrCoords[1]+pnt.scrCoords[2]),cw=curve.board.canvasWidth,ch=curve.board.canvasHeight;(!(newReal=newReal&&pnt.scrCoords[1]>-500&&pnt.scrCoords[2]>-500&&pnt.scrCoords[1]<cw+500&&pnt.scrCoords[2]<ch+500)&&lastReal||newReal&&(!lastReal||Math.abs(pnt.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(pnt.scrCoords[2]-this._lastCrds[2])>.7))&&(pnt._t=t,curve.points.push(pnt),this._lastCrds=pnt.copy("scrCoords"))},neighborhood_isNaN_v2:function(curve,t0){var t,p,pnt=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1);return t=t0+Mat.eps,pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1),p=pnt.usrCoords,!!(isNaN(p[1]+p[2])||(t=t0-Mat.eps,pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1),p=pnt.usrCoords,isNaN(p[1]+p[2])))},_borderCase:function(curve,a,b,c,ta,tb,tc,depth){var t,pnt,p,j,t_nan,t_real,t_real2,p_good=null,is_undef=!1;if(depth<=1){if(pnt=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2])&&!this.neighborhood_isNaN_v2(curve,ta))return!1;if(isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2])&&!this.neighborhood_isNaN_v2(curve,tb))return!1;if(isNaN(c[1]+c[2])&&(!isNaN(a[1]+a[2])||!isNaN(b[1]+b[2]))&&!this.neighborhood_isNaN_v2(curve,tc))return!1;j=0;do{if(isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2]))t_nan=ta,t_real=tc,t_real2=tb;else if(isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2]))t_nan=tb,t_real=tc,t_real2=ta;else if(isNaN(c[1]+c[2])&&!isNaN(b[1]+b[2]))t_nan=tc,t_real=tb,t_real2=tb+(tb-tc);else{if(!isNaN(c[1]+c[2])||isNaN(a[1]+a[2]))return!1;t_nan=tc,t_real=ta,t_real2=ta-(tc-ta)}t=.5*(t_nan+t_real),pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1),p=pnt.usrCoords,(is_undef=isNaN(p[1]+p[2]))?t_nan=t:(t_real2=t_real,t_real=t),++j}while(is_undef&&j<30);if(j<30&&(p_good=p.slice(),c=p.slice(),t_real=t),(curve.X(t_real,!0)-curve.X(t_real2,!0))/(t_real-t_real2),(curve.Y(t_real,!0)-curve.Y(t_real2,!0))/(t_real-t_real2),null!==p_good)return this._insertPoint_v2(curve,new Coords(Const.COORDS_BY_USER,p_good,curve.board,!1)),!0}return!1},_plotRecursive_v2:function(curve,a,ta,b,tb,depth,delta){var tc,c,ds,isSmooth,isJump,mindepth=0,pnt=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1);if(!(curve.numberPoints>65536))return depth<this.nanLevel&&this._isUndefined(curve,a,ta,b,tb)||depth<this.nanLevel&&this._isOutside(a,ta,b,tb,curve.board)?this:(tc=.5*(ta+tb),pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(tc,!0),curve.Y(tc,!0)],!1),c=pnt.scrCoords,this._borderCase(curve,a,b,c,ta,tb,tc,depth)||(ds=this._triangleDists(a,b,c),isSmooth=depth<this.smoothLevel&&ds[3]<delta,isJump=depth<this.jumpLevel&&(ds[2]>.99*ds[0]||ds[1]>.99*ds[0]||ds[0]===1/0||ds[1]===1/0||ds[2]===1/0),depth<this.smoothLevel+2&&ds[0]<.5*(ds[1]+ds[2])&&(mindepth=0,isSmooth=!1),--depth,isJump?this._insertPoint_v2(curve,new Coords(Const.COORDS_BY_SCREEN,[NaN,NaN],curve.board,!1),tc):depth<=mindepth||isSmooth?this._insertPoint_v2(curve,pnt,tc):(this._plotRecursive_v2(curve,a,ta,c,tc,depth,delta),isNaN(pnt.scrCoords[1]+pnt.scrCoords[2])||this._insertPoint_v2(curve,pnt,tc),this._plotRecursive_v2(curve,c,tc,b,tb,depth,delta))),this)},updateParametricCurve_v2:function(curve,mi,ma){var ta,tb,a,b,depth,delta,w2,bbox,ret_arr,suspendUpdate=!1,pa=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),pb=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1);return curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW?(depth=Type.evaluate(curve.visProp.recursiondepthlow)||13,delta=2,this.smoothLevel=depth-6,this.jumpLevel=3):(depth=Type.evaluate(curve.visProp.recursiondepthhigh)||17,delta=2,this.smoothLevel=depth-9,this.jumpLevel=2),this.nanLevel=depth-4,curve.points=[],"x"===this.xterm?(w2=.3*((bbox=curve.board.getBoundingBox())[2]-bbox[0]),.3*(bbox[1]-bbox[3]),ta=Math.max(mi,bbox[0]-w2),tb=Math.min(ma,bbox[2]+w2)):(ta=mi,tb=ma),pa.setCoordinates(Const.COORDS_BY_USER,[curve.X(ta,suspendUpdate),curve.Y(ta,suspendUpdate)],!1),suspendUpdate=!0,pb.setCoordinates(Const.COORDS_BY_USER,[curve.X(tb,suspendUpdate),curve.Y(tb,suspendUpdate)],!1),ret_arr=this._findStartPoint(curve,pa.scrCoords,ta,pb.scrCoords,tb),pa.setCoordinates(Const.COORDS_BY_SCREEN,ret_arr[0],!1),ta=ret_arr[1],ret_arr=this._findStartPoint(curve,pb.scrCoords,tb,pa.scrCoords,ta),pb.setCoordinates(Const.COORDS_BY_SCREEN,ret_arr[0],!1),tb=ret_arr[1],this._visibleArea=[ta,tb],a=pa.copy("scrCoords"),b=pb.copy("scrCoords"),pa._t=ta,curve.points.push(pa),this._lastCrds=pa.copy("scrCoords"),this._plotRecursive_v2(curve,a,ta,b,tb,depth,delta),pb._t=tb,curve.points.push(pb),curve.numberPoints=curve.points.length,curve},_insertLimesPoint:function(curve,pnt,t,depth,limes){var p0,p1,p2;Math.abs(this._lastUsrCrds[1])===1/0&&Math.abs(limes.left_x)===1/0||Math.abs(this._lastUsrCrds[2])===1/0&&Math.abs(limes.left_y)===1/0||((p0=new Coords(Const.COORDS_BY_USER,[limes.left_x,limes.left_y],curve.board))._t=t,curve.points.push(p0),isNaN(limes.left_x)||isNaN(limes.left_y)||isNaN(limes.right_x)||isNaN(limes.right_y)||!(Math.abs(limes.left_x-limes.right_x)>Mat.eps||Math.abs(limes.left_y-limes.right_y)>Mat.eps)||((p1=new Coords(Const.COORDS_BY_SCREEN,pnt,curve.board))._t=t,curve.points.push(p1)),(p2=new Coords(Const.COORDS_BY_USER,[limes.right_x,limes.right_y],curve.board))._t=t,curve.points.push(p2),this._lastScrCrds=p2.copy("scrCoords"),this._lastUsrCrds=p2.copy("usrCoords"))},_insertPoint:function(curve,pnt,t,depth,limes){var p,last_is_real=!isNaN(this._lastScrCrds[1]+this._lastScrCrds[2]),point_is_real=!isNaN(pnt[1]+pnt[2]),cw=curve.board.canvasWidth,ch=curve.board.canvasHeight;Type.exists(limes)?this._insertLimesPoint(curve,pnt,t,depth,limes):(point_is_real=point_is_real&&pnt[1]>-500&&pnt[2]>-500&&pnt[1]<cw+500&&pnt[2]<ch+500,(last_is_real||point_is_real)&&(point_is_real&&last_is_real&&Math.abs(pnt[1]-this._lastScrCrds[1])<.8&&Math.abs(pnt[2]-this._lastScrCrds[2])<.8||Math.abs(pnt[1])===1/0&&Math.abs(this._lastUsrCrds[1])===1/0||Math.abs(pnt[2])===1/0&&Math.abs(this._lastUsrCrds[2])===1/0||((p=new Coords(Const.COORDS_BY_SCREEN,pnt,curve.board))._t=t,curve.points.push(p),this._lastScrCrds=p.copy("scrCoords"),this._lastUsrCrds=p.copy("usrCoords"))))},_triangleDists:function(a,b,c){var d;return d=[a[0]*b[0],.5*(a[1]+b[1]),.5*(a[2]+b[2])],[Geometry.distance(a,b,3),Geometry.distance(a,c,3),Geometry.distance(c,b,3),Geometry.distance(c,d,3)]},_isUndefined:function(curve,a,ta,b,tb){var t,i,pnt;if(!isNaN(a[1]+a[2])||!isNaN(b[1]+b[2]))return!1;for(pnt=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),i=0;i<20;++i)if(t=ta+Math.random()*(tb-ta),pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1),!isNaN(pnt.scrCoords[0]+pnt.scrCoords[1]+pnt.scrCoords[2]))return!1;return!0},_isOutside:function(a,ta,b,tb,board){var cw=board.canvasWidth,ch=board.canvasHeight;return!!(a[1]<-500&&b[1]<-500||a[2]<-500&&b[2]<-500||a[1]>cw+500&&b[1]>cw+500||a[2]>ch+500&&b[2]>ch+500)},_isOutsidePoint:function(a,board){var cw=board.canvasWidth,ch=board.canvasHeight;return!!(a[1]<-500||a[2]<-500||a[1]>cw+500||a[2]>ch+500)},_findStartPoint:function(curve,a,ta,b,tb){new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),curve.board.getBoundingBox();return[a,ta]},_getBorderPos:function(curve,ta,a,tc,c,tb,b){var t,pnt,p,j,t_good,t_bad;if(pnt=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),j=0,isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2]))t_bad=ta,t_good=tc,tb;else if(isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2]))t_bad=tb,t_good=tc,ta;else if(isNaN(c[1]+c[2])&&!isNaN(b[1]+b[2]))t_bad=tc,t_good=tb,tb+(tb-tc);else{if(!isNaN(c[1]+c[2])||isNaN(a[1]+a[2]))return!1;t_bad=tc,t_good=ta,ta-(tc-ta)}do{t=.5*(t_good+t_bad),pnt.setCoordinates(Const.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1),p=pnt.usrCoords,isNaN(p[1]+p[2])?t_bad=t:(t_good,t_good=t),++j}while(j<30&&Math.abs(t_good-t_bad)>Mat.eps);return t},_getCuspPos:function(curve,ta,tb){var a=[curve.X(ta,!0),curve.Y(ta,!0)],b=[curve.X(tb,!0),curve.Y(tb,!0)];return Numerics.fminbr((function(t){var c=[curve.X(t,!0),curve.Y(t,!0)];return-(Math.sqrt((a[0]-c[0])*(a[0]-c[0])+(a[1]-c[1])*(a[1]-c[1]))+Math.sqrt((b[0]-c[0])*(b[0]-c[0])+(b[1]-c[1])*(b[1]-c[1])))}),[ta,tb],curve)},_getJumpPos:function(curve,ta,tb){return Numerics.fminbr((function(t){var e=Mat.eps*Mat.eps,c1=[curve.X(t,!0),curve.Y(t,!0)],c2=[curve.X(t+e,!0),curve.Y(t+e,!0)];return-Math.abs((c2[1]-c1[1])/(c2[0]-c1[0]))}),[ta,tb],curve)},_getLimits:function(curve,t){var res,x_l,x_r,y_l,y_r,step=2/(curve.maxX()-curve.minX());return x_l=(res=Extrapolate.limit(t,-step,curve.X))[0],"infinite"===res[1]&&(x_l=Math.sign(x_l)*(1/0)),y_l=(res=Extrapolate.limit(t,-step,curve.Y))[0],"infinite"===res[1]&&(y_l=Math.sign(y_l)*(1/0)),x_r=(res=Extrapolate.limit(t,step,curve.X))[0],"infinite"===res[1]&&(x_r=Math.sign(x_r)*(1/0)),y_r=(res=Extrapolate.limit(t,step,curve.Y))[0],"infinite"===res[1]&&(y_r=Math.sign(y_r)*(1/0)),{left_x:x_l,left_y:y_l,right_x:x_r,right_y:y_r,t:t}},_getLimes:function(curve,ta,a,tc,c,tb,b,may_be_special,depth){var t;return"border"===may_be_special?t=this._getBorderPos(curve,ta,a,tc,c,tb,b):"cusp"===may_be_special?t=this._getCuspPos(curve,ta,tb):"jump"===may_be_special&&(t=this._getJumpPos(curve,ta,tb)),this._getLimits(curve,t)},_plotNonRecursive:function(curve,a,ta,b,tb,d){var tc,c,ds,a_nan,b_nan,x,y,oc,depth,ds0,item,limes=null,isSmooth=!1,may_be_special="",stack=[],stack_length=0;for(oc=curve.board.origin.scrCoords,stack[stack_length++]=[a,ta,b,tb,d,1/0];stack_length>0;){if(a=(item=stack[--stack_length])[0],ta=item[1],b=item[2],tb=item[3],depth=item[4],ds0=item[5],isSmooth=!1,may_be_special="",limes=null,curve.points.length>65536)return;if(depth<this.nanLevel){if(this._isUndefined(curve,a,ta,b,tb))continue;if(this._isOutside(a,ta,b,tb,curve.board))continue}tc=.5*(ta+tb),x=curve.X(tc,!0),y=curve.Y(tc,!0),c=[1,oc[1]+x*curve.board.unitX,oc[2]-y*curve.board.unitY],ds=this._triangleDists(a,b,c),a_nan=isNaN(a[1]+a[2]),b_nan=isNaN(b[1]+b[2]),a_nan&&!b_nan||!a_nan&&b_nan?may_be_special="border":ds[0]>.66*ds0||ds[0]<this.cusp_threshold*(ds[1]+ds[2])||ds[1]>5*ds[2]||ds[2]>5*ds[1]?may_be_special="cusp":(ds[2]>this.jump_threshold*ds[0]||ds[1]>this.jump_threshold*ds[0]||ds[0]===1/0||ds[1]===1/0||ds[2]===1/0)&&(may_be_special="jump"),isSmooth=""===may_be_special&&depth<this.smoothLevel&&ds[3]<this.smooth_threshold,depth<this.testLevel&&!isSmooth&&(""===may_be_special?isSmooth=!0:limes=this._getLimes(curve,ta,a,tc,c,tb,b,may_be_special,depth)),null!==limes?(c=[1,NaN,NaN],this._insertPoint(curve,c,tc,depth,limes)):depth<=0||isSmooth?this._insertPoint(curve,c,tc,depth,null):(stack[stack_length++]=[c,tc,b,tb,depth-1,ds[0]],stack[stack_length++]=[a,ta,c,tc,depth-1,ds[0]])}return this},updateParametricCurve_v3:function(curve,mi,ma){var ta,tb,a,b,depth,w2,bbox,ret_arr,suspendUpdate=!1,pa=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1),pb=new Coords(Const.COORDS_BY_USER,[0,0],curve.board,!1);return depth=curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW?Type.evaluate(curve.visProp.recursiondepthlow)||14:Type.evaluate(curve.visProp.recursiondepthhigh)||17,this.smoothLevel=7,this.nanLevel=depth-4,this.testLevel=4,this.cusp_threshold=.5,this.jump_threshold=.99,this.smooth_threshold=2,curve.points=[],"x"===curve.xterm?(w2=.3*((bbox=curve.board.getBoundingBox())[2]-bbox[0]),ta=Math.max(mi,bbox[0]-w2),tb=Math.min(ma,bbox[2]+w2)):(ta=mi,tb=ma),pa.setCoordinates(Const.COORDS_BY_USER,[curve.X(ta,suspendUpdate),curve.Y(ta,suspendUpdate)],!1),suspendUpdate=!0,pb.setCoordinates(Const.COORDS_BY_USER,[curve.X(tb,suspendUpdate),curve.Y(tb,suspendUpdate)],!1),ret_arr=this._findStartPoint(curve,pa.scrCoords,ta,pb.scrCoords,tb),pa.setCoordinates(Const.COORDS_BY_SCREEN,ret_arr[0],!1),ta=ret_arr[1],ret_arr=this._findStartPoint(curve,pb.scrCoords,tb,pa.scrCoords,ta),pb.setCoordinates(Const.COORDS_BY_SCREEN,ret_arr[0],!1),tb=ret_arr[1],this._visibleArea=[ta,tb],a=pa.copy("scrCoords"),b=pb.copy("scrCoords"),pa._t=ta,curve.points.push(pa),this._lastScrCrds=pa.copy("scrCoords"),this._lastUsrCrds=pa.copy("usrCoords"),this._plotNonRecursive(curve,a,ta,b,tb,depth),pb._t=tb,curve.points.push(pb),curve.numberPoints=curve.points.length,curve},_criticalInterval:function(vec,le,level){var i,j,le1,med,sgn,sgnChange,abs_vec,isGroup=!1,last=-1/0,very_small=!1,smooth=!1,group=0,groups=[],types=[],positions=[];for(abs_vec=Statistics.abs(vec),(med=Statistics.median(abs_vec))<1e-7?(med=1e-7,very_small=!0):med*=this.criticalThreshold,i=0;i<le;i++)abs_vec[i]>med?(positions.push({i:i,v:vec[i],group:group}),last=i,isGroup||(isGroup=!0)):isGroup&&i>last+4&&(positions.length>0&&groups.push(positions.slice(0)),positions=[],isGroup=!1,group++);for(isGroup&&positions.length>1&&groups.push(positions.slice(0)),very_small&&0===groups.length&&(smooth=!0),j=0;j<groups.length;j++)if(types[j]="point",!((le1=groups[j].length)<64)){for(sgnChange=0,sgn=Math.sign(groups[j][0].v),i=1;i<le1;i++)Math.sign(groups[j][i].v)!==sgn&&(sgnChange++,sgn=Math.sign(groups[j][i].v));6*sgnChange>le1&&(types[j]="interval")}return{smooth:smooth,groups:groups,types:types}},Component:function(){this.left_isNaN=!1,this.right_isNaN=!1,this.left_t=null,this.right_t=null,this.t_values=[],this.x_values=[],this.y_values=[],this.len=0},findComponents:function(curve,mi,ma,steps){var i,t,h,x,y,comp,components=[],comp_nr=0,cnt=0,cntNaNs=0,comp_started=!1,suspended=!1;for(h=(ma-mi)/steps,components[comp_nr]=new this.Component,comp=components[comp_nr],i=0,t=mi;i<=steps;i++,t+=h)x=curve.X(t,suspended),y=curve.Y(t,suspended),isNaN(x)||isNaN(y)?++cntNaNs>1&&comp_started&&(comp.right_isNaN=!0,comp.right_t=t-h,comp.len=cnt,comp_started=!1,components[++comp_nr]=new this.Component,comp=components[comp_nr],cntNaNs=0):(comp_started||(comp_started=!0,cnt=0,cntNaNs>0&&(comp.left_t=t-h,comp.left_isNaN=!0)),cntNaNs=0,comp.t_values[cnt]=t,comp.x_values[cnt]=x,comp.y_values[cnt]=y,cnt++),0===i&&(suspended=!0);return comp_started?comp.len=cnt:components.pop(),components},getPointType:function(curve,pos,t_approx,t_values,x_table,y_table,len){var x_values=x_table[0],y_values=y_table[0],full_len=t_values.length,result={idx:pos,t:t_approx,x:x_values[pos],y:y_values[pos],type:"other"};return pos<5?(result.type="borderleft",result.idx=0,result.t=t_values[0],result.x=x_values[0],result.y=y_values[0],result):pos>len-6?(result.type="borderright",result.idx=full_len-1,result.t=t_values[full_len-1],result.x=x_values[full_len-1],result.y=y_values[full_len-1],result):result},newtonApprox:function(idx,t,h,level,table){var i,s=0;for(i=level;i>0;i--)s=(s+table[i][idx])*(t-(i-1)*h)/i;return s+table[0][idx]},thiele:function(t,recip,t_values,idx,degree){var i,v=0;for(i=degree;i>1;i--)v=(t-t_values[idx+i])/(recip[i][idx+1]-recip[i-2][idx+1]+v);return recip[0][idx+1]+(t-t_values[idx+1])/(recip[1][idx+1]+v)},differenceMethodExperiments:function(component,curve){var i,level,le,up,h,numerator,pos,ma,j,v,groups,t_values=component.t_values,x_values=component.x_values,y_values=component.y_values,x_diffs=[],y_diffs=[],x_slopes=[],y_slopes=[],x_table=[],y_table=[],x_recip=[],y_recip=[],foundCriticalPoint=0,criticalPoints=[];for(h=t_values[1]-t_values[0],x_table.push([]),y_table.push([]),x_recip.push([]),y_recip.push([]),le=y_values.length,i=0;i<le;i++)x_table[0][i]=x_values[i],y_table[0][i]=y_values[i],x_recip[0][i]=x_values[i],y_recip[0][i]=y_values[i];for(x_table.push([]),y_table.push([]),x_recip.push([]),y_recip.push([]),numerator=h,le=y_values.length-1,i=0;i<le;i++)x_diffs[i]=x_values[i+1]-x_values[i],y_diffs[i]=y_values[i+1]-y_values[i],x_slopes[i]=x_diffs[i],y_slopes[i]=y_diffs[i],x_table[1][i]=x_diffs[i],y_table[1][i]=y_diffs[i],x_recip[1][i]=numerator/x_diffs[i],y_recip[1][i]=numerator/y_diffs[i];for(le--,up=Math.min(8,y_values.length-1),level=1;level<up;level++){for(x_table.push([]),y_table.push([]),x_recip.push([]),y_recip.push([]),numerator*=h,i=0;i<le;i++)x_diffs[i]=x_diffs[i+1]-x_diffs[i],y_diffs[i]=y_diffs[i+1]-y_diffs[i],x_table[level+1][i]=x_diffs[i],y_table[level+1][i]=y_diffs[i],x_recip[level+1][i]=numerator/(x_recip[level][i+1]-x_recip[level][i])+x_recip[level-1][i+1],y_recip[level+1][i]=numerator/(y_recip[level][i+1]-y_recip[level][i])+y_recip[level-1][i+1];if(!1===(groups=this._criticalPoints(y_diffs,le,level))){console.log("Polynomial of degree",level),groups=[];break}if(groups.length>0&&++foundCriticalPoint>1&&level%2==0)break;le--}for(i=0;i<groups.length;i++){for(ma=-1/0,j=0;j<groups[i].length;j++)(v=Math.abs(groups[i][j].v))>ma&&(ma=v,pos=j);pos=Math.floor(groups[i][pos].i+level/2),criticalPoints.push(this.getPointType(curve,pos,t_values,x_values,y_values,x_slopes,y_slopes,le+1))}return[criticalPoints,x_table,y_table,x_recip,y_recip]},getCenterOfCriticalInterval:function(group,degree,t_values){var ma,j,pos,v,pos_mean,num=0,den=0,h=t_values[1]-t_values[0],range=[];for(ma=-1/0,range=[],j=0;j<group.length;j++)(v=Math.abs(group[j].v))>ma?(range=[j],ma=v,pos=j):ma===v&&range.push(j);if(range.length>0&&(pos_mean=range.reduce((function(total,val){return total+val}),0)/range.length,pos=Math.floor(pos_mean),pos_mean+=group[0].i),ma<1/0){for(j=0;j<group.length;j++)num+=Math.abs(group[j].v)*group[j].i,den+=Math.abs(group[j].v);pos_mean=num/den}return pos_mean+=degree/2,[group[pos].i+degree/2,pos_mean,t_values[Math.floor(pos_mean)]+h*(pos_mean-Math.floor(pos_mean))]},differenceMethod:function(component,curve){var i,level,le,up,pos,res,res_x,res_y,t_approx,types,t_values=component.t_values,x_values=component.x_values,y_values=component.y_values,x_table=[],y_table=[],foundCriticalPoint=0,degree_x=-1,degree_y=-1,groups=[],criticalPoints=[];for(le=y_values.length,x_table.push(new Float64Array(x_values)),y_table.push(new Float64Array(y_values)),le--,up=Math.min(12,le),level=0;level<up&&(x_table.push(new Float64Array(le)),y_table.push(new Float64Array(le)),x_table[level+1]=x_table[level].map((function(v,idx,arr){return arr[idx+1]-v})),y_table[level+1]=y_table[level].map((function(v,idx,arr){return arr[idx+1]-v})),!0===(res_y=this._criticalInterval(y_table[level+1],le,level)).smooth&&(degree_y=level,groups=[]),res_x=this._criticalInterval(x_table[level+1],le,level),-1===degree_x&&!0===res_x.smooth&&(degree_x=level),!(degree_y>=0));level++){if(res_y.groups.length>0&&++foundCriticalPoint>2&&(level+1)%2==0){groups=res_y.groups,types=res_y.types;break}le--}for(i=0;i<groups.length;i++)"interval"!==types[i]&&(res=this.getCenterOfCriticalInterval(groups[i],level+1,t_values),res_y[0],pos=Math.floor(res[1]),t_approx=res[2],criticalPoints.push(this.getPointType(curve,pos,t_approx,t_values,x_table,y_table,le+1)));return[criticalPoints,x_table,y_table,degree_x,degree_y]},_insertPoint_v4:function(curve,crds,t,doLog){var p,x,y,prev=null;curve.points.length>0&&(prev=curve.points[curve.points.length-1].scrCoords),p=new Coords(Const.COORDS_BY_USER,crds,curve.board),null!==prev&&(x=p.scrCoords[1]-prev[1])*x+(y=p.scrCoords[2]-prev[2])*y<.8*.8||(p._t=t,curve.points.push(p))},getInterval:function(curve,ta,tb){var t_int,y_int;return IntervalArithmetic.disable(),t_int=IntervalArithmetic.Interval(ta,tb),curve.board.mathLib=IntervalArithmetic,curve.board.mathLibJXG=IntervalArithmetic,curve.X(t_int,!0),y_int=curve.Y(t_int,!0),curve.board.mathLib=Math,curve.board.mathLibJXG=JXG.Math,y_int},sign:function(v){return v<0?-1:v>0?1:0},handleBorder:function(curve,comp,group,x_table,y_table){var t,t1,t2,y_int,x,y,lo,hi,i,components2,le,h,idx=group.idx;if(h=comp.t_values[1]-comp.t_values[0],"borderleft"===group.type?t2=(t1=t=comp.left_isNaN?comp.left_t:group.t-h)+h:"borderright"===group.type?t1=(t2=t=comp.right_isNaN?comp.right_t:group.t+h)-h:console.log("No bordercase!!!"),0!==(components2=this.findComponents(curve,t1,t2,32)).length){for("borderleft"===group.type&&(t1=components2[0].left_t,t2=components2[0].t_values[0],h=components2[0].t_values[1]-components2[0].t_values[0],t=t1=null===t1?t2-h:t1,y_int=this.getInterval(curve,t1,t2),Type.isObject(y_int)&&(lo=y_int.lo,hi=y_int.hi,x=curve.X(t,!0),y=y_table[1][idx]<0?hi:lo,this._insertPoint_v4(curve,[1,x,y],t))),le=components2[0].t_values.length,i=0;i<le;i++)t=components2[0].t_values[i],x=components2[0].x_values[i],y=components2[0].y_values[i],this._insertPoint_v4(curve,[1,x,y],t);"borderright"===group.type&&(t1=components2[0].t_values[le-1],t2=components2[0].right_t,h=components2[0].t_values[1]-components2[0].t_values[0],t=t2=null===t2?t1+h:t2,y_int=this.getInterval(curve,t1,t2),Type.isObject(y_int)&&(lo=y_int.lo,hi=y_int.hi,x=curve.X(t,!0),y=y_table[1][idx]>0?hi:lo,this._insertPoint_v4(curve,[1,x,y],t)))}},_seconditeration_v4:function(curve,comp,group,x_table,y_table){var i,t1,t2,ret,components2,comp2,idx,groups2,g,x_table2,y_table2,start,le;for(t1=comp.t_values[group.idx-2],t2=comp.t_values[group.idx+2],components2=this.findComponents(curve,t1,t2,64),idx=0;idx<components2.length;idx++){for(comp2=components2[idx],groups2=(ret=this.differenceMethod(comp2,curve))[0],x_table2=ret[1],y_table2=ret[2],start=0,g=0;g<=groups2.length;g++){for(le=g===groups2.length?comp2.len:groups2[g].idx,i=start;i<le;i++)isNaN(comp2.x_values[i])||isNaN(comp2.y_values[i])||this._insertPoint_v4(curve,[1,comp2.x_values[i],comp2.y_values[i]],comp2.t_values[i]);g<groups2.length&&(this.handleSingularity(curve,comp2,groups2[g],x_table2,y_table2),start=groups2[g].idx+1)}le=comp2.len,idx<components2.length-1&&this._insertPoint_v4(curve,[1,NaN,NaN],comp2.right_t)}return this},_recurse_v4:function(curve,t1,t2,x1,y1,x2,y2,level){var dx,dy,t=.5*(t1+t2),x=curve.X(t,!0),y=curve.Y(t,!0);0!==level?(dx=(x-x1)*curve.board.unitX,dy=(y-y1)*curve.board.unitY,Math.sqrt(dx*dx+dy*dy)>2?this._recurse_v4(curve,t1,t,x1,y1,x,y,level-1):this._insertPoint_v4(curve,[1,x,y],t),dx=(x-x2)*curve.board.unitX,dy=(y-y2)*curve.board.unitY,Math.sqrt(dx*dx+dy*dy)>2?this._recurse_v4(curve,t,t2,x,y,x2,y2,level-1):this._insertPoint_v4(curve,[1,x,y],t)):this._insertPoint_v4(curve,[1,NaN,NaN],t)},handleSingularity:function(curve,comp,group,x_table,y_table){var t,t1,t2,y_int,i1,i2,x,lo,hi,d_lft,d_rgt,idx=group.idx;t=group.t,console.log("HandleSingularity at t =",t),t1=comp.t_values[idx-5],t2=comp.t_values[idx+5],y_int=this.getInterval(curve,t1,t2),Type.isObject(y_int)?(lo=y_int.lo,hi=y_int.hi):y_table[0][idx-1]<y_table[0][idx+1]?(lo=y_table[0][idx-1],hi=y_table[0][idx+1]):(lo=y_table[0][idx+1],hi=y_table[0][idx-1]),x=curve.X(t,!0),d_lft=(y_table[0][idx-3]-y_table[0][idx-5])/(comp.t_values[idx-3]-comp.t_values[idx-5]),d_rgt=(y_table[0][idx+3]-y_table[0][idx+5])/(comp.t_values[idx+3]-comp.t_values[idx+5]),console.log(":::",d_lft,d_rgt),d_lft<-100?(this._insertPoint_v4(curve,[1,x,lo],t,!0),d_rgt<=100&&this._insertPoint_v4(curve,[1,NaN,NaN],t)):d_lft>100?(this._insertPoint_v4(curve,[1,x,hi],t),d_rgt>=-100&&this._insertPoint_v4(curve,[1,NaN,NaN],t)):(lo===-1/0&&(this._insertPoint_v4(curve,[1,x,lo],t,!0),this._insertPoint_v4(curve,[1,NaN,NaN],t)),hi===1/0&&(this._insertPoint_v4(curve,[1,NaN,NaN],t),this._insertPoint_v4(curve,[1,x,hi],t,!0)),group.t<comp.t_values[idx]?(i1=idx-1,i2=idx):(i1=idx,i2=idx+1),t1=comp.t_values[i1],t2=comp.t_values[i2],this._recurse_v4(curve,t1,t2,x_table[0][i1],y_table[0][i1],x_table[0][i2],y_table[0][i2],10)),d_rgt<-100?this._insertPoint_v4(curve,[1,x,hi],t):d_rgt>100&&this._insertPoint_v4(curve,[1,x,lo],t)},steps:1021,criticalThreshold:1e3,plot_v4:function(curve,ta,tb,steps){var i,le,components,idx,comp,groups,g,start,ret,x_table,y_table,t,t1,t2,y_int,h=(tb-ta)/steps,Ypl=function(x){return curve.Y(x,!0)},Ymi=function(x){return-curve.Y(x,!0)},h2=.5*h;for(components=this.findComponents(curve,ta,tb,steps),idx=0;idx<components.length;idx++){for(comp=components[idx],groups=(ret=this.differenceMethod(comp,curve))[0],x_table=ret[1],y_table=ret[2],ret[3],ret[4],0!==groups.length&&"borderleft"===groups[0].type||groups.unshift({idx:0,t:comp.t_values[0],x:comp.x_values[0],y:comp.y_values[0],type:"borderleft"}),"borderright"!==groups[groups.length-1].type&&(le=comp.t_values.length,groups.push({idx:le-1,t:comp.t_values[le-1],x:comp.x_values[le-1],y:comp.y_values[le-1],type:"borderright"})),start=0,g=0;g<=groups.length;g++){for(le=g===groups.length?comp.len:groups[g].idx-1,0,0,i=start;i<le-2;i++)this._insertPoint_v4(curve,[1,comp.x_values[i],comp.y_values[i]],comp.t_values[i]),Math.max(0,i-2),i>=start+3&&i<le-3&&y_table.length>3&&Math.abs(y_table[2][i])>.2*Math.abs(y_table[0][i])?(t=comp.t_values[i],h2=.25*h,y_int=this.getInterval(curve,t,t+h),Type.isObject(y_int)?y_table[2][i]>0?this._insertPoint_v4(curve,[1,t+h2,y_int.lo],t+h2):this._insertPoint_v4(curve,[1,t+h-h2,y_int.hi],t+h-h2):(t1=Numerics.fminbr(Ypl,[t,t+h]))<(t2=Numerics.fminbr(Ymi,[t,t+h]))?(this._insertPoint_v4(curve,[1,curve.X(t1,!0),curve.Y(t1,!0)],t1),this._insertPoint_v4(curve,[1,curve.X(t2,!0),curve.Y(t2,!0)],t2)):(this._insertPoint_v4(curve,[1,curve.X(t2,!0),curve.Y(t2,!0)],t2),this._insertPoint_v4(curve,[1,curve.X(t1,!0),curve.Y(t1,!0)],t1))):0;g<groups.length&&(i=groups[g].idx,"borderleft"===groups[g].type||"borderright"===groups[g].type?this.handleBorder(curve,comp,groups[g],x_table,y_table):this._seconditeration_v4(curve,comp,groups[g],x_table,y_table),start=groups[g].idx+1+1)}le=comp.len,idx<components.length-1&&this._insertPoint_v4(curve,[1,NaN,NaN],comp.right_t)}},updateParametricCurve_v4:function(curve,mi,ma){var ta,tb,w2,bbox;"x"===curve.xterm?(w2=.3*((bbox=curve.board.getBoundingBox())[2]-bbox[0]),ta=Math.max(mi,bbox[0]-w2),tb=Math.min(ma,bbox[2]+w2)):(ta=mi,tb=ma),curve.points=[],this.plot_v4(curve,ta,tb,this.steps),curve.numberPoints=curve.points.length},updateParametricCurve:function(curve,mi,ma){return this.updateParametricCurve_v2(curve,mi,ma)}},Mat.Plot})),define("math/metapost",["utils/type","math/math"],(function(Type,Mat){return Mat.Metapost={MP_ENDPOINT:0,MP_EXPLICIT:1,MP_GIVEN:2,MP_CURL:3,MP_OPEN:4,MP_END_CYCLE:5,UNITY:1,FRACTION_ONE:1,FRACTION_THREE:3,ONE_EIGHTY_DEG:Math.PI,THREE_SIXTY_DEG:2*Math.PI,EPS_SQ:1e-5*1e-5,make_choices:function(knots){var dely,h,k,delx,n,q,p,s,cosine,t,sine,delta_x,delta_y,delta,psi;p=knots[0];do{if(!p)break;q=p.next,p.rtype>this.MP_EXPLICIT&&(p.x-q.x)*(p.x-q.x)+(p.y-q.y)*(p.y-q.y)<this.EPS_SQ&&(p.rtype=this.MP_EXPLICIT,p.ltype===this.MP_OPEN&&(p.ltype=this.MP_CURL,p.set_left_curl(this.UNITY)),q.ltype=this.MP_EXPLICIT,q.rtype===this.MP_OPEN&&(q.rtype=this.MP_CURL,q.set_right_curl(this.UNITY)),p.rx=p.x,q.lx=p.x,p.ry=p.y,q.ly=p.y),p=q}while(p!==knots[0]);for(h=knots[0];h.ltype===this.MP_OPEN&&h.rtype===this.MP_OPEN;)if((h=h.next)===knots[0]){h.ltype=this.MP_END_CYCLE;break}for(p=h;p;){if(q=p.next,p.rtype>=this.MP_GIVEN){for(;q.ltype===this.MP_OPEN&&q.rtype===this.MP_OPEN;)q=q.next;for(k=0,s=p,n=knots.length,delta_x=[],delta_y=[],delta=[],psi=[null];t=s.next,delta_x.push(t.x-s.x),delta_y.push(t.y-s.y),delta.push(this.mp_pyth_add(delta_x[k],delta_y[k])),k>0&&(sine=delta_y[k-1]/delta[k-1],cosine=delta_x[k-1]/delta[k-1],psi.push(Math.atan2(delta_y[k]*cosine-delta_x[k]*sine,delta_x[k]*cosine+delta_y[k]*sine))),k++,(s=t)===q&&(n=k),!(k>=n&&s.ltype!==this.MP_END_CYCLE););k===n?psi.push(0):psi.push(psi[1]),q.ltype===this.MP_OPEN&&((delx=q.rx-q.x)*delx+(dely=q.ry-q.y)*dely<this.EPS_SQ?(q.ltype=this.MP_CURL,q.set_left_curl(this.UNITY)):(q.ltype=this.MP_GIVEN,q.set_left_given(Math.atan2(dely,delx)))),p.rtype===this.MP_OPEN&&p.ltype===this.MP_EXPLICIT&&((delx=p.x-p.lx)*delx+(dely=p.y-p.ly)*dely<this.EPS_SQ?(p.rtype=this.MP_CURL,p.set_right_curl(this.UNITY)):(p.rtype=this.MP_GIVEN,p.set_right_given(Math.atan2(dely,delx)))),this.mp_solve_choices(p,q,n,delta_x,delta_y,delta,psi)}else p.rtype===this.MP_ENDPOINT&&(p.rx=p.x,p.ry=p.y,q.lx=q.x,q.ly=q.y);if((p=q)===h)break}},mp_solve_choices:function(p,q,n,delta_x,delta_y,delta,psi){var aa,acc,vv,bb,ldelta,ee,k,s,ww,uu,lt,r,t,ff,theta,rt,dd,cc,ct_st,ct,st,cf_sf,cf,sf,i,k_idx;for(ldelta=delta.length+1,uu=new Array(ldelta),ww=new Array(ldelta),vv=new Array(ldelta),theta=new Array(ldelta),i=0;i<ldelta;i++)theta[i]=vv[i]=ww[i]=uu[i]=0;for(k=0,s=p,r=0;;){if(t=s.next,0===k)if(s.rtype===this.MP_GIVEN){if(t.ltype===this.MP_GIVEN)return aa=Math.atan2(delta_y[0],delta_x[0]),ct=(ct_st=this.mp_n_sin_cos(p.right_given()-aa))[0],st=ct_st[1],cf=(cf_sf=this.mp_n_sin_cos(q.left_given()-aa))[0],sf=cf_sf[1],void this.mp_set_controls(p,q,delta_x[0],delta_y[0],st,ct,-sf,cf);vv[0]=s.right_given()-Math.atan2(delta_y[0],delta_x[0]),vv[0]=this.reduce_angle(vv[0]),uu[0]=0,ww[0]=0}else if(s.rtype===this.MP_CURL){if(t.ltype===this.MP_CURL)return p.rtype=this.MP_EXPLICIT,q.ltype=this.MP_EXPLICIT,lt=Math.abs(q.left_tension()),rt=Math.abs(p.right_tension()),ff=this.UNITY/(3*rt),p.rx=p.x+delta_x[0]*ff,p.ry=p.y+delta_y[0]*ff,ff=this.UNITY/(3*lt),q.lx=q.x-delta_x[0]*ff,void(q.ly=q.y-delta_y[0]*ff);cc=s.right_curl(),lt=Math.abs(t.left_tension()),rt=Math.abs(s.right_tension()),uu[0]=this.mp_curl_ratio(cc,rt,lt),vv[0]=-psi[1]*uu[0],ww[0]=0}else s.rtype===this.MP_OPEN&&(uu[0]=0,vv[0]=0,ww[0]=this.FRACTION_ONE);else if(s.ltype===this.MP_END_CYCLE||s.ltype===this.MP_OPEN){if(aa=this.UNITY/(3*Math.abs(r.right_tension())-this.UNITY),dd=delta[k]*(this.FRACTION_THREE-this.UNITY/Math.abs(r.right_tension())),bb=this.UNITY/(3*Math.abs(t.left_tension())-this.UNITY),ee=delta[k-1]*(this.FRACTION_THREE-this.UNITY/Math.abs(t.left_tension())),dd*=cc=this.FRACTION_ONE-uu[k-1]*aa,(lt=Math.abs(s.left_tension()))<(rt=Math.abs(s.right_tension()))?dd*=Math.pow(lt/rt,2):lt>rt&&(ee*=Math.pow(rt/lt,2)),ff=ee/(ee+dd),uu[k]=ff*bb,acc=-psi[k+1]*uu[k],r.rtype===this.MP_CURL?(ww[k]=0,vv[k]=acc-psi[1]*(this.FRACTION_ONE-ff)):(ff=(this.FRACTION_ONE-ff)/cc,acc-=psi[k]*ff,ff*=aa,vv[k]=acc-vv[k-1]*ff,ww[k]=-ww[k-1]*ff),s.ltype===this.MP_END_CYCLE){for(aa=0,bb=this.FRACTION_ONE;0===(k-=1)&&(k=n),aa=vv[k]-aa*uu[k],bb=ww[k]-bb*uu[k],k!==n;);for(aa/=this.FRACTION_ONE-bb,theta[n]=aa,vv[0]=aa,k_idx=1;k_idx<n;k_idx++)vv[k_idx]=vv[k_idx]+aa*ww[k_idx];break}}else{if(s.ltype===this.MP_CURL){cc=s.left_curl(),lt=Math.abs(s.left_tension()),rt=Math.abs(r.right_tension()),ff=this.mp_curl_ratio(cc,lt,rt),theta[n]=-vv[n-1]*ff/(this.FRACTION_ONE-ff*uu[n-1]);break}if(s.ltype===this.MP_GIVEN){theta[n]=s.left_given()-Math.atan2(delta_y[n-1],delta_x[n-1]),theta[n]=this.reduce_angle(theta[n]);break}}r=s,s=t,k+=1}for(k=n-1;k>-1;k--)theta[k]=vv[k]-theta[k+1]*uu[k];for(s=p,k=0;t=s.next,ct=(ct_st=this.mp_n_sin_cos(theta[k]))[0],st=ct_st[1],cf=(cf_sf=this.mp_n_sin_cos(-psi[k+1]-theta[k+1]))[0],sf=cf_sf[1],this.mp_set_controls(s,t,delta_x[k],delta_y[k],st,ct,sf,cf),s=t,++k!==n;);},mp_n_sin_cos:function(z){return[Math.cos(z),Math.sin(z)]},mp_set_controls:function(p,q,delta_x,delta_y,st,ct,sf,cf){var rt,ss,lt,sine,rr;lt=Math.abs(q.left_tension()),rt=Math.abs(p.right_tension()),rr=this.mp_velocity(st,ct,sf,cf,rt),ss=this.mp_velocity(sf,cf,st,ct,lt),(p.right_tension()<0||q.left_tension()<0)&&(st>=0&&sf>=0||st<=0&&sf<=0)&&(sine=Math.abs(st)*cf+Math.abs(sf)*ct)>0&&(sine*=1.00024414062,p.right_tension()<0&&this.mp_ab_vs_cd(Math.abs(sf),this.FRACTION_ONE,rr,sine)<0&&(rr=Math.abs(sf)/sine),q.left_tension()<0&&this.mp_ab_vs_cd(Math.abs(st),this.FRACTION_ONE,ss,sine)<0&&(ss=Math.abs(st)/sine)),p.rx=p.x+(delta_x*ct-delta_y*st)*rr,p.ry=p.y+(delta_y*ct+delta_x*st)*rr,q.lx=q.x-(delta_x*cf+delta_y*sf)*ss,q.ly=q.y-(delta_y*cf-delta_x*sf)*ss,p.rtype=this.MP_EXPLICIT,q.ltype=this.MP_EXPLICIT},mp_pyth_add:function(a,b){return Math.sqrt(a*a+b*b)},mp_curl_ratio:function(gamma,a_tension,b_tension){var alpha=1/a_tension,beta=1/b_tension;return Math.min(4,((3-alpha)*alpha*alpha*gamma+beta*beta*beta)/(alpha*alpha*alpha*gamma+(3-beta)*beta*beta))},mp_ab_vs_cd:function(a,b,c,d){return a*b==c*d?0:a*b>c*d?1:-1},mp_velocity:function(st,ct,sf,cf,t){return Math.min(4,(2+Math.sqrt(2)*(st-sf/16)*(sf-st/16)*(ct-cf))/(1.5*t*(2+(Math.sqrt(5)-1)*ct+(3-Math.sqrt(5))*cf)))},reduce_angle:function(A){return Math.abs(A)>this.ONE_EIGHTY_DEG&&(A>0?A-=this.THREE_SIXTY_DEG:A+=this.THREE_SIXTY_DEG),A},makeknots:function(p,tension,cycle){var i,len,knots=[];for(tension=tension||1,len=p.length,i=0;i<len;i++)knots.push({x:p[i][0],y:p[i][1],ltype:this.MP_OPEN,rtype:this.MP_OPEN,ly:tension,ry:tension,lx:tension,rx:tension,left_curl:function(){return this.lx||0},right_curl:function(){return this.rx||0},left_tension:function(){return this.ly||(this.ly=1),this.ly},right_tension:function(){return this.ry||(this.ry=1),this.ry},set_right_curl:function(x){this.rx=x||0},set_left_curl:function(x){this.lx=x||0}});for(len=knots.length,i=0;i<len;i++)knots[i].next=knots[i+1]||knots[i],knots[i].set_right_given=knots[i].set_right_curl,knots[i].set_left_given=knots[i].set_left_curl,knots[i].right_given=knots[i].right_curl,knots[i].left_given=knots[i].left_curl;return knots[len-1].next=knots[0],cycle||(knots[len-1].rtype=this.MP_ENDPOINT,knots[len-1].ltype=this.MP_CURL,knots[0].rtype=this.MP_CURL),knots},curve:function(point_list,controls){var knots,len,i,val,x=[],y=[];for(i in controls=controls||{tension:1,direction:{},curl:{},isClosed:!1},len=(knots=this.makeknots(point_list,Type.evaluate(controls.tension),controls.isClosed)).length,controls.direction)controls.direction.hasOwnProperty(i)&&(val=Type.evaluate(controls.direction[i]),Type.isArray(val)?(!1!==val[0]&&(knots[i].lx=val[0]*Math.PI/180,knots[i].ltype=this.MP_GIVEN),!1!==val[1]&&(knots[i].rx=val[1]*Math.PI/180,knots[i].rtype=this.MP_GIVEN)):(knots[i].lx=val*Math.PI/180,knots[i].rx=val*Math.PI/180,knots[i].ltype=knots[i].rtype=this.MP_GIVEN));for(i in controls.curl)controls.curl.hasOwnProperty(i)&&(val=Type.evaluate(controls.curl[i]),0===parseInt(i,10)?(knots[i].rtype=this.MP_CURL,knots[i].set_right_curl(val)):parseInt(i,10)===len-1&&(knots[i].ltype=this.MP_CURL,knots[i].set_left_curl(val)));for(this.make_choices(knots),i=0;i<len-1;i++)x.push(knots[i].x),x.push(knots[i].rx),x.push(knots[i+1].lx),y.push(knots[i].y),y.push(knots[i].ry),y.push(knots[i+1].ly);return x.push(knots[len-1].x),y.push(knots[len-1].y),controls.isClosed&&(x.push(knots[len-1].rx),y.push(knots[len-1].ry),x.push(knots[0].lx),y.push(knots[0].ly),x.push(knots[0].x),y.push(knots[0].y)),[x,y]}},Mat.Metapost})),define("utils/zip",["jxg"],(function(JXG){var bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];return JXG.Util=JXG.Util||{},JXG.Util.Unzip=function(barray){var gpflags,fileout,flens,fmax,outputArr=[],files=0,unzipped=[],buf32k=new Array(32768),bIdx=0,modeZIP=!1,barraylen=barray.length,bytepos=0,bb=1,literalTree=new Array(288),distanceTree=new Array(32),treepos=0,Places=null,len=(new Array(64),new Array(64),0),fpos=new Array(17),nameBuf=[];function readByte(){return 8,bytepos<barraylen?barray[bytepos++]:-1}function byteAlign(){bb=1}function readBit(){var carry;try{return carry=1&bb,0===(bb>>=1)&&(carry=1&(bb=readByte()),bb=bb>>1|128),carry}catch(e){throw e}}function readBits(a){var res=0,i=a;try{for(;i--;)res=res<<1|readBit();a&&(res=bitReverse[res]>>8-a)}catch(e){throw e}return res}function flushBuffer(){bIdx=0}function addBuffer(a){buf32k[bIdx++]=a,outputArr.push(String.fromCharCode(a)),32768===bIdx&&(bIdx=0)}function HufNode(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function isPat(){for(;;){if(fpos[len]>=fmax)return-1;if(flens[fpos[len]]===len)return fpos[len]++;fpos[len]++}}function rec(){var tmp,curplace=Places[treepos];if(17===len)return-1;if(treepos++,len++,(tmp=isPat())>=0)curplace.b0=tmp;else if(curplace.b0=32768,rec())return-1;if((tmp=isPat())>=0)curplace.b1=tmp,curplace.jump=null;else if(curplace.b1=32768,curplace.jump=Places[treepos],curplace.jumppos=treepos,rec())return-1;return len--,0}function createTree(currentTree,numval,lengths,show){var i;for(Places=currentTree,treepos=0,flens=lengths,fmax=numval,i=0;i<17;i++)fpos[i]=0;return len=0,rec()?-1:0}function decodeValue(currentTree){for(var len,i,xtreepos=0,X=currentTree[xtreepos];;)if(readBit()){if(!(32768&X.b1))return X.b1;for(X=X.jump,len=currentTree.length,i=0;i<len;i++)if(currentTree[i]===X){xtreepos=i;break}}else{if(!(32768&X.b0))return X.b0;X=currentTree[++xtreepos]}}function deflateLoop(){var last,type,i,j,l,ll,ll2,len,blockLen,dist,cSum,n,literalCodes,distCodes,lenCodes;do{if(last=readBit(),0===(type=readBits(2)))for(byteAlign(),blockLen=readByte(),blockLen|=readByte()<<8,cSum=readByte(),65535&(blockLen^~(cSum|=readByte()<<8))&&JXG.debug("BlockLen checksum mismatch\n");blockLen--;)addBuffer(readByte());else if(1===type)for(;;)if((j=bitReverse[readBits(7)]>>1)>23?(j=j<<1|readBit())>199?j=(j-=128)<<1|readBit():(j-=48)>143&&(j+=136):j+=256,j<256)addBuffer(j);else{if(256===j)break;for(len=readBits(cplext[j-=257])+cplens[j],j=bitReverse[readBits(5)]>>3,cpdext[j]>8?(dist=readBits(8),dist|=readBits(cpdext[j]-8)<<8):dist=readBits(cpdext[j]),dist+=cpdist[j],j=0;j<len;j++)addBuffer(buf32k[bIdx-dist&32767])}else if(2===type){for(ll=new Array(320),literalCodes=257+readBits(5),distCodes=1+readBits(5),lenCodes=4+readBits(4),j=0;j<19;j++)ll[j]=0;for(j=0;j<lenCodes;j++)ll[border[j]]=readBits(3);for(len=distanceTree.length,i=0;i<len;i++)distanceTree[i]=new HufNode;if(createTree(distanceTree,19,ll))return flushBuffer(),1;for(n=literalCodes+distCodes,i=0,-1;i<n;)if((j=decodeValue(distanceTree))<16)ll[i++]=j;else if(16===j){if(i+(j=3+readBits(2))>n)return flushBuffer(),1;for(l=i?ll[i-1]:0;j--;)ll[i++]=l}else{if(i+(j=17===j?3+readBits(3):11+readBits(7))>n)return flushBuffer(),1;for(;j--;)ll[i++]=0}for(len=literalTree.length,i=0;i<len;i++)literalTree[i]=new HufNode;if(createTree(literalTree,literalCodes,ll))return flushBuffer(),1;for(len=literalTree.length,i=0;i<len;i++)distanceTree[i]=new HufNode;for(ll2=[],i=literalCodes;i<ll.length;i++)ll2[i-literalCodes]=ll[i];if(createTree(distanceTree,distCodes,ll2))return flushBuffer(),1;for(;;)if((j=decodeValue(literalTree))>=256){if(0===(j-=256))break;for(len=readBits(cplext[j-=1])+cplens[j],j=decodeValue(distanceTree),cpdext[j]>8?(dist=readBits(8),dist|=readBits(cpdext[j]-8)<<8):dist=readBits(cpdext[j]),dist+=cpdist[j];len--;)addBuffer(buf32k[bIdx-dist&32767])}else addBuffer(j)}}while(!last);return flushBuffer(),byteAlign(),0}function nextFile(){var i,c,extralen,filelen,method,tmp=[];try{if(outputArr=[],modeZIP=!1,tmp[0]=readByte(),tmp[1]=readByte(),120===tmp[0]&&218===tmp[1]&&(deflateLoop(),unzipped[files]=[outputArr.join(""),"geonext.gxt"],files++),31===tmp[0]&&139===tmp[1]&&(skipdir(),unzipped[files]=[outputArr.join(""),"file"],files++),80===tmp[0]&&75===tmp[1]){if(modeZIP=!0,tmp[2]=readByte(),tmp[3]=readByte(),3===tmp[2]&&4===tmp[3]){for(tmp[0]=readByte(),tmp[1]=readByte(),gpflags=readByte(),gpflags|=readByte()<<8,method=readByte(),method|=readByte()<<8,readByte(),readByte(),readByte(),readByte(),readByte(),readByte()<<8,readByte()<<16,readByte()<<24,readByte(),readByte()<<8,readByte()<<16,readByte()<<24,readByte(),readByte()<<8,readByte()<<16,readByte()<<24,filelen=readByte(),filelen|=readByte()<<8,extralen=readByte(),extralen|=readByte()<<8,i=0,nameBuf=[];filelen--;)"/"===(c=readByte())|":"===c?i=0:i<255&&(nameBuf[i++]=String.fromCharCode(c));for(fileout||(fileout=nameBuf),i=0;i<extralen;)c=readByte(),i++;if(0,8===method&&(deflateLoop(),unzipped[files]=new Array(2),unzipped[files][0]=outputArr.join(""),unzipped[files][1]=nameBuf.join(""),files++),skipdir())return!1}return!0}}catch(e){throw e}return!1}function skipdir(){var i,c,tmp=[];if(8&gpflags&&(tmp[0]=readByte(),tmp[1]=readByte(),tmp[2]=readByte(),tmp[3]=readByte(),80===tmp[0]&&75===tmp[1]&&7===tmp[2]&&8===tmp[3]?(readByte(),readByte()<<8,readByte()<<16,readByte()<<24):tmp[0]|tmp[1]<<8|tmp[2]<<16|tmp[3]<<24,readByte(),readByte()<<8,readByte()<<16,readByte()<<24,readByte(),readByte()<<8,readByte()<<16,readByte()<<24),modeZIP&&nextFile())return!1;if(tmp[0]=readByte(),8!==tmp[0])return!0;if(gpflags=readByte(),readByte(),readByte(),readByte(),readByte(),readByte(),readByte(),4&gpflags)for(tmp[0]=readByte(),tmp[2]=readByte(),len=tmp[0]+256*tmp[1],i=0;i<len;i++)readByte();if(8&gpflags)for(i=0,nameBuf=[],c=readByte();c;)"7"!==c&&":"!==c||(i=0),i<255&&(nameBuf[i++]=c),c=readByte();if(16&gpflags)for(c=readByte();c;)c=readByte();return 2&gpflags&&(readByte(),readByte()),deflateLoop(),readByte(),readByte()<<8,readByte()<<16,readByte()<<24,readByte(),readByte()<<8,readByte()<<16,readByte()<<24,modeZIP&&nextFile(),!1}fpos[0]=0,JXG.Util.Unzip.prototype.unzipFile=function(name){var i;for(this.unzip(),i=0;i<unzipped.length;i++)if(unzipped[i][1]===name)return unzipped[i][0];return""},JXG.Util.Unzip.prototype.unzip=function(){return nextFile(),unzipped}},JXG.Util})),define("utils/encoding",["jxg"],(function(JXG){var UTF8D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return JXG.Util=JXG.Util||{},JXG.Util.UTF8={encode:function(string){var n,c,utftext="",len=string.length;if(string=string.replace(/\r\n/g,"\n"),"function"==typeof unescape&&"function"==typeof encodeURIComponent)return unescape(encodeURIComponent(string));for(n=0;n<len;n++)(c=string.charCodeAt(n))<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128));return utftext},decode:function(utftext){var i,charCode,type,j=0,codepoint=0,state=0,chars=[],len=utftext.length,results=[];for(i=0;i<len;i++)charCode=utftext.charCodeAt(i),type=UTF8D[charCode],codepoint=0!==state?63&charCode|codepoint<<6:255>>type&charCode,0===(state=UTF8D[256+state+type])&&(codepoint>65535?chars.push(55232+(codepoint>>10),56320+(1023&codepoint)):chars.push(codepoint),++j%1e4==0&&(results.push(String.fromCharCode.apply(null,chars)),chars=[]));return results.push(String.fromCharCode.apply(null,chars)),results.join("")},asciiCharCodeAt:function(str,i){var c=str.charCodeAt(i);if(c>255)switch(c){case 8364:c=128;break;case 8218:c=130;break;case 402:c=131;break;case 8222:c=132;break;case 8230:c=133;break;case 8224:c=134;break;case 8225:c=135;break;case 710:c=136;break;case 8240:c=137;break;case 352:c=138;break;case 8249:c=139;break;case 338:c=140;break;case 381:c=142;break;case 8216:c=145;break;case 8217:c=146;break;case 8220:c=147;break;case 8221:c=148;break;case 8226:c=149;break;case 8211:c=150;break;case 8212:c=151;break;case 732:c=152;break;case 8482:c=153;break;case 353:c=154;break;case 8250:c=155;break;case 339:c=156;break;case 382:c=158;break;case 376:c=159}return c}},JXG.Util.UTF8})),define("utils/base64",["jxg","utils/encoding"],(function(JXG,Encoding){var alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function _getByte(s,i){return 255&s.charCodeAt(i)}function _getIndex(s,i){return alphabet.indexOf(s.charAt(i))}return JXG.Util=JXG.Util||{},JXG.Util.Base64={encode:function(input){var i,bin,len,padLen,encInput,buffer=[];for(padLen=(len=(encInput=Encoding.encode(input)).length)%3,i=0;i<len-padLen;i+=3)bin=_getByte(encInput,i)<<16|_getByte(encInput,i+1)<<8|_getByte(encInput,i+2),buffer.push(alphabet.charAt(bin>>18),alphabet.charAt(bin>>12&63),alphabet.charAt(bin>>6&63),alphabet.charAt(63&bin));switch(padLen){case 1:bin=_getByte(encInput,len-1),buffer.push(alphabet.charAt(bin>>2),alphabet.charAt(bin<<4&63),"=","=");break;case 2:bin=_getByte(encInput,len-2)<<8|_getByte(encInput,len-1),buffer.push(alphabet.charAt(bin>>10),alphabet.charAt(bin>>4&63),alphabet.charAt(bin<<2&63),"=")}return buffer.join("")},decode:function(input,utf8){var encInput,i,len,padLen,bin,output,result=[],buffer=[];if((len=(encInput=input.replace(/[^A-Za-z0-9+/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for("="===encInput.charAt(len-1)&&(padLen=1,"="===encInput.charAt(len-2)&&(padLen=2),len-=4),i=0;i<len;i+=4)bin=_getIndex(encInput,i)<<18|_getIndex(encInput,i+1)<<12|_getIndex(encInput,i+2)<<6|_getIndex(encInput,i+3),buffer.push(bin>>16,bin>>8&255,255&bin),i%1e4==0&&(result.push(String.fromCharCode.apply(null,buffer)),buffer=[]);switch(padLen){case 1:bin=_getIndex(encInput,len)<<12|_getIndex(encInput,len+1)<<6|_getIndex(encInput,len+2),buffer.push(bin>>10,bin>>2&255);break;case 2:bin=_getIndex(encInput,i)<<6|_getIndex(encInput,i+1),buffer.push(bin>>4)}return result.push(String.fromCharCode.apply(null,buffer)),output=result.join(""),utf8&&(output=Encoding.decode(output)),output},decodeAsArray:function(input){var i,dec=this.decode(input),ar=[],len=dec.length;for(i=0;i<len;i++)ar[i]=dec.charCodeAt(i);return ar}},JXG.Util.Base64})),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],(function(JXG,Zip,Base64,Type){return JXG.Server={modules:{},runningCalls:{},handleError:function(data){JXG.debug("error occured, server says: "+data.message)},callServer:function(action,callback,data,sync){var fileurl,passdata,AJAX,id,dataJSONStr,k,cb;for(k in sync=sync||!1,"",data)data.hasOwnProperty(k)&&"&"+escape(k)+"="+escape(data[k]);dataJSONStr=Type.toJSON(data);do{id=action+Math.floor(4096*Math.random())}while(Type.exists(this.runningCalls[id]));return this.runningCalls[id]={action:action},Type.exists(data.module)&&(this.runningCalls[id].module=data.module),fileurl=JXG.serverBase+"JXGServer.py",passdata="action="+escape(action)+"&id="+id+"&dataJSON="+escape(Base64.encode(dataJSONStr)),this.cbp=function(d){var str,data,tmp,inject,paramlist,id,i,j;if(str=new Zip.Unzip(Base64.decodeAsArray(d)).unzip(),Type.isArray(str)&&str.length>0&&(str=str[0][0]),Type.exists(str))if("error"===(data=window.JSON&&window.JSON.parse?window.JSON.parse(str):new Function("return "+str)()).type)this.handleError(data);else if("response"===data.type){for(id=data.id,i=0;i<data.fields.length;i++)inject=(tmp=data.fields[i]).namespace+("object"===_typeof(new Function("return "+tmp.namespace)())?".":".prototype.")+tmp.name+" = "+tmp.value,new Function(inject)();for(i=0;i<data.handler.length;i++){for(tmp=data.handler[i],paramlist=[],j=0;j<tmp.parameters.length;j++)paramlist[j]='"'+tmp.parameters[j]+'": '+tmp.parameters[j];inject="if(typeof JXG.Server.modules."+this.runningCalls[id].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[id].module+" = {};",inject+="JXG.Server.modules."+this.runningCalls[id].module+"."+tmp.name+"_cb = "+tmp.callback+";",inject+="JXG.Server.modules."+this.runningCalls[id].module+"."+tmp.name+" = function ("+tmp.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[id].module+"."+tmp.name+"_cb;var __JXGSERVER_PAR__ = {"+paramlist.join(",")+', "module": "'+this.runningCalls[id].module+'", "handler": "'+tmp.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(inject)()}delete this.runningCalls[id],callback(data.data)}},this.cb=JXG.bind(this.cbp,this),window.XMLHttpRequest?(AJAX=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):AJAX=new ActiveXObject("Microsoft.XMLHTTP"),!(!AJAX||(AJAX.open("POST",fileurl,!sync),AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),sync||(AJAX.onreadystatechange=(cb=this.cb,function(){return 4===AJAX.readyState&&200===AJAX.status&&(cb(AJAX.responseText),!0)})),AJAX.send(passdata),!sync))&&(this.cb(AJAX.responseText),!0)},loadModule_cb:function(data){var i;for(i=0;i<data.length;i++)JXG.debug(data[i].name+": "+data[i].value)},loadModule:function(module){return JXG.Server.callServer("load",JXG.Server.loadModule_cb,{module:module},!0)}},JXG.Server.load=JXG.Server.loadModule,JXG.Server})),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],(function(Const,Coords,Mat,Geometry,Server,Type){return Mat.Symbolic={generateSymbolicCoordinatesPartial:function(board,element,variable,append){var t_num,t,k,list=element.ancestors,count=0,makeCoords=function(num){return"underscore"===append?variable+"_{"+num+"}":"brace"===append?variable+"["+num+"]":variable+num};for(t in board.listOfFreePoints=[],board.listOfDependantPoints=[],list)if(list.hasOwnProperty(t)&&(t_num=0,Type.isPoint(list[t]))){for(k in list[t].ancestors)list[t].ancestors.hasOwnProperty(k)&&t_num++;0===t_num?(list[t].symbolic.x=list[t].coords.usrCoords[1],list[t].symbolic.y=list[t].coords.usrCoords[2],board.listOfFreePoints.push(list[t])):(count+=1,list[t].symbolic.x=makeCoords(count),count+=1,list[t].symbolic.y=makeCoords(count),board.listOfDependantPoints.push(list[t]))}return Type.isPoint(element)&&(element.symbolic.x="x",element.symbolic.y="y"),count},clearSymbolicCoordinates:function(board){var clear=function(list){var t,l=list&&list.length||0;for(t=0;t<l;t++)Type.isPoint(list[t])&&(list[t].symbolic.x="",list[t].symbolic.y="")};clear(board.listOfFreePoints),clear(board.listOfDependantPoints),delete board.listOfFreePoints,delete board.listOfDependantPoints},generatePolynomials:function(board,element,generateCoords){var t,k,i,number_of_ancestors,list=element.ancestors,pgs=[],result=[];for(t in generateCoords&&this.generateSymbolicCoordinatesPartial(board,element,"u","brace"),list[element.id]=element,list)if(list.hasOwnProperty(t)&&(number_of_ancestors=0,pgs=[],Type.isPoint(list[t]))){for(k in list[t].ancestors)list[t].ancestors.hasOwnProperty(k)&&number_of_ancestors++;if(number_of_ancestors>0)for(pgs=list[t].generatePolynomial(),i=0;i<pgs.length;i++)result.push(pgs[i])}return generateCoords&&this.clearSymbolicCoordinates(board),result},geometricLocusByGroebnerBase:function(board,point){var polyStr,result,P1,P2,i,xs,xe,ys,ye,c,s,tx,bol=board.options.locus,oldRadius={},numDependent=this.generateSymbolicCoordinatesPartial(board,point,"u","brace"),xsye=new Coords(Const.COORDS_BY_USR,[0,0],board),xeys=new Coords(Const.COORDS_BY_USR,[board.canvasWidth,board.canvasHeight],board),sf=1,transx=0,transy=0,rot=0;if(undefined===Server.modules.geoloci&&Server.loadModule("geoloci"),undefined===Server.modules.geoloci)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(xs=xsye.usrCoords[1],xe=xeys.usrCoords[1],ys=xeys.usrCoords[2],ye=xsye.usrCoords[2],bol.translateToOrigin&&board.listOfFreePoints.length>0){for(transx=(P1=undefined!==bol.toOrigin&&null!==bol.toOrigin&&Type.isInArray(board.listOfFreePoints,bol.toOrigin.id)?bol.toOrigin:board.listOfFreePoints[0]).symbolic.x,transy=P1.symbolic.y,i=0;i<board.listOfFreePoints.length;i++)board.listOfFreePoints[i].symbolic.x-=transx,board.listOfFreePoints[i].symbolic.y-=transy;if(xs-=transx,xe-=transx,ys-=transy,ye-=transy,bol.translateTo10&&board.listOfFreePoints.length>1){for(P2=undefined!==bol.to10&&null!==bol.to10&&bol.to10.id!==bol.toOrigin.id&&Type.isInArray(board.listOfFreePoints,bol.to10.id)?bol.to10:board.listOfFreePoints[0].id===P1.id?board.listOfFreePoints[1]:board.listOfFreePoints[0],rot=Geometry.rad([1,0],[0,0],[P2.symbolic.x,P2.symbolic.y]),c=Math.cos(-rot),s=Math.sin(-rot),i=0;i<board.listOfFreePoints.length;i++)tx=board.listOfFreePoints[i].symbolic.x,board.listOfFreePoints[i].symbolic.x=c*board.listOfFreePoints[i].symbolic.x-s*board.listOfFreePoints[i].symbolic.y,board.listOfFreePoints[i].symbolic.y=s*tx+c*board.listOfFreePoints[i].symbolic.y;if(P2.symbolic.y=0,tx=xs,xs=c*xs-s*ys,ys=s*tx+c*ys,tx=xe,xe=c*xe-s*ye,ye=s*tx+c*ye,bol.stretch&&Math.abs(P2.symbolic.x)>Mat.eps){for(sf=P2.symbolic.x,i=0;i<board.listOfFreePoints.length;i++)board.listOfFreePoints[i].symbolic.x/=sf,board.listOfFreePoints[i].symbolic.y/=sf;for(i=0;i<board.objectsList.length;i++)board.objectsList[i].elementClass===Const.OBJECT_CLASS_CIRCLE&&"pointRadius"===board.objectsList[i].method&&(oldRadius[i]=board.objectsList[i].radius,board.objectsList[i].radius/=sf);xs/=sf,xe/=sf,ys/=sf,ye/=sf,P2.symbolic.x=1}}for(i=0;i<board.listOfFreePoints.length;i++)tx=board.listOfFreePoints[i].symbolic.x,Math.abs(tx)<Mat.eps&&(board.listOfFreePoints[i].symbolic.x=0),Math.abs(tx-Math.round(tx))<Mat.eps&&(board.listOfFreePoints[i].symbolic.x=Math.round(tx)),tx=board.listOfFreePoints[i].symbolic.y,Math.abs(tx)<Mat.eps&&(board.listOfFreePoints[i].symbolic.y=0),Math.abs(tx-Math.round(tx))<Mat.eps&&(board.listOfFreePoints[i].symbolic.y=Math.round(tx))}for(i in polyStr=this.generatePolynomials(board,point).join(","),this.cbp=function(data){result=data},this.cb=Type.bind(this.cbp,this),Server.modules.geoloci.lociCoCoA(xs,xe,ys,ye,numDependent,polyStr,sf,rot,transx,transy,this.cb,!0),this.clearSymbolicCoordinates(board),oldRadius)oldRadius.hasOwnProperty(i)&&(board.objects[i].radius=oldRadius[i]);return result}},Mat.Symbolic})),define("math/clip",["jxg","base/constants","base/coords","math/math","math/geometry","utils/type"],(function(JXG,Const,Coords,Mat,Geometry,Type){return Mat.Clip={_isSeparator:function(node){return isNaN(node.coords.usrCoords[1])&&isNaN(node.coords.usrCoords[2])},makeDoublyLinkedList:function(S){var i,first=null,components=[],le=S.length;if(le>0)for(i=0;i<le;i++)this._isSeparator(S[i])?(S[i]._next=S[(i+1)%le],S[i]._prev=S[(le+i-1)%le]):(null===first&&(first=i,components.push(first)),this._isSeparator(S[(i+1)%le])||i===le-1?(S[i]._next=S[first],S[first]._prev=S[i],S[i]._end=!0,first=null):(S[i]._next=S[(i+1)%le],S[first]._prev=S[i]),this._isSeparator(S[(le+i-1)%le])||(S[i]._prev=S[(le+i-1)%le]));return components},det:function(p1,p2,q){return(p1[1]-q[1])*(p2[2]-q[2])-(p2[1]-q[1])*(p1[2]-q[2])},windingNumber:function(usrCoords,path){var p1,p2,d,sign,i,wn=0,le=path.length,x=usrCoords[1],y=usrCoords[2];if(0===le)return 0;if(isNaN(x)||isNaN(y))return 1;if(path[0].coords.usrCoords[1]===x&&path[0].coords.usrCoords[2]===y)return 1;for(i=0;i<le;i++)if(p1=path[i].coords.usrCoords,p2=path[(i+1)%le].coords.usrCoords,!(0===p1[0]||0===p2[0]||isNaN(p1[1])||isNaN(p2[1])||isNaN(p1[2])||isNaN(p2[2]))){if(p2[2]===y){if(p2[1]===x)return 1;if(p1[2]===y&&p2[1]>x==p1[1]<x)return 0}if(p1[2]<y!=p2[2]<y)if(sign=2*(p2[2]>p1[2]?1:0)-1,p1[1]>=x)if(p2[1]>x)wn+=sign;else{if(0===(d=this.det(p1,p2,usrCoords)))return 0;d>0==p2[2]>p1[2]&&(wn+=sign)}else p2[1]>x&&(d=this.det(p1,p2,usrCoords))>0+Mat.eps==p2[2]>p1[2]&&(wn+=sign)}return wn},Vertex:function(coords,i,alpha,path,pathname,type){this.pos=i,this.intersection=!0,this.coords=coords,this.elementClass=Const.OBJECT_CLASS_POINT,this.data={alpha:alpha,path:path,pathname:pathname,done:!1,type:type,idx:0},this.neighbour=null,this.entry_exit=!1},_addToList:function(list,coords,pos){var len=list.length,eps=Mat.eps*Mat.eps;len>0&&Math.abs(list[len-1].coords.usrCoords[0]-coords.usrCoords[0])<eps&&Math.abs(list[len-1].coords.usrCoords[1]-coords.usrCoords[1])<eps&&Math.abs(list[len-1].coords.usrCoords[2]-coords.usrCoords[2])<eps||list.push({pos:pos,intersection:!1,coords:coords,elementClass:Const.OBJECT_CLASS_POINT})},sortIntersections:function(P_crossings){var i,j,P,Q,last,next_node,P_intersect=[],P_le=P_crossings.length;for(i=0;i<P_le;i++)if(P_crossings[i].sort((function(a,b){return a.data.alpha>b.data.alpha?1:-1})),P_crossings[i].length>0){for(last=P_crossings[i].length-1,next_node=(Q=(P=P_crossings[i][0]).data.path[P.pos])._next,i===P_le-1&&(Q._end=!1),0===P.data.alpha&&"T"===P.data.type?(Q.intersection=!0,Q.data=P.data,Q.neighbour=P.neighbour,Q.neighbour.neighbour=Q,Q.entry_exit=!1,P_crossings[i][0]=Q):(P._prev=Q,P._prev._next=P),j=1;j<=last;j++)(P=P_crossings[i][j])._prev=P_crossings[i][j-1],P._prev._next=P;(P=P_crossings[i][last])._next=next_node,P._next._prev=P,i===P_le-1&&(P._end=!0),P_intersect=P_intersect.concat(P_crossings[i])}return P_intersect},_inbetween:function(q,p1,p2){var alpha,eps=Mat.eps*Mat.eps,px=p2[1]-p1[1],py=p2[2]-p1[2],qx=q[1]-p1[1],qy=q[2]-p1[2];return 0===px&&0===py&&0===qx&&0===qy||(alpha=Math.abs(qx)<eps&&Math.abs(px)<eps?qy/py:qx/px,Math.abs(alpha)<eps&&(alpha=0),alpha)},_print_array:function(arr){var i,end;for(i=0;i<arr.length;i++)try{end="",arr[i]._end&&(end=" end"),console.log(i,arr[i].coords.usrCoords,arr[i].data.type,"\t","prev",arr[i]._prev.coords.usrCoords,"next",arr[i]._next.coords.usrCoords+end)}catch(e){console.log(i,arr[i].coords.usrCoords)}},_print_list:function(P){for(var alpha,cnt=0;cnt<100&&(alpha=P.data?P.data.alpha:"-",console.log("\t",P.coords.usrCoords,"\n\t\tis:",P.intersection,"end:",P._end,alpha,"\n\t\t-:",P._prev.coords.usrCoords,"\n\t\t+:",P._next.coords.usrCoords,"\n\t\tn:",P.intersection?P.neighbour.coords.usrCoords:"-"),!P._end);)P=P._next,cnt++},_noOverlap:function(p1,p2,q1,q2){var k,minp,maxp,minq,maxq,eps=Math.sqrt(Mat.eps),no_overlap=!1;for(k=0;k<3;k++)if(minp=Math.min(p1[k],p2[k]),maxp=Math.max(p1[k],p2[k]),minq=Math.min(q1[k],q2[k]),maxq=Math.max(q1[k],q2[k]),maxp<minq-eps||minp>maxq+eps){no_overlap=!0;break}return no_overlap},findIntersections:function(S,C,board){var i,j,crds,Si,Si1,Cj,Cj1,d1,d2,alpha,type,IS,IC,res=[],eps=Mat.eps,S_le=S.length,C_le=C.length,S_intersect=[],S_crossings=[],C_crossings=[],hasMultCompsS=!1,hasMultCompsC=!1;for(j=0;j<C_le;j++)C_crossings.push([]);for(i=0;i<S_le;i++)if(S_crossings.push([]),this._isSeparator(S[i])||this._isSeparator(S[(i+1)%S_le]))hasMultCompsS=!0;else{if(hasMultCompsS&&i===S_le-1)break;for(Si=S[i].coords.usrCoords,Si1=S[(i+1)%S_le].coords.usrCoords,j=0;j<C_le;j++)if(this._isSeparator(C[j])||this._isSeparator(C[(j+1)%C_le]))hasMultCompsC=!0;else{if(hasMultCompsC&&j===C_le-1)break;if(Cj=C[j].coords.usrCoords,Cj1=C[(j+1)%C_le].coords.usrCoords,!this._noOverlap(Si,Si1,Cj,Cj1)&&(res=Geometry.meetSegmentSegment(Si,Si1,Cj,Cj1),d1=Geometry.distance(Si,Si1,3),d2=Geometry.distance(Cj,Cj1,3),res[1]*d1>-eps&&res[1]<1-eps/d1&&res[2]*d2>-eps&&res[2]<1-eps/d2||res[1]===1/0&&res[2]===1/0&&Mat.norm(res[0],3)<eps)){if(crds=new Coords(Const.COORDS_BY_USER,res[0],board),type="X",Math.abs(res[1])*d1<eps||Math.abs(res[2])*d2<eps)type="T",Math.abs(res[1])*d1<eps&&(res[1]=0),Math.abs(res[2])*d2<eps&&(res[2]=0),crds=0===res[1]?new Coords(Const.COORDS_BY_USER,Si,board):new Coords(Const.COORDS_BY_USER,Cj,board);else if(res[1]===1/0&&res[2]===1/0&&Mat.norm(res[0],3)<eps){(alpha=this._inbetween(Si,Cj,Cj1))>=0&&alpha<1&&(type="T",crds=new Coords(Const.COORDS_BY_USER,Si,board),res[1]=0,res[2]=alpha,IS=new this.Vertex(crds,i,res[1],S,"S",type),IC=new this.Vertex(crds,j,res[2],C,"C",type),IS.neighbour=IC,IC.neighbour=IS,S_crossings[i].push(IS),C_crossings[j].push(IC)),alpha=this._inbetween(Cj,Si,Si1),Geometry.distance(Si,Cj,3)>eps&&alpha>=0&&alpha<1&&(type="T",crds=new Coords(Const.COORDS_BY_USER,Cj,board),res[1]=alpha,res[2]=0,IS=new this.Vertex(crds,i,res[1],S,"S",type),IC=new this.Vertex(crds,j,res[2],C,"C",type),IS.neighbour=IC,IC.neighbour=IS,S_crossings[i].push(IS),C_crossings[j].push(IC));continue}false,IS=new this.Vertex(crds,i,res[1],S,"S",type),IC=new this.Vertex(crds,j,res[2],C,"C",type),IS.neighbour=IC,IC.neighbour=IS,S_crossings[i].push(IS),C_crossings[j].push(IC)}}}for(S_intersect=this.sortIntersections(S_crossings),i=0;i<S_intersect.length;i++)S_intersect[i].data.idx=i,S_intersect[i].neighbour.data.idx=i;return[S_intersect,this.sortIntersections(C_crossings)]},_getPosition:function(q,p1,p2,p3){var s1=this.det(q,p1,p2),s2=this.det(q,p2,p3);return this.det(p1,p2,p3)>=0?s1>=0&&s2>=0?"left":"right":s1>=0||s2>=0?"left":"right"},_classifyDegenerateIntersections:function(P){var Pp,Pm,Qp,Qm,Q,side,cnt,tmp,oppositeDir,s1,s2,s3,s4;for(false,cnt=0,P._tours=0;;){if(P.intersection&&"T"===P.data.type&&(Pp=P._next.coords.usrCoords,Pm=P._prev.coords.usrCoords,Geometry.distance(P.coords.usrCoords,Pp,3)<Mat.eps&&(Pp=P._next._next.coords.usrCoords),Geometry.distance(P.coords.usrCoords,Pm,3)<Mat.eps&&(Pm=P._prev._prev.coords.usrCoords),Qm=(Q=P.neighbour)._prev.coords.usrCoords,Qp=Q._next.coords.usrCoords,Geometry.distance(Q.coords.usrCoords,Qp,3)<Mat.eps&&(Qp=Q._next._next.coords.usrCoords),Geometry.distance(Q.coords.usrCoords,Qm,3)<Mat.eps&&(Qm=Q._prev._prev.coords.usrCoords),s1=this.det(P.coords.usrCoords,Pm,Qm),s2=this.det(P.coords.usrCoords,Pp,Qp),s3=this.det(P.coords.usrCoords,Pm,Qp),s4=this.det(P.coords.usrCoords,Pp,Qm),0===s1&&0===s2&&0===s3&&0===s4&&(P.coords.usrCoords[1]*=1+Math.random()*Mat.eps,P.coords.usrCoords[2]*=1+Math.random()*Mat.eps,Q.coords.usrCoords[1]=P.coords.usrCoords[1],Q.coords.usrCoords[2]=P.coords.usrCoords[2],s1=this.det(P.coords.usrCoords,Pm,Qm),s2=this.det(P.coords.usrCoords,Pp,Qp),s3=this.det(P.coords.usrCoords,Pm,Qp),s4=this.det(P.coords.usrCoords,Pp,Qm)),oppositeDir=!1,0===s1?Geometry.affineRatio(P.coords.usrCoords,Pm,Qm)<0&&(oppositeDir=!0):0===s2?Geometry.affineRatio(P.coords.usrCoords,Pp,Qp)<0&&(oppositeDir=!0):0===s3?Geometry.affineRatio(P.coords.usrCoords,Pm,Qp)>0&&(oppositeDir=!0):0===s4&&Geometry.affineRatio(P.coords.usrCoords,Pp,Qm)>0&&(oppositeDir=!0),oppositeDir&&(tmp=Qm,Qm=Qp,Qp=tmp,tmp=s1,s1=s3,s3=tmp,tmp=s2,s2=s4,s4=tmp),Type.exists(P.delayedStatus)||(P.delayedStatus=[]),0===s1&&0===s2?P.delayedStatus=["on","on"]:0===s1?(side=this._getPosition(Pp,Qm,Q.coords.usrCoords,Qp),P.delayedStatus=["on",side]):0===s2?(side=this._getPosition(Pm,Qm,Q.coords.usrCoords,Qp),P.delayedStatus=[side,"on"]):0===P.delayedStatus.length&&(this._getPosition(Pm,Qm,Q.coords.usrCoords,Qp)!==this._getPosition(Pp,Qm,Q.coords.usrCoords,Qp)?P.data.type="X":P.data.type="B")),Type.exists(P._tours)&&P._tours++,P._tours>3||P._end||cnt>1e3){cnt>1e3&&console.log("Clipping: _classifyDegenerateIntersections exit"),Type.exists(P._tours)&&delete P._tours;break}P.intersection&&cnt++,P=P._next}},_handleIntersectionChains:function(P){var P_start,cnt=0,start_status="Null",intersection_chain=!1,wait_for_exit=!1;for(false;!0===P.intersection&&("T"===P.data.type&&("on"!==P.delayedStatus[0]&&"on"===P.delayedStatus[1]?(intersection_chain=!0,P_start=P,start_status=P.delayedStatus[0]):intersection_chain&&"on"===P.delayedStatus[0]&&"on"===P.delayedStatus[1]?P.data.type="B":intersection_chain&&"on"===P.delayedStatus[0]&&"on"!==P.delayedStatus[1]&&(intersection_chain=!1,start_status===P.delayedStatus[1]?(P_start.data.type="DB",P.data.type="DB"):(P_start.data.type="DX",P.data.type="DX"))),cnt++),P._end&&(wait_for_exit=!0),!wait_for_exit||intersection_chain;){if(cnt>1e3){console.log("Warning: _handleIntersectionChains: intersection chain reached maximum numbers of iterations");break}P=P._next}},_handleFullyDegenerateCase:function(S,C,board){var P,Q,l,M,q1,q2,node,i,j,le,le2,is_on_Q,is_fully_degenerated,arr=[S,C];for(l=0;l<2;l++){for(le=(P=arr[l]).length,i=0,is_fully_degenerated=!0;i<le;i++)if(!P[i].intersection){is_fully_degenerated=!1;break}if(is_fully_degenerated)for(le2=(Q=arr[(l+1)%2]).length,i=0;i<le;i++){for(q1=P[i].coords.usrCoords,q2=P[(i+1)%le].coords.usrCoords,M=[.5*(q1[0]+q2[0]),.5*(q1[1]+q2[1]),.5*(q1[2]+q2[2])],j=0,is_on_Q=!1;j<le2;j++)if(Math.abs(this.det(Q[j].coords.usrCoords,Q[(j+1)%le2].coords.usrCoords,M))<Mat.eps){is_on_Q=!0;break}if(!is_on_Q){node={pos:i,intersection:!1,coords:new Coords(Const.COORDS_BY_USER,M,board),elementClass:Const.OBJECT_CLASS_POINT},P[i]._next=node,node._prev=P[i],P[(i+1)%le]._prev=node,node._next=P[(i+1)%le],P[i]._end&&(P[i]._end=!1,node._end=!0);break}}}},_getStatus:function(P,path){for(;P.intersection&&!P._end;)P=P._next;return[P,this.windingNumber(P.coords.usrCoords,path)%2==0?"entry":"exit"]},markEntryExit:function(path1,path2,starters){var status,P,cnt,res,i,len,start,chain_start=null,intersection_chain=0;for(len=starters.length,i=0;i<len;i++)for(start=starters[i],this._classifyDegenerateIntersections(path1[start]),this._handleIntersectionChains(path1[start]),P=(res=this._getStatus(path1[start],path2))[0],status=res[1],P._starter=!0,cnt=0,chain_start=null,intersection_chain=0;!0===P.intersection&&("X"===P.data.type&&1===intersection_chain&&(chain_start.entry_exit=status,"exit"===status&&(chain_start.data.type="X"),intersection_chain=2),"X"!==P.data.type&&"DB"!==P.data.type||(P.entry_exit=status,status="entry"===status?"exit":"entry"),"DX"===P.data.type&&(0===intersection_chain?(chain_start=P,intersection_chain=1):1===intersection_chain?(P.entry_exit=status,chain_start.entry_exit=status,"exit"===status?chain_start.data.type="X":P.data.type="X",status="entry"===status?"exit":"entry",chain_start=null,intersection_chain=0):2===intersection_chain&&(P.entry_exit=status,P.data.type="X",status="entry"===status?"exit":"entry",chain_start=null,intersection_chain=0))),P=P._next,!(Type.exists(P._starter)||cnt>1e4);)cnt++},_stayOnPath:function(P,status){var stay=!0;return P.intersection&&"B"!==P.data.type&&(stay=status===P.entry_exit),stay},_addVertex:function(path,vertex,DEBUG){return isNaN(vertex.coords.usrCoords[1])||isNaN(vertex.coords.usrCoords[2])||path.push(vertex),vertex.intersection&&vertex.data.done?(DEBUG&&console.log("Add last intersection point",vertex.coords.usrCoords,"on",vertex.data.pathname,vertex.entry_exit,vertex.data.type),!0):(vertex.intersection&&(vertex.data.done=!0,DEBUG&&console.log("Add intersection point",vertex.coords.usrCoords,"on",vertex.data.pathname,vertex.entry_exit,vertex.data.type)),!1)},tracing:function(S,S_intersect,clip_type){var P,current,start,status,cnt=0,S_idx=0,path=[],done=!1;for(false;S_idx<S_intersect.length&&cnt<1e4;)if((current=S_intersect[S_idx]).data.done||"X"!==current.data.type)S_idx++;else{false,path.length>0&&path.push([NaN,NaN]),start=current.data.idx,P=S,done=this._addVertex(path,current,false),status=current.entry_exit;do{if(done)break;if("intersection"===clip_type&&"entry"===current.entry_exit||"union"===clip_type&&"exit"===current.entry_exit||"difference"===clip_type&&P===S==("exit"===current.entry_exit)){false;do{if(current=current._next,done=this._addVertex(path,current,false))break}while(this._stayOnPath(current,status));cnt++}else{false;do{if(current=current._prev,done=this._addVertex(path,current,false))break}while(this._stayOnPath(current,status));cnt++}if(done)break;if(!current.neighbour)return console.log("Tracing: emergency break - no neighbour!!!!!!!!!!!!!!!!!",cnt),[[0],[0]];if((current=current.neighbour).data.done)break;current.data.done=!0,status=current.entry_exit,P=current.data.path}while(current.data.idx!==start&&cnt<1e4);cnt>=1e4&&console.log("Tracing: stopping an infinite loop!",cnt),S_idx++}return this._getCoordsArrays(path,!1)},isEmptyCase:function(S,C,clip_type){return"intersection"===clip_type&&(0===S.length||0===C.length)||("union"===clip_type&&0===S.length&&0===C.length||"difference"===clip_type&&0===S.length)},_getCoordsArrays:function(path,doClose){var i,pathX=[],pathY=[],le=path.length;for(i=0;i<le;i++)path[i].coords?(pathX.push(path[i].coords.usrCoords[1]),pathY.push(path[i].coords.usrCoords[2])):(pathX.push(path[i][0]),pathY.push(path[i][1]));return doClose&&le>0&&(path[0].coords?(pathX.push(path[0].coords.usrCoords[1]),pathY.push(path[0].coords.usrCoords[2])):(pathX.push(path[0][0]),pathY.push(path[0][1]))),[pathX,pathY]},handleEmptyIntersection:function(S,C,clip_type){var P,Q,doClose=!1,path=[];if(0===S.length)return path="union"===clip_type?C:[],this._getCoordsArrays(path,!0);if(0===C.length)return path="intersection"===clip_type?[]:S,this._getCoordsArrays(path,!0);if(S.length>0)for(P=S[0];P.intersection&&!(P=P._next)._end;);if(C.length>0)for(Q=C[0];Q.intersection&&!(Q=Q._next)._end;);return 0===this.windingNumber(P.coords.usrCoords,C)?0!==this.windingNumber(Q.coords.usrCoords,S)?("union"===clip_type?(path=path.concat(S)).push(S[0]):"difference"===clip_type&&((path=path.concat(S)).push(S[0]),Geometry.signedPolygon(S)*Geometry.signedPolygon(C)>0&&path.reverse(),path.push([NaN,NaN])),"difference"!==clip_type&&"intersection"!==clip_type||((path=path.concat(C)).push(C[0]),doClose=!1)):"difference"===clip_type?(path=path.concat(S),doClose=!0):"union"===clip_type&&((path=path.concat(S)).push(S[0]),path.push([NaN,NaN]),(path=path.concat(C)).push(C[0])):"intersection"===clip_type?(path=path.concat(S),doClose=!0):"union"===clip_type&&(path=path.concat(C)).push(C[0]),this._getCoordsArrays(path,doClose)},_countCrossingIntersections:function(intersections){var i,le=intersections.length,sum=0;for(i=0;i<le;i++)"X"===intersections[i].data.type&&sum++;return sum},_getPath:function(obj,board){var i,len,r,rad,angle,alpha,steps,S=[];if(obj.elementClass!==Const.OBJECT_CLASS_CURVE||obj.type!==Const.OBJECT_TYPE_ARC&&obj.type!==Const.OBJECT_TYPE_SECTOR){if(obj.elementClass===Const.OBJECT_CLASS_CURVE&&Type.exists(obj.points))for(len=obj.numberPoints,i=0;i<len;i++)this._addToList(S,obj.points[i],i);else if(obj.type===Const.OBJECT_TYPE_POLYGON)for(i=0;i<obj.vertices.length;i++)this._addToList(S,obj.vertices[i].coords,i);else if(obj.elementClass===Const.OBJECT_CLASS_CIRCLE)for(steps=359,r=obj.Radius(),rad=2*Math.PI/steps,i=0;i<=steps;i++)this._addToList(S,new Coords(Const.COORDS_BY_USER,[obj.center.coords.usrCoords[0],obj.center.coords.usrCoords[1]+Math.cos(i*rad)*r,obj.center.coords.usrCoords[2]+Math.sin(i*rad)*r],board),i);else if(Type.isArray(obj))for(len=obj.length,i=0;i<len;i++)Type.exists(obj[i].coords)?this._addToList(S,obj[i].coords,i):Type.isArray(obj[i])?this._addToList(S,new Coords(Const.COORDS_BY_USER,obj[i],board),i):Type.exists(obj[i].usrCoords)&&this._addToList(S,obj[i],i)}else{for(angle=Geometry.rad(obj.radiuspoint,obj.center,obj.anglepoint),steps=Math.floor(180*angle/Math.PI),r=obj.Radius(),rad=angle/steps,alpha=Math.atan2(obj.radiuspoint.coords.usrCoords[2]-obj.center.coords.usrCoords[2],obj.radiuspoint.coords.usrCoords[1]-obj.center.coords.usrCoords[1]),obj.type===Const.OBJECT_TYPE_SECTOR&&this._addToList(S,obj.center.coords,0),i=0;i<=steps;i++)this._addToList(S,new Coords(Const.COORDS_BY_USER,[obj.center.coords.usrCoords[0],obj.center.coords.usrCoords[1]+Math.cos(i*rad+alpha)*r,obj.center.coords.usrCoords[2]+Math.sin(i*rad+alpha)*r],board),i+1);obj.type===Const.OBJECT_TYPE_SECTOR&&this._addToList(S,obj.center.coords,steps+2)}return S},greinerHormann:function(subject,clip,clip_type,board){var len,S_intersect,S_starters,C_starters,S=[],C=[];return(len=(S=this._getPath(subject,board)).length)>0&&Geometry.distance(S[0].coords.usrCoords,S[len-1].coords.usrCoords,3)<Mat.eps&&S.pop(),(len=(C=this._getPath(clip,board)).length)>0&&Geometry.distance(C[0].coords.usrCoords,C[len-1].coords.usrCoords,3)<Mat.eps*Mat.eps&&C.pop(),this.isEmptyCase(S,C,clip_type)?[[],[]]:(S_starters=this.makeDoublyLinkedList(S),C_starters=this.makeDoublyLinkedList(C),S_intersect=this.findIntersections(S,C,board)[0],this._handleFullyDegenerateCase(S,C,board),this.markEntryExit(S,C,S_starters),this.markEntryExit(C,S,C_starters),0===this._countCrossingIntersections(S_intersect)?this.handleEmptyIntersection(S,C,clip_type):this.tracing(S,S_intersect,clip_type))},union:function(path1,path2,board){return this.greinerHormann(path1,path2,"union",board)},intersection:function(path1,path2,board){return this.greinerHormann(path1,path2,"intersection",board)},difference:function(path1,path2,board){return this.greinerHormann(path1,path2,"difference",board)}},JXG.extend(Mat.Clip,{}),Mat.Clip})),define("math/poly",["jxg","math/math","utils/type"],(function(JXG,Mat,Type){return Mat.Poly={},Mat.Poly.Ring=function(variables){this.vars=variables},JXG.extend(Mat.Poly.Ring.prototype,{}),Mat.Poly.Monomial=function(ring,coefficient,exponents){var i;if(!Type.exists(ring))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(Type.isArray(exponents)||(exponents=[]),i=(exponents=exponents.slice(0,ring.vars.length)).length;i<ring.vars.length;i++)exponents.push(0);this.ring=ring,this.coefficient=coefficient||0,this.exponents=Type.deepCopy(exponents)},JXG.extend(Mat.Poly.Monomial.prototype,{copy:function(){return new Mat.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var i,s=[];for(i=0;i<this.ring.vars.length;i++)s.push(this.ring.vars[i]+"^"+this.exponents[i]);return this.coefficient+"*"+s.join("*")}}),Mat.Poly.Polynomial=function(ring,str){var mons;if(!Type.exists(ring))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");mons=Type.exists(str)&&Type.isString(str)?void 0:[],this.ring=ring,this.monomials=mons},JXG.extend(Mat.Poly.Polynomial.prototype,{findSignature:function(sig){var i;for(i=0;i<this.monomials.length;i++)if(Type.cmpArrays(this.monomials[i].exponents,sig))return i;return-1},addSubMonomial:function(m,factor){var i;(i=this.findSignature(m.exponents))>-1?this.monomials[i].coefficient+=factor*m.coefficient:(m.coefficient*=factor,this.monomials.push(m))},add:function(mp){var i;if(!Type.exists(mp)||mp.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(Type.isArray(mp.exponents))this.addSubMonomial(mp,1);else for(i=0;i<mp.monomials.length;i++)this.addSubMonomial(mp.monomials[i],1)},sub:function(mp){var i;if(!Type.exists(mp)||mp.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(Type.isArray(mp.exponents))this.addSubMonomial(mp,-1);else for(i=0;i<mp.monomials.length;i++)this.addSubMonomial(mp.monomials[i],-1)},copy:function(){var i,p;for(p=new Mat.Poly.Polynomial(this.ring),i=0;i<this.monomials.length;i++)p.monomials.push(this.monomials[i].copy());return p},print:function(){var i,s=[];for(i=0;i<this.monomials.length;i++)s.push("("+this.monomials[i].print()+")");return s.join("+")}}),Mat.Poly})),define("math/complex",["jxg","utils/type"],(function(JXG,Type){return JXG.Complex=function(x,y){this.isComplex=!0,x&&x.isComplex&&(y=x.imaginary,x=x.real),this.real=x||0,this.imaginary=y||0,this.absval=0,this.angle=0},JXG.extend(JXG.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(c){return Type.isNumber(c)?this.real+=c:(this.real+=c.real,this.imaginary+=c.imaginary),this},sub:function(c){return Type.isNumber(c)?this.real-=c:(this.real-=c.real,this.imaginary-=c.imaginary),this},mult:function(c){var re,im;return Type.isNumber(c)?(this.real*=c,this.imaginary*=c):(re=this.real,im=this.imaginary,this.real=re*c.real-im*c.imaginary,this.imaginary=re*c.imaginary+im*c.real),this},div:function(c){var denom,im,re;if(Type.isNumber(c)){if(Math.abs(c)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=c,this.imaginary/=c}else{if(Math.abs(c.real)<Math.eps&&Math.abs(c.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;denom=c.real*c.real+c.imaginary*c.imaginary,re=this.real,im=this.imaginary,this.real=(re*c.real+im*c.imaginary)/denom,this.imaginary=(im*c.real-re*c.imaginary)/denom}return this},conj:function(){return this.imaginary*=-1,this}}),JXG.C={},JXG.C.add=function(z1,z2){var z=new JXG.Complex(z1);return z.add(z2),z},JXG.C.sub=function(z1,z2){var z=new JXG.Complex(z1);return z.sub(z2),z},JXG.C.mult=function(z1,z2){var z=new JXG.Complex(z1);return z.mult(z2),z},JXG.C.div=function(z1,z2){var z=new JXG.Complex(z1);return z.div(z2),z},JXG.C.conj=function(z1){var z=new JXG.Complex(z1);return z.conj(),z},JXG.C.abs=function(z1){var z=new JXG.Complex(z1);return z.conj(),z.mult(z1),Math.sqrt(z.real)},JXG.Complex.C=JXG.C,JXG.Complex})),define("utils/color",["jxg","utils/type","math/math"],(function(JXG,Type,Mat){var simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},colorDefs=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(bits){return[parseInt(bits[1],10),parseInt(bits[2],10),parseInt(bits[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(bits){return[parseInt(bits[1],10),parseInt(bits[2],10),parseInt(bits[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(bits){return[parseInt(bits[1],16),parseInt(bits[2],16),parseInt(bits[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(bits){return[parseInt(bits[1]+bits[1],16),parseInt(bits[2]+bits[2],16),parseInt(bits[3]+bits[3],16)]}}];return JXG.rgbParser=function(color,ag,ab){var color_string,channels,re,processor,bits,i,r,g,b,testFloat,values=color;if(!Type.exists(color))return[];if(Type.exists(ag)&&Type.exists(ab)&&(values=[color,ag,ab]),color_string=values,testFloat=!1,Type.isArray(color_string)){for(i=0;i<3;i++)testFloat=testFloat||/\./.test(values[i].toString());for(i=0;i<3;i++)testFloat=testFloat&&values[i]>=0&&values[i]<=1;return testFloat?[Math.ceil(255*values[0]),Math.ceil(255*values[1]),Math.ceil(255*values[2])]:values}for("string"==typeof values&&(color_string=values),"#"===color_string.charAt(0)&&(color_string=color_string.substr(1,6)),color_string=color_string.replace(/ /g,"").toLowerCase(),color_string=simpleColors[color_string]||color_string,i=0;i<colorDefs.length;i++)re=colorDefs[i].re,processor=colorDefs[i].process,(bits=re.exec(color_string))&&(r=(channels=processor(bits))[0],g=channels[1],b=channels[2]);return isNaN(r)||isNaN(g)||isNaN(b)?[]:[r=r<0||isNaN(r)?0:r>255?255:r,g=g<0||isNaN(g)?0:g>255?255:g,b=b<0||isNaN(b)?0:b>255?255:b]},JXG.rgb2css=function(color,ag,ab){var r;return"rgb("+(r=JXG.rgbParser(color,ag,ab))[0]+", "+r[1]+", "+r[2]+")"},JXG.rgb2hex=function(color,ag,ab){var r,g,b;return g=(r=JXG.rgbParser(color,ag,ab))[1],b=r[2],r=(r=r[0]).toString(16),g=g.toString(16),b=b.toString(16),1===r.length&&(r="0"+r),1===g.length&&(g="0"+g),1===b.length&&(b="0"+b),"#"+r+g+b},JXG.hex2rgb=function(hex){return JXG.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),JXG.rgb2css(hex)},JXG.hsv2rgb=function(H,S,V){var R,G,B,f,i,hTemp,p,q,t;if(H=(H%360+360)%360,0===S){if(!(isNaN(H)||H<Mat.eps))return"#ffffff";R=V,G=V,B=V}else switch(hTemp=H>=360?0:H,p=V*(1-S),q=V*(1-S*(f=(hTemp/=60)-(i=Math.floor(hTemp)))),t=V*(1-S*(1-f)),i){case 0:R=V,G=t,B=p;break;case 1:R=q,G=V,B=p;break;case 2:R=p,G=V,B=t;break;case 3:R=p,G=q,B=V;break;case 4:R=t,G=p,B=V;break;case 5:R=V,G=p,B=q}return["#",R=2===(R=Math.round(255*R).toString(16)).length?R:1===R.length?"0"+R:"00",G=2===(G=Math.round(255*G).toString(16)).length?G:1===G.length?"0"+G:"00",B=2===(B=Math.round(255*B).toString(16)).length?B:1===B.length?"0"+B:"00"].join("")},JXG.rgb2hsv=function(color,ag,ab){var r,g,b,fr,fg,fb,fmax,fmin,h,s,v,max,min;return g=(r=JXG.rgbParser(color,ag,ab))[1],b=r[2],fr=(r=r[0])/255,fg=g/255,fb=b/255,max=Math.max(r,g,b),fmin=(min=Math.min(r,g,b))/255,s=0,(v=fmax=max/255)>0&&(s=(v-fmin)/v),h=1/(fmax-fmin),s>0&&(max===r?h*=fg-fb:h=max===g?2+(fb-fr)*h:4+(fr-fg)*h),(h*=60)<0&&(h+=360),max===min&&(h=0),[h,s,v]},JXG.rgb2LMS=function(color,ag,ab){var r,g,b,l,m,s,ret,matrix=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return g=(r=JXG.rgbParser(color,ag,ab))[1],b=r[2],r=r[0],r=Math.pow(r,.476190476),g=Math.pow(g,.476190476),b=Math.pow(b,.476190476),(ret=[l=r*matrix[0][0]+g*matrix[0][1]+b*matrix[0][2],m=r*matrix[1][0]+g*matrix[1][1]+b*matrix[1][2],s=r*matrix[2][0]+g*matrix[2][1]+b*matrix[2][2]]).l=l,ret.m=m,ret.s=s,ret},JXG.LMS2rgb=function(l,m,s){var r,g,b,ret,matrix=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],lut_lookup=function(value){for(var offset=127,step=64;step>0;){if(Math.pow(offset,.476190476)>value)offset-=step;else{if(Math.pow(offset+1,.476190476)>value)return offset;offset+=step}step/=2}return 254===offset&&13.994955247<value?255:offset};return r=l*matrix[0][0]+m*matrix[0][1]+s*matrix[0][2],g=l*matrix[1][0]+m*matrix[1][1]+s*matrix[1][2],b=l*matrix[2][0]+m*matrix[2][1]+s*matrix[2][2],(ret=[r=lut_lookup(r),g=lut_lookup(g),b=lut_lookup(b)]).r=r,ret.g=g,ret.b=b,ret},JXG.rgba2rgbo=function(rgba){var opacity;return 9===rgba.length&&"#"===rgba.charAt(0)?(opacity=parseInt(rgba.substr(7,2).toUpperCase(),16)/255,rgba=rgba.substr(0,7)):opacity=1,[rgba,opacity]},JXG.rgbo2rgba=function(rgb,o){var rgba;return"none"===rgb?rgb:(1===(rgba=Math.round(255*o).toString(16)).length&&(rgba="0"+rgba),rgb+rgba)},JXG.rgb2bw=function(color){var x,tmp,arr;return"none"===color?color:(arr=JXG.rgbParser(color),x=Math.floor(.3*arr[0]+.59*arr[1]+.11*arr[2]),color="#"+(tmp="0123456789ABCDEF".charAt(x>>4&15)+"0123456789ABCDEF".charAt(15&x))+tmp+tmp)},JXG.rgb2cb=function(color,deficiency){var rgb,l,m,s,lms,a1,b1,c1,a2,b2,c2,HexChars="0123456789ABCDEF";if("none"===color)return color;switch(l=(lms=JXG.rgb2LMS(color))[0],m=lms[1],s=lms[2],deficiency=deficiency.toLowerCase()){case"protanopia":a1=-.06150039994295001,b1=.08277001656812001,c1=-.013200141220000003,a2=.05858939668799999,b2=-.07934519995360001,c2=.013289415272000003,l=s/m<.6903216543277437?-(b1*m+c1*s)/a1:-(b2*m+c2*s)/a2;break;case"tritanopia":a1=-.00058973116217,b1=.007690316482,c1=-.01011703519052,a2=.025495080838999994,b2=-.0422740347,c2=.017005316784,s=m/l<.8349489908460004?-(a1*l+b1*m)/c1:-(a2*l+b2*m)/c2;break;default:a1=-.06150039994295001,b1=.08277001656812001,c1=-.013200141220000003,a2=.05858939668799999,b2=-.07934519995360001,c2=.013289415272000003,m=s/l<.5763833686400911?-(a1*l+c1*s)/b1:-(a2*l+c2*s)/b2}return rgb=JXG.LMS2rgb(l,m,s),color="#"+(HexChars.charAt(rgb[0]>>4&15)+HexChars.charAt(15&rgb[0])),color+=HexChars.charAt(rgb[1]>>4&15)+HexChars.charAt(15&rgb[1]),color+=HexChars.charAt(rgb[2]>>4&15)+HexChars.charAt(15&rgb[2])},JXG.autoHighlight=function(colstr){var col=JXG.rgba2rgbo(colstr),c=col[0],opa=col[1];return"#"===colstr.charAt(0)?(opa*=opa<.3?1.8:.4,JXG.rgbo2rgba(c,opa)):colstr},JXG.contrast=function(hexColor,darkColor,lightColor,threshold){var rgb,rgbBlack,l1,l2,contrastRatio;return darkColor=darkColor||"#000000",lightColor=lightColor||"#ffffff",threshold=threshold||7,rgb=JXG.rgbParser(hexColor),rgbBlack=JXG.rgbParser("#000000"),contrastRatio=(l1=.2126*Math.pow(rgb[0]/255,2.2)+.7152*Math.pow(rgb[1]/255,2.2)+.0722*Math.pow(rgb[2]/255,2.2))>(l2=.2126*Math.pow(rgbBlack[0]/255,2.2)+.7152*Math.pow(rgbBlack[1]/255,2.2)+.0722*Math.pow(rgbBlack[2]/255,2.2))?Math.floor((l1+.05)/(l2+.05)):Math.floor((l2+.05)/(l1+.05)),(contrastRatio-=1)>threshold?darkColor:lightColor},JXG.setClassicColors=function(){JXG.Options.elements.strokeColor="blue",JXG.Options.elements.fillColor="red",JXG.Options.hatch.strokeColor="blue",JXG.Options.angle.fillColor="#ff7f00",JXG.Options.angle.highlightFillColor="#ff7f00",JXG.Options.angle.strokeColor="#ff7f00",JXG.Options.angle.label.strokeColor="blue",JXG.Options.arc.strokeColor="blue",JXG.Options.circle.center.fillColor="red",JXG.Options.circle.center.strokeColor="blue",JXG.Options.circumcircle.strokeColor="blue",JXG.Options.circumcircle.center.fillColor="red",JXG.Options.circumcircle.center.strokeColor="blue",JXG.Options.circumcirclearc.strokeColor="blue",JXG.Options.circumcirclesector.strokeColor="blue",JXG.Options.circumcirclesector.fillColor="green",JXG.Options.circumcirclesector.highlightFillColor="green",JXG.Options.conic.strokeColor="blue",JXG.Options.curve.strokeColor="blue",JXG.Options.incircle.strokeColor="blue",JXG.Options.incircle.center.fillColor="red",JXG.Options.incircle.center.strokeColor="blue",JXG.Options.inequality.fillColor="red",JXG.Options.integral.fillColor="red",JXG.Options.integral.curveLeft.color="red",JXG.Options.integral.curveRight.color="red",JXG.Options.line.strokeColor="blue",JXG.Options.point.fillColor="red",JXG.Options.point.strokeColor="red",JXG.Options.polygon.fillColor="green",JXG.Options.polygon.highlightFillColor="green",JXG.Options.polygon.vertices.strokeColor="red",JXG.Options.polygon.vertices.fillColor="red",JXG.Options.regularpolygon.fillColor="green",JXG.Options.regularpolygon.highlightFillColor="green",JXG.Options.regularpolygon.vertices.strokeColor="red",JXG.Options.regularpolygon.vertices.fillColor="red",JXG.Options.riemannsum.fillColor="yellow",JXG.Options.sector.fillColor="green",JXG.Options.sector.highlightFillColor="green",JXG.Options.semicircle.center.fillColor="red",JXG.Options.semicircle.center.strokeColor="blue",JXG.Options.slopetriangle.fillColor="red",JXG.Options.slopetriangle.highlightFillColor="red",JXG.Options.turtle.arrow.strokeColor="blue"},JXG.extend(JXG,{paletteWong:{black:"#000000",orange:"#E69F00",skyblue:"#56B4E9",bluishgreen:"#009E73",yellow:"#F0E442",darkblue:"#0072B2",vermillion:"#D55E00",reddishpurple:"#CC79A7",blue:"#0072B2",red:"#D55E00",green:"#009E73",purple:"#CC79A7",white:"#ffffff"}}),JXG.palette=JXG.paletteWong,JXG})),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],(function(JXG,Const,Mat,Color,Type){return JXG.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],maxBoundingBox:[-1/0,1/0,1/0,-1/0],zoomFactor:1,zoomX:1,zoomY:1,title:"",description:"",showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showFullscreen:!1,fullscreen:{symbol:"□",id:null},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,maxFrameRate:40,registerEvents:!0,minimizeReflow:"none",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},drag:{enabled:!0},keyboard:{enabled:!0,dx:10,dy:10,panShift:!0,panCtrl:!1},resize:{enabled:!0,throttle:10},moveTarget:null,selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1},showInfobox:!0},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",fillColor:Color.palette.red,highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,gradient:null,gradientSecondColor:"#ffffff",gradientSecondOpacity:1,gradientStartOffset:0,gradientEndOffset:1,gradientAngle:0,gradientCX:.5,gradientCY:.5,gradientR:.5,gradientFX:.5,gradientFY:.5,gradientFR:0,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,precision:"inherit",draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1,tabindex:0},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},beautifulScientificTickLabels:!1,useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,digits:3,ticksDistance:1,face:"|",strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"none",highlightFillColor:"none",visible:"inherit",includeBoundaries:!1,type:"linear"},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",face:"|",strokeWidth:2,strokeColor:Color.palette.blue,ticksDistance:.2},precision:{touch:30,touchMax:100,mouse:4,pen:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,unused9:19,unused8:18,unused7:17,unused6:16,unused5:15,unused4:14,unused3:13,unused2:12,unused1:11,unused0:10,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:"auto",type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:Color.palette.orange,highlightFillColor:Color.palette.orange,strokeColor:Color.palette.orange,fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"#000000",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:Color.palette.blue},arc:{visible:!1,fillColor:"none"}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",useDirection:!1,center:{},radiusPoint:{},anglePoint:{}},arrow:{firstArrow:!1,lastArrow:{type:1,highlightSize:6,size:6}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,highlightSize:8,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},tabindex:-1,label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"#000000"},line2:{strokeColor:"#000000"}},boxplot:{dir:"vertical",smallWidth:.5,strokeWidth:2,strokeColor:Color.palette.blue,fillColor:Color.palette.blue,fillOpacity:.2,highlightStrokeWidth:2,highlightStrokeColor:Color.palette.blue,highlightFillColor:Color.palette.blue,highlightFillOpacity:.1},button:{disabled:!1,display:"html"},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1,display:"html"},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,fillColor:Color.palette.red,strokeColor:Color.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:Color.palette.red,strokeColor:Color.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:Color.palette.yellow,highlightFillColor:Color.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""},line:{visible:!1}},curve:{strokeWidth:1,strokeColor:Color.palette.blue,fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:15,doAdvancedPlotOld:!1,plotVersion:2,label:{position:"lft"},firstArrow:!1,lastArrow:!1},foreignobject:{attractors:[],fixed:!0,visible:!0},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#c0c0c0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"#000000",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:Color.palette.red,strokeColor:Color.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},inequality:{fillColor:Color.palette.red,fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:Color.palette.red,fillOpacity:.3,highlightFillColor:Color.palette.red,highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:Color.palette.red,fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:Color.palette.red,fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288,display:"html"},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"#000000",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"#000000",fixed:!0,position:"urt",offset:[10,10],autoPosition:!1},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],rowHeight:20,strokeWidth:5},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:Color.palette.blue,highlightStrokeColor:"#c3d9ff",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},metapostspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},mirrorelement:{fixed:!0,point:{},center:{},type:"Euclidean"},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",strokeWidth:2,fillColor:Color.palette.red,strokeColor:Color.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",zoom:!1,showInfobox:"inherit",infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,attractToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:Color.palette.yellow,highlightFillColor:Color.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:Color.palette.red,fillColor:Color.palette.red,fixed:!1,visible:"inherit"},label:{offset:[0,0]}},polygonalchain:{fillColor:"none",highlightFillColor:"none"},prescribedangle:{anglePoint:{size:2,visible:!1,withLabel:!1}},reflection:{fixed:!0,center:{},type:"Euclidean"},regularpolygon:{hasInnerPoints:!1,fillColor:Color.palette.yellow,highlightFillColor:Color.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:Color.palette.red,fillColor:Color.palette.red,fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:Color.palette.yellow},sector:{fillColor:Color.palette.yellow,highlightFillColor:Color.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiusPoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglePoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,fillColor:Color.palette.red,strokeColor:Color.palette.red,highlightFillColor:"#eeeeee",highlightStrokeColor:Color.palette.red,name:""}},slider:{snapWidth:-1,precision:2,digits:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,visible:"inherit",fixed:!0,scalable:!1,tabindex:null,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,digits:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,visible:"inherit",fixed:!0,tabindex:null,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{visible:"inherit",strokeColor:"#000000"},moveOnUp:!0},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:Color.palette.red,fillOpacity:.4,highlightFillColor:Color.palette.red,highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,digits:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,fontUnit:"px",digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"#000000",highlightStrokeColor:"#000000",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,useKatex:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:Color.palette.red,lastArrow:!0}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},JXG.Validator=function(){var i,validateColor=function(v){return Type.isString(v)},validateInteger=function(v){return Math.abs(v-Math.round(v))<Mat.eps},validatePositiveInteger=function(v){return validateInteger(v)&&v>0},validatePositive=function(v){return v>0},validateNotNegative=function(v){return v>=0},v={},validators={attractorDistance:validateNotNegative,color:validateColor,defaultDistance:Type.isNumber,display:function(v){return"html"===v||"internal"===v},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(v){return Type.exists(JXG.normalizePointFace(v))},factor:Type.isNumber,fillColor:validateColor,fillOpacity:Type.isNumber,firstArrow:!1,fontSize:validateInteger,dash:validateInteger,gridX:Type.isNumber,gridY:Type.isNumber,hasGrid:!1,highlightFillColor:validateColor,highlightFillOpacity:Type.isNumber,highlightStrokeColor:validateColor,highlightStrokeOpacity:Type.isNumber,insertTicks:!1,lastArrow:!1,layer:function(v){return validateInteger(v)&&v>=0},majorHeight:validateInteger,minorHeight:validateInteger,minorTicks:validateNotNegative,minTicksDistance:validatePositiveInteger,numberPointsHigh:validatePositiveInteger,numberPointsLow:validatePositiveInteger,opacity:Type.isNumber,radius:Type.isNumber,RDPsmoothing:!1,renderer:function(v){return"vml"===v||"svg"===v||"canvas"===v||"no"===v},right:function(v){return/^[0-9]+px$/.test(v)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:validateNotNegative,snapSizeX:validatePositive,snapSizeY:validatePositive,snapWidth:Type.isNumber,snapToGrid:!1,snatchDistance:validateNotNegative,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:validateColor,strokeOpacity:Type.isNumber,strokeWidth:validateNotNegative,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(i in validators)validators.hasOwnProperty(i)&&(v[i.toLowerCase()]=validators[i]);return v}(),JXG.normalizePointFace=function(s){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[s]},JXG.useStandardOptions=function(board){var el,t,p,copyProps,o=JXG.Options,boardHadGrid=board.hasGrid;for(el in board.options.grid.hasGrid=o.grid.hasGrid,board.options.grid.gridX=o.grid.gridX,board.options.grid.gridY=o.grid.gridY,board.options.grid.gridColor=o.grid.gridColor,board.options.grid.gridOpacity=o.grid.gridOpacity,board.options.grid.gridDash=o.grid.gridDash,board.options.grid.snapToGrid=o.grid.snapToGrid,board.options.grid.snapSizeX=o.grid.SnapSizeX,board.options.grid.snapSizeY=o.grid.SnapSizeY,board.takeSizeFromFile=o.takeSizeFromFile,copyProps=function(p,o){p.visProp.fillcolor=o.fillColor,p.visProp.highlightfillcolor=o.highlightFillColor,p.visProp.strokecolor=o.strokeColor,p.visProp.highlightstrokecolor=o.highlightStrokeColor},board.objects)if(board.objects.hasOwnProperty(el))if((p=board.objects[el]).elementClass===Const.OBJECT_CLASS_POINT)copyProps(p,o.point);else if(p.elementClass===Const.OBJECT_CLASS_LINE)for(copyProps(p,o.line),t=0;t<p.ticks.length;t++)p.ticks[t].majorTicks=o.line.ticks.majorTicks,p.ticks[t].minTicksDistance=o.line.ticks.minTicksDistance,p.ticks[t].visProp.minorheight=o.line.ticks.minorHeight,p.ticks[t].visProp.majorheight=o.line.ticks.majorHeight;else p.elementClass===Const.OBJECT_CLASS_CIRCLE?copyProps(p,o.circle):p.type===Const.OBJECT_TYPE_ANGLE?copyProps(p,o.angle):p.type===Const.OBJECT_TYPE_ARC?copyProps(p,o.arc):p.type===Const.OBJECT_TYPE_POLYGON?copyProps(p,o.polygon):p.type===Const.OBJECT_TYPE_CONIC?copyProps(p,o.conic):p.type===Const.OBJECT_TYPE_CURVE?copyProps(p,o.curve):p.type===Const.OBJECT_TYPE_SECTOR&&(p.arc.visProp.fillcolor=o.sector.fillColor,p.arc.visProp.highlightfillcolor=o.sector.highlightFillColor,p.arc.visProp.fillopacity=o.sector.fillOpacity,p.arc.visProp.highlightfillopacity=o.sector.highlightFillOpacity);board.fullUpdate(),boardHadGrid&&!board.hasGrid?board.removeGrids(board):!boardHadGrid&&board.hasGrid&&board.create("grid",[])},JXG.useBlackWhiteOptions=function(board){var o=JXG.Options;o.point.fillColor=Color.rgb2bw(o.point.fillColor),o.point.highlightFillColor=Color.rgb2bw(o.point.highlightFillColor),o.point.strokeColor=Color.rgb2bw(o.point.strokeColor),o.point.highlightStrokeColor=Color.rgb2bw(o.point.highlightStrokeColor),o.line.fillColor=Color.rgb2bw(o.line.fillColor),o.line.highlightFillColor=Color.rgb2bw(o.line.highlightFillColor),o.line.strokeColor=Color.rgb2bw(o.line.strokeColor),o.line.highlightStrokeColor=Color.rgb2bw(o.line.highlightStrokeColor),o.circle.fillColor=Color.rgb2bw(o.circle.fillColor),o.circle.highlightFillColor=Color.rgb2bw(o.circle.highlightFillColor),o.circle.strokeColor=Color.rgb2bw(o.circle.strokeColor),o.circle.highlightStrokeColor=Color.rgb2bw(o.circle.highlightStrokeColor),o.arc.fillColor=Color.rgb2bw(o.arc.fillColor),o.arc.highlightFillColor=Color.rgb2bw(o.arc.highlightFillColor),o.arc.strokeColor=Color.rgb2bw(o.arc.strokeColor),o.arc.highlightStrokeColor=Color.rgb2bw(o.arc.highlightStrokeColor),o.polygon.fillColor=Color.rgb2bw(o.polygon.fillColor),o.polygon.highlightFillColor=Color.rgb2bw(o.polygon.highlightFillColor),o.sector.fillColor=Color.rgb2bw(o.sector.fillColor),o.sector.highlightFillColor=Color.rgb2bw(o.sector.highlightFillColor),o.curve.strokeColor=Color.rgb2bw(o.curve.strokeColor),o.grid.gridColor=Color.rgb2bw(o.grid.gridColor),JXG.useStandardOptions(board)},JXG.Options.normalizePointFace=JXG.normalizePointFace,JXG.Options})),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],(function(JXG,Options,Coords,Const,Mat,Geometry,Type,Env){return JXG.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},JXG.extend(JXG.AbstractRenderer.prototype,{_updateVisual:function(el,not,enhanced){(enhanced||this.enhancedRendering)&&(not=not||{},this.setObjectTransition(el),Type.evaluate(el.visProp.draft)?this.setDraft(el):(not.stroke||(el.highlighted?(this.setObjectStrokeColor(el,el.visProp.highlightstrokecolor,el.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(el,el.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(el,el.visProp.strokecolor,el.visProp.strokeopacity),this.setObjectStrokeWidth(el,el.visProp.strokewidth))),not.fill||(el.highlighted?this.setObjectFillColor(el,el.visProp.highlightfillcolor,el.visProp.highlightfillopacity):this.setObjectFillColor(el,el.visProp.fillcolor,el.visProp.fillopacity)),not.dash||this.setDashStyle(el,el.visProp),not.shadow||this.setShadow(el),not.gradient||this.setShadow(el),not.tabindex||this.setTabindex(el)))},_getHighlighted:function(el){var isTrace=!1;return Type.exists(el.board)&&Type.exists(el.board.highlightedObjects)||(isTrace=!0),!isTrace&&Type.exists(el.board.highlightedObjects[el.id])?"highlight":""},drawPoint:function(el){var prim,face=Options.normalizePointFace(Type.evaluate(el.visProp.face));prim="o"===face?"ellipse":"[]"===face?"rect":"path",el.rendNode=this.appendChildPrim(this.createPrim(prim,el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,prim),this._updateVisual(el,{dash:!0,shadow:!0},!0),this.updatePoint(el)},updatePoint:function(el){var s1,size=Type.evaluate(el.visProp.size),face=Options.normalizePointFace(Type.evaluate(el.visProp.face)),unit=Type.evaluate(el.visProp.sizeunit),zoom=Type.evaluate(el.visProp.zoom);isNaN(el.coords.scrCoords[2]+el.coords.scrCoords[1])||("user"===unit&&(size*=Math.sqrt(el.board.unitX*el.board.unitY)),s1=0===(size*=el.board&&zoom?Math.sqrt(el.board.zoomX*el.board.zoomY):1)?0:size+1,"o"===face?this.updateEllipsePrim(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2],s1,s1):"[]"===face?this.updateRectPrim(el.rendNode,el.coords.scrCoords[1]-size,el.coords.scrCoords[2]-size,2*size,2*size):this.updatePathPrim(el.rendNode,this.updatePathStringPoint(el,size,face),el.board),this._updateVisual(el,{dash:!1,shadow:!1}),this.setShadow(el))},changePointStyle:function(el){var node=this.getElementById(el.id);Type.exists(node)&&this.remove(node),this.drawPoint(el),Type.clearVisPropOld(el),el.visPropCalc.visible||this.display(el,!1),Type.evaluate(el.visProp.draft)&&this.setDraft(el)},drawLine:function(el){el.rendNode=this.appendChildPrim(this.createPrim("line",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"lines"),this.updateLine(el)},updateLine:function(el){this._updateVisual(el),this.updatePathWithArrowHeads(el),this.setLineCap(el)},drawCurve:function(el){el.rendNode=this.appendChildPrim(this.createPrim("path",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"path"),this.updateCurve(el)},updateCurve:function(el){this._updateVisual(el),this.updatePathWithArrowHeads(el),this.setLineCap(el)},updatePathWithArrowHeads:function(el,doHighlight){var w,arrowData,ev=el.visProp,hl=doHighlight?"highlight":"";w=doHighlight&&ev.highlightstrokewidth?Math.max(Type.evaluate(ev.highlightstrokewidth),Type.evaluate(ev.strokewidth)):Type.evaluate(ev.strokewidth),arrowData=this.getArrowHeadData(el,w,hl),this.makeArrows(el,arrowData),el.elementClass===Const.OBJECT_CLASS_LINE?this.updateLineWithEndings(el,arrowData):el.elementClass===Const.OBJECT_CLASS_CURVE&&this.updatePath(el),this.setArrowSize(el,arrowData)},getArrowHeadData:function(el,strokewidth,hl){var typeFirst,typeLast,off,size,minlen=Mat.eps,offFirst=0,offLast=0,sizeFirst=0,sizeLast=0,ev_fa=Type.evaluate(el.visProp.firstarrow),ev_la=Type.evaluate(el.visProp.lastarrow);return(ev_fa||ev_la)&&(typeFirst=Type.exists(ev_fa.type)?Type.evaluate(ev_fa.type):el.elementClass===Const.OBJECT_CLASS_LINE?1:7,typeLast=Type.exists(ev_la.type)?Type.evaluate(ev_la.type):el.elementClass===Const.OBJECT_CLASS_LINE?1:7,ev_fa&&(size=6,Type.exists(ev_fa.size)&&(size=Type.evaluate(ev_fa.size)),""!==hl&&Type.exists(ev_fa[hl+"size"])&&(size=Type.evaluate(ev_fa[hl+"size"])),off=strokewidth*size,2===typeFirst?(off*=.5,minlen+=strokewidth*size):3===typeFirst?(off=strokewidth*size/3,minlen+=strokewidth):4===typeFirst||5===typeFirst||6===typeFirst?(off=strokewidth*size/1.5,minlen+=strokewidth*size):7===typeFirst?(off=0,size=10,minlen+=strokewidth):minlen+=strokewidth*size,offFirst+=off,sizeFirst=size),ev_la&&(size=6,Type.exists(ev_la.size)&&(size=Type.evaluate(ev_la.size)),""!==hl&&Type.exists(ev_la[hl+"size"])&&(size=Type.evaluate(ev_la[hl+"size"])),off=strokewidth*size,2===typeLast?(off*=.5,minlen+=strokewidth*size):3===typeLast?(off=strokewidth*size/3,minlen+=strokewidth):4===typeLast||5===typeLast||6===typeLast?(off=strokewidth*size/1.5,minlen+=strokewidth*size):7===typeLast?(off=0,size=10,minlen+=strokewidth):minlen+=strokewidth*size,offLast+=off,sizeLast=size)),el.visPropCalc.typeFirst=typeFirst,el.visPropCalc.typeLast=typeLast,{evFirst:ev_fa,evLast:ev_la,typeFirst:typeFirst,typeLast:typeLast,offFirst:offFirst,offLast:offLast,sizeFirst:sizeFirst,sizeLast:sizeLast,showFirst:1,showLast:1,minLen:minlen,strokeWidth:strokewidth}},updateLineWithEndings:function(el,arrowData){var c1,c2,margin;return c1=new Coords(Const.COORDS_BY_USER,el.point1.coords.usrCoords,el.board),c2=new Coords(Const.COORDS_BY_USER,el.point2.coords.usrCoords,el.board),margin=Type.evaluate(el.visProp.margin),Geometry.calcStraight(el,c1,c2,margin),this.handleTouchpoints(el,c1,c2,arrowData),this.getPositionArrowHead(el,c1,c2,arrowData),this.updateLinePrim(el.rendNode,c1.scrCoords[1],c1.scrCoords[2],c2.scrCoords[1],c2.scrCoords[2],el.board),this},updatePath:function(el){return Type.evaluate(el.visProp.handdrawing)?this.updatePathPrim(el.rendNode,this.updatePathStringBezierPrim(el),el.board):this.updatePathPrim(el.rendNode,this.updatePathStringPrim(el),el.board),this},getPositionArrowHead:function(el,c1,c2,a){var d,d1x,d1y,d2x,d2y;return(a.evFirst||a.evLast)&&(d1x=d1y=d2x=d2y=0,d=c1.distance(Const.COORDS_BY_SCREEN,c2),a.evFirst&&"vml"!==el.board.renderer.type&&(d>=a.minLen?(d1x=(c2.scrCoords[1]-c1.scrCoords[1])*a.offFirst/d,d1y=(c2.scrCoords[2]-c1.scrCoords[2])*a.offFirst/d):a.showFirst=0),a.evLast&&"vml"!==el.board.renderer.type&&(d>=a.minLen?(d2x=(c2.scrCoords[1]-c1.scrCoords[1])*a.offLast/d,d2y=(c2.scrCoords[2]-c1.scrCoords[2])*a.offLast/d):a.showLast=0),c1.setCoordinates(Const.COORDS_BY_SCREEN,[c1.scrCoords[1]+d1x,c1.scrCoords[2]+d1y],!1,!0),c2.setCoordinates(Const.COORDS_BY_SCREEN,[c2.scrCoords[1]-d2x,c2.scrCoords[2]-d2y],!1,!0)),this},handleTouchpoints:function(el,c1,c2,a){var s1,s2,d,d1x,d1y,d2x,d2y;return(a.evFirst||a.evLast)&&(d=d1x=d1y=d2x=d2y=0,s1=Type.evaluate(el.point1.visProp.size)+Type.evaluate(el.point1.visProp.strokewidth),s2=Type.evaluate(el.point2.visProp.size)+Type.evaluate(el.point2.visProp.strokewidth),a.evFirst&&Type.evaluate(el.visProp.touchfirstpoint)&&(d=c1.distance(Const.COORDS_BY_SCREEN,c2),d1x=(c2.scrCoords[1]-c1.scrCoords[1])*s1/d,d1y=(c2.scrCoords[2]-c1.scrCoords[2])*s1/d),a.evLast&&Type.evaluate(el.visProp.touchlastpoint)&&(d=c1.distance(Const.COORDS_BY_SCREEN,c2),d2x=(c2.scrCoords[1]-c1.scrCoords[1])*s2/d,d2y=(c2.scrCoords[2]-c1.scrCoords[2])*s2/d),c1.setCoordinates(Const.COORDS_BY_SCREEN,[c1.scrCoords[1]+d1x,c1.scrCoords[2]+d1y],!1,!0),c2.setCoordinates(Const.COORDS_BY_SCREEN,[c2.scrCoords[1]-d2x,c2.scrCoords[2]-d2y],!1,!0)),this},setArrowSize:function(el,a){return a.evFirst&&this._setArrowWidth(el.rendNodeTriangleStart,a.showFirst*a.strokeWidth,el.rendNode,a.sizeFirst),a.evLast&&this._setArrowWidth(el.rendNodeTriangleEnd,a.showLast*a.strokeWidth,el.rendNode,a.sizeLast),this},setLineCap:function(el){},drawTicks:function(el){el.rendNode=this.appendChildPrim(this.createPrim("path",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"path")},updateTicks:function(element){},drawEllipse:function(el){el.rendNode=this.appendChildPrim(this.createPrim("ellipse",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"ellipse"),this.updateEllipse(el)},updateEllipse:function(el){this._updateVisual(el);var radius=el.Radius();radius>0&&Math.abs(el.center.coords.usrCoords[0])>Mat.eps&&!isNaN(radius+el.center.coords.scrCoords[1]+el.center.coords.scrCoords[2])&&radius*el.board.unitX<2e6&&this.updateEllipsePrim(el.rendNode,el.center.coords.scrCoords[1],el.center.coords.scrCoords[2],radius*el.board.unitX,radius*el.board.unitY)},drawPolygon:function(el){el.rendNode=this.appendChildPrim(this.createPrim("polygon",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"polygon"),this.updatePolygon(el)},updatePolygon:function(el){this._updateVisual(el,{stroke:!0,dash:!0}),this.updatePolygonPrim(el.rendNode,el)},displayCopyright:function(str,fontsize){},drawInternalText:function(element){},updateInternalText:function(element){},drawText:function(el){var node,z,level,ev_visible;"html"===Type.evaluate(el.visProp.display)&&Env.isBrowser&&"no"!==this.type?((node=this.container.ownerDocument.createElement("div")).style.position="absolute",node.className=Type.evaluate(el.visProp.cssclass),level=Type.evaluate(el.visProp.layer),Type.exists(level)||(level=0),z=""===this.container.style.zIndex?0:parseInt(this.container.style.zIndex,10),node.style.zIndex=z+level,this.container.appendChild(node),node.setAttribute("id",this.container.id+"_"+el.id)):node=this.drawInternalText(el),el.rendNode=node,el.htmlStr="",el.visProp.islabel&&Type.exists(el.visProp.anchor)?(ev_visible=Type.evaluate(el.visProp.anchor.visProp.visible),el.prepareUpdate().updateVisibility(ev_visible)):el.prepareUpdate().updateVisibility(),this.updateText(el)},updateText:function(el){var v,c,parentNode,scale,vshift,id,wrap_id,ax,ay,content=el.plaintext;if(el.visPropCalc.visible)if(this.updateTextStyle(el,!1),"html"===Type.evaluate(el.visProp.display)&&"no"!==this.type){if(isNaN(el.coords.scrCoords[1]+el.coords.scrCoords[2])||(c=el.coords.scrCoords[1],c=Math.abs(c)<1e6?c:1e6,v="right"===(ax=el.getAnchorX())?el.board.canvasWidth-c:"middle"===ax?c-.5*el.size[0]:c,el.visPropOld.left!==ax+v&&("right"===ax?(el.rendNode.style.right=v+"px",el.rendNode.style.left="auto"):(el.rendNode.style.left=v+"px",el.rendNode.style.right="auto"),el.visPropOld.left=ax+v),c=el.coords.scrCoords[2]+this.vOffsetText,c=Math.abs(c)<1e6?c:1e6,v="bottom"===(ay=el.getAnchorY())?el.board.canvasHeight-c:"middle"===ay?c-.5*el.size[1]:c,el.visPropOld.top!==ay+v&&("bottom"===ay?(el.rendNode.style.top="auto",el.rendNode.style.bottom=v+"px"):(el.rendNode.style.bottom="auto",el.rendNode.style.top=v+"px"),el.visPropOld.top=ay+v)),el.htmlStr!==content){try{el.type===Type.OBJECT_TYPE_BUTTON?el.rendNodeButton.innerHTML=content:el.type===Type.OBJECT_TYPE_CHECKBOX||el.type===Type.OBJECT_TYPE_INPUT?el.rendNodeLabel.innerHTML=content:el.rendNode.innerHTML=content}catch(e){parentNode=el.rendNode.parentNode,el.rendNode.parentNode.removeChild(el.rendNode),el.rendNode.innerHTML=content,parentNode.appendChild(el.rendNode)}if(el.htmlStr=content,Type.evaluate(el.visProp.usemathjax))try{MathJax.typeset?MathJax.typeset([el.rendNode]):MathJax.Hub.Queue(["Typeset",MathJax.Hub,el.rendNode]),wrap_id="fullscreenwrap_"+(id=el.board.container),document.getElementById(wrap_id)&&(scale=el.board.containerObj._cssFullscreenStore.scale,vshift=el.board.containerObj._cssFullscreenStore.vshift,Env.scaleJSXGraphDiv("#"+wrap_id,"#"+id,scale,vshift))}catch(e){JXG.debug("MathJax (not yet) loaded")}else if(Type.evaluate(el.visProp.usekatex))try{katex.render(content,el.rendNode,{throwOnError:!1})}catch(e){JXG.debug("KaTeX (not yet) loaded")}else if(Type.evaluate(el.visProp.useasciimathml))try{AMprocessNode(el.rendNode,!1)}catch(e){JXG.debug("AsciiMathML (not yet) loaded")}}this.transformImage(el,el.transformations)}else this.updateInternalText(el)},_css2js:function(cssString){var i,len,key,val,s,pairs=[],list=Type.trim(cssString).replace(/;$/,"").split(";");for(len=list.length,i=0;i<len;++i)""!==Type.trim(list[i])&&(s=list[i].split(":"),key=Type.trim(s[0].replace(/-([a-z])/gi,(function(match,char){return char.toUpperCase()}))),val=Type.trim(s[1]),pairs.push({key:key,val:val}));return pairs},updateTextStyle:function(el,doHighlight){var fs,so,sc,css,node,cssList,prop,style,cssString,ev=el.visProp,display=Env.isBrowser?ev.display:"internal",nodeList=["rendNode","rendNodeTag","rendNodeLabel"],lenN=nodeList.length,fontUnit=Type.evaluate(ev.fontunit),styleList=["cssdefaultstyle","cssstyle"],lenS=styleList.length;if(doHighlight?(sc=ev.highlightstrokecolor,so=ev.highlightstrokeopacity,css=ev.highlightcssclass):(sc=ev.strokecolor,so=ev.strokeopacity,css=ev.cssclass),"no"!==this.type&&("html"===display||"canvas"!==this.type)){for(style=0;style<lenS;style++)if(""!==(cssString=Type.evaluate(ev[(doHighlight?"highlight":"")+styleList[style]]))&&el.visPropOld[styleList[style]]!==cssString){for(cssList=this._css2js(cssString),node=0;node<lenN;node++)if(Type.exists(el[nodeList[node]]))for(prop in cssList)cssList.hasOwnProperty(prop)&&(el[nodeList[node]].style[cssList[prop].key]=cssList[prop].val);el.visPropOld[styleList[style]]=cssString}if(fs=Type.evaluate(ev.fontsize),el.visPropOld.fontsize!==fs){el.needsSizeUpdate=!0;try{for(node=0;node<lenN;node++)Type.exists(el[nodeList[node]])&&(el[nodeList[node]].style.fontSize=fs+fontUnit)}catch(e){for(node=0;node<lenN;node++)Type.exists(el[nodeList[node]])&&(el[nodeList[node]].style.fontSize=fs)}el.visPropOld.fontsize=fs}}return this.setObjectTransition(el),"html"===display&&"no"!==this.type?(el.visPropOld.cssclass!==css&&(el.rendNode.className=css,el.visPropOld.cssclass=css,el.needsSizeUpdate=!0),this.setObjectStrokeColor(el,sc,so)):this.updateInternalTextStyle(el,sc,so),this},updateInternalTextStyle:function(el,strokeColor,strokeOpacity){this.setObjectStrokeColor(el,strokeColor,strokeOpacity)},drawImage:function(element){},updateImage:function(el){this.updateRectPrim(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2]-el.size[1],el.size[0],el.size[1]),this.updateImageURL(el),this.transformImage(el,el.transformations),this._updateVisual(el,{stroke:!0,dash:!0},!0)},joinTransforms:function(el,transformations){var i,ox=el.board.origin.scrCoords[1],oy=el.board.origin.scrCoords[2],ux=el.board.unitX,uy=el.board.unitY,len=transformations.length,m=[[1,0,0],[-ox/ux,1/ux,0],[oy/uy,0,-1/uy]];for(i=0;i<len;i++)m=Mat.matMatMult(transformations[i].matrix,m);return m=Mat.matMatMult([[1,0,0],[ox,ux,0],[oy,0,-uy]],m)},transformImage:function(element,transformations){},updateImageURL:function(element){},updateImageStyle:function(el,doHighlight){el.rendNode.className=Type.evaluate(doHighlight?el.visProp.highlightcssclass:el.visProp.cssclass)},drawForeignObject:function(el){},updateForeignObject:function(el){},appendChildPrim:function(node,level){},appendNodesToElement:function(element,type){},createPrim:function(type,id){return null},remove:function(node){},makeArrows:function(element,arrowData){},_setArrowWidth:function(node,width,parentNode){},updateEllipsePrim:function(node,x,y,rx,ry){},updateLinePrim:function(node,p1x,p1y,p2x,p2y,board){},updatePathPrim:function(node,pathString,board){},updatePathStringPoint:function(element,size,type){},updatePathStringPrim:function(element){},updatePathStringBezierPrim:function(element){},updatePolygonPrim:function(node,element){},updateRectPrim:function(node,x,y,w,h){},setPropertyPrim:function(node,key,val){},setTabindex:function(element){var val;element.board.attr.keyboard.enabled&&Type.exists(element.rendNode)&&(val=Type.evaluate(element.visProp.tabindex),element.visPropCalc.visible&&!Type.evaluate(element.visProp.fixed)||(val=null),val!==element.visPropOld.tabindex&&(element.rendNode.setAttribute("tabindex",val),element.visPropOld.tabindex=val))},display:function(element,value){element&&(element.visPropOld.visible=value)},show:function(element){},hide:function(element){},setBuffering:function(node,type){},setDashStyle:function(element){},setDraft:function(el){if(Type.evaluate(el.visProp.draft)){var draftColor=el.board.options.elements.draft.color,draftOpacity=el.board.options.elements.draft.opacity;this.setObjectTransition(el),el.type===Const.OBJECT_TYPE_POLYGON?this.setObjectFillColor(el,draftColor,draftOpacity):(el.elementClass===Const.OBJECT_CLASS_POINT?this.setObjectFillColor(el,draftColor,draftOpacity):this.setObjectFillColor(el,"none",0),this.setObjectStrokeColor(el,draftColor,draftOpacity),this.setObjectStrokeWidth(el,el.board.options.elements.draft.strokeWidth))}},removeDraft:function(el){this.setObjectTransition(el),el.type===Const.OBJECT_TYPE_POLYGON?this.setObjectFillColor(el,el.visProp.fillcolor,el.visProp.fillopacity):(el.type===Const.OBJECT_CLASS_POINT&&this.setObjectFillColor(el,el.visProp.fillcolor,el.visProp.fillopacity),this.setObjectStrokeColor(el,el.visProp.strokecolor,el.visProp.strokeopacity),this.setObjectStrokeWidth(el,el.visProp.strokewidth))},setGradient:function(element){},updateGradient:function(element){},setObjectTransition:function(element,duration){},setObjectFillColor:function(element,color,opacity){},setObjectStrokeColor:function(element,color,opacity){},setObjectStrokeWidth:function(element,width){},setShadow:function(element){},highlight:function(el){var i,sw,ev=el.visProp;if(this.setObjectTransition(el),!ev.draft){if(el.type===Const.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(el,ev.highlightfillcolor,ev.highlightfillopacity),i=0;i<el.borders.length;i++)this.setObjectStrokeColor(el.borders[i],el.borders[i].visProp.highlightstrokecolor,el.borders[i].visProp.highlightstrokeopacity);else el.elementClass===Const.OBJECT_CLASS_TEXT?this.updateTextStyle(el,!0):el.type===Const.OBJECT_TYPE_IMAGE?(this.updateImageStyle(el,!0),this.setObjectFillColor(el,ev.highlightfillcolor,ev.highlightfillopacity)):(this.setObjectStrokeColor(el,ev.highlightstrokecolor,ev.highlightstrokeopacity),this.setObjectFillColor(el,ev.highlightfillcolor,ev.highlightfillopacity));ev.highlightstrokewidth&&(sw=Math.max(Type.evaluate(ev.highlightstrokewidth),Type.evaluate(ev.strokewidth)),this.setObjectStrokeWidth(el,sw),el.elementClass!==Const.OBJECT_CLASS_LINE&&el.elementClass!==Const.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(el,!0))}return this},noHighlight:function(el){var i,sw,ev=el.visProp;if(this.setObjectTransition(el),!Type.evaluate(el.visProp.draft)){if(el.type===Const.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(el,ev.fillcolor,ev.fillopacity),i=0;i<el.borders.length;i++)this.setObjectStrokeColor(el.borders[i],el.borders[i].visProp.strokecolor,el.borders[i].visProp.strokeopacity);else el.elementClass===Const.OBJECT_CLASS_TEXT?this.updateTextStyle(el,!1):el.type===Const.OBJECT_TYPE_IMAGE?(this.updateImageStyle(el,!1),this.setObjectFillColor(el,ev.fillcolor,ev.fillopacity)):(this.setObjectStrokeColor(el,ev.strokecolor,ev.strokeopacity),this.setObjectFillColor(el,ev.fillcolor,ev.fillopacity));sw=Type.evaluate(ev.strokewidth),this.setObjectStrokeWidth(el,sw),el.elementClass!==Const.OBJECT_CLASS_LINE&&el.elementClass!==Const.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(el,!1)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(board,attr){var doc,node,cancelbubble=function(e){e||(e=window.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},createButton=function(label,handler){var button;button=doc.createElement("span"),node.appendChild(button),button.appendChild(doc.createTextNode(label)),button.style.paddingLeft="7px",button.style.paddingRight="7px",void 0!==button.classList&&button.classList.add("JXG_navigation_button"),Env.addEvent(button,"click",(function(e){return Type.bind(handler,board)(),!1}),board),Env.addEvent(button,"mouseup",cancelbubble,board),Env.addEvent(button,"mousedown",cancelbubble,board),Env.addEvent(button,"touchend",cancelbubble,board),Env.addEvent(button,"touchstart",cancelbubble,board)};Env.isBrowser&&"no"!==this.type&&(doc=board.containerObj.ownerDocument,(node=doc.createElement("div")).setAttribute("id",board.containerObj.id+"_navigationbar"),node.style.color=attr.strokecolor,node.style.backgroundColor=attr.fillcolor,node.style.padding=attr.padding,node.style.position=attr.position,node.style.fontSize=attr.fontsize,node.style.cursor=attr.cursor,node.style.zIndex=attr.zindex,board.containerObj.appendChild(node),node.style.right=attr.right,node.style.bottom=attr.bottom,void 0!==node.classList&&node.classList.add("JXG_navigation"),board.attr.showfullscreen&&createButton(board.attr.fullscreen.symbol,(function(){board.toFullscreen(board.attr.fullscreen.id)})),board.attr.showscreenshot&&createButton(board.attr.screenshot.symbol,(function(){window.setTimeout((function(){board.renderer.screenshot(board,"",!1)}),330)})),board.attr.showreload&&createButton("↻",(function(){board.reload()})),board.attr.showcleartraces&&createButton("⊗",(function(){board.clearTraces()})),board.attr.shownavigation&&(board.attr.showzoom&&(createButton("–",board.zoomOut),createButton("o",board.zoom100),createButton("+",board.zoomIn)),createButton("←",board.clickLeftArrow),createButton("↓",board.clickUpArrow),createButton("↑",board.clickDownArrow),createButton("→",board.clickRightArrow)))},getElementById:function(id){return Type.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+id):""},removeToInsertLater:function(el){var parentNode=el.parentNode,nextSibling=el.nextSibling;if(null!==parentNode)return parentNode.removeChild(el),function(){nextSibling?parentNode.insertBefore(el,nextSibling):parentNode.appendChild(el)}},resize:function(w,h){},createTouchpoints:function(n){},showTouchpoint:function(i){},hideTouchpoint:function(i){},updateTouchpoint:function(i,pos){},dumpToDataURI:function(_ignoreTexts){},dumpToCanvas:function(canvasId,w,h,_ignoreTexts){},screenshot:function(board){},setLayer:function(el,level){}}),JXG.AbstractRenderer})),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],(function(JXG,Env,Type,Encoding,Base64){return JXG.FileReader={handleRemoteFile:function(url,board,format,async,encoding,callback){var request=!1;try{request=new XMLHttpRequest,"raw"===format.toLowerCase()?request.overrideMimeType("text/plain; charset="+encoding):request.overrideMimeType("text/xml; charset="+encoding)}catch(e){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(ex){try{request=new ActiveXObject("Microsoft.XMLHTTP")}catch(exc){request=!1}}}if(request){request.open("GET",url,async),"raw"===format.toLowerCase()?this.cbp=function(){var req=request;4===req.readyState&&board(req.responseText)}:this.cbp=function(){var req=request,text="";4===req.readyState&&(text=!Type.exists(req.responseStream)||"PK"!==req.responseText.slice(0,2)&&31!==Encoding.asciiCharCodeAt(req.responseText.slice(0,1),0)?req.responseText:Base64.decode(jxgBinFileReader(req)),this.parseString(text,board,format,callback))},this.cb=Type.bind(this.cbp,this),request.onreadystatechange=this.cb;try{request.send(null)}catch(ex2){throw new Error("JSXGraph: A problem occurred while trying to read remote file '"+url+"'.")}}else JXG.debug("AJAX not activated!")},handleLocalFile:function(url,board,format,async,encoding,callback){Type.exists(async)||(async=!0),"raw"===format.toLowerCase()?this.cbp=function(e){board(e.target.result)}:this.cbp=function(e){var text=e.target.result;this.parseString(text,board,format,callback)},this.cb=Type.bind(this.cbp,this);var reader=new FileReader;reader.onload=this.cb,"raw"===format.toLowerCase()?reader.readAsText(url):reader.readAsText(url,encoding)},parseFileContent:function(url,board,format,async,encoding,callback){Type.isString(url)||void 0===FileReader?this.handleRemoteFile(url,board,format,async,encoding,callback):this.handleLocalFile(url,board,format,async,encoding,callback)},parseString:function(str,board,format,callback){var Reader;if(format=format.toLowerCase(),Reader=JXG.readers[format],Type.exists(Reader))new Reader(board,str).read();else if("jessiecode"!==format)throw new Error("JSXGraph: There is no reader available for '"+format+"'.");Type.isFunction(callback)&&callback(board)}},!Env.isMetroApp()&&Env.isBrowser&&"object"===("undefined"==typeof navigator?"undefined":_typeof(navigator))&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction jxgBinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    jxgBinFileReader = b64String\nEnd Function\n<\/script>\n'),JXG.FileReader})),define("parser/geonext",["jxg","base/constants","utils/type"],(function(JXG,Const,Type){return JXG.GeonextParser={replacePow:function(te){var count,pos,c,previousIndex,leftop,rightop,pre,p,left,i,right,expr;for(i=(te=te.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),previousIndex=-1;i>=0&&i<te.length-1;){if(previousIndex===i)throw new Error("JSXGraph: Error while parsing expression '"+te+"'");if(previousIndex=i,left=te.slice(0,i),right=te.slice(i+1),")"===left.charAt(left.length-1)){for(count=1,pos=left.length-2;pos>=0&&count>0;)")"===(c=left.charAt(pos))?count++:"("===c&&(count-=1),pos-=1;if(0!==count)throw new Error("JSXGraph: Missing '(' in expression");for(leftop="",pre=left.substring(0,pos+1),p=pos;p>=0&&pre.substr(p,1).match(/([\w.]+)/);)leftop=RegExp.$1+leftop,p-=1;leftop=(leftop+=left.substring(pos+1,left.length)).replace(/([()+*%^\-/\][])/g,"\\$1")}else leftop="[\\w\\.]+";if(right.match(/^([\w.]*\()/)){for(count=1,pos=RegExp.$1.length;pos<right.length&&count>0;)")"===(c=right.charAt(pos))?count-=1:"("===c&&(count+=1),pos+=1;if(0!==count)throw new Error("JSXGraph: Missing ')' in expression");rightop=(rightop=right.substring(0,pos)).replace(/([()+*%^\-/[\]])/g,"\\$1")}else rightop="[\\w\\.]+";expr=new RegExp("("+leftop+")\\^("+rightop+")"),i=(te=te.replace(expr,"pow($1,$2)")).indexOf("^")}return te},replaceIf:function(te){var left,right,i,pos,count,k1,k2,c,meat,s="",first=null,second=null,third=null;if((i=te.indexOf("If("))<0)return te;for(te=te.replace(/""/g,"0");i>=0;){for(left=te.slice(0,i),right=te.slice(i+3),count=1,pos=0,k1=-1,k2=-1;pos<right.length&&count>0;)")"===(c=right.charAt(pos))?count-=1:"("===c?count+=1:","===c&&1===count&&(k1<0?k1=pos:k2=pos),pos+=1;if(meat=right.slice(0,pos-1),right=right.slice(pos),k1<0)return"";if(k2<0)return"";first=meat.slice(0,k1),second=meat.slice(k1+1,k2),third=meat.slice(k2+1),s+=left+"(("+(first=this.replaceIf(first))+")?("+(second=this.replaceIf(second))+"):("+(third=this.replaceIf(third))+"))",first=null,second=null,i=(te=right).indexOf("If(")}return s+=right},replaceNameById:function(term,board,jc){var end,elName,el,i,pos=0,funcs=["X","Y","L","V"],printId=function(id){return jc?"$('"+id+"')":id};for(i=0;i<funcs.length;i++)for(pos=term.indexOf(funcs[i]+"(");pos>=0;)pos>=0&&(end=term.indexOf(")",pos+2))>=0&&(elName=(elName=term.slice(pos+2,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+2)+(jc?"$('":"")+printId(el.id)+term.slice(end))),end=term.indexOf(")",pos+2),pos=term.indexOf(funcs[i]+"(",end);for(pos=term.indexOf("Dist(");pos>=0;)pos>=0&&(end=term.indexOf(",",pos+5))>=0&&(elName=(elName=term.slice(pos+5,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+5)+printId(el.id)+term.slice(end))),end=term.indexOf(",",pos+5),pos=term.indexOf(",",end),(end=term.indexOf(")",pos+1))>=0&&(elName=(elName=term.slice(pos+1,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+1)+printId(el.id)+term.slice(end))),end=term.indexOf(")",pos+1),pos=term.indexOf("Dist(",end);for(funcs=["Deg","Rad"],i=0;i<funcs.length;i++)for(pos=term.indexOf(funcs[i]+"(");pos>=0;)pos>=0&&(end=term.indexOf(",",pos+4))>=0&&(elName=(elName=term.slice(pos+4,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+4)+printId(el.id)+term.slice(end))),end=term.indexOf(",",pos+4),pos=term.indexOf(",",end),(end=term.indexOf(",",pos+1))>=0&&(elName=(elName=term.slice(pos+1,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+1)+printId(el.id)+term.slice(end))),end=term.indexOf(",",pos+1),pos=term.indexOf(",",end),(end=term.indexOf(")",pos+1))>=0&&(elName=(elName=term.slice(pos+1,end)).replace(/\\(['"])?/g,"$1"),(el=board.elementsByName[elName])&&(term=term.slice(0,pos+1)+printId(el.id)+term.slice(end))),end=term.indexOf(")",pos+1),pos=term.indexOf(funcs[i]+"(",end);return term},replaceIdByObj:function(term){var expr=/(X|Y|L)\(([\w_]+)\)/g;return term=term.replace(expr,"$('$2').$1()"),expr=/(V)\(([\w_]+)\)/g,term=term.replace(expr,"$('$2').Value()"),expr=/(Dist)\(([\w_]+),([\w_]+)\)/g,term=term.replace(expr,"dist($('$2'), $('$3'))"),expr=/(Deg)\(([\w_]+),([ \w[\w_]+),([\w_]+)\)/g,term=term.replace(expr,"deg($('$2'),$('$3'),$('$4'))"),expr=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,term=term.replace(expr,"rad($('$1'),$('$2'),$('$3'))"),expr=/N\((.+)\)/g,term=term.replace(expr,"($1)")},geonext2JS:function(term,board){var expr,newterm,i,from=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],to=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(newterm=term=(term=(term=term.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),newterm=this.replaceNameById(newterm,board),newterm=this.replaceIf(newterm),newterm=this.replacePow(newterm),newterm=this.replaceIdByObj(newterm),i=0;i<from.length;i++)expr=new RegExp(["(\\W|^)(",from[i],")"].join(""),"ig"),newterm=newterm.replace(expr,["$1",to[i]].join(""));return newterm=(newterm=(newterm=(newterm=(newterm=newterm.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(me,term,board){var elements,el,expr,elmask;for(el in Type.exists(board)||(board=me.board),elements=board.elementsByName)elements.hasOwnProperty(el)&&el!==me.name&&(elements[el].elementClass===Const.OBJECT_CLASS_TEXT&&Type.evaluate(elements[el].visProp.islabel)||(elmask=(elmask=el.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),expr=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+elmask+")(,[\\w\\[\\]'_ ]+)*\\)","g"),term.search(expr)>=0&&elements[el].addChild(me)))},gxt2jc:function(term,board){var newterm;return newterm=term=(term=(term=term.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),newterm=(newterm=(newterm=(newterm=this.replaceNameById(newterm,board,!0)).replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")}},JXG.GeonextParser})),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","utils/event","utils/color","utils/type"],(function(JXG,Const,Coords,Mat,Statistics,Options,EventEmitter,Color,Type){return JXG.GeometryElement=function(board,attributes,type,oclass){var name,key,attr;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},EventEmitter.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(key in this.board=board,this.type=type,this._org_type=type,this.elementClass=oclass||Const.OBJECT_CLASS_OTHER,this.id=attributes.id,name=attributes.name,Type.exists(name)||(name=this.board.generateName(this)),""!==name&&(this.board.elementsByName[name]=this),this.name=name,this.needsRegularUpdate=attributes.needsregularupdate,Type.clearVisPropOld(this),attr=this.resolveShortcuts(attributes))attr.hasOwnProperty(key)&&this._set(key,attr[key]);this.visProp.draft=attr.draft&&attr.draft.draft}},JXG.extend(JXG.GeometryElement.prototype,{addChild:function(obj){var el,el2;for(el in this.childElements[obj.id]=obj,this.addDescendants(obj),obj.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(el))for(el2 in this.descendants[el].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(el2)&&(this.descendants[el].ancestors[this.ancestors[el2].id]=this.ancestors[el2]);for(el in this.ancestors)if(this.ancestors.hasOwnProperty(el))for(el2 in this.descendants)this.descendants.hasOwnProperty(el2)&&(this.ancestors[el].descendants[this.descendants[el2].id]=this.descendants[el2]);return this},addDescendants:function(obj){var el;for(el in this.descendants[obj.id]=obj,obj.childElements)obj.childElements.hasOwnProperty(el)&&this.addDescendants(obj.childElements[el]);return this},addParents:function(parents){var i,len,par;for(len=(par=Type.isArray(parents)?parents:arguments).length,i=0;i<len;++i)Type.exists(par[i])&&(Type.isId(this.board,par[i])?this.parents.push(par[i]):Type.exists(par[i].id)&&this.parents.push(par[i].id));this.parents=Type.uniqueArray(this.parents)},setParents:function(parents){this.parents=[],this.addParents(parents)},removeChild:function(obj){return delete this.childElements[obj.id],this.removeDescendants(obj),delete obj.ancestors[this.id],this},removeDescendants:function(obj){var el;for(el in delete this.descendants[obj.id],obj.childElements)obj.childElements.hasOwnProperty(el)&&this.removeDescendants(obj.childElements[el]);return this},countChildren:function(){var prop,d,s=0;for(prop in d=this.childElements)d.hasOwnProperty(prop)&&prop.indexOf("Label")<0&&s++;return s},getName:function(){return this.name},addTransform:function(transform){return this},draggable:function(){return this.isDraggable&&!Type.evaluate(this.visProp.fixed)&&this.type!==Const.OBJECT_TYPE_GLIDER},setPosition:function(method,coords){var el,i,len,t,parents=[];if(!Type.exists(this.parents))return this;for(len=this.parents.length,i=0;i<len;++i)if(el=this.board.select(this.parents[i]),Type.isPoint(el)){if(!el.draggable())return this;parents.push(el)}for(3===coords.length&&(coords=coords.slice(1)),t=this.board.create("transform",coords,{type:"translate"}),(len=parents.length)>0?t.applyOnce(parents):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(t):this.addTransform(t),i=0;i<len;++i)parents[i].type===Const.OBJECT_TYPE_GLIDER&&parents[i].updateGlider();return this},setPositionDirectly:function(method,coords,oldcoords){var c=new Coords(method,coords,this.board,!1),oldc=new Coords(method,oldcoords,this.board,!1),dc=Statistics.subtract(c.usrCoords,oldc.usrCoords);return this.setPosition(Const.COORDS_BY_USER,dc),this},generatePolynomial:function(){return[]},animate:function(hash,time,options){options=options||{};var r,p,i,delay=this.board.attr.animationdelay,steps=Math.ceil(time/delay),self=this,animateColor=function(startRGB,endRGB,property){var hsv1,hsv2,sh,ss,sv;for(hsv1=Color.rgb2hsv(startRGB),sh=((hsv2=Color.rgb2hsv(endRGB))[0]-hsv1[0])/steps,ss=(hsv2[1]-hsv1[1])/steps,sv=(hsv2[2]-hsv1[2])/steps,self.animationData[property]=[],i=0;i<steps;i++)self.animationData[property][steps-i-1]=Color.hsv2rgb(hsv1[0]+(i+1)*sh,hsv1[1]+(i+1)*ss,hsv1[2]+(i+1)*sv)},animateFloat=function(start,end,property,round){var tmp,s;if(start=parseFloat(start),end=parseFloat(end),!isNaN(start)&&!isNaN(end))for(s=(end-start)/steps,self.animationData[property]=[],i=0;i<steps;i++)tmp=start+(i+1)*s,self.animationData[property][steps-i-1]=round?Math.floor(tmp):tmp};for(r in this.animationData={},hash)if(hash.hasOwnProperty(r))switch(p=r.toLowerCase()){case"strokecolor":case"fillcolor":animateColor(this.visProp[p],hash[r],p);break;case"size":if(!Type.isPoint(this))break;animateFloat(this.visProp[p],hash[r],p,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":animateFloat(this.visProp[p],hash[r],p,!1)}return this.animationCallback=options.callback,this.board.addAnimation(this),this},update:function(){return Type.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(visible){return this.prepareUpdate().update().updateVisibility(visible).updateRenderer()},setDisplayRendNode:function(val){var i,len,s,len_s,obj;if(void 0===val&&(val=this.visPropCalc.visible),val===this.visPropOld.visible)return this;for(this.board.renderer.display(this,val),len=this.inherits.length,s=0;s<len;s++)if(obj=this.inherits[s],Type.isArray(obj))for(len_s=obj.length,i=0;i<len_s;i++)Type.exists(obj[i])&&Type.exists(obj[i].rendNode)&&"inherit"===Type.evaluate(obj[i].visProp.visible)&&obj[i].setDisplayRendNode(val);else Type.exists(obj)&&Type.exists(obj.rendNode)&&"inherit"===Type.evaluate(obj.visProp.visible)&&obj.setDisplayRendNode(val);return this.hasLabel&&Type.exists(this.label)&&Type.exists(this.label.rendNode)&&"inherit"===Type.evaluate(this.label.visProp.visible)&&this.label.setDisplayRendNode(val),this},hide:function(){return this.setAttribute({visible:!1}),this},hideElement:function(){return this.hide(),this},show:function(){return this.setAttribute({visible:!0}),this},showElement:function(){return this.show(),this},updateVisibility:function(parent_val){var i,len,s,len_s,obj,val;if(this.needsUpdate){for(void 0!==parent_val?this.visPropCalc.visible=parent_val:(val=Type.evaluate(this.visProp.visible),Type.exists(this.hiddenByParent)&&this.hiddenByParent&&(val=!1),"inherit"!==val&&(this.visPropCalc.visible=val)),len=this.inherits.length,s=0;s<len;s++)if(obj=this.inherits[s],Type.isArray(obj))for(len_s=obj.length,i=0;i<len_s;i++)Type.exists(obj[i])&&"inherit"===Type.evaluate(obj[i].visProp.visible)&&obj[i].prepareUpdate().updateVisibility(this.visPropCalc.visible);else Type.exists(obj)&&"inherit"===Type.evaluate(obj.visProp.visible)&&obj.prepareUpdate().updateVisibility(this.visPropCalc.visible);Type.exists(this.label)&&Type.exists(this.label.visProp)&&Type.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(property,value){var el;if(property=property.toLocaleLowerCase(),this.visProp.hasOwnProperty(property)&&property.indexOf("color")>=0&&Type.isString(value)&&9===value.length&&"#"===value.charAt(0))value=Color.rgba2rgbo(value),this.visProp[property]=value[0],this.visProp[property.replace("color","opacity")]=value[1];else if(null===value||!Type.isObject(value)||Type.exists(value.id)||Type.exists(value.name))this.visProp[property]=value;else for(el in this.visProp[property]={},value)value.hasOwnProperty(el)&&(this.visProp[property][el.toLocaleLowerCase()]=value[el])},resolveShortcuts:function(attributes){var key,i,j,subattr=["traceattributes","traceAttributes"];for(key in Options.shortcuts)if(Options.shortcuts.hasOwnProperty(key)){if(Type.exists(attributes[key]))for(i=0;i<Options.shortcuts[key].length;i++)Type.exists(attributes[Options.shortcuts[key][i]])||(attributes[Options.shortcuts[key][i]]=attributes[key]);for(j=0;j<subattr.length;j++)Type.isObject(attributes[subattr[j]])&&(attributes[subattr[j]]=this.resolveShortcuts(attributes[subattr[j]]))}return attributes},setLabel:function(str){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(str)},setLabelText:function(str){return Type.exists(this.label)&&(str=str.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(str)),this},setName:function(str){str=str.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"slider"!==this.elType&&this.setLabelText(str),this.setAttribute({name:str})},setProperty:function(){JXG.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(attributes){var i,j,le,key,value,arg,opacity,pair,oldvalue,properties={};for(i=0;i<arguments.length;i++)arg=arguments[i],Type.isString(arg)?(pair=arg.split(":"),properties[Type.trim(pair[0])]=Type.trim(pair[1])):Type.isArray(arg)?properties[arg[0]]=arg[1]:JXG.extend(properties,arg);for(i in properties=this.resolveShortcuts(properties))if(properties.hasOwnProperty(i)){if(key=i.replace(/\s+/g,"").toLowerCase(),value=properties[i],Type.isObject(value)&&Type.exists(this.visProp[key])){if(this.visProp[key]=Type.merge(this.visProp[key],value),this.type===Const.OBJECT_TYPE_TICKS&&Type.exists(this.labels))for(le=this.labels.length,j=0;j<le;j++)this.labels[j].setAttribute(value);else if(Type.exists(this[key]))if(Type.isArray(this[key]))for(j=0;j<this[key].length;j++)this[key][j].setAttribute(value);else this[key].setAttribute(value);continue}switch(oldvalue=this.visProp[key],key){case"name":oldvalue=this.name,delete this.board.elementsByName[this.name],this.name=value,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"===value||!1===value),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":opacity=(value=Color.rgba2rgbo(value))[1],value=value[0],0===opacity&&Type.exists(this.label)&&this.hasLabel&&this.label.hideElement(),Type.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=value,this.board.renderer.setObjectStrokeColor(this.label,value,opacity)),this.elementClass===Const.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=value,this.visProp.strokeopacity=opacity,this.board.renderer.setObjectStrokeColor(this,value,opacity));break;case"infoboxtext":Type.isString(value)?this.infoboxText=value:this.infoboxText=!1;break;case"visible":this.visProp.visible="false"!==value&&("true"===value||value),this.setDisplayRendNode(Type.evaluate(this.visProp.visible)),Type.evaluate(this.visProp.visible)&&Type.exists(this.updateSize)&&this.updateSize();break;case"face":Type.isPoint(this)&&(this.visProp.face=value,this.board.renderer.changePointStyle(this));break;case"trace":"false"===value||!1===value?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace="pause"!==value;break;case"gradient":this.visProp.gradient=value,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":value=Color.rgba2rgbo(value),this.visProp.gradientsecondcolor=value[0],this.visProp.gradientsecondopacity=value[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=value,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=value,Type.evaluate(value)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=value;break;case"radius":this.type!==Const.OBJECT_TYPE_ANGLE&&this.type!==Const.OBJECT_TYPE_SECTOR||this.setRadius(value);break;case"rotate":(this.elementClass===Const.OBJECT_CLASS_TEXT&&"internal"===Type.evaluate(this.visProp.display)||this.type===Const.OBJECT_TYPE_IMAGE)&&this.addRotation(value);break;case"ticksdistance":this.type===Const.OBJECT_TYPE_TICKS&&Type.isNumber(value)&&(this.ticksFunction=this.makeTicksFunction(value));break;case"generatelabelvalue":this.type===Const.OBJECT_TYPE_TICKS&&Type.isFunction(value)&&(this.generateLabelValue=value);break;case"onpolygon":this.type===Const.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!value);break;case"disabled":Type.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!value);break;case"checked":Type.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!value);break;case"maxlength":Type.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!value);break;case"layer":this.board.renderer.setLayer(this,Type.evaluate(value)),this._set(key,value);break;case"tabindex":Type.exists(this.rendNode)&&(this.rendNode.setAttribute("tabindex",value),this._set(key,value));break;default:Type.exists(this.visProp[key])&&(!JXG.Validator[key]||JXG.Validator[key]&&JXG.Validator[key](value)||JXG.Validator[key]&&Type.isFunction(value)&&JXG.Validator[key](value()))&&(value=(!value.toLowerCase||"false"!==value.toLowerCase())&&value,this._set(key,value))}this.triggerEventHandlers(["attribute:"+key],[oldvalue,value,this])}return this.triggerEventHandlers(["attribute"],[properties,this]),Type.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){JXG.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(key){var result;switch(key=key.toLowerCase()){case"needsregularupdate":result=this.needsRegularUpdate;break;case"labelcolor":result=this.label.visProp.strokecolor;break;case"infoboxtext":result=this.infoboxText;break;case"withlabel":result=this.hasLabel;break;default:result=this.visProp[key]}return result},setDash:function(dash){return this.setAttribute({dash:dash}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new Coords(Const.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new Coords(Const.COORDS_BY_USER,[0,0],this.board)},setArrow:function(firstArrow,lastArrow){return this.visProp.firstarrow=firstArrow,this.visProp.lastarrow=lastArrow,lastArrow&&(this.type=Const.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var ev_g=Type.evaluate(this.visProp.gradient);"linear"!==ev_g&&"radial"!==ev_g||this.board.renderer.setGradient(this)},createLabel:function(){var attr,that=this;return JXG.elements.text?((attr=Type.deepCopy(this.visProp.label,null)).id=this.id+"Label",attr.isLabel=!0,attr.anchor=this,attr.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=JXG.elements.text(this.board,[0,0,function(){return Type.isFunction(that.name)?that.name():that.name}],attr),this.label.needsUpdate=!0,this.label.dump=!1,this.label.fullUpdate(),this.hasLabel=!0)):JXG.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(force){return force=Type.def(force,!1),!Type.evaluate(this.visProp.highlight)||this.highlighted&&!force||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var obj;for(obj in this.traces)this.traces.hasOwnProperty(obj)&&this.board.renderer.remove(this.traces[obj]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=Mat.normalize(this.stdform),this},toJSON:function(){var vis,key,json=['{"name":',this.name];for(key in json.push(', "id":'+this.id),vis=[],this.visProp)this.visProp.hasOwnProperty(key)&&Type.exists(this.visProp[key])&&vis.push('"'+key+'":'+this.visProp[key]);return json.push(', "visProp":{'+vis.toString()+"}"),json.push("}"),json.join("")},addRotation:function(angle){var tOffInv,tOff,tS,tSInv,tRot,that=this;return(this.elementClass===Const.OBJECT_CLASS_TEXT&&"internal"===Type.evaluate(this.visProp.display)||this.type===Const.OBJECT_TYPE_IMAGE)&&0!==angle&&(tOffInv=this.board.create("transform",[function(){return-that.X()},function(){return-that.Y()}],{type:"translate"}),tOff=this.board.create("transform",[function(){return that.X()},function(){return that.Y()}],{type:"translate"}),tS=this.board.create("transform",[function(){return that.board.unitX/that.board.unitY},function(){return 1}],{type:"scale"}),tSInv=this.board.create("transform",[function(){return that.board.unitY/that.board.unitX},function(){return 1}],{type:"scale"}),tRot=this.board.create("transform",[function(){return Type.evaluate(angle)*Math.PI/180}],{type:"rotate"}),tOffInv.bindTo(this),tS.bindTo(this),tRot.bindTo(this),tSInv.bindTo(this),tOff.bindTo(this)),this},highlightStrokeColor:function(sColor){return JXG.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:sColor}),this},strokeColor:function(sColor){return JXG.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:sColor}),this},strokeWidth:function(width){return JXG.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:width}),this},fillColor:function(fColor){return JXG.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:fColor}),this},highlightFillColor:function(fColor){return JXG.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:fColor}),this},labelColor:function(lColor){return JXG.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:lColor}),this},dash:function(d){return JXG.deprecated("dash()","setAttribute()"),this.setAttribute({dash:d}),this},visible:function(v){return JXG.deprecated("visible()","setAttribute()"),this.setAttribute({visible:v}),this},shadow:function(s){return JXG.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:s}),this},getType:function(){return this.elType},getParents:function(){return Type.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var i,attributes=Type.deepCopy(this.visProp),cleanThis=[],len=cleanThis.length;for(attributes.id=this.id,attributes.name=this.name,i=0;i<len;i++)delete attributes[cleanThis[i]];return attributes},hasPoint:function(x,y){return!1},addTicks:function(ticks){return""!==ticks.id&&Type.exists(ticks.id)||(ticks.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(ticks),this.ticks.push(ticks),ticks.id},removeAllTicks:function(){var t;if(Type.exists(this.ticks)){for(t=this.ticks.length-1;t>=0;t--)this.removeTicks(this.ticks[t]);this.ticks=[],this.board.update()}},removeTicks:function(tick){var t,j;if(Type.exists(this.defaultTicks)&&this.defaultTicks===tick&&(this.defaultTicks=null),Type.exists(this.ticks))for(t=this.ticks.length-1;t>=0;t--)if(this.ticks[t]===tick){if(this.board.removeObject(this.ticks[t]),this.ticks[t].ticks)for(j=0;j<this.ticks[t].ticks.length;j++)Type.exists(this.ticks[t].labels[j])&&this.board.removeObject(this.ticks[t].labels[j]);delete this.ticks[t];break}},getSnapSizes:function(){var sX,sY,ticks;return sX=Type.evaluate(this.visProp.snapsizex),sY=Type.evaluate(this.visProp.snapsizey),sX<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(sX=(ticks=this.board.defaultAxes.x.defaultTicks).ticksDelta*(Type.evaluate(ticks.visProp.minorticks)+1)),sY<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(sY=(ticks=this.board.defaultAxes.y.defaultTicks).ticksDelta*(Type.evaluate(ticks.visProp.minorticks)+1)),[sX,sY]},handleSnapToGrid:function(force,fromParent){var x,y,rx,ry,rcoords,boardBB,res,sX,sY,attractToGrid=Type.evaluate(this.visProp.attracttogrid),ev_au=Type.evaluate(this.visProp.attractorunit),ev_ad=Type.evaluate(this.visProp.attractordistance);return!Type.exists(this.coords)||Type.evaluate(this.visProp.fixed)||(Type.evaluate(this.visProp.snaptogrid)||attractToGrid||!0===force)&&(x=this.coords.usrCoords[1],y=this.coords.usrCoords[2],sX=(res=this.getSnapSizes())[0],sY=res[1],sX>0&&sY>0&&(boardBB=this.board.getBoundingBox(),rx=Math.round(x/sX)*sX,ry=Math.round(y/sY)*sY,rcoords=new JXG.Coords(Const.COORDS_BY_USER,[rx,ry],this.board),(!attractToGrid||rcoords.distance("screen"===ev_au?Const.COORDS_BY_SCREEN:Const.COORDS_BY_USER,this.coords)<ev_ad)&&(x=rx,y=ry,fromParent||(x<boardBB[0]?x+=sX:x>boardBB[2]&&(x-=sX),y<boardBB[3]?y+=sY:y>boardBB[1]&&(y-=sY)),this.coords.setCoordinates(Const.COORDS_BY_USER,[x,y])))),this},getBoundingBox:function(){var i,le,v,x,y,bb=[1/0,1/0,-1/0,-1/0];if(this.type===Const.OBJECT_TYPE_POLYGON){if((le=this.vertices.length-1)<=0)return bb;for(i=0;i<le;i++)v=this.vertices[i].X(),bb[0]=v<bb[0]?v:bb[0],bb[2]=v>bb[2]?v:bb[2],v=this.vertices[i].Y(),bb[1]=v<bb[1]?v:bb[1],bb[3]=v>bb[3]?v:bb[3]}else if(this.elementClass===Const.OBJECT_CLASS_CIRCLE)x=this.center.X(),y=this.center.Y(),bb=[x-this.radius,y+this.radius,x+this.radius,y-this.radius];else if(this.elementClass===Const.OBJECT_CLASS_CURVE){if(0===(le=this.vertices.length))return bb;for(i=0;i<le;i++)v=this.points[i].coords.usrCoords[1],bb[0]=v<bb[0]?v:bb[0],bb[2]=v>bb[2]?v:bb[2],v=this.points[i].coords.usrCoords[1],bb[1]=v<bb[1]?v:bb[1],bb[3]=v>bb[3]?v:bb[3]}return bb},addEvent:JXG.shortcut(JXG.GeometryElement.prototype,"on"),removeEvent:JXG.shortcut(JXG.GeometryElement.prototype,"off"),__evt__over:function(e){},__evt__mouseover:function(e){},__evt__out:function(e){},__evt__mouseout:function(e){},__evt__move:function(e){},__evt__mousemove:function(e){},__evt__drag:function(e){},__evt__mousedrag:function(e){},__evt__pendrag:function(e){},__evt__touchdrag:function(e){},__evt__down:function(e){},__evt__mousedown:function(e){},__evt__pendown:function(e){},__evt__touchdown:function(e){},__evt__up:function(e){},__evt__mouseup:function(e){},__evt__penup:function(e){},__evt__touchup:function(e){},__evt__attribute:function(o,el){},__evt__attribute_:function(val,nval,el){},__evt:function(){}}),JXG.GeometryElement})),define("base/coordselement",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","utils/type"],(function(JXG,Mat,Geometry,Numerics,Statistics,Coords,Const,Type){return JXG.CoordsElement=function(coordinates,isLabel){var i;for(Type.exists(coordinates)||(coordinates=[1,0,0]),i=0;i<coordinates.length;++i)coordinates[i]=parseFloat(coordinates[i]);this.coords=new Coords(Const.COORDS_BY_USER,coordinates,this.board),this.initialCoords=new Coords(Const.COORDS_BY_USER,coordinates,this.board),this.position=null,this.isConstrained=!1,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=Type.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),Type.exists(this.element)&&this.addAnchor(coordinates,isLabel),this.isDraggable=!0},JXG.extend(JXG.CoordsElement.prototype,{updateConstraint:function(){return this},updateCoords:function(fromParent){return this.needsUpdate?(Type.exists(fromParent)||(fromParent=!1),Type.evaluate(this.visProp.frozen)||this.updateConstraint(),this.type===Const.OBJECT_TYPE_GLIDER&&(this.isConstrained&&(fromParent=!1),fromParent?this.updateGliderFromParent():this.updateGlider()),this.updateTransform(fromParent),this):this},updateGlider:function(){var i,p1c,p2c,d,v,poly,pos,alpha,beta,angle,cp,c,invMat,newCoords,newPos,ev_sw,res,cu,isTransformed,delta=2*Math.PI,doRound=!1,slide=this.slideObject,slides=[];if(this.needsUpdateFromParent=!1,slide.elementClass===Const.OBJECT_CLASS_CIRCLE)Type.evaluate(this.visProp.isgeonext)&&(delta=1),newCoords=Geometry.projectPointToCircle(this,slide,this.board),newPos=Geometry.rad([slide.center.X()+1,slide.center.Y()],slide.center,this)/delta;else if(slide.elementClass===Const.OBJECT_CLASS_LINE){if(this.onPolygon){if(p1c=slide.point1.coords.usrCoords,d=(p2c=slide.point2.coords.usrCoords)[i=1]-p1c[i],Math.abs(d)<Mat.eps&&(d=p2c[i=2]-p1c[i]),pos=(Geometry.projectPointToLine(this,slide,this.board).usrCoords[i]-p1c[i])/d,poly=slide.parentPolygon,pos<0){for(i=0;i<poly.borders.length;i++)if(slide===poly.borders[i]){slide=poly.borders[(i-1+poly.borders.length)%poly.borders.length];break}}else if(pos>1)for(i=0;i<poly.borders.length;i++)if(slide===poly.borders[i]){slide=poly.borders[(i+1+poly.borders.length)%poly.borders.length];break}slide.id!==this.slideObject.id&&(this.slideObject=slide)}p1c=slide.point1.coords,p2c=slide.point2.coords,(d=p1c.distance(Const.COORDS_BY_USER,p2c))<Mat.eps?(newCoords=p1c,doRound=!0,newPos=0):(newCoords=Geometry.projectPointToLine(this,slide,this.board),p1c=p1c.usrCoords.slice(0),p2c=p2c.usrCoords.slice(0),Math.abs(p2c[0])<Mat.eps?(d=p2c[i=1],Math.abs(d)<Mat.eps&&(d=p2c[i=2]),newPos=((d=(newCoords.usrCoords[i]-p1c[i])/d)>=0?1:-1)*(d=Math.abs(d))/(d+1)):Math.abs(p1c[0])<Mat.eps?(d=p1c[i=1],Math.abs(d)<Mat.eps&&(d=p1c[i=2]),newPos=(d=(newCoords.usrCoords[i]-p2c[i])/d)<0?(1-2*d)/(1-d):1/(d+1)):(d=p2c[i=1]-p1c[i],Math.abs(d)<Mat.eps&&(d=p2c[i=2]-p1c[i]),newPos=(newCoords.usrCoords[i]-p1c[i])/d)),ev_sw=Type.evaluate(this.visProp.snapwidth),Type.evaluate(ev_sw)>0&&Math.abs(this._smax-this._smin)>=Mat.eps&&(v=(newPos=Math.max(Math.min(newPos,1),0))*(this._smax-this._smin)+this._smin,newPos=((v=Math.round(v/ev_sw)*ev_sw)-this._smin)/(this._smax-this._smin),this.update(!0)),p1c=slide.point1.coords,!Type.evaluate(slide.visProp.straightfirst)&&Math.abs(p1c.usrCoords[0])>Mat.eps&&newPos<0&&(newCoords=p1c,doRound=!0,newPos=0),p2c=slide.point2.coords,!Type.evaluate(slide.visProp.straightlast)&&Math.abs(p2c.usrCoords[0])>Mat.eps&&newPos>1&&(newCoords=p2c,doRound=!0,newPos=1)}else if(slide.type===Const.OBJECT_TYPE_TURTLE)this.updateConstraint(),newCoords=(res=Geometry.projectPointToTurtle(this,slide,this.board))[0],newPos=res[1];else if(slide.elementClass===Const.OBJECT_CLASS_CURVE)if(slide.type===Const.OBJECT_TYPE_ARC||slide.type===Const.OBJECT_TYPE_SECTOR)newCoords=Geometry.projectPointToCircle(this,slide,this.board),angle=Geometry.rad(slide.radiuspoint,slide.center,this),alpha=0,beta=Geometry.rad(slide.radiuspoint,slide.center,slide.anglepoint),newPos=angle,("minor"===(ev_sw=Type.evaluate(slide.visProp.selection))&&beta>Math.PI||"major"===ev_sw&&beta<Math.PI)&&(alpha=beta,beta=2*Math.PI),(angle<alpha||angle>beta)&&(newPos=beta,(angle<alpha&&angle>.5*alpha||angle>beta&&angle>.5*beta+Math.PI)&&(newPos=alpha),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),delta=beta-alpha,this.visProp.isgeonext&&(delta=1),Math.abs(delta)>Mat.eps&&(newPos/=delta);else if(this.updateConstraint(),slide.transformations.length>0){for(isTransformed=!1,(res=slide.getTransformationSource())[0]&&(isTransformed=res[0],slides.push(slide),slides.push(res[1]));res[0]&&Type.exists(res[1]._transformationSource);)res=res[1].getTransformationSource(),slides.push(res[1]);if(cu=this.coords.usrCoords,isTransformed){for(i=0;i<slides.length;i++)slides[i].updateTransformMatrix(),invMat=Mat.inverse(slides[i].transformMat),cu=Mat.matVecMult(invMat,cu);for(cp=new Coords(Const.COORDS_BY_USER,cu,this.board).usrCoords,cu=(c=Geometry.projectCoordsToCurve(cp[1],cp[2],this.position||0,slides[slides.length-1],this.board))[0].usrCoords,i=slides.length-2;i>=0;i--)cu=Mat.matVecMult(slides[i].transformMat,cu);c[0]=new Coords(Const.COORDS_BY_USER,cu,this.board)}else slide.updateTransformMatrix(),invMat=Mat.inverse(slide.transformMat),cu=Mat.matVecMult(invMat,cu),cp=new Coords(Const.COORDS_BY_USER,cu,this.board).usrCoords,c=Geometry.projectCoordsToCurve(cp[1],cp[2],this.position||0,slide,this.board);newCoords=c[0],newPos=c[1]}else newCoords=(res=Geometry.projectPointToCurve(this,slide,this.board))[0],newPos=res[1];else Type.isPoint(slide)&&(newCoords=Geometry.projectPointToPoint(this,slide,this.board),newPos=this.position);this.coords.setCoordinates(Const.COORDS_BY_USER,newCoords.usrCoords,doRound),this.position=newPos},updateGliderFromParent:function(){var p1c,p2c,r,lbda,c,res,i,isTransformed,baseangle,alpha,angle,beta,slide=this.slideObject,slides=[],delta=2*Math.PI;if(this.needsUpdateFromParent){if(slide.elementClass===Const.OBJECT_CLASS_CIRCLE)r=slide.Radius(),Type.evaluate(this.visProp.isgeonext)&&(delta=1),c=[slide.center.X()+r*Math.cos(this.position*delta),slide.center.Y()+r*Math.sin(this.position*delta)];else if(slide.elementClass===Const.OBJECT_CLASS_LINE)p1c=slide.point1.coords.usrCoords,p2c=slide.point2.coords.usrCoords,0===p1c[0]&&0===p1c[1]&&0===p1c[2]||0===p2c[0]&&0===p2c[1]&&0===p2c[2]?c=[0,0,0]:Math.abs(p2c[0])<Mat.eps?(lbda=Math.min(Math.abs(this.position),1-Mat.eps),lbda/=1-lbda,this.position<0&&(lbda=-lbda),c=[p1c[0]+lbda*p2c[0],p1c[1]+lbda*p2c[1],p1c[2]+lbda*p2c[2]]):Math.abs(p1c[0])<Mat.eps?(lbda=Math.max(this.position,Mat.eps),lbda=(lbda=Math.min(lbda,2-Mat.eps))>1?(lbda-1)/(lbda-2):(1-lbda)/lbda,c=[p2c[0]+lbda*p1c[0],p2c[1]+lbda*p1c[1],p2c[2]+lbda*p1c[2]]):(lbda=this.position,c=[p1c[0]+lbda*(p2c[0]-p1c[0]),p1c[1]+lbda*(p2c[1]-p1c[1]),p1c[2]+lbda*(p2c[2]-p1c[2])]);else if(slide.type===Const.OBJECT_TYPE_TURTLE)this.coords.setCoordinates(Const.COORDS_BY_USER,[slide.Z(this.position),slide.X(this.position),slide.Y(this.position)]),this.updateConstraint(),c=Geometry.projectPointToTurtle(this,slide,this.board)[0].usrCoords;else if(slide.elementClass===Const.OBJECT_CLASS_CURVE){for(isTransformed=!1,(res=slide.getTransformationSource())[0]&&(isTransformed=res[0],slides.push(slide),slides.push(res[1]));res[0]&&Type.exists(res[1]._transformationSource);)res=res[1].getTransformationSource(),slides.push(res[1]);if(isTransformed?this.coords.setCoordinates(Const.COORDS_BY_USER,[slides[slides.length-1].Z(this.position),slides[slides.length-1].X(this.position),slides[slides.length-1].Y(this.position)]):this.coords.setCoordinates(Const.COORDS_BY_USER,[slide.Z(this.position),slide.X(this.position),slide.Y(this.position)]),slide.type===Const.OBJECT_TYPE_ARC||slide.type===Const.OBJECT_TYPE_SECTOR)baseangle=Geometry.rad([slide.center.X()+1,slide.center.Y()],slide.center,slide.radiuspoint),alpha=0,beta=Geometry.rad(slide.radiuspoint,slide.center,slide.anglepoint),("minor"===slide.visProp.selection&&beta>Math.PI||"major"===slide.visProp.selection&&beta<Math.PI)&&(alpha=beta,beta=2*Math.PI),delta=beta-alpha,Type.evaluate(this.visProp.isgeonext)&&(delta=1),((angle=this.position*delta)<alpha||angle>beta)&&(((angle=beta)<alpha&&angle>.5*alpha||angle>beta&&angle>.5*beta+Math.PI)&&(angle=alpha),this.position=angle,Math.abs(delta)>Mat.eps&&(this.position/=delta)),r=slide.Radius(),c=[slide.center.X()+r*Math.cos(this.position*delta+baseangle),slide.center.Y()+r*Math.sin(this.position*delta+baseangle)];else if(this.updateConstraint(),isTransformed)for(c=Geometry.projectPointToCurve(this,slides[slides.length-1],this.board)[0].usrCoords,i=slides.length-2;i>=0;i--)c=new Coords(Const.COORDS_BY_USER,Mat.matVecMult(slides[i].transformMat,c),this.board).usrCoords;else c=Geometry.projectPointToCurve(this,slide,this.board)[0].usrCoords}else Type.isPoint(slide)&&(c=Geometry.projectPointToPoint(this,slide,this.board).usrCoords);this.coords.setCoordinates(Const.COORDS_BY_USER,c,!1)}else this.needsUpdateFromParent=!0},updateRendererGeneric:function(rendererMethod){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>Mat.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[rendererMethod](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(point2){return this.isReal&&point2.isReal?this.coords.distance(Const.COORDS_BY_USER,point2.coords):NaN},snapToGrid:function(force){return this.handleSnapToGrid(force)},handleSnapToPoints:function(force){var i,pEl,pCoords,len,ev_au,ev_ad,len2,j,d=0,dMax=1/0,c=null,ev_is2p=Type.evaluate(this.visProp.ignoredsnaptopoints),ignore=!1;if(len=this.board.objectsList.length,ev_is2p&&(len2=ev_is2p.length),Type.evaluate(this.visProp.snaptopoints)||force){for(ev_au=Type.evaluate(this.visProp.attractorunit),ev_ad=Type.evaluate(this.visProp.attractordistance),i=0;i<len;i++){if(pEl=this.board.objectsList[i],ev_is2p){for(ignore=!1,j=0;j<len2;j++)if(pEl===this.board.select(ev_is2p[j])){ignore=!0;break}if(ignore)continue}Type.isPoint(pEl)&&pEl!==this&&pEl.visPropCalc.visible&&(pCoords=Geometry.projectPointToPoint(this,pEl,this.board),(d="screen"===ev_au?pCoords.distance(Const.COORDS_BY_SCREEN,this.coords):pCoords.distance(Const.COORDS_BY_USER,this.coords))<ev_ad&&d<dMax&&(dMax=d,c=pCoords))}null!==c&&this.coords.setCoordinates(Const.COORDS_BY_USER,c.usrCoords)}return this},snapToPoints:function(force){return this.handleSnapToPoints(force)},handleAttractors:function(){var i,el,projCoords,projection,d=0,ev_au=Type.evaluate(this.visProp.attractorunit),ev_ad=Type.evaluate(this.visProp.attractordistance),ev_sd=Type.evaluate(this.visProp.snatchdistance),ev_a=Type.evaluate(this.visProp.attractors),len=ev_a.length;if(0!==ev_ad){for(i=0;i<len;i++)if(el=this.board.select(ev_a[i]),Type.exists(el)&&el!==this){if(Type.isPoint(el)?projCoords=Geometry.projectPointToPoint(this,el,this.board):el.elementClass===Const.OBJECT_CLASS_LINE?(projection=Geometry.projectCoordsToSegment(this.coords.usrCoords,el.point1.coords.usrCoords,el.point2.coords.usrCoords),projCoords=!Type.evaluate(el.visProp.straightfirst)&&projection[1]<0?el.point1.coords:!Type.evaluate(el.visProp.straightlast)&&projection[1]>1?el.point2.coords:new Coords(Const.COORDS_BY_USER,projection[0],this.board)):el.elementClass===Const.OBJECT_CLASS_CIRCLE?projCoords=Geometry.projectPointToCircle(this,el,this.board):el.elementClass===Const.OBJECT_CLASS_CURVE?projCoords=Geometry.projectPointToCurve(this,el,this.board)[0]:el.type===Const.OBJECT_TYPE_TURTLE?projCoords=Geometry.projectPointToTurtle(this,el,this.board)[0]:el.type===Const.OBJECT_TYPE_POLYGON&&(projCoords=new Coords(Const.COORDS_BY_USER,Geometry.projectCoordsToPolygon(this.coords.usrCoords,el),this.board)),(d="screen"===ev_au?projCoords.distance(Const.COORDS_BY_SCREEN,this.coords):projCoords.distance(Const.COORDS_BY_USER,this.coords))<ev_ad){this.type===Const.OBJECT_TYPE_GLIDER&&(el===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===el)||this.makeGlider(el);break}d>=ev_sd&&(el===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===el)&&this.popSlideObject()}return this}},setPositionDirectly:function(method,coords){var i,c,dc,newCoords,oldCoords=this.coords;if(this.relativeCoords)return c=new Coords(method,coords,this.board),Type.evaluate(this.visProp.islabel)?(dc=Statistics.subtract(c.scrCoords,oldCoords.scrCoords),this.relativeCoords.scrCoords[1]+=dc[1],this.relativeCoords.scrCoords[2]+=dc[2]):(dc=Statistics.subtract(c.usrCoords,oldCoords.usrCoords),this.relativeCoords.usrCoords[1]+=dc[1],this.relativeCoords.usrCoords[2]+=dc[2]),this;for(this.coords.setCoordinates(method,coords),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),i=this.transformations.length-1;i>=0;i--)method===Const.COORDS_BY_SCREEN?newCoords=new Coords(method,coords,this.board).usrCoords:(2===coords.length&&(coords=[1].concat(coords)),newCoords=coords),this.initialCoords.setCoordinates(Const.COORDS_BY_USER,Mat.matVecMult(Mat.inverse(this.transformations[i].matrix),newCoords));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===Const.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(method,tv){var t;return tv=new Coords(method,tv,this.board),t=this.board.create("transform",tv.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(t):this.addTransform(this,t),this.prepareUpdate().update(),this},setPosition:function(method,coords){return this.setPositionDirectly(method,coords)},setGliderPosition:function(x){return this.type===Const.OBJECT_TYPE_GLIDER&&(this.position=x,this.board.update()),this},makeGlider:function(slide){var min,i,dist,slideobj=this.board.select(slide),onPolygon=!1;if(slideobj.type===Const.OBJECT_TYPE_POLYGON){for(min=Number.MAX_VALUE,i=0;i<slideobj.borders.length;i++)(dist=JXG.Math.Geometry.distPointLine(this.coords.usrCoords,slideobj.borders[i].stdform))<min&&(min=dist,slide=slideobj.borders[i]);slideobj=this.board.select(slide),onPolygon=!0}if(!Type.exists(slideobj))throw new Error("JSXGraph: slide object undefined.");if(slideobj.type===Const.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(slide),this.slideObjects.push(this.slideObject),this.addParents(slide),this.type=Const.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=onPolygon,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),0===this.slideObjects.length?(this.type=this._org_type,this.type===Const.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===Const.OBJECT_CLASS_TEXT?this.elType="text":this.type===Const.OBJECT_TYPE_IMAGE?this.elType="image":this.type===Const.OBJECT_TYPE_FOREIGNOBJECT&&(this.elType="foreignobject"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var ancestorId,ancestor;if(this.type!==Const.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,delete this.updateConstraint,this.isConstrained=!1,this.isDraggable)return;this.isDraggable=!0,this.elementClass===Const.OBJECT_CLASS_POINT&&(this.type=Const.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(ancestorId in this.board.objects)this.board.objects.hasOwnProperty(ancestorId)&&(ancestor=this.board.objects[ancestorId]).descendants&&(delete ancestor.descendants[this.id],delete ancestor.childElements[this.id],this.hasLabel&&(delete ancestor.descendants[this.label.id],delete ancestor.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===Const.OBJECT_CLASS_POINT?(this.type=Const.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===Const.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===Const.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(terms){var i,v,newfuncs=[],what=["X","Y"],makeConstFunction=function(z){return function(){return z}},makeSliderFunction=function(a){return function(){return a.Value()}};for(this.elementClass===Const.OBJECT_CLASS_POINT&&(this.type=Const.OBJECT_TYPE_CAS),this.isDraggable=!1,i=0;i<terms.length;i++)v=terms[i],Type.isString(v)?(newfuncs[i]=this.board.jc.snippet(v,!0,null,!0),2===terms.length&&(this[what[i]+"jc"]=terms[i])):Type.isFunction(v)?newfuncs[i]=v:Type.isNumber(v)?newfuncs[i]=makeConstFunction(v):Type.isObject(v)&&Type.isFunction(v.Value)&&(newfuncs[i]=makeSliderFunction(v)),newfuncs[i].origin=v;return 1===terms.length?this.updateConstraint=function(){var c=newfuncs[0]();return Type.isArray(c)?this.coords.setCoordinates(Const.COORDS_BY_USER,c):this.coords=c,this}:2===terms.length?(this.XEval=newfuncs[0],this.YEval=newfuncs[1],this.setParents([newfuncs[0].origin,newfuncs[1].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(Const.COORDS_BY_USER,[this.XEval(),this.YEval()]),this}):(this.ZEval=newfuncs[0],this.XEval=newfuncs[1],this.YEval=newfuncs[2],this.setParents([newfuncs[0].origin,newfuncs[1].origin,newfuncs[2].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(Const.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]),this}),this.isConstrained=!0,this.prepareUpdate().update(),this.board.isSuspendedUpdate||(this.updateVisibility().updateRenderer(),this.hasLabel&&this.label.fullUpdate()),this},addAnchor:function(coordinates,isLabel){this.relativeCoords=isLabel?new Coords(Const.COORDS_BY_SCREEN,coordinates.slice(0,2),this.board):new Coords(Const.COORDS_BY_USER,coordinates,this.board),this.element.addChild(this),isLabel&&this.addParents(this.element),this.XEval=function(){var sx,anchor,ev_o;return Type.evaluate(this.visProp.islabel)?(ev_o=Type.evaluate(this.visProp.offset),sx=parseFloat(ev_o[0]),anchor=this.element.getLabelAnchor(),new Coords(Const.COORDS_BY_SCREEN,[sx+this.relativeCoords.scrCoords[1]+anchor.scrCoords[1],0],this.board).usrCoords[1]):(anchor=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+anchor.usrCoords[1])},this.YEval=function(){var sy,anchor,ev_o;return Type.evaluate(this.visProp.islabel)?(ev_o=Type.evaluate(this.visProp.offset),sy=-parseFloat(ev_o[1]),anchor=this.element.getLabelAnchor(),new Coords(Const.COORDS_BY_SCREEN,[0,sy+this.relativeCoords.scrCoords[2]+anchor.scrCoords[2]],this.board).usrCoords[2]):(anchor=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+anchor.usrCoords[2])},this.ZEval=Type.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(Const.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.isConstrained=!0,this.updateConstraint()},updateTransform:function(fromParent){var i;if(0===this.transformations.length)return this;for(i=0;i<this.transformations.length;i++)this.transformations[i].update();return this},addTransform:function(el,transform){var i,list=Type.isArray(transform)?transform:[transform],len=list.length;for(0===this.transformations.length&&(this.baseElement=el),i=0;i<len;i++)this.transformations.push(list[i]);return this},startAnimation:function(direction,stepCount,delay){var that=this;return delay=delay||250,this.type!==Const.OBJECT_TYPE_GLIDER||Type.exists(this.intervalCode)||(this.intervalCode=window.setInterval((function(){that._anim(direction,stepCount)}),delay),Type.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return Type.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(path,time,options){options=options||{};var i,neville,len,pos,part,interpath=[],p=[],steps=time/this.board.attr.animationdelay,makeFakeFunction=function(i,j){return function(){return path[i][j]}};if(Type.isArray(path)){for(len=path.length,i=0;i<len;i++)Type.isPoint(path[i])?p[i]=path[i]:p[i]={elementClass:Const.OBJECT_CLASS_POINT,X:makeFakeFunction(i,0),Y:makeFakeFunction(i,1)};if(0===(time=time||0))return this.setPosition(Const.COORDS_BY_USER,[p[p.length-1].X(),p[p.length-1].Y()]),this.board.update(this);if(!Type.exists(options.interpolate)||options.interpolate)for(neville=Numerics.Neville(p),i=0;i<steps;i++)interpath[i]=[],interpath[i][0]=neville[0]((steps-i)/steps*neville[3]()),interpath[i][1]=neville[1]((steps-i)/steps*neville[3]());else{for(len=path.length-1,i=0;i<steps;++i)part=i/steps*len-(pos=Math.floor(i/steps*len)),interpath[i]=[],interpath[i][0]=(1-part)*p[pos].X()+part*p[pos+1].X(),interpath[i][1]=(1-part)*p[pos].Y()+part*p[pos+1].Y();interpath.push([p[len].X(),p[len].Y()]),interpath.reverse()}this.animationPath=interpath}else Type.isFunction(path)&&(this.animationPath=path,this.animationStart=(new Date).getTime());return this.animationCallback=options.callback,this.board.addAnimation(this),this},moveTo:function(where,time,options){options=options||{},where=new Coords(Const.COORDS_BY_USER,where,this.board);var i,delay=this.board.attr.animationdelay,steps=Math.ceil(time/delay),coords=[],X=this.coords.usrCoords[1],Y=this.coords.usrCoords[2],dX=where.usrCoords[1]-X,dY=where.usrCoords[2]-Y,stepFun=function(i){return options.effect&&"<>"===options.effect?Math.pow(Math.sin(i/steps*Math.PI/2),2):i/steps};if(!Type.exists(time)||0===time||Math.abs(where.usrCoords[0]-this.coords.usrCoords[0])>Mat.eps)return this.setPosition(Const.COORDS_BY_USER,where.usrCoords),this.board.update(this);if(!Type.exists(options.callback)&&Math.abs(dX)<Mat.eps&&Math.abs(dY)<Mat.eps)return this;for(i=steps;i>=0;i--)coords[steps-i]=[where.usrCoords[0],X+dX*stepFun(i),Y+dY*stepFun(i)];return this.animationPath=coords,this.animationCallback=options.callback,this.board.addAnimation(this),this},visit:function(where,time,options){where=new Coords(Const.COORDS_BY_USER,where,this.board);var i,j,steps,delay=this.board.attr.animationdelay,coords=[],X=this.coords.usrCoords[1],Y=this.coords.usrCoords[2],dX=where.usrCoords[1]-X,dY=where.usrCoords[2]-Y,stepFun=function(i){var x=i<steps/2?2*i/steps:2*(steps-i)/steps;return options.effect&&"<>"===options.effect?Math.pow(Math.sin(x*Math.PI/2),2):x};for(Type.isNumber(options)?options={repeat:options}:(options=options||{},Type.exists(options.repeat)||(options.repeat=1)),steps=Math.ceil(time/(delay*options.repeat)),j=0;j<options.repeat;j++)for(i=steps;i>=0;i--)coords[j*(steps+1)+steps-i]=[where.usrCoords[0],X+dX*stepFun(i),Y+dY*stepFun(i)];return this.animationPath=coords,this.animationCallback=options.callback,this.board.addAnimation(this),this},_anim:function(direction,stepCount){var dX,dY,alpha,startPoint,newX,radius,sp1c,sp2c,res;return this.intervalCount+=1,this.intervalCount>stepCount&&(this.intervalCount=0),this.slideObject.elementClass===Const.OBJECT_CLASS_LINE?(sp1c=this.slideObject.point1.coords.scrCoords,sp2c=this.slideObject.point2.coords.scrCoords,dX=Math.round((sp2c[1]-sp1c[1])*this.intervalCount/stepCount),dY=Math.round((sp2c[2]-sp1c[2])*this.intervalCount/stepCount),direction>0?startPoint=this.slideObject.point1:(startPoint=this.slideObject.point2,dX*=-1,dY*=-1),this.coords.setCoordinates(Const.COORDS_BY_SCREEN,[startPoint.coords.scrCoords[1]+dX,startPoint.coords.scrCoords[2]+dY])):this.slideObject.elementClass===Const.OBJECT_CLASS_CURVE?(newX=direction>0?Math.round(this.intervalCount/stepCount*this.board.canvasWidth):Math.round((stepCount-this.intervalCount)/stepCount*this.board.canvasWidth),this.coords.setCoordinates(Const.COORDS_BY_SCREEN,[newX,0]),res=Geometry.projectPointToCurve(this,this.slideObject,this.board),this.coords=res[0],this.position=res[1]):this.slideObject.elementClass===Const.OBJECT_CLASS_CIRCLE&&(alpha=2*Math.PI,alpha*=direction<0?this.intervalCount/stepCount:(stepCount-this.intervalCount)/stepCount,radius=this.slideObject.Radius(),this.coords.setCoordinates(Const.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+radius*Math.cos(alpha),this.slideObject.center.coords.usrCoords[2]+radius*Math.sin(alpha)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var p=[this.Z(),this.X(),this.Y()];return 0!==this.parents.length&&(p=this.parents),this.type===Const.OBJECT_TYPE_GLIDER&&(p=[this.X(),this.Y(),this.slideObject.id]),p}}),JXG.CoordsElement.create=function(Callback,board,coords,attr,arg1,arg2){var el,i,isConstrained=!1;for(i=0;i<coords.length;i++)(Type.isFunction(coords[i])||Type.isString(coords[i]))&&(isConstrained=!0);if(isConstrained)(el=new Callback(board,[0,0],attr,arg1,arg2)).addConstraint(coords);else if(Type.isNumber(coords[0])&&Type.isNumber(coords[1]))el=new Callback(board,coords,attr,arg1,arg2),Type.exists(attr.slideobject)?el.makeGlider(attr.slideobject):el.baseElement=el,el.isDraggable=!0;else{if(!Type.isObject(coords[0])||!Type.isTransformationOrArray(coords[1]))return!1;(el=new Callback(board,[0,0],attr,arg1,arg2)).addTransform(coords[0],coords[1]),el.isDraggable=!1}return el.handleSnapToGrid(),el.handleSnapToPoints(),el.handleAttractors(),el.addParents(coords),el},JXG.CoordsElement})),define("base/text",["jxg","base/constants","base/element","parser/geonext","utils/env","utils/type","math/math","base/coordselement"],(function(JXG,Const,GeometryElement,GeonextParser,Env,Type,Mat,CoordsElement){var priv_HTMLSliderInputEventHandler=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};return JXG.Text=function(board,coords,attributes,content){this.constructor(board,attributes,Const.OBJECT_TYPE_TEXT,Const.OBJECT_CLASS_TEXT),this.element=this.board.select(attributes.anchor),this.coordsConstructor(coords,Type.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.board.finalizeAdding(this),this.setText(content),Type.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=Type.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},JXG.Text.prototype=new GeometryElement,Type.copyPrototypeMethods(JXG.Text,CoordsElement,"coordsConstructor"),JXG.extend(JXG.Text.prototype,{hasPoint:function(x,y){var lft,rt,top,bot,ax,ay,type,r;return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,r=Type.evaluate(this.visProp.precision[type])):r=this.board.options.precision.hasPoint,this.transformations.length>0&&(x=(lft=Mat.matVecMult(Mat.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,x,y]))[1],y=lft[2]),rt=(lft="right"===(ax=this.getAnchorX())?this.coords.scrCoords[1]-this.size[0]:"middle"===ax?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],top=(bot="top"===(ay=this.getAnchorY())?this.coords.scrCoords[2]+this.size[1]:"middle"===ay?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],"all"===Type.evaluate(this.visProp.dragarea)?x>=lft-r&&x<rt+r&&y>=top-r&&y<=bot+r:y>=top-r&&y<=bot+r&&(x>=lft-r&&x<=lft+2*r||x>=rt-2*r&&x<=rt+r)},_createFctUpdateText:function(text){var updateText,resolvedText,ev_p=Type.evaluate(this.visProp.parse),ev_um=Type.evaluate(this.visProp.usemathjax),ev_uk=Type.evaluate(this.visProp.usekatex);this.orgText=text,Type.isFunction(text)?this.updateText=function(){resolvedText=text().toString(),this.plaintext=!ev_p||ev_um||ev_uk?resolvedText:this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(resolvedText)))}:Type.isString(text)&&!ev_p?this.updateText=function(){this.plaintext=text}:(Type.isNumber(text)?this.content=Type.toFixed(text,Type.evaluate(this.visProp.digits)):Type.evaluate(this.visProp.useasciimathml)?this.content="'`"+text+"`'":this.content=ev_um||ev_uk?"'"+text+"'":this.generateTerm(text,!0,!0),updateText=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=updateText()})},_setText:function(text){return this._createFctUpdateText(text),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(text){var s;return this.visProp.castext=text,s=Type.isFunction(text)?function(){return Type.sanitizeHTML(text())}:Type.isNumber(text)?text:Type.sanitizeHTML(text),this._setText(s)},setText:function(text){return this._setText(text)},updateSize:function(){var tmp,that,node,ev_d=Type.evaluate(this.visProp.display);return Env.isBrowser&&"no"!==this.board.renderer.type?(node=this.rendNode,"html"===ev_d||"vml"===this.board.renderer.type?Type.exists(node.offsetWidth)?(that=this,window.setTimeout((function(){that.size=[node.offsetWidth,node.offsetHeight],that.needsUpdate=!0,that.updateRenderer()}),0)):this.size=this.crudeSizeEstimate():"internal"===ev_d&&("svg"===this.board.renderer.type?(that=this,window.setTimeout((function(){try{tmp=node.getBBox(),that.size=[tmp.width,tmp.height],that.needsUpdate=!0,that.updateRenderer()}catch(e){}}),0)):"canvas"===this.board.renderer.type&&(this.size=this.crudeSizeEstimate())),this):this},crudeSizeEstimate:function(){var ev_fs=parseFloat(Type.evaluate(this.visProp.fontsize));return[ev_fs*this.plaintext.length*.45,.9*ev_fs]},utf8_decode:function(string){return string.replace(/&#x(\w+);/g,(function(m,p1){return String.fromCharCode(parseInt(p1,16))}))},replaceSub:function(te){if(!te.indexOf)return te;for(var j,i=te.indexOf("_{");i>=0;)(j=(te=te.substr(0,i)+te.substr(i).replace(/_\{/,"<sub>")).substr(i).indexOf("}"))>=0&&(te=te.substr(0,j)+te.substr(j).replace(/\}/,"</sub>")),i=te.indexOf("_{");for(i=te.indexOf("_");i>=0;)i=(te=te.substr(0,i)+te.substr(i).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return te},replaceSup:function(te){if(!te.indexOf)return te;for(var j,i=te.indexOf("^{");i>=0;)(j=(te=te.substr(0,i)+te.substr(i).replace(/\^\{/,"<sup>")).substr(i).indexOf("}"))>=0&&(te=te.substr(0,j)+te.substr(j).replace(/\}/,"</sup>")),i=te.indexOf("^{");for(i=te.indexOf("^");i>=0;)i=(te=te.substr(0,i)+te.substr(i).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return te},getSize:function(){return this.size},setCoords:function(x,y){var coordsAnchor,dx,dy;return Type.isArray(x)&&x.length>1&&(y=x[1],x=x[0]),Type.evaluate(this.visProp.islabel)&&Type.exists(this.element)?(dx=(x-(coordsAnchor=this.element.getLabelAnchor()).usrCoords[1])*this.board.unitX,dy=-(y-coordsAnchor.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(Const.COORDS_BY_SCREEN,[dx,dy])):this.coords.setCoordinates(Const.COORDS_BY_USER,[x,y]),this.fullUpdate(),this},update:function(fromParent){return this.needsUpdate?(this.updateCoords(fromParent),this.updateText(),"internal"===Type.evaluate(this.visProp.display)&&Type.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return Type.evaluate(this.visProp.autoposition)&&this.setAutoPosition().updateConstraint(),this.updateRendererGeneric("updateText")},expandShortMath:function(expr){return expr.replace(/([)0-9.])\s*([(a-zA-Z_])/g,"$1*$2")},generateTerm:function(contentStr,expand,avoidGeonext2JS){var res,term,i,j,plaintext='""';if(i=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=(contentStr=contentStr||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),j=contentStr.indexOf("</value>"),i>=0)for(;i>=0;)plaintext+=' + "'+this.replaceSub(this.replaceSup(contentStr.slice(0,i)))+'"',term=(term=contentStr.slice(i+7,j)).replace(/\s+/g,""),!0===expand&&(term=this.expandShortMath(term)),(res=(res=(res=avoidGeonext2JS?term:GeonextParser.geonext2JS(term,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&Type.isNumber(Type.bind(this.board.jc.snippet(res,!0,"",!1),this)())?plaintext+="+("+res+").toFixed("+Type.evaluate(this.visProp.digits)+")":plaintext+="+("+res+")",i=(contentStr=contentStr.slice(j+8)).indexOf("<value>"),j=contentStr.indexOf("</value>");return plaintext+=' + "'+this.replaceSub(this.replaceSup(contentStr))+'"',plaintext=(plaintext=(plaintext=this.convertGeonextAndSketchometry2CSS(plaintext)).replace(/&amp;/g,"&")).replace(/"/g,"'")},convertGeonext2CSS:function(s){return Type.isString(s)&&(s=(s=(s=(s=s.replace(/(<|&lt;)overline(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/overline(>|&gt;)/g,"</span>")).replace(/(<|&lt;)arrow(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/arrow(>|&gt;)/g,"</span>")),s},convertSketchometry2CSS:function(s){return Type.isString(s)&&(s=(s=(s=(s=s.replace(/(<|&lt;)sketchofont(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchofont(>|&gt;)/g,"</span>")).replace(/(<|&lt;)sketchometry-light(>|&gt;)/g,"<span style=font-family:sketchometry-light;font-weight:500;>")).replace(/(<|&lt;)\/sketchometry-light(>|&gt;)/g,"</span>")),s},convertGeonextAndSketchometry2CSS:function(s){return s=this.convertGeonext2CSS(s),s=this.convertSketchometry2CSS(s)},notifyParents:function(content){var search,res=null;content=(content=content.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do{null!==(res=(search=/<value>([\w\s*/^\-+()[\],<>=!]+)<\/value>/).exec(content))&&(GeonextParser.findDependencies(this,res[1],this.board),content=(content=content.substr(res.index)).replace(search,""))}while(null!==res);return this},getParents:function(){var p;return p=void 0!==this.relativeCoords?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],0!==this.parents.length&&(p=this.parents),p},bounds:function(){var c=this.coords.usrCoords;return Type.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX?[0,0,0,0]:[c[1],c[2]+this.size[1]/this.board.unitY,c[1]+this.size[0]/this.board.unitX,c[2]]},getAnchorX:function(){var a=Type.evaluate(this.visProp.anchorx);if("auto"===a)switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";default:return"right"}return a},getAnchorY:function(){var a=Type.evaluate(this.visProp.anchory);if("auto"===a)switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";default:return"middle"}return a},getNumberofConflicts:function(x,y,w,h){var i,obj,le,savePointPrecision,count=0;for(savePointPrecision=this.board.options.precision.hasPoint,this.board.options.precision.hasPoint=.25*(w+h),i=0,le=this.board.objectsList.length;i<le;i++)(obj=this.board.objectsList[i]).visPropCalc.visible&&"axis"!==obj.elType&&"ticks"!==obj.elType&&obj!==this.board.infobox&&obj!==this&&obj.hasPoint(x,y)&&count++;return this.board.options.precision.hasPoint=savePointPrecision,count},setAutoPosition:function(){var x,y,cx,cy,anchorCoords,start_angle,angle,delta_r,conflicts,offset,r,j,dx,dy,co,si,w=this.size[0],h=this.size[1],optimum={conflicts:1/0,angle:0,r:0},step=2*Math.PI/12;if(this===this.board.infobox||!this.visPropCalc.visible||!Type.evaluate(this.visProp.islabel)||!this.element)return this;if(offset=Type.evaluate(this.visProp.offset),cx=(anchorCoords=this.element.getLabelAnchor()).scrCoords[1],cy=anchorCoords.scrCoords[2],dx=offset[0],dy=offset[1],0===(conflicts=this.getNumberofConflicts(cx+dx,cy-dy,w,h)))return this;for(28,delta_r=.2*(r=12),start_angle=Math.atan2(dy,dx),optimum.conflicts=conflicts,optimum.angle=start_angle,optimum.r=r;optimum.conflicts>0&&r<28;){for(j=1,angle=start_angle+step;j<12&&optimum.conflicts>0&&(x=cx+r*(co=Math.cos(angle)),y=cy-r*(si=Math.sin(angle)),(conflicts=this.getNumberofConflicts(x,y,w,h))<optimum.conflicts&&(optimum.conflicts=conflicts,optimum.angle=angle,optimum.r=r),0!==optimum.conflicts);j++)angle+=step;r+=delta_r}return r=optimum.r,co=Math.cos(optimum.angle),si=Math.sin(optimum.angle),this.visProp.offset=[r*co,r*si],this.visProp.anchorx=co<-.2?"right":co>.2?"left":"middle",this}}),JXG.createText=function(board,parents,attributes){var t,attr=Type.copyAttributes(attributes,board.options,"text"),coords=parents.slice(0,-1),content=parents[parents.length-1];if(attr.anchor=attr.parent||attr.anchor,!(t=CoordsElement.create(JXG.Text,board,coords,attr,content)))throw new Error("JSXGraph: Can't create text with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==attr.rotate&&"internal"===attr.display&&t.addRotation(attr.rotate),t},JXG.registerElement("text",JXG.createText),JXG.createHTMLSlider=function(board,parents,attributes){var t,par,attr=Type.copyAttributes(attributes,board.options,"htmlslider");if(2!==parents.length||2!==parents[0].length||3!==parents[1].length)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parents are: [[x,y], [min, start, max]]");attr.anchor=attr.parent||attr.anchor,attr.fixed=attr.fixed||!0,par=[parents[0][0],parents[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],(t=JXG.createText(board,par,attr)).type=Type.OBJECT_TYPE_HTMLSLIDER,t.rendNodeForm=t.rendNode.childNodes[0],t.rendNodeRange=t.rendNodeForm.childNodes[0],t.rendNodeRange.min=parents[1][0],t.rendNodeRange.max=parents[1][2],t.rendNodeRange.step=attr.step,t.rendNodeRange.value=parents[1][1],t.rendNodeLabel=t.rendNodeForm.childNodes[1],t.rendNodeLabel.id=t.rendNode.id+"_label",attr.withlabel&&(t.rendNodeLabel.innerHTML=t.name+"="),t.rendNodeOut=t.rendNodeForm.childNodes[2],t.rendNodeOut.value=parents[1][1];try{t.rendNodeForm.id=t.rendNode.id+"_form",t.rendNodeRange.id=t.rendNode.id+"_range",t.rendNodeOut.id=t.rendNode.id+"_out"}catch(e){JXG.debug(e)}return t.rendNodeRange.style.width=attr.widthrange+"px",t.rendNodeRange.style.verticalAlign="middle",t.rendNodeOut.style.width=attr.widthout+"px",t._val=parents[1][1],JXG.supportsVML()?Env.addEvent(t.rendNodeForm,"change",priv_HTMLSliderInputEventHandler,t):Env.addEvent(t.rendNodeForm,"input",priv_HTMLSliderInputEventHandler,t),t.Value=function(){return this._val},t},JXG.registerElement("htmlslider",JXG.createHTMLSlider),{Text:JXG.Text,createText:JXG.createText,createHTMLSlider:JXG.createHTMLSlider}})),define("utils/uuid",["jxg"],(function(JXG){var uuidChars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return JXG.Util=JXG.Util||{},JXG.Util.genUUID=function(prefix){var r,i,uuid=[],rnd=0;for(""!==(prefix=prefix||"")&&"-"!==prefix.substr(prefix.length-1)&&(prefix+="-"),i=0;i<36;i++)8===i||13===i||18===i||23===i?uuid[i]="-":14===i?uuid[i]="4":(rnd<=2&&(rnd=33554432+16777216*Math.random()|0),r=15&rnd,rnd>>=4,uuid[i]=uuidChars[19===i?3&r|8:r]);return prefix+uuid.join("")},JXG.Util})),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/ia","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],(function(JXG,Const,Text,Mat,Interval,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(o,properties){if("object"!==_typeof(o)&&"function"!=typeof o)throw new TypeError("Object prototype may only be an Object: "+o);if(null===o)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==properties)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function F(){}return F.prototype=o,new F});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}},r,_ccache;JXG.JessieCode=function(code,geonext){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.operands=this.getPossibleOperands(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="","string"==typeof code&&this.parse(code,geonext)},JXG.extend(JXG.JessieCode.prototype,{node:function(type,value,children){return{type:type,value:value,children:children}},createNode:function(type,value,children){var i,n=this.node(type,value,[]);for(i=2;i<arguments.length;i++)n.children.push(arguments[i]);return"node_const"==n.type&&Type.isNumber(n.value)&&(n.isMath=!0),n.line=this.parCurLine,n.col=this.parCurColumn,n},pushScope:function(args){var scope={args:args,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=scope,scope.id=this.scopes.push(scope)-1,scope},popScope:function(){var s=this.scope.previous;return this.scope=null!==s?s:this.scope,this.scope},getElementById:function(id){return this.board.objects[id]},log:function(){this.$log.push(arguments),"object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&console.log.apply(console,arguments)},creator:(_ccache={},(r=function(vname){var f,that;return"function"==typeof _ccache[this.board.id+vname]?f=_ccache[this.board.id+vname]:(that=this,(f=function(parameters,attributes){var attr;return void 0===(attr=Type.exists(attributes)?attributes:{}).name&&void 0===attr.id&&(attr.name=0!==that.lhs[that.scope.id]?that.lhs[that.scope.id]:""),that.board.create(vname,parameters,attr)}).creator=!0,_ccache[this.board.id+vname]=f),f}).clearCache=function(){_ccache={}},r),letvar:function(vname,value){this.builtIn[vname]&&this._warn('"'+vname+'" is a predefined value.'),this.scope.locals[vname]=value},isLocalVariable:function(vname){for(var s=this.scope;null!==s;){if(Type.exists(s.locals[vname]))return s;s=s.previous}return null},isParameter:function(vname){for(var s=this.scope;null!==s;){if(Type.indexOf(s.args,vname)>-1)return s;s=s.previous}return null},isCreator:function(vname){return!!JXG.elements[vname]},isMathMethod:function(vname){return"E"!==vname&&!!Math[vname]},isBuiltIn:function(vname){return!!this.builtIn[vname]},getvar:function(vname,local,isFunctionName){var s;if(local=Type.def(local,!1),null!==(s=this.isLocalVariable(vname)))return s.locals[vname];if("$board"===vname||"EULER"===vname||"PI"===vname)return this.builtIn[vname];if(isFunctionName){if(this.isBuiltIn(vname))return this.builtIn[vname];if(this.isMathMethod(vname))return Math[vname];if(this.isCreator(vname))return this.creator(vname)}return local||(s=this.board.select(vname))===vname?void 0:s},resolve:function(vname){for(var s=this.scope;null!==s;){if(Type.exists(s.locals[vname]))return s.locals[vname];s=s.previous}},getvarJS:function(vname,local,withProps){var re,r="";return local=Type.def(local,!1),withProps=Type.def(withProps,!1),null!==this.isParameter(vname)?vname:null===this.isLocalVariable(vname)||withProps?this.isCreator(vname)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(withProps?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+vname+"'].concat([a, props])); })":(withProps&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(vname)?(r=this.builtIn[vname].src||this.builtIn[vname],Type.isNumber(r)||r.match(/board\.select/)?r:(vname=r.split(".").pop(),Type.exists(this.board.mathLib)&&null!==(re=new RegExp("^Math."+vname)).exec(r)?r.replace(re,"$jc$.board.mathLib."+vname):Type.exists(this.board.mathLibJXG)&&null!==(re=new RegExp("^JXG.Math.")).exec(r)?r.replace(re,"$jc$.board.mathLibJXG."):r)):this.isMathMethod(vname)?"$jc$.board.mathLib."+vname:local?"":(Type.isId(this.board,vname)?(r="$jc$.board.objects['"+vname+"']","slider"===this.board.objects[vname].elType&&(r+=".Value()")):Type.isName(this.board,vname)?(r="$jc$.board.elementsByName['"+vname+"']","slider"===this.board.elementsByName[vname].elType&&(r+=".Value()")):Type.isGroup(this.board,vname)&&(r="$jc$.board.groups['"+vname+"']"),r)):"$jc$.resolve('"+vname+"')"},makeMap:function(f){return f.isMap=!0,f},functionCodeJS:function(node){var p=node.children[0].join(", "),bo="",bc="";return"op_map"===node.value&&(bo="{ return  ",bc=" }"),"function ("+p+") {\nvar $oldscope$ = $jc$.scope;\n$jc$.scope = $jc$.scopes["+this.scope.id+"];\nvar r = (function () "+bo+this.compile(node.children[1],!0)+bc+")();\n$jc$.scope = $oldscope$;\nreturn r;\n}"},defineFunction:function defineFunction(node){var fun,i,that=this,list=node.children[0],scope=this.pushScope(list),_that;if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{for(fun=eval(str),scope.argtypes=[],i=0;i<list.length;i++)scope.argtypes.push(that.resolveType(list[i],node));return fun}catch(e){return $jc$._warn("error compiling function\n\n"+str+"\n\n"+e.toString()),function(){}}}(this),this.popScope()}else fun=function(_pstack,that,id){return function(){var r,oldscope;for(oldscope=that.scope,that.scope=that.scopes[id],r=0;r<_pstack.length;r++)that.scope.locals[_pstack[r]]=arguments[r];return r=that.execute(node.children[1]),that.scope=oldscope,r}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=(_that=this,function(){return _that.compile(_that.replaceIDs(Type.deepCopy(node)))}),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(o){var i,attr={};for(i=0;i<arguments.length;i++)attr=Type.deepCopy(attr,arguments[i],!0);return attr},setProp:function(o,what,value){var x,y,par={};o.elementClass!==Const.OBJECT_CLASS_POINT||"X"!==what&&"Y"!==what?o.elementClass!==Const.OBJECT_CLASS_TEXT||"X"!==what&&"Y"!==what?o.type&&o.elementClass&&o.visProp?Type.exists(o[o.methodMap[what]])&&"function"!=typeof o[o.methodMap[what]]?o[o.methodMap[what]]=value:(par[what]=value,o.setAttribute(par)):o[what]=value:("number"==typeof value?o[what]=function(){return value}:"function"==typeof value?(o.isDraggable=!1,o[what]=value):"string"==typeof value&&(o.isDraggable=!1,o[what]=Type.createFunction(value,this.board,null,!0),o[what+"jc"]=value),o[what].origin=value,this.board.update()):(what=what.toLowerCase(),o.isDraggable&&"number"==typeof value?(x="x"===what?value:o.X(),y="y"===what?value:o.Y(),o.setPosition(Const.COORDS_BY_USER,[x,y])):!o.isDraggable||"function"!=typeof value&&"string"!=typeof value?o.isDraggable||(x="x"===what?value:o.XEval.origin,y="y"===what?value:o.YEval.origin,o.addConstraint([x,y])):(x="x"===what?value:o.coords.usrCoords[1],y="y"===what?value:o.coords.usrCoords[2],o.addConstraint([x,y])),this.board.update())},_genericParse:function(code,cmd,geonext,dontstore){var i,setTextBackup,ast,result,ccode=code.replace(/\r\n/g,"\n").split("\n"),cleaned=[];dontstore||(this.code+=code+"\n"),Text&&(setTextBackup=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(geonext)||(geonext=!1),i=0;i<ccode.length;i++)geonext&&(ccode[i]=JXG.GeonextParser.geonext2JS(ccode[i],this.board)),cleaned.push(ccode[i]);switch(code=cleaned.join("\n"),ast=parser.parse(code),this.CA&&(ast=this.CA.expandDerivatives(ast,null,ast),ast=this.CA.removeTrivialNodes(ast)),cmd){case"parse":result=this.execute(ast);break;case"manipulate":result=this.compile(ast);break;case"getAst":result=ast;break;default:result=!1}}catch(e){throw e}finally{Text&&(Text.Text.prototype.setText=setTextBackup)}return result},parse:function(code,geonext,dontstore){return this._genericParse(code,"parse",geonext,dontstore)},manipulate:function(code,geonext,dontstore){return this._genericParse(code,"manipulate",geonext,dontstore)},getAST:function(code,geonext,dontstore){return this._genericParse(code,"getAst",geonext,dontstore)},snippet:function(code,funwrap,varname,geonext){var c;return funwrap=Type.def(funwrap,!0),varname=Type.def(varname,""),geonext=Type.def(geonext,!1),c=(funwrap?" function ("+varname+") { return ":"")+code+(funwrap?"; }":"")+";",this.parse(c,geonext,!0)},replaceIDs:function(node){var i,v;if(node.replaced&&(v=this.board.objects[node.children[1][0].value],Type.exists(v)&&""!==v.name&&(node.type="node_var",node.value=v.name,node.children.length=0,delete node.replaced)),Type.isArray(node))for(i=0;i<node.length;i++)node[i]=this.replaceIDs(node[i]);if(node.children)for(i=node.children.length;i>0;i--)Type.exists(node.children[i-1])&&(node.children[i-1]=this.replaceIDs(node.children[i-1]));return node},replaceNames:function(node){var i,v;if(v=node.value,"node_op"===node.type&&"op_lhs"===v&&1===node.children.length?this.isLHS=!0:"node_var"===node.type&&(this.isLHS?this.letvar(v,!0):!Type.exists(this.getvar(v,!0))&&Type.exists(this.board.elementsByName[v])&&(node=this.createReplacementNode(node))),Type.isArray(node))for(i=0;i<node.length;i++)node[i]=this.replaceNames(node[i]);if(node.children)for(i=node.children.length;i>0;i--)Type.exists(node.children[i-1])&&(node.children[i-1]=this.replaceNames(node.children[i-1]));return"node_op"===node.type&&"op_lhs"===node.value&&1===node.children.length&&(this.isLHS=!1),node},createReplacementNode:function(node){var v=node.value,el=this.board.elementsByName[v];return(node=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",el.id)])).replaced=!0,node},collectDependencies:function(node,result){var i,v,e,le;if(Type.isArray(node))for(le=node.length,i=0;i<le;i++)this.collectDependencies(node[i],result);else if(v=node.value,"node_var"===node.type&&(e=this.getvar(v))&&e.visProp&&e.type&&e.elementClass&&e.id&&(result[e.id]=e),"node_op"===node.type&&"op_execfun"===node.value&&node.children.length>1&&"$"===node.children[0].value&&node.children[1].length>0&&(result[e=node.children[1][0].value]=this.board.objects[e]),node.children)for(i=node.children.length;i>0;i--)Type.exists(node.children[i-1])&&this.collectDependencies(node.children[i-1],result)},resolveProperty:function(e,v,compile){return compile=Type.def(compile,!1),e&&e.methodMap&&(Type.exists(e.subs)&&Type.exists(e.subs[v])?e=e.subs:Type.exists(e.methodMap[v])?v=e.methodMap[v]:(e=e.visProp,v=v.toLowerCase())),Type.isFunction(e)&&this._error("Accessing function properties is not allowed."),Type.exists(e)||this._error(e+" is not an object"),Type.exists(e[v])||this._error("unknown property "+v),compile&&"function"==typeof e[v]?function(){return e[v].apply(e,arguments)}:e[v]},resolveType:function(vname,node){var i,t;if(Type.isArray(node))for(i=0;i<node.length;i++)if("any"!==(t=this.resolveType(vname,node[i])))return t;if("node_op"===node.type&&"op_execfun"===node.value&&"node_var"===node.children[0].type&&node.children[0].value===vname)return"function";if("node_op"===node.type){for(i=0;i<node.children.length;i++)if("node_var"===node.children[0].type&&node.children[0].value===vname&&("op_add"===node.value||"op_sub"===node.value||"op_mul"===node.value||"op_div"===node.value||"op_mod"===node.value||"op_exp"===node.value||"op_neg"===node.value))return"any";for(i=0;i<node.children.length;i++)if("any"!==(t=this.resolveType(vname,node.children[i])))return t}return"any"},getLHS:function(node){var res;if("node_var"===node.type)res={o:this.scope.locals,what:node.value};else if("node_op"===node.type&&"op_property"===node.value)res={o:this.execute(node.children[0]),what:node.children[1]};else{if("node_op"!==node.type||"op_extvalue"!==node.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");res={o:this.execute(node.children[0]),what:this.execute(node.children[1])}}return res},getLHSCompiler:function(node,js){var res;if("node_var"===node.type)res=node.value;else if("node_op"===node.type&&"op_property"===node.value)res=[this.compile(node.children[0],js),"'"+node.children[1]+"'"];else{if("node_op"!==node.type||"op_extvalue"!==node.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");res=[this.compile(node.children[0],js),"node_const"===node.children[1].type?node.children[1].value:this.compile(node.children[1],js)]}return res},execute:function(node){var ret,v,i,e,l,list,ilist,fun,attr,sc,parents=[];if(ret=0,!node)return ret;switch(this.line=node.line,this.col=node.col,node.type){case"node_op":switch(node.value){case"op_none":node.children[0]&&this.execute(node.children[0]),node.children[1]&&(ret=this.execute(node.children[1]));break;case"op_assign":v=this.getLHS(node.children[0]),this.lhs[this.scope.id]=v.what,v.o.type&&v.o.elementClass&&v.o.methodMap&&"label"===v.what&&this._error("Left-hand side of assignment is read-only."),ret=this.execute(node.children[1]),v.o!==this.scope.locals||Type.isArray(v.o)&&"number"==typeof v.what?this.setProp(v.o,v.what,ret):this.letvar(v.what,ret),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(node.children[0])&&(ret=this.execute(node.children[1]));break;case"op_conditional":case"op_if_else":ret=this.execute(node.children[0])?this.execute(node.children[1]):this.execute(node.children[2]);break;case"op_while":for(;this.execute(node.children[0]);)this.execute(node.children[1]);break;case"op_do":do{this.execute(node.children[0])}while(this.execute(node.children[1]));break;case"op_for":for(this.execute(node.children[0]);this.execute(node.children[1]);this.execute(node.children[2]))this.execute(node.children[3]);break;case"op_proplst":node.children[0]&&this.execute(node.children[0]),node.children[1]&&this.execute(node.children[1]);break;case"op_emptyobject":ret={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(node.children[0]),ret=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][node.children[0]]=this.execute(node.children[1]);break;case"op_array":for(ret=[],l=node.children[0].length,i=0;i<l;i++)ret.push(this.execute(node.children[0][i]));break;case"op_extvalue":ret=this.execute(node.children[0]),ret="number"==typeof(i=this.execute(node.children[1]))&&Math.abs(Math.round(i)-i)<Mat.eps?ret[i]:undefined;break;case"op_return":if(0!==this.scope)return this.execute(node.children[0]);this._error("Unexpected return.");break;case"op_map":node.children[1].isMath||"node_var"===node.children[1].type||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(fun=this.defineFunction(node)).isMap=!0,ret=fun;break;case"op_function":(fun=this.defineFunction(node)).isMap=!1,ret=fun;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,list=node.children[1],Type.exists(node.children[2]))if(node.children[3])for(ilist=node.children[2],attr={},i=0;i<ilist.length;i++)attr=Type.deepCopy(attr,this.execute(ilist[i]),!0);else attr=this.execute(node.children[2]);for(node.children[0]._isFunctionName=!0,fun=this.execute(node.children[0]),delete node.children[0]._isFunctionName,sc=fun&&fun.sc?fun.sc:this,!fun.creator&&Type.exists(node.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),i=0;i<list.length;i++)Type.exists(fun.scope)&&Type.exists(fun.scope.argtypes)&&"function"===fun.scope.argtypes[i]?(list[i]._isFunctionName=!0,parents[i]=this.execute(list[i]),delete list[i]._isFunctionName):parents[i]=this.execute(list[i]),this.dpstack[this.pscope].push({line:node.children[1][i].line,col:node.children[1][i].ecol});if("function"!=typeof fun||fun.creator)if("function"==typeof fun&&fun.creator){e=this.line;try{for((ret=fun(parents,attr)).jcLineStart=e,ret.jcLineEnd=node.eline,i=e;i<=node.line;i++)this.lineToElement[i]=ret;ret.debugParents=this.dpstack[this.pscope]}catch(ex){this._error(ex.toString())}}else this._error("Function '"+fun+"' is undefined.");else ret=fun.apply(sc,parents);this.dpstack.pop(),this.pscope--;break;case"op_property":e=this.execute(node.children[0]),v=node.children[1],ret=this.resolveProperty(e,v,!1),Type.exists(ret)&&(ret.sc=e);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(node.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),v=this.getvar(node.children[0]),ret=this.del(v);break;case"op_eq":ret=this.execute(node.children[0])==this.execute(node.children[1]);break;case"op_neq":ret=this.execute(node.children[0])!=this.execute(node.children[1]);break;case"op_approx":ret=Math.abs(this.execute(node.children[0])-this.execute(node.children[1]))<Mat.eps;break;case"op_gt":ret=this.execute(node.children[0])>this.execute(node.children[1]);break;case"op_lt":ret=this.execute(node.children[0])<this.execute(node.children[1]);break;case"op_geq":ret=this.execute(node.children[0])>=this.execute(node.children[1]);break;case"op_leq":ret=this.execute(node.children[0])<=this.execute(node.children[1]);break;case"op_or":ret=this.execute(node.children[0])||this.execute(node.children[1]);break;case"op_and":ret=this.execute(node.children[0])&&this.execute(node.children[1]);break;case"op_not":ret=!this.execute(node.children[0]);break;case"op_add":ret=this.add(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_sub":ret=this.sub(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_div":ret=this.div(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_mod":ret=this.mod(this.execute(node.children[0]),this.execute(node.children[1]),!0);break;case"op_mul":ret=this.mul(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_exp":ret=this.pow(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_neg":ret=this.neg(this.execute(node.children[0]))}break;case"node_var":ret=this.getvar(node.value,!1,node._isFunctionName);break;case"node_const":ret=null===node.value?null:Number(node.value);break;case"node_const_bool":ret=node.value;break;case"node_str":ret=node.value.replace(/\\(.)/,"$1")}return ret},compile:function(node,js){var e,i,list,ret="";if(Type.exists(js)||(js=!1),!node)return ret;switch(node.type){case"node_op":switch(node.value){case"op_none":node.children[0]&&(ret=this.compile(node.children[0],js)),node.children[1]&&(ret+=this.compile(node.children[1],js));break;case"op_assign":js?(e=this.getLHSCompiler(node.children[0],js),Type.isArray(e)?ret="$jc$.setProp("+e[0]+", "+e[1]+", "+this.compile(node.children[1],js)+");\n":(this.isLocalVariable(e)!==this.scope&&(this.scope.locals[e]=!0),ret="$jc$.scopes["+this.scope.id+"].locals['"+e+"'] = "+this.compile(node.children[1],js)+";\n")):ret=(e=this.compile(node.children[0]))+" = "+this.compile(node.children[1],js)+";\n";break;case"op_if":ret=" if ("+this.compile(node.children[0],js)+") "+this.compile(node.children[1],js);break;case"op_if_else":ret=" if ("+this.compile(node.children[0],js)+")"+this.compile(node.children[1],js),ret+=" else "+this.compile(node.children[2],js);break;case"op_conditional":ret="(("+this.compile(node.children[0],js)+")?("+this.compile(node.children[1],js),ret+="):("+this.compile(node.children[2],js)+"))";break;case"op_while":ret=" while ("+this.compile(node.children[0],js)+") {\n"+this.compile(node.children[1],js)+"}\n";break;case"op_do":ret=" do {\n"+this.compile(node.children[0],js)+"} while ("+this.compile(node.children[1],js)+");\n";break;case"op_for":ret=" for ("+this.compile(node.children[0],js)+this.compile(node.children[1],js)+"; "+this.compile(node.children[2],js).slice(0,-2)+") {\n"+this.compile(node.children[3],js)+"\n}\n";break;case"op_proplst":node.children[0]&&(ret=this.compile(node.children[0],js)+", "),ret+=this.compile(node.children[1],js);break;case"op_prop":ret=node.children[0]+": "+this.compile(node.children[1],js);break;case"op_emptyobject":ret=js?"{}":"<< >>";break;case"op_proplst_val":ret=this.compile(node.children[0],js);break;case"op_array":for(list=[],i=0;i<node.children[0].length;i++)list.push(this.compile(node.children[0][i],js));ret="["+list.join(", ")+"]";break;case"op_extvalue":ret=this.compile(node.children[0],js)+"["+this.compile(node.children[1],js)+"]";break;case"op_return":ret=" return "+this.compile(node.children[0],js)+";\n";break;case"op_map":node.children[1].isMath||"node_var"===node.children[1].type||this._error("compile: In a map only function calls and mathematical expressions are allowed."),list=node.children[0],ret=js?" $jc$.makeMap(function ("+list.join(", ")+") { return "+this.compile(node.children[1],js)+"; })":"map ("+list.join(", ")+") -> "+this.compile(node.children[1],js);break;case"op_function":list=node.children[0],this.pushScope(list),ret=js?this.functionCodeJS(node):" function ("+list.join(", ")+") "+this.compile(node.children[1],js),this.popScope();break;case"op_execfunmath":console.log("op_execfunmath: TODO"),ret="-1";break;case"op_execfun":if(node.children[2]){for(list=[],i=0;i<node.children[2].length;i++)list.push(this.compile(node.children[2][i],js));js&&(e="$jc$.mergeAttributes("+list.join(", ")+")")}for(node.children[0].withProps=!!node.children[2],list=[],i=0;i<node.children[1].length;i++)list.push(this.compile(node.children[1][i],js));ret=this.compile(node.children[0],js)+"("+list.join(", ")+(node.children[2]&&js?", "+e:"")+")"+(node.children[2]&&!js?e:""),js&&(ret+="\n"),js&&"$"===node.children[0].value&&(ret="$jc$.board.objects["+this.compile(node.children[1][0],js)+"]");break;case"op_property":ret=js&&"X"!==node.children[1]&&"Y"!==node.children[1]?"$jc$.resolveProperty("+this.compile(node.children[0],js)+", '"+node.children[1]+"', true)":this.compile(node.children[0],js)+"."+node.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),ret=js?"$jc$.use('":"use('",ret+=node.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),ret=js?"$jc$.del(":"remove(",ret+=this.compile(node.children[0],js)+")";break;case"op_eq":ret="("+this.compile(node.children[0],js)+" === "+this.compile(node.children[1],js)+")";break;case"op_neq":ret="("+this.compile(node.children[0],js)+" !== "+this.compile(node.children[1],js)+")";break;case"op_approx":ret="("+this.compile(node.children[0],js)+" ~= "+this.compile(node.children[1],js)+")";break;case"op_gt":ret=js?"$jc$.gt("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" > "+this.compile(node.children[1],js)+")";break;case"op_lt":ret=js?"$jc$.lt("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" < "+this.compile(node.children[1],js)+")";break;case"op_geq":ret=js?"$jc$.geq("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" >= "+this.compile(node.children[1],js)+")";break;case"op_leq":ret=js?"$jc$.leq("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" <= "+this.compile(node.children[1],js)+")";break;case"op_or":ret="("+this.compile(node.children[0],js)+" || "+this.compile(node.children[1],js)+")";break;case"op_and":ret="("+this.compile(node.children[0],js)+" && "+this.compile(node.children[1],js)+")";break;case"op_not":ret="!("+this.compile(node.children[0],js)+")";break;case"op_add":ret=js?"$jc$.add("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" + "+this.compile(node.children[1],js)+")";break;case"op_sub":ret=js?"$jc$.sub("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" - "+this.compile(node.children[1],js)+")";break;case"op_div":ret=js?"$jc$.div("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" / "+this.compile(node.children[1],js)+")";break;case"op_mod":ret=js?"$jc$.mod("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+", true)":"("+this.compile(node.children[0],js)+" % "+this.compile(node.children[1],js)+")";break;case"op_mul":ret=js?"$jc$.mul("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+" * "+this.compile(node.children[1],js)+")";break;case"op_exp":ret=js?"$jc$.pow("+this.compile(node.children[0],js)+", "+this.compile(node.children[1],js)+")":"("+this.compile(node.children[0],js)+"^"+this.compile(node.children[1],js)+")";break;case"op_neg":ret=js?"$jc$.neg("+this.compile(node.children[0],js)+")":"(-"+this.compile(node.children[0],js)+")"}break;case"node_var":ret=js?this.getvarJS(node.value,!1,node.withProps):node.value;break;case"node_const":case"node_const_bool":ret=node.value;break;case"node_str":ret="'"+node.value+"'"}return node.needsBrackets&&(ret="{\n"+ret+"\n}\n"),ret},getName:function(obj,useId){var name="";return Type.exists(obj)&&Type.exists(obj.getName)?(name=obj.getName(),Type.exists(name)&&""!==name||!useId||(name=obj.id)):useId&&(name=obj.id),name},X:function(e){return e.X()},Y:function(e){return e.Y()},V:function(e){return e.Value()},L:function(e){return e.L()},area:function(obj){return Type.exists(obj)&&Type.exists(obj.Area)||this._error("Error: Can't calculate area."),obj.Area()},dist:function(p1,p2){return Type.exists(p1)&&Type.exists(p1.Dist)||this._error("Error: Can't calculate distance."),p1.Dist(p2)},radius:function(obj){return Type.exists(obj)&&Type.exists(obj.Radius)||this._error("Error: Can't calculate radius."),obj.Radius()},add:function(a,b){var i,len,res;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Interval.isInterval(a)||Interval.isInterval(b))res=Interval.add(a,b);else if(Type.isArray(a)&&Type.isArray(b))for(len=Math.min(a.length,b.length),res=[],i=0;i<len;i++)res[i]=a[i]+b[i];else Type.isNumber(a)&&Type.isNumber(b)?res=a+b:Type.isString(a)||Type.isString(b)?res=a.toString()+b.toString():this._error("Operation + not defined on operands "+_typeof(a)+" and "+_typeof(b));return res},sub:function(a,b){var i,len,res;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Interval.isInterval(a)||Interval.isInterval(b))res=Interval.sub(a,b);else if(Type.isArray(a)&&Type.isArray(b))for(len=Math.min(a.length,b.length),res=[],i=0;i<len;i++)res[i]=a[i]-b[i];else Type.isNumber(a)&&Type.isNumber(b)?res=a-b:this._error("Operation - not defined on operands "+_typeof(a)+" and "+_typeof(b));return res},neg:function(a){var i,len,res;if(a=Type.evalSlider(a),Interval.isInterval(a))res=Interval.negative(a);else if(Type.isArray(a))for(len=a.length,res=[],i=0;i<len;i++)res[i]=-a[i];else Type.isNumber(a)?res=-a:this._error("Unary operation - not defined on operand "+_typeof(a));return res},mul:function(a,b){var i,len,res;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isNumber(b)&&(i=a,b=a=b),Interval.isInterval(a)||Interval.isInterval(b))res=Interval.mul(a,b);else if(Type.isArray(a)&&Type.isArray(b))len=Math.min(a.length,b.length),res=Mat.innerProduct(a,b,len);else if(Type.isNumber(a)&&Type.isArray(b))for(len=b.length,res=[],i=0;i<len;i++)res[i]=a*b[i];else Type.isNumber(a)&&Type.isNumber(b)?res=a*b:this._error("Operation * not defined on operands "+_typeof(a)+" and "+_typeof(b));return res},div:function(a,b){var i,len,res;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Interval.isInterval(a)||Interval.isInterval(b))res=Interval.div(a,b);else if(Type.isArray(a)&&Type.isNumber(b))for(len=a.length,res=[],i=0;i<len;i++)res[i]=a[i]/b;else Type.isNumber(a)&&Type.isNumber(b)?res=a/b:this._error("Operation * not defined on operands "+_typeof(a)+" and "+_typeof(b));return res},mod:function(a,b){var i,len,res;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Interval.isInterval(a)||Interval.isInterval(b))return Interval.fmod(a,b);if(Type.isArray(a)&&Type.isNumber(b))for(len=a.length,res=[],i=0;i<len;i++)res[i]=Mat.mod(a[i],b,!0);else Type.isNumber(a)&&Type.isNumber(b)?res=Mat.mod(a,b,!0):this._error("Operation * not defined on operands "+_typeof(a)+" and "+_typeof(b));return res},pow:function(a,b){return a=Type.evalSlider(a),b=Type.evalSlider(b),Interval.isInterval(a)||Interval.isInterval(b)?Interval.pow(a,b):Mat.pow(a,b)},lt:function(a,b){return Interval.isInterval(a)||Interval.isInterval(b)?Interval.lt(a,b):a<b},leq:function(a,b){return Interval.isInterval(a)||Interval.isInterval(b)?Interval.leq(a,b):a<=b},gt:function(a,b){return Interval.isInterval(a)||Interval.isInterval(b)?Interval.gt(a,b):a>b},geq:function(a,b){return Interval.isInterval(a)||Interval.isInterval(b)?Intervalt.geq(a,b):a>=b},randint:function(min,max,step){return Type.exists(step)||(step=1),Math.round(Math.random()*(max-min)/step)*step+min},DDD:function(f){console.log("Dummy derivative function. This should never appear!")},ifthen:function(cond,v1,v2){return cond?v1:v2},del:function(element){"object"===_typeof(element)&&JXG.exists(element.type)&&JXG.exists(element.elementClass)&&this.board.removeObject(element)},use:function(board){var b,ref,found=!1;if("string"==typeof board){for(b in JXG.boards)if(JXG.boards.hasOwnProperty(b)&&JXG.boards[b].container===board){ref=JXG.boards[b],found=!0;break}}else ref=board,found=!0;found?(this.board=ref,this.builtIn.$board=ref,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+board+"' not found!")},findSymbol:function(v,scope){var i,s;for(s=-1===(scope=Type.def(scope,-1))?this.scope:this.scopes[scope];null!==s;){for(i in s.locals)if(s.locals.hasOwnProperty(i)&&s.locals[i]===v)return[i,s];s=s.previous}return[]},importModule:function(module){return priv.modules[module.toLowerCase()]},defineBuiltIn:function(){var builtIn={PI:Math.PI,EULER:Math.E,D:this.DDD,X:this.X,Y:this.Y,V:this.V,L:this.L,acosh:Mat.acosh,acot:Mat.acot,asinh:Mat.asinh,binomial:Mat.binomial,cbrt:Mat.cbrt,cosh:Mat.cosh,cot:Mat.cot,deg:Geometry.trueAngle,A:this.area,area:this.area,dist:this.dist,R:this.radius,radius:this.radius,erf:Mat.erf,erfc:Mat.erfc,erfi:Mat.erfi,factorial:Mat.factorial,gcd:Mat.gcd,lb:Mat.log2,lcm:Mat.lcm,ld:Mat.log2,lg:Mat.log10,ln:Math.log,log:Mat.log,log10:Mat.log10,log2:Mat.log2,ndtr:Mat.ndtr,ndtri:Mat.ndtri,nthroot:Mat.nthroot,pow:Mat.pow,rad:Geometry.rad,ratpow:Mat.ratpow,trunc:Type.trunc,sinh:Mat.sinh,randint:this.randint,IfThen:this.ifthen,import:this.importModule,use:this.use,remove:this.del,$:this.getElementById,getName:this.getName,name:this.getName,$board:this.board,$log:this.log};return builtIn.rad.sc=Geometry,builtIn.deg.sc=Geometry,builtIn.factorial.sc=Mat,builtIn.X.src="$jc$.X",builtIn.Y.src="$jc$.Y",builtIn.V.src="$jc$.V",builtIn.L.src="$jc$.L",builtIn.acosh.src="JXG.Math.acosh",builtIn.acot.src="JXG.Math.acot",builtIn.asinh.src="JXG.Math.asinh",builtIn.binomial.src="JXG.Math.binomial",builtIn.cbrt.src="JXG.Math.cbrt",builtIn.cot.src="JXG.Math.cot",builtIn.cosh.src="JXG.Math.cosh",builtIn.deg.src="JXG.Math.Geometry.trueAngle",builtIn.erf.src="JXG.Math.erf",builtIn.erfc.src="JXG.Math.erfc",builtIn.erfi.src="JXG.Math.erfi",builtIn.A.src="$jc$.area",builtIn.area.src="$jc$.area",builtIn.dist.src="$jc$.dist",builtIn.R.src="$jc$.radius",builtIn.radius.src="$jc$.radius",builtIn.factorial.src="JXG.Math.factorial",builtIn.gcd.src="JXG.Math.gcd",builtIn.lb.src="JXG.Math.log2",builtIn.lcm.src="JXG.Math.lcm",builtIn.ld.src="JXG.Math.log2",builtIn.lg.src="JXG.Math.log10",builtIn.ln.src="Math.log",builtIn.log.src="JXG.Math.log",builtIn.log10.src="JXG.Math.log10",builtIn.log2.src="JXG.Math.log2",builtIn.ndtr.src="JXG.Math.ndtr",builtIn.ndtri.src="JXG.Math.ndtri",builtIn.nthroot.src="JXG.Math.nthroot",builtIn.pow.src="JXG.Math.pow",builtIn.rad.src="JXG.Math.Geometry.rad",builtIn.ratpow.src="JXG.Math.ratpow",builtIn.trunc.src="JXG.trunc",builtIn.sinh.src="JXG.Math.sinh",builtIn.randint.src="$jc$.randint",builtIn.import.src="$jc$.importModule",builtIn.use.src="$jc$.use",builtIn.remove.src="$jc$.del",builtIn.IfThen.src="$jc$.ifthen",builtIn.$.src="(function (n) { return $jc$.board.select(n); })",builtIn.getName.src="$jc$.getName",builtIn.name.src="$jc$.getName",builtIn.$board&&(builtIn.$board.src="$jc$.board"),builtIn.$log.src="$jc$.log",builtIn},getPossibleOperands:function(){var jc,ma,merge,i,j,p,len,e,funcs,funcsJC,consts,operands,sort,pack,FORBIDDEN=["E"],jessiecode=this.defineBuiltIn(),math=Math;for(sort=function(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())},pack=function(name,origin){var that=null;if("jc"===origin)that=jessiecode[name];else{if("Math"!==origin)return;that=math[name]}if(!FORBIDDEN.includes(name))return JXG.isFunction(that)?{name:name,type:"function",numParams:that.length,origin:origin}:JXG.isNumber(that)?{name:name,type:"constant",value:that,origin:origin}:void(void 0!==that&&console.error("undefined type",that))},jc=Object.getOwnPropertyNames(jessiecode).sort(sort),ma=Object.getOwnPropertyNames(math).sort(sort),merge=[],i=0,j=0;i<jc.length||j<ma.length;)jc[i]===ma[j]?(p=pack(ma[j],"Math"),JXG.exists(p)&&merge.push(p),i++,j++):!JXG.exists(ma[j])||jc[i].toLowerCase().localeCompare(ma[j].toLowerCase())<0?(p=pack(jc[i],"jc"),JXG.exists(p)&&merge.push(p),i++):(p=pack(ma[j],"Math"),JXG.exists(p)&&merge.push(p),j++);for(funcs=[],funcsJC=[],consts=[],operands={},len=merge.length,i=0;i<len;i++){switch((e=merge[i]).type){case"function":funcs.push(e.name),"jc"===e.origin&&funcsJC.push(e.name);break;case"constant":consts.push(e.name)}operands[e.name]=e}return{all:operands,list:merge,functions:funcs,functions_jessiecode:funcsJC,constants:consts}},_debug:function(log){"object"===("undefined"==typeof console?"undefined":_typeof(console))?console.log(log):Env.isBrowser&&document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=log+"<br />")},_error:function(msg){var e=new Error("Error("+this.line+"): "+msg);throw e.line=this.line,e},_warn:function(msg){"object"===("undefined"==typeof console?"undefined":_typeof(console))?console.log("Warning("+this.line+"): "+msg):Env.isBrowser&&document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+msg+"<br />")},_log:function(msg){"object"!==("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+msg.toString()}):console.log("Log: ",arguments)}});var parser=function(){var o=function(k,v,_o,l){for(_o=_o||{},l=k.length;l--;_o[k[l]]=v);return _o},$V0=[2,14],$V1=[1,13],$V2=[1,37],$V3=[1,14],$V4=[1,15],$V5=[1,21],$V6=[1,16],$V7=[1,17],$V8=[1,33],$V9=[1,18],$Va=[1,19],$Vb=[1,12],$Vc=[1,59],$Vd=[1,60],$Ve=[1,58],$Vf=[1,46],$Vg=[1,48],$Vh=[1,49],$Vi=[1,50],$Vj=[1,51],$Vk=[1,52],$Vl=[1,53],$Vm=[1,54],$Vn=[1,45],$Vo=[1,38],$Vp=[1,39],$Vq=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],$Vr=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],$Vs=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],$Vt=[2,48],$Vu=[1,72],$Vv=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],$Vw=[1,78],$Vx=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],$Vy=[1,82],$Vz=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],$VA=[1,83],$VB=[1,84],$VC=[1,85],$VD=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],$VE=[1,89],$VF=[1,90],$VG=[1,91],$VH=[1,92],$VI=[1,97],$VJ=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],$VK=[1,103],$VL=[1,104],$VM=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],$VN=[1,105],$VO=[1,106],$VP=[1,107],$VQ=[1,126],$VR=[1,139],$VS=[83,86],$VT=[1,150],$VU=[10,66,86],$VV=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],$VW=[1,167],$VX=[10,86],parser={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,5],[63,6],[92,1],[92,3]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=AST.createNode(lc(_$[$0-4]),"node_op","op_if",$$[$0-2],$$[$0]);break;case 3:this.$=AST.createNode(lc(_$[$0-6]),"node_op","op_if_else",$$[$0-4],$$[$0-2],$$[$0]);break;case 4:this.$=AST.createNode(lc(_$[$0-4]),"node_op","op_while",$$[$0-2],$$[$0]);break;case 5:this.$=AST.createNode(lc(_$[$0-8]),"node_op","op_for",$$[$0-6],$$[$0-4],$$[$0-2],$$[$0]);break;case 6:this.$=AST.createNode(lc(_$[$0-6]),"node_op","op_do",$$[$0-5],$$[$0-2]);break;case 7:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_use",$$[$0]);break;case 8:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_delete",$$[$0]);break;case 9:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_return",void 0);break;case 10:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_return",$$[$0-1]);break;case 11:case 14:this.$=AST.createNode(lc(_$[$0]),"node_op","op_none");break;case 12:this.$=$$[$0-1],this.$.needsBrackets=!0;break;case 13:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_none",$$[$0-1],$$[$0]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=$$[$0];break;case 22:case 65:case 93:this.$=$$[$0-1];break;case 25:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_assign",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 27:this.$=AST.createNode(lc(_$[$0-4]),"node_op","op_conditional",$$[$0-4],$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 29:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_or",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 31:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_and",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 33:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_eq",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 34:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_neq",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 35:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_approx",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 37:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_lt",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 38:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_gt",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 39:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_leq",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 40:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_geq",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 42:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_add",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 43:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_sub",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 45:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_mul",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 46:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_div",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 47:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_mod",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 49:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_exp",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 51:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_not",$$[$0]),this.$.isMath=!1;break;case 53:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_neg",$$[$0]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=$$[$0],this.$.isMath=!1;break;case 59:case 91:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_property",$$[$0-2],$$[$0]),this.$.isMath=!0;break;case 60:case 90:this.$=AST.createNode(lc(_$[$0-3]),"node_op","op_extvalue",$$[$0-3],$$[$0-1]),this.$.isMath=!0;break;case 61:this.$=AST.createNode(lc(_$[$0]),"node_var",$$[$0]);break;case 69:this.$=$$[$0],this.$.isMath=!0;break;case 70:this.$=AST.createNode(lc(_$[$0]),"node_const",null);break;case 71:this.$=AST.createNode(lc(_$[$0]),"node_const_bool",!0);break;case 72:this.$=AST.createNode(lc(_$[$0]),"node_const_bool",!1);break;case 73:this.$=AST.createNode(lc(_$[$0]),"node_str",$$[$0].substring(1,$$[$0].length-1));break;case 74:this.$=AST.createNode(lc(_$[$0]),"node_const",parseFloat($$[$0]));break;case 75:this.$=AST.createNode(lc(_$[$0]),"node_const",NaN);break;case 76:this.$=AST.createNode(lc(_$[$0]),"node_const",1/0);break;case 77:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_array",[]);break;case 78:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_array",$$[$0-1]);break;case 79:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_emptyobject",{}),this.$.needsBrackets=!0;break;case 80:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_proplst_val",$$[$0-1]),this.$.needsBrackets=!0;break;case 82:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_proplst",$$[$0-2],$$[$0]);break;case 83:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_prop",$$[$0-2],$$[$0]);break;case 87:case 89:this.$=AST.createNode(lc(_$[$0-1]),"node_op","op_execfun",$$[$0-1],$$[$0]),this.$.isMath=!0;break;case 88:this.$=AST.createNode(lc(_$[$0-2]),"node_op","op_execfun",$$[$0-2],$$[$0-1],$$[$0],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 104:this.$=[$$[$0]];break;case 95:case 99:case 105:this.$=$$[$0-2].concat($$[$0]);break;case 96:this.$=AST.createNode(lc(_$[$0]),"node_var",$$[$0]),this.$.isMath=!0;break;case 100:this.$=AST.createNode(lc(_$[$0-3]),"node_op","op_function",[],$$[$0]),this.$.isMath=!1;break;case 101:this.$=AST.createNode(lc(_$[$0-4]),"node_op","op_function",$$[$0-2],$$[$0]),this.$.isMath=!1;break;case 102:this.$=AST.createNode(lc(_$[$0-4]),"node_op","op_map",[],$$[$0]);break;case 103:this.$=AST.createNode(lc(_$[$0-5]),"node_op","op_map",$$[$0-3],$$[$0])}},table:[o([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],$V0,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:$V1,8:$V2,9:20,11:4,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{1:[2,1]},o($Vq,[2,13]),o($Vr,[2,15]),o($Vr,[2,16]),o($Vr,[2,17]),o($Vr,[2,18]),o($Vr,[2,19]),o($Vr,[2,20]),o($Vr,[2,21]),o([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],$V0,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:$V1,8:$V2,9:20,11:65,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{20:[1,66]},{20:[1,67]},{8:$V2,9:69,16:[1,68],20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{16:[1,70]},o($Vr,[2,11]),o($Vs,[2,23]),o($Vs,[2,24]),o([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],$Vt,{32:[1,71],57:$Vu}),o([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),o($Vv,[2,54],{88:77,8:$Vw,64:[1,75],65:[1,76]}),o($Vv,[2,55],{88:79,8:$Vw,64:[1,81],65:[1,80]}),o($Vx,[2,28],{39:$Vy}),o($Vs,[2,56]),o($Vs,[2,57]),o($Vs,[2,58]),o($Vz,[2,30],{41:$VA,42:$VB,43:$VC}),o($Vs,[2,61]),o($Vs,[2,62]),o($Vs,[2,63]),o($Vs,[2,64]),{8:$V2,9:86,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:[1,87]},{8:[1,88]},o($VD,[2,32],{45:$VE,46:$VF,47:$VG,48:$VH}),o($Vs,[2,66]),o($Vs,[2,67]),o($Vs,[2,68]),o($Vs,[2,69]),{20:$VI,72:98,73:99,77:$Vj,78:$Vk,79:$Vl,80:$Vm,83:[1,93],84:94,85:95,87:96},{8:$V2,20:$V8,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,81:101,82:$Vn,91:$Vo,93:$Vp},o($VJ,[2,36],{50:$VK,51:$VL}),o($Vs,[2,70]),o($Vs,[2,71]),o($Vs,[2,72]),o($Vs,[2,73]),o($Vs,[2,74]),o($Vs,[2,75]),o($Vs,[2,76]),o($VM,[2,41],{53:$VN,54:$VO,55:$VP}),o($Vs,[2,44]),o($Vs,[2,50]),{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:108,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:110,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:111,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{6:6,7:$V1,8:$V2,9:20,11:4,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:113,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:114,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:115,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{14:[1,116]},o($Vr,[2,7]),o($Vr,[2,8]),o($Vr,[2,9]),{16:[1,117]},o($Vr,[2,22]),{8:$V2,20:$V8,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:119,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,36:121,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{20:[1,122]},{8:$V2,9:123,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,87],{89:124,90:125,68:127,20:$VQ,82:$Vn}),{8:$V2,10:[1,128],20:$V8,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,81:129,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,89]),{8:$V2,9:130,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{20:[1,131]},{8:$V2,20:$V8,31:109,38:132,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,40:133,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,40:134,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,40:135,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{10:[1,136]},{10:[1,137],20:$VR,92:138},{10:[1,140],20:$VR,92:141},{8:$V2,20:$V8,31:109,44:142,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,44:143,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,44:144,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,44:145,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,79]),{83:[1,146],86:[1,147]},o($VS,[2,81]),{35:[1,148]},{35:[2,84]},{35:[2,85]},{35:[2,86]},o($Vs,[2,77]),{66:[1,149],86:$VT},o($VU,[2,98]),{8:$V2,20:$V8,31:109,49:151,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,49:152,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:153,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:154,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,31:109,50:$Vc,51:$Vd,52:155,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,51]),o([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],$Vt,{57:$Vu}),o($Vs,[2,52]),o($Vs,[2,53]),o([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,156]},{10:[1,157]},{16:[1,158]},{8:[1,159]},o($Vr,[2,10]),o($Vs,[2,25]),o($Vs,[2,49]),{35:[1,160]},o($Vx,[2,29],{39:$Vy}),o($Vs,[2,59]),{66:[1,161]},o([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,162]}),o($Vs,[2,94]),o($Vs,[2,96]),o($Vs,[2,97]),o($VV,[2,92]),{10:[1,163],86:$VT},{66:[1,164]},o($Vs,[2,91]),o($Vz,[2,31],{41:$VA,42:$VB,43:$VC}),o($VD,[2,33],{45:$VE,46:$VF,47:$VG,48:$VH}),o($VD,[2,34],{45:$VE,46:$VF,47:$VG,48:$VH}),o($VD,[2,35],{45:$VE,46:$VF,47:$VG,48:$VH}),o($Vs,[2,65]),{25:165,26:$Vb},{10:[1,166],86:$VW},o($VX,[2,104]),{94:[1,168]},{10:[1,169],86:$VW},o($VJ,[2,37],{50:$VK,51:$VL}),o($VJ,[2,38],{50:$VK,51:$VL}),o($VJ,[2,39],{50:$VK,51:$VL}),o($VJ,[2,40],{50:$VK,51:$VL}),o($Vs,[2,80]),{20:$VI,72:98,73:99,77:$Vj,78:$Vk,79:$Vl,80:$Vm,85:170,87:96},{8:$V2,20:$V8,29:171,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,78]),{8:$V2,20:$V8,29:172,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($VM,[2,42],{53:$VN,54:$VO,55:$VP}),o($VM,[2,43],{53:$VN,54:$VO,55:$VP}),o($Vs,[2,45]),o($Vs,[2,46]),o($Vs,[2,47]),{6:6,7:$V1,8:$V2,9:20,11:173,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{6:6,7:$V1,8:$V2,9:20,11:174,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:175,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:176,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,20:$V8,29:177,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vs,[2,60]),{20:$VQ,68:127,82:$Vn,90:178},o($VV,[2,93]),o($Vs,[2,90]),o($Vs,[2,100]),{25:179,26:$Vb},{20:[1,180]},{8:$V2,9:181,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{94:[1,182]},o($VS,[2,82]),o($VS,[2,83]),o($VU,[2,99]),o($Vq,[2,2],{12:[1,183]}),o($Vr,[2,4]),{16:[1,184]},{10:[1,185]},o($Vs,[2,27]),o($Vs,[2,95]),o($Vs,[2,101]),o($VX,[2,105]),o($Vs,[2,102]),{8:$V2,9:186,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{6:6,7:$V1,8:$V2,9:20,11:187,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{8:$V2,9:188,20:$V8,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},{16:[1,189]},o($Vs,[2,103]),o($Vr,[2,3]),{10:[1,190]},o($Vr,[2,6]),{6:6,7:$V1,8:$V2,9:20,11:191,13:7,14:$V3,15:$V4,16:$V5,17:$V6,18:8,19:$V7,20:$V8,21:$V9,22:9,23:$Va,24:11,25:5,26:$Vb,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:$Vc,51:$Vd,52:56,56:57,58:$Ve,59:26,60:27,61:29,62:30,63:31,65:$Vf,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:$Vg,75:$Vh,76:$Vi,77:$Vj,78:$Vk,79:$Vl,80:$Vm,82:$Vn,91:$Vo,93:$Vp},o($Vr,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(str,hash){if(!hash.recoverable){var error=new Error(str);throw error.hash=hash,error}this.trace(str)},parse:function(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1,args=lstack.slice.call(arguments,1),lexer=Object.create(this.lexer),sharedState={yy:{}};for(var k in this.yy)Object.prototype.hasOwnProperty.call(this.yy,k)&&(sharedState.yy[k]=this.yy[k]);lexer.setInput(input,sharedState.yy),sharedState.yy.lexer=lexer,sharedState.yy.parser=this,void 0===lexer.yylloc&&(lexer.yylloc={});var yyloc=lexer.yylloc;lstack.push(yyloc);var ranges=lexer.options&&lexer.options.ranges;"function"==typeof sharedState.yy.parseError?this.parseError=sharedState.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,lex=function(){var token;return"number"!=typeof(token=lexer.lex()||EOF)&&(token=self.symbols_[token]||token),token},yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:(null==symbol&&(symbol=lex()),action=table[state]&&table[state][symbol]),void 0===action||!action.length||!action[0]){var errStr="";for(p in expected=[],table[state])this.terminals_[p]&&p>TERROR&&expected.push("'"+this.terminals_[p]+"'");errStr=lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:lexer.match,token:this.terminals_[symbol]||symbol,line:lexer.yylineno,loc:yyloc,expected:expected})}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(lexer.yytext),lstack.push(lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=lexer.yyleng,yytext=lexer.yytext,yylineno=lexer.yylineno,yyloc=lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),void 0!==(r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,sharedState.yy,action[1],vstack,lstack].concat(args))))return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}},AST={node:function(type,value,children){return{type:type,value:value,children:children}},createNode:function(pos,type,value,children){var i,n=this.node(type,value,[]);for(i=3;i<arguments.length;i++)n.children.push(arguments[i]);return n.line=pos[0],n.col=pos[1],n.eline=pos[2],n.ecol=pos[3],n}},lc=function(lc1){return[lc1.first_line,lc1.first_column,lc1.last_line,lc1.last_column]},lexer=function(){var lexer={EOF:1,parseError:function(str,hash){if(!this.yy.parser)throw new Error(str);this.yy.parser.parseError(str,hash)},setInput:function(input,yy){return this.yy=yy||this.yy||{},this._input=input,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ch=this._input[0];return this.yytext+=ch,this.yyleng++,this.offset++,this.match+=ch,this.matched+=ch,ch.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ch},unput:function(ch){var len=ch.length,lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-len),this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),lines.length-1&&(this.yylineno-=lines.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-len]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;return next.length<20&&(next+=this._input.substr(0,20-next.length)),(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput(),c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},test_match:function(match,indexed_rule){var token,lines,backup;if(this.options.backtrack_lexer&&(backup={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(backup.yylloc.range=this.yylloc.range.slice(0))),(lines=match[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=lines.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length},this.yytext+=match[0],this.match+=match[0],this.matches=match,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(match[0].length),this.matched+=match[0],token=this.performAction.call(this,this.yy,this,indexed_rule,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),token)return token;if(this._backtrack){for(var k in backup)this[k]=backup[k];return!1}return!1},next:function(){if(this.done)return this.EOF;var token,match,tempMatch,index;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var rules=this._currentRules(),i=0;i<rules.length;i++)if((tempMatch=this._input.match(this.rules[rules[i]]))&&(!match||tempMatch[0].length>match[0].length)){if(match=tempMatch,index=i,this.options.backtrack_lexer){if(!1!==(token=this.test_match(tempMatch,rules[i])))return token;if(this._backtrack){match=!1;continue}return!1}if(!this.options.flex)break}return match?!1!==(token=this.test_match(match,rules[index]))&&token:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return r||this.lex()},begin:function(condition){this.conditionStack.push(condition)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(n){return(n=this.conditionStack.length-1-Math.abs(n||0))>=0?this.conditionStack[n]:"INITIAL"},pushState:function(condition){this.begin(condition)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(yy,yy_,$avoiding_name_collisions,YY_START){switch($avoiding_name_collisions){case 0:case 5:case 6:break;case 1:case 2:return 78;case 3:case 4:return 77;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:case 22:return 94;case 23:return 82;case 24:return 83;case 25:return 26;case 26:return 27;case 27:return 16;case 28:return"#";case 29:return 34;case 30:return 35;case 31:return 79;case 32:return 64;case 33:return 65;case 34:return 66;case 35:return 8;case 36:return 10;case 37:return 58;case 38:return 57;case 39:return 53;case 40:return 54;case 41:return 55;case 42:return 50;case 43:return 51;case 44:return 47;case 45:return 45;case 46:return 48;case 47:return 46;case 48:return 41;case 49:return 43;case 50:return 42;case 51:return 39;case 52:return 37;case 53:return 32;case 54:return 86;case 55:return 5;case 56:return 20;case 57:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:=>)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],inclusive:!0}}};return lexer}();function Parser(){this.yy={}}return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();return void 0!==require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(args){args[1]||(console.log("Usage: "+args[0]+" FILE"),process.exit(1));var source=require("fs").readFileSync(require("path").normalize(args[1]),"utf8");return exports.parser.parse(source)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode})),define("base/composition",["jxg","utils/type"],(function(JXG,Type){return JXG.Composition=function(elements){var e,that=this,genericMethods=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],generateMethod=function(what){return function(){var i;for(i in that.elements)that.elements.hasOwnProperty(i)&&Type.exists(that.elements[i][what])&&that.elements[i][what].apply(that.elements[i],arguments);return that}};for(e=0;e<genericMethods.length;e++)this[genericMethods[e]]=generateMethod(genericMethods[e]);for(e in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},elements)elements.hasOwnProperty(e)&&this.add(e,elements[e]);this.dump=!0,this.subs={}},JXG.extend(JXG.Composition.prototype,{add:function(what,element){return!(Type.exists(this[what])||!Type.exists(element))&&(Type.exists(element.id)?this.elements[element.id]=element:this.elements[what]=element,Type.exists(element.name)&&(this.elementsByName[element.name]=element),element.on("attribute:name",this.nameListener,this),this.objectsList.push(element),this[what]=element,this.methodMap[what]=element,!0)},remove:function(what){var e,found=!1;for(e in this.elements)if(this.elements.hasOwnProperty(e)&&this.elements[e].id===this[what].id){found=!0;break}return found&&(delete this.elements[this[what].id],delete this[what]),found},nameListener:function(oval,nval,el){delete this.elementsByName[oval],this.elementsByName[nval]=el},select:function(filter){return Type.exists(JXG.Board)?JXG.Board.prototype.select.call(this,filter):new JXG.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var e,attr={};for(e in this.subs)this.subs.hasOwnProperty(e)&&(attr[e]=this.subs[e].visProp);return this.attr}}),JXG.Composition})),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","utils/color","utils/type","utils/event","utils/env","base/composition"],(function(JXG,Const,Coords,Options,Numerics,Mat,Geometry,Complex,Statistics,JessieCode,Color,Type,EventEmitter,Env,Composition){return JXG.Board=function(container,renderer,id,origin,zoomX,zoomY,unitX,unitY,canvasWidth,canvasHeight,attributes){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_MODE_ZOOM=17,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,Type.exists(attributes.document)&&!1!==attributes.document?this.document=attributes.document:void 0!==document&&Type.isObject(document)&&(this.document=document),this.container=container,this.containerObj=Env.isBrowser?this.document.getElementById(this.container):null,Env.isBrowser&&"no"!==renderer.type&&null===this.containerObj)throw new Error("\nJSXGraph: HTML container element '"+container+"' not found.");this.renderer=renderer,this.grids=[],this.options=Type.deepCopy(Options),this.attr=attributes,this.dimension=2,this.jc=new JessieCode,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,origin[0],origin[1]],this.zoomX=zoomX,this.zoomY=zoomY,this.unitX=unitX*this.zoomX,this.unitY=unitY*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=canvasWidth,this.canvasHeight=canvasHeight,Type.exists(id)&&""!==id&&Env.isBrowser&&!Type.exists(this.document.getElementById(id))?this.id=id:this.id=this.generateId(),EventEmitter.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.touchMoveLastId=1/0,this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(Const.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._inputDevice="mouse",this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this._isScrolling=!1,this._isResizing=!1,this.selectingBox=[[0,0],[0,0]],this.mathLib=Math,this.mathLibJXG=JXG.Math,this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},JXG.extend(JXG.Board.prototype,{generateName:function(object){var possibleNames,i,maxNameLength=this.attr.maxnamelength,pre="",post="",indices=[],name="";if(object.type===Const.OBJECT_TYPE_TICKS)return"";for(possibleNames=Type.isPoint(object)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:object.type===Const.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Type.isPoint(object)||object.elementClass===Const.OBJECT_CLASS_LINE||object.type===Const.OBJECT_TYPE_ANGLE||(pre=object.type===Const.OBJECT_TYPE_POLYGON?"P_{":object.elementClass===Const.OBJECT_CLASS_CIRCLE?"k_{":object.elementClass===Const.OBJECT_CLASS_TEXT?"t_{":"s_{",post="}"),i=0;i<maxNameLength;i++)indices[i]=0;for(;indices[maxNameLength-1]<possibleNames.length;){for(indices[0]=1;indices[0]<possibleNames.length;indices[0]++){for(name=pre,i=maxNameLength;i>0;i--)name+=possibleNames[indices[i-1]];if(!Type.exists(this.elementsByName[name+post]))return name+post}for(indices[0]=possibleNames.length,i=1;i<maxNameLength;i++)indices[i-1]===possibleNames.length&&(indices[i-1]=1,indices[i]+=1)}return""},generateId:function(){for(var r=1;Type.exists(JXG.boards["jxgBoard"+r]);)r=Math.round(65535*Math.random());return"jxgBoard"+r},setId:function(obj,type){var randomNumber,num=this.numObjects,elId=obj.id;if(this.numObjects+=1,""===elId||!Type.exists(elId))for(elId=this.id+type+num;Type.exists(this.objects[elId]);)randomNumber=Math.round(65535*Math.random()),elId=this.id+type+num+"-"+randomNumber;return obj.id=elId,this.objects[elId]=obj,obj._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=obj,elId},finalizeAdding:function(obj){!1===Type.evaluate(obj.visProp.visible)&&this.renderer.display(obj,!1)},finalizeLabel:function(obj){obj.hasLabel&&!Type.evaluate(obj.label.visProp.islabel)&&!1===Type.evaluate(obj.label.visProp.visible)&&this.renderer.display(obj.label,!1)},checkFrameRate:function(evt){var handleEvt=!1,time=(new Date).getTime();return Type.exists(evt.pointerId)&&this.touchMoveLastId!==evt.pointerId&&(handleEvt=!0,this.touchMoveLastId=evt.pointerId),!handleEvt&&(time-this.touchMoveLast)*this.attr.maxframerate>=1e3&&(handleEvt=!0),handleEvt&&(this.touchMoveLast=time),handleEvt},getCoordsTopLeftCorner:function(){var cPos,doc,crect,zoom,o,ownerDoc=this.document.ownerDocument||this.document,docElement=ownerDoc.documentElement||this.document.body.parentNode,docBody=ownerDoc.body,container=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||(new Date).getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=(new Date).getTime(),container.getBoundingClientRect){for(crect=container.getBoundingClientRect(),zoom=1,o=container;o&&Type.exists(o.parentNode);)Type.exists(o.style)&&Type.exists(o.style.zoom)&&""!==o.style.zoom&&(zoom*=parseFloat(o.style.zoom)),o=o.parentNode;return(cPos=[crect.left*zoom,crect.top*zoom])[0]+=Env.getProp(container,"border-left-width"),cPos[1]+=Env.getProp(container,"border-top-width"),"vml"!==this.renderer.type&&(cPos[0]+=Env.getProp(container,"padding-left"),cPos[1]+=Env.getProp(container,"padding-top")),this.cPos=cPos.slice(),this.cPos}return cPos=Env.getOffset(container),doc=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&doc.defaultView&&(cPos[0]+=Env.getProp(docElement,"margin-left"),cPos[1]+=Env.getProp(docElement,"margin-top"),cPos[0]+=Env.getProp(docElement,"border-left-width"),cPos[1]+=Env.getProp(docElement,"border-top-width"),cPos[0]+=Env.getProp(docElement,"padding-left"),cPos[1]+=Env.getProp(docElement,"padding-top")),docBody&&(cPos[0]+=Env.getProp(docBody,"left"),cPos[1]+=Env.getProp(docBody,"top")),"object"===("undefined"==typeof google?"undefined":_typeof(google))&&google.translate&&(cPos[0]+=10,cPos[1]+=25),cPos[0]+=Env.getProp(container,"border-left-width"),cPos[1]+=Env.getProp(container,"border-top-width"),"vml"!==this.renderer.type&&(cPos[0]+=Env.getProp(container,"padding-left"),cPos[1]+=Env.getProp(container,"padding-top")),cPos[0]+=this.attr.offsetx,cPos[1]+=this.attr.offsety,this.cPos=cPos.slice(),this.cPos},getMousePosition:function(e,i){var absPos,v,cPos=this.getCoordsTopLeftCorner();return absPos=Env.getPosition(e,i,this.document),Type.exists(this.cssTransMat)||this.updateCSSTransforms(),v=[1,absPos[0]-cPos[0],absPos[1]-cPos[1]],(v=Mat.matVecMult(this.cssTransMat,v))[1]/=v[0],v[2]/=v[0],[v[1],v[2]]},initMoveOrigin:function(x,y){this.drag_dx=x-this.origin.scrCoords[1],this.drag_dy=y-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(x,y,evt,type){var pEl,el,haspoint,collect=[],offset=[],len=this.objectsList.length,dragEl={visProp:{layer:-1e4}};for(el=0;el<len;el++)haspoint=(pEl=this.objectsList[el]).hasPoint&&pEl.hasPoint(x,y),pEl.visPropCalc.visible&&haspoint&&(pEl.triggerEventHandlers([type+"down","down"],[evt]),this.downObjects.push(pEl)),haspoint&&pEl.isDraggable&&pEl.visPropCalc.visible&&(this.geonextCompatibilityMode&&(Type.isPoint(pEl)||pEl.elementClass===Const.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!Type.evaluate(pEl.visProp.fixed)&&(pEl.visProp.layer>dragEl.visProp.layer||pEl.visProp.layer===dragEl.visProp.layer&&pEl.lastDragTime.getTime()>=dragEl.lastDragTime.getTime())&&(this.attr.ignorelabels&&Type.exists(dragEl.label)&&pEl===dragEl.label||(dragEl=pEl,collect.push(dragEl),Type.exists(dragEl.coords)?offset.push(Statistics.subtract(dragEl.coords.scrCoords.slice(1),[x,y])):offset.push([0,0])));return this.attr.drag.enabled&&collect.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(collect.length=1,this._drag_offset=offset[0]):(collect=collect.slice(-1),this._drag_offset=offset[offset.length-1]),this._drag_offset||(this._drag_offset=[0,0]),"svg"===this.renderer.type&&Type.exists(collect[0])&&Type.evaluate(collect[0].visProp.dragtotopoflayer)&&1===collect.length&&Type.exists(collect[0].rendNode)&&collect[0].rendNode.parentNode.appendChild(collect[0].rendNode),this.previousRotation=0,this.previousScale=1,collect.length>=1&&(collect[0].highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[evt,collect[0]])),collect},moveObject:function(x,y,o,evt,type){var drag,dragScrCoords,newDragScrCoords,newPos=new Coords(Const.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(x,y),this);o&&o.obj&&((drag=o.obj).coords&&(dragScrCoords=drag.coords.scrCoords.slice()),this.drag_position=[newPos.scrCoords[1],newPos.scrCoords[2]],this.drag_position=Statistics.add(this.drag_position,this._drag_offset),Type.exists(drag.coords)?drag.setPositionDirectly(Const.COORDS_BY_SCREEN,this.drag_position):(this.displayInfobox(!1),isNaN(o.targets[0].Xprev+o.targets[0].Yprev)||drag.setPositionDirectly(Const.COORDS_BY_SCREEN,[newPos.scrCoords[1],newPos.scrCoords[2]],[o.targets[0].Xprev,o.targets[0].Yprev]),o.targets[0].Xprev=newPos.scrCoords[1],o.targets[0].Yprev=newPos.scrCoords[2]),Type.exists(drag.coords)&&(drag.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(drag),drag.prepareUpdate().update(!0).updateRenderer()),drag.coords&&(newDragScrCoords=drag.coords.scrCoords),drag.coords&&dragScrCoords[1]===newDragScrCoords[1]&&dragScrCoords[2]===newDragScrCoords[2]||(drag.triggerEventHandlers([type+"drag","drag"],[evt]),this.update()),drag.highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[evt,drag]),drag.lastDragTime=new Date)},twoFingerMove:function(o,id,evt){var drag;Type.exists(o)&&Type.exists(o.obj)&&((drag=o.obj).elementClass===Const.OBJECT_CLASS_LINE||drag.type===Const.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(o.targets,drag,id):drag.elementClass===Const.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(o.targets,drag,id),evt&&drag.triggerEventHandlers(["touchdrag","drag"],[evt]))},twoFingerTouchObject:function(tar,drag,id){var np,op,nd,od,d,alpha,S,t1,t3,t4,t5,ar,i,len,fixEl,moveEl,fix;if(Type.exists(tar[0])&&Type.exists(tar[1])&&!isNaN(tar[0].Xprev+tar[0].Yprev+tar[1].Xprev+tar[1].Yprev)){if(id===tar[0].num?(fixEl=tar[1],moveEl=tar[0]):(fixEl=tar[0],moveEl=tar[1]),fix=new Coords(Const.COORDS_BY_SCREEN,[fixEl.Xprev,fixEl.Yprev],this).usrCoords,op=new Coords(Const.COORDS_BY_SCREEN,[moveEl.Xprev,moveEl.Yprev],this).usrCoords,np=new Coords(Const.COORDS_BY_SCREEN,[moveEl.X,moveEl.Y],this).usrCoords,od=Mat.crossProduct(fix,op),nd=Mat.crossProduct(fix,np),S=Mat.crossProduct(od,nd),Math.abs(S[0])<Mat.eps)return;if(alpha=Geometry.rad(op.slice(1),fix.slice(1),np.slice(1)),(t1=this.create("transform",[alpha,[fix[1],fix[2]]],{type:"rotate"})).update(),Type.evaluate(drag.visProp.scalable)&&(d=Geometry.distance(np,fix)/Geometry.distance(op,fix),t3=this.create("transform",[-fix[1],-fix[2]],{type:"translate"}),t4=this.create("transform",[d,d],{type:"scale"}),t5=this.create("transform",[fix[1],fix[2]],{type:"translate"}),t1.melt(t3).melt(t4).melt(t5)),drag.elementClass===Const.OBJECT_CLASS_LINE)ar=[],drag.point1.draggable()&&ar.push(drag.point1),drag.point2.draggable()&&ar.push(drag.point2),t1.applyOnce(ar);else if(drag.type===Const.OBJECT_TYPE_POLYGON){for(ar=[],len=drag.vertices.length-1,i=0;i<len;++i)drag.vertices[i].draggable()&&ar.push(drag.vertices[i]);t1.applyOnce(ar)}this.update(),drag.highlight(!0)}},twoFingerTouchCircle:function(tar,drag,id){var fixEl,moveEl,np,op,fix,d,alpha,t1,t2,t3,t4;"pointCircle"!==drag.method&&"pointLine"!==drag.method&&Type.exists(tar[0])&&Type.exists(tar[1])&&!isNaN(tar[0].Xprev+tar[0].Yprev+tar[1].Xprev+tar[1].Yprev)&&(id===tar[0].num?(fixEl=tar[1],moveEl=tar[0]):(fixEl=tar[0],moveEl=tar[1]),fix=new Coords(Const.COORDS_BY_SCREEN,[fixEl.Xprev,fixEl.Yprev],this).usrCoords,op=new Coords(Const.COORDS_BY_SCREEN,[moveEl.Xprev,moveEl.Yprev],this).usrCoords,np=new Coords(Const.COORDS_BY_SCREEN,[moveEl.X,moveEl.Y],this).usrCoords,alpha=Geometry.rad(op.slice(1),fix.slice(1),np.slice(1)),t1=this.create("transform",[-fix[1],-fix[2]],{type:"translate"}),t2=this.create("transform",[alpha],{type:"rotate"}),t1.melt(t2),Type.evaluate(drag.visProp.scalable)&&(d=Geometry.distance(fix,np)/Geometry.distance(fix,op),t3=this.create("transform",[d,d],{type:"scale"}),t1.melt(t3)),t4=this.create("transform",[fix[1],fix[2]],{type:"translate"}),t1.melt(t4),drag.center.draggable()&&t1.applyOnce([drag.center]),"twoPoints"===drag.method?drag.point2.draggable()&&t1.applyOnce([drag.point2]):"pointRadius"===drag.method&&Type.isNumber(drag.updateRadius.origin)&&drag.setRadius(drag.radius*d),this.update(drag.center),drag.highlight(!0))},highlightElements:function(x,y,evt,target){var el,pEl,pId,overObjects={},len=this.objectsList.length;for(el=0;el<len;el++)pId=(pEl=this.objectsList[el]).id,Type.exists(pEl.hasPoint)&&pEl.visPropCalc.visible&&pEl.hasPoint(x,y)&&(this.updateInfobox(pEl),Type.exists(this.highlightedObjects[pId])||(overObjects[pId]=pEl,pEl.highlight(),this.triggerEventHandlers(["mousehit","hit"],[evt,pEl,target])),pEl.mouseover?pEl.triggerEventHandlers(["mousemove","move"],[evt]):(pEl.triggerEventHandlers(["mouseover","over"],[evt]),pEl.mouseover=!0));for(el=0;el<len;el++)pId=(pEl=this.objectsList[el]).id,pEl.mouseover&&(overObjects[pId]||(pEl.triggerEventHandlers(["mouseout","out"],[evt]),pEl.mouseover=!1))},saveStartPos:function(obj,targets){var i,len,xy=[];if(obj.type===Const.OBJECT_TYPE_TICKS)xy.push([1,NaN,NaN]);else if(obj.elementClass===Const.OBJECT_CLASS_LINE)xy.push(obj.point1.coords.usrCoords),xy.push(obj.point2.coords.usrCoords);else if(obj.elementClass===Const.OBJECT_CLASS_CIRCLE)xy.push(obj.center.coords.usrCoords),"twoPoints"===obj.method&&xy.push(obj.point2.coords.usrCoords);else if(obj.type===Const.OBJECT_TYPE_POLYGON)for(len=obj.vertices.length-1,i=0;i<len;i++)xy.push(obj.vertices[i].coords.usrCoords);else if(obj.type===Const.OBJECT_TYPE_SECTOR)xy.push(obj.point1.coords.usrCoords),xy.push(obj.point2.coords.usrCoords),xy.push(obj.point3.coords.usrCoords);else if(Type.isPoint(obj)||obj.type===Const.OBJECT_TYPE_GLIDER)xy.push(obj.coords.usrCoords);else if(obj.elementClass===Const.OBJECT_CLASS_CURVE)obj.points.length>0&&xy.push(obj.points[0].usrCoords);else try{xy.push(obj.coords.usrCoords)}catch(e){JXG.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+e)}for(len=xy.length,i=0;i<len;i++)targets.Zstart.push(xy[i][0]),targets.Xstart.push(xy[i][1]),targets.Ystart.push(xy[i][2])},mouseOriginMoveStart:function(evt){var r,pos;return(r=this._isRequiredKeyPressed(evt,"pan"))&&(pos=this.getMousePosition(evt),this.initMoveOrigin(pos[0],pos[1])),r},mouseOriginMove:function(evt){var pos,r=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return r&&(pos=this.getMousePosition(evt),this.moveOrigin(pos[0],pos[1],!0)),r},touchStartMoveOriginOneFinger:function(evt){var conditions,pos,touches=evt[JXG.touchProperty];return(conditions=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&1===touches.length)&&(pos=this.getMousePosition(evt,0),this.initMoveOrigin(pos[0],pos[1])),conditions},touchOriginMove:function(evt){var pos,r=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return r&&(pos=this.getMousePosition(evt,0),this.moveOrigin(pos[0],pos[1],!0)),r},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){if(Env.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),null!==this.containerObj&&(this.containerObj.oncontextmenu=function(e){return Type.exists(e)&&e.preventDefault(),!1}),this.addFullscreenEventHandlers(),this.addKeyboardEventHandlers(),Env.isBrowser){try{this.startResizeObserver()}catch(err){Env.addEvent(window,"resize",this.resizeListener,this),this.startIntersectionObserver()}Env.addEvent(window,"scroll",this.scrollListener,this)}},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers(),this.removeFullscreenEventHandlers(),this.removeKeyboardEventHandlers(),Env.isBrowser&&(Type.exists(this.resizeObserver)?this.stopResizeObserver():(Env.removeEvent(window,"resize",this.resizeListener,this),this.stopIntersectionObserver()),Env.removeEvent(window,"scroll",this.scrollListener,this))},addPointerEventHandlers:function(){if(!this.hasPointerHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(Env.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),Env.addEvent(moveTarget,"MSPointerMove",this.pointerMoveListener,this)):(Env.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),Env.addEvent(moveTarget,"pointermove",this.pointerMoveListener,this)),Env.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),Env.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),null!==this.containerObj&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0}},addMouseEventHandlers:function(){if(!this.hasMouseHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;Env.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),Env.addEvent(moveTarget,"mousemove",this.mouseMoveListener,this),Env.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),Env.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0}},addTouchEventHandlers:function(appleGestures){if(!this.hasTouchHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;Env.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),Env.addEvent(moveTarget,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0}},addFullscreenEventHandlers:function(){var i,events=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],le=events.length;if(!this.hasFullsceenEventHandlers&&Env.isBrowser){for(i=0;i<le;i++)Env.addEvent(this.document,events[i],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!0}},addKeyboardEventHandlers:function(){this.attr.keyboard.enabled&&!this.hasKeyboardHandlers&&Env.isBrowser&&(Env.addEvent(this.containerObj,"keydown",this.keyDownListener,this),Env.addEvent(this.containerObj,"focusin",this.keyFocusInListener,this),Env.addEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!0)},removeKeyboardEventHandlers:function(){this.hasKeyboardHandlers&&Env.isBrowser&&(Env.removeEvent(this.containerObj,"keydown",this.keyDownListener,this),Env.removeEvent(this.containerObj,"focusin",this.keyFocusInListener,this),Env.removeEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!1)},removeFullscreenEventHandlers:function(){var i,events=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],le=events.length;if(this.hasFullsceenEventHandlers&&Env.isBrowser){for(i=0;i<le;i++)Env.removeEvent(this.document,events[i],this.fullscreenListener,this);this.hasFullsceenEventHandlers=!1}},removePointerEventHandlers:function(){if(this.hasPointerHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(Env.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),Env.removeEvent(moveTarget,"MSPointerMove",this.pointerMoveListener,this)):(Env.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),Env.removeEvent(moveTarget,"pointermove",this.pointerMoveListener,this)),Env.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),Env.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?Env.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(Env.removeEvent(this.document,"pointerup",this.pointerUpListener,this),Env.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this.hasPointerHandlers=!1}},removeMouseEventHandlers:function(){if(this.hasMouseHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;Env.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),Env.removeEvent(moveTarget,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(Env.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),Env.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),Env.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1}},removeTouchEventHandlers:function(){if(this.hasTouchHandlers&&Env.isBrowser){var moveTarget=this.attr.movetarget||this.containerObj;Env.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),Env.removeEvent(moveTarget,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(Env.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1}},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(evt){var c,dir1,dir2,angle,factor,dist,dx,dy,theta,cx,cy,bound,isPinch=!1,zx=this.attr.zoom.factorx,zy=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(evt.preventDefault(),dist=Geometry.distance([evt.touches[0].clientX,evt.touches[0].clientY],[evt.touches[1].clientX,evt.touches[1].clientY],2),void 0===evt.scale&&(evt.scale=dist/this.prevDist),!!Type.exists(this.prevCoords)&&(dir1=[evt.touches[0].clientX-this.prevCoords[0][0],evt.touches[0].clientY-this.prevCoords[0][1]],dir2=[evt.touches[1].clientX-this.prevCoords[1][0],evt.touches[1].clientY-this.prevCoords[1][1]],dir1[0]*dir1[0]+dir1[1]*dir1[1]<100&&dir2[0]*dir2[0]+dir2[1]*dir2[1]<100||(angle=Geometry.rad(dir1,[0,0],dir2),"pan"!==this.isPreviousGesture&&Math.abs(angle)>.2*Math.PI&&Math.abs(angle)<1.8*Math.PI&&(isPinch=!0),"pan"===this.isPreviousGesture||isPinch||(Math.abs(evt.scale)<.77||Math.abs(evt.scale)>1.3)&&(isPinch=!0),factor=evt.scale/this.prevScale,this.prevScale=evt.scale,this.prevCoords=[[evt.touches[0].clientX,evt.touches[0].clientY],[evt.touches[1].clientX,evt.touches[1].clientY]],c=new Coords(Const.COORDS_BY_SCREEN,this.getMousePosition(evt,0),this),this.attr.pan.enabled&&this.attr.pan.needtwofingers&&!isPinch?(this.isPreviousGesture="pan",this.moveOrigin(c.scrCoords[1],c.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(factor-1)<.5&&((this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(dx=Math.abs(evt.touches[0].clientX-evt.touches[1].clientX),dy=Math.abs(evt.touches[0].clientY-evt.touches[1].clientY),theta=Math.abs(Math.atan2(dy,dx)),bound=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&theta<bound?(this.attr.zoom.factorx=factor,this.attr.zoom.factory=1,cx=0,cy=0):this.attr.zoom.pinchvertical&&Math.abs(theta-.5*Math.PI)<bound?(this.attr.zoom.factorx=1,this.attr.zoom.factory=factor,cx=0,cy=0):(this.attr.zoom.factorx=factor,this.attr.zoom.factory=factor,cx=c.usrCoords[1],cy=c.usrCoords[2]),this.zoomIn(cx,cy),this.attr.zoom.factorx=zx,this.attr.zoom.factory=zy)),!1))},gestureStartListener:function(evt){var pos;return evt.preventDefault(),this.prevScale=1,this.prevDist=Geometry.distance([evt.touches[0].clientX,evt.touches[0].clientY],[evt.touches[1].clientX,evt.touches[1].clientY],2),this.prevCoords=[[evt.touches[0].clientX,evt.touches[0].clientY],[evt.touches[1].clientX,evt.touches[1].clientY]],this.isPreviousGesture="none",pos=this.getMousePosition(evt,0),this.initMoveOrigin(pos[0],pos[1]),this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(evt,action){var obj=this.attr[action];return!!obj.enabled&&!(!(obj.needshift&&evt.shiftKey||!obj.needshift&&!evt.shiftKey)||!(obj.needctrl&&evt.ctrlKey||!obj.needctrl&&!evt.ctrlKey))},_isPointerRegistered:function(evt){var i,len=this._board_touches.length;for(i=0;i<len;i++)if(this._board_touches[i].pointerId===evt.pointerId)return!0;return!1},_pointerStorePosition:function(evt){var i,found;for(i=0,found=!1;i<this._board_touches.length;i++)if(this._board_touches[i].pointerId===evt.pointerId){this._board_touches[i].clientX=evt.clientX,this._board_touches[i].clientY=evt.clientY,found=!0;break}return!found&&this._board_touches.length<2&&this._board_touches.push({pointerId:evt.pointerId,clientX:evt.clientX,clientY:evt.clientY}),this},_pointerRemoveTouches:function(evt){var i;for(i=0;i<this._board_touches.length;i++)if(this._board_touches[i].pointerId===evt.pointerId){this._board_touches.splice(i,1);break}return this},_pointerClearTouches:function(){this._board_touches.length>0&&this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this._board_touches=[],this.touches=[]},_getPointerInputDevice:function(evt){if(Env.isBrowser){if("touch"===evt.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)return"touch";if("mouse"===evt.pointerType)return"mouse";if("pen"===evt.pointerType)return"pen"}return"mouse"},pointerDownListener:function(evt,object){var i,j,k,pos,elements,sel,target_obj,type,found,target;if(!object&&this._isPointerRegistered(evt))return!1;if(!object&&evt.isPrimary&&this._pointerClearTouches(),this.hasPointerUp||(window.navigator.msPointerEnabled?Env.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(Env.addEvent(this.document,"pointerup",this.pointerUpListener,this),Env.addEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&Type.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(sel=window.getSelection()).removeAllRanges)try{sel.removeAllRanges()}catch(e){}if(this._inputDevice=this._getPointerInputDevice(evt),type=this._inputDevice,this.options.precision.hasPoint=this.options.precision[type],pos=this.getMousePosition(evt),this._testForSelection(evt),this.selectingMode)return this._startSelecting(pos),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[evt]);if(this.attr.drag.enabled&&object?(elements=[object],this.mode=this.BOARD_MODE_DRAG):elements=this.initMoveObject(pos[0],pos[1],evt,type),target_obj={num:evt.pointerId,X:pos[0],Y:pos[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},elements.length>0){for(target=elements[elements.length-1],found=!1,i=0;i<this.touches.length;i++)if(this.touches[i].obj===target){j=i,k=this.touches[i].targets.push(target_obj)-1,found=!0;break}found||(k=0,j=this.touches.push({obj:target,targets:[target_obj]})-1),this.dehighlightAll(),target.highlight(!0),this.saveStartPos(target,this.touches[j].targets[k]),evt&&evt.preventDefault?evt.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(evt.preventDefault(),evt.stopPropagation()),!!Env.isBrowser&&("touch"!==this._getPointerInputDevice(evt)?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(evt):(this._pointerStorePosition(evt),evt.touches=this._board_touches,1===evt.touches.length&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(evt)||2!==evt.touches.length||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(evt))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[evt]),!1)},pointerMoveListener:function(evt){var i,j,pos,touchTargets,type;if("touch"===this._getPointerInputDevice(evt)&&!this._isPointerRegistered(evt))return this.BOARD_MODE_NONE;if(!this.checkFrameRate(evt))return!1;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(evt.preventDefault(),evt.stopPropagation()),this.updateQuality=this.BOARD_QUALITY_LOW,this._inputDevice=this._getPointerInputDevice(evt),type=this._inputDevice,this.options.precision.hasPoint=this.options.precision[type],this.selectingMode)pos=this.getMousePosition(evt),this._moveSelecting(pos),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[evt,this.mode]);else if(!this.mouseOriginMove(evt))if(this.mode===this.BOARD_MODE_DRAG){for(i=0;i<this.touches.length;i++)for(touchTargets=this.touches[i].targets,j=0;j<touchTargets.length;j++)if(touchTargets[j].num===evt.pointerId){pos=this.getMousePosition(evt),touchTargets[j].X=pos[0],touchTargets[j].Y=pos[1],1===touchTargets.length?this.moveObject(pos[0],pos[1],this.touches[i],evt,type):2===touchTargets.length&&(this.twoFingerMove(this.touches[i],evt.pointerId,evt),touchTargets[j].Xprev=pos[0],touchTargets[j].Yprev=pos[1]);break}}else"touch"===this._getPointerInputDevice(evt)&&(this._pointerStorePosition(evt),2===this._board_touches.length&&(evt.touches=this._board_touches,this.gestureChangeListener(evt))),pos=this.getMousePosition(evt),this.highlightElements(pos[0],pos[1],evt,-1);return this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[evt,this.mode]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(evt){var i,j,found,touchTargets;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[evt]),this.displayInfobox(!1),evt)for(i=0;i<this.touches.length;i++)for(touchTargets=this.touches[i].targets,j=0;j<touchTargets.length;j++)if(touchTargets[j].num===evt.pointerId){touchTargets.splice(j,1),0===touchTargets.length&&this.touches.splice(i,1);break}if(this.originMoveEnd(),this.update(),this.selectingMode)this._stopSelecting(evt),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[evt]),this.stopSelectionMode();else for(i=this.downObjects.length-1;i>-1;i--){for(found=!1,j=0;j<this.touches.length;j++)this.touches[j].obj.id===this.downObjects[i].id&&(found=!0);found||(this.downObjects[i].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[evt]),this.downObjects.splice(i,1))}return this.hasPointerUp&&(window.navigator.msPointerEnabled?Env.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(Env.removeEvent(this.document,"pointerup",this.pointerUpListener,this),Env.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this._pointerClearTouches(),!0},touchStartListener:function(evt){var i,pos,elements,j,k,obj,found,targets,target,touchTargets,eps=this.options.precision.touch,evtTouches=evt[JXG.touchProperty];for(this.hasTouchEnd||(Env.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&Type.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,i=0;i<evtTouches.length;i++)evtTouches[i].jxg_isused=!1;for(i=0;i<this.touches.length;i++)for(touchTargets=this.touches[i].targets,j=0;j<touchTargets.length;j++){touchTargets[j].num=-1,eps=this.options.precision.touch;do{for(k=0;k<evtTouches.length;k++)if(Math.abs(Math.pow(evtTouches[k].screenX-touchTargets[j].X,2)+Math.pow(evtTouches[k].screenY-touchTargets[j].Y,2))<eps*eps){touchTargets[j].num=k,touchTargets[j].X=evtTouches[k].screenX,touchTargets[j].Y=evtTouches[k].screenY,evtTouches[k].jxg_isused=!0;break}eps*=2}while(-1===touchTargets[j].num&&eps<this.options.precision.touchMax);-1===touchTargets[j].num&&(JXG.debug("i couldn't find a targettouches for target no "+j+" on "+this.touches[i].obj.name+" ("+this.touches[i].obj.id+"). Removed the target."),JXG.debug("eps = "+eps+", touchMax = "+Options.precision.touchMax),touchTargets.splice(i,1))}for(i=0;i<evtTouches.length;i++)if(!evtTouches[i].jxg_isused){if(pos=this.getMousePosition(evt,i),this.selectingMode)return this._startSelecting(pos),this.triggerEventHandlers(["touchstartselecting","startselecting"],[evt]),evt.preventDefault(),evt.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(0!==(elements=this.initMoveObject(pos[0],pos[1],evt,"touch")).length)if(obj=elements[elements.length-1],target={num:i,X:evtTouches[i].screenX,Y:evtTouches[i].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},Type.isPoint(obj)||obj.elementClass===Const.OBJECT_CLASS_TEXT||obj.type===Const.OBJECT_TYPE_TICKS||obj.type===Const.OBJECT_TYPE_IMAGE)targets=[target],this.saveStartPos(obj,targets[0]),this.touches.push({obj:obj,targets:targets}),obj.highlight(!0);else if(obj.elementClass===Const.OBJECT_CLASS_LINE||obj.elementClass===Const.OBJECT_CLASS_CIRCLE||obj.elementClass===Const.OBJECT_CLASS_CURVE||obj.type===Const.OBJECT_TYPE_POLYGON){for(found=!1,j=0;j<this.touches.length;j++)obj.id===this.touches[j].obj.id&&(found=!0,1===this.touches[j].targets.length&&(this.saveStartPos(obj,target),this.touches[j].targets.push(target)),evtTouches[i].jxg_isused=!0);found||(targets=[target],this.saveStartPos(obj,targets[0]),this.touches.push({obj:obj,targets:targets}),obj.highlight(!0))}evtTouches[i].jxg_isused=!0}return this.touches.length>0&&(evt.preventDefault(),evt.stopPropagation()),1===evtTouches.length&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(evt)||2!==evtTouches.length||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(evt)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[evt]),!1},touchMoveListener:function(evt){var i,pos1,pos2,touchTargets,evtTouches=evt[JXG.touchProperty];if(!this.checkFrameRate(evt))return!1;if(this.mode!==this.BOARD_MODE_NONE&&(evt.preventDefault(),evt.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(i=0;i<evtTouches.length;i++)if(!evtTouches[i].jxg_isused){pos1=this.getMousePosition(evt,i),this._moveSelecting(pos1),this.triggerEventHandlers(["touchmoves","moveselecting"],[evt,this.mode]);break}}else if(!this.touchOriginMove(evt))if(this.mode===this.BOARD_MODE_DRAG){for(i=0;i<this.touches.length;i++)if(1===(touchTargets=this.touches[i].targets).length){if(evtTouches[touchTargets[0].num]){if((pos1=this.getMousePosition(evt,touchTargets[0].num))[0]<0||pos1[0]>this.canvasWidth||pos1[1]<0||pos1[1]>this.canvasHeight)return;touchTargets[0].X=pos1[0],touchTargets[0].Y=pos1[1],this.moveObject(pos1[0],pos1[1],this.touches[i],evt,"touch")}}else if(2===touchTargets.length&&touchTargets[0].num>-1&&touchTargets[1].num>-1&&evtTouches[touchTargets[0].num]&&evtTouches[touchTargets[1].num]){if(pos1=this.getMousePosition(evt,touchTargets[0].num),pos2=this.getMousePosition(evt,touchTargets[1].num),pos1[0]<0||pos1[0]>this.canvasWidth||pos1[1]<0||pos1[1]>this.canvasHeight||pos2[0]<0||pos2[0]>this.canvasWidth||pos2[1]<0||pos2[1]>this.canvasHeight)return;touchTargets[0].X=pos1[0],touchTargets[0].Y=pos1[1],touchTargets[1].X=pos2[0],touchTargets[1].Y=pos2[1],this.twoFingerMove(this.touches[i],touchTargets[0].num,evt),this.twoFingerMove(this.touches[i],touchTargets[1].num),touchTargets[0].Xprev=pos1[0],touchTargets[0].Yprev=pos1[1],touchTargets[1].Xprev=pos2[0],touchTargets[1].Yprev=pos2[1]}}else 2===evtTouches.length&&this.gestureChangeListener(evt),pos1=this.getMousePosition(evt,0),this.highlightElements(pos1[0],pos1[1],evt,-1);return this.mode!==this.BOARD_MODE_DRAG&&this.displayInfobox(!1),this.triggerEventHandlers(["touchmove","move"],[evt,this.mode]),this.options.precision.hasPoint=this.options.precision.mouse,this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},touchEndListener:function(evt){var i,j,k,found,foundNumber,touchTargets,eps=this.options.precision.touch,tmpTouches=[],evtTouches=evt&&evt[JXG.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[evt]),this.displayInfobox(!1),this.selectingMode)this._stopSelecting(evt),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[evt]),this.stopSelectionMode();else if(evtTouches&&evtTouches.length>0){for(i=0;i<this.touches.length;i++)tmpTouches[i]=this.touches[i];for(this.touches.length=0,i=0;i<evtTouches.length;i++)evtTouches[i].jxg_isused=!1;for(i=0;i<tmpTouches.length;i++){for(found=!1,foundNumber=0,touchTargets=tmpTouches[i].targets,j=0;j<touchTargets.length;j++)for(touchTargets[j].found=!1,k=0;k<evtTouches.length;k++)if(Math.abs(Math.pow(evtTouches[k].screenX-touchTargets[j].X,2)+Math.pow(evtTouches[k].screenY-touchTargets[j].Y,2))<eps*eps){touchTargets[j].found=!0,touchTargets[j].num=k,touchTargets[j].X=evtTouches[k].screenX,touchTargets[j].Y=evtTouches[k].screenY,foundNumber+=1;break}if(Type.isPoint(tmpTouches[i].obj)?found=touchTargets[0]&&touchTargets[0].found:tmpTouches[i].obj.elementClass===Const.OBJECT_CLASS_LINE?found=touchTargets[0]&&touchTargets[0].found||touchTargets[1]&&touchTargets[1].found:tmpTouches[i].obj.elementClass===Const.OBJECT_CLASS_CIRCLE&&(found=1===foundNumber||3===foundNumber),found)for(this.touches.push({obj:tmpTouches[i].obj,targets:[]}),j=0;j<touchTargets.length;j++)touchTargets[j].found&&this.touches[this.touches.length-1].targets.push({num:touchTargets[j].num,X:touchTargets[j].screenX,Y:touchTargets[j].screenY,Xprev:NaN,Yprev:NaN,Xstart:touchTargets[j].Xstart,Ystart:touchTargets[j].Ystart,Zstart:touchTargets[j].Zstart});else tmpTouches[i].obj.noHighlight()}}else this.touches.length=0;for(i=this.downObjects.length-1;i>-1;i--){for(found=!1,j=0;j<this.touches.length;j++)this.touches[j].obj.id===this.downObjects[i].id&&(found=!0);found||(this.downObjects[i].triggerEventHandlers(["touchup","up"],[evt]),this.downObjects.splice(i,1))}return evtTouches&&0!==evtTouches.length||(this.hasTouchEnd&&(Env.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(evt){var pos,elements,result;if(this.document.selection&&Type.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return Env.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,this._inputDevice="mouse",this.options.precision.hasPoint=this.options.precision.mouse,pos=this.getMousePosition(evt),this._testForSelection(evt),this.selectingMode?(this._startSelecting(pos),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[evt])):(0===(elements=this.initMoveObject(pos[0],pos[1],evt,"mouse")).length?(this.mode=this.BOARD_MODE_NONE,result=!0):(this.mouse={obj:null,targets:[{X:pos[0],Y:pos[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=elements[elements.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),evt&&evt.preventDefault?evt.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(result=this.mouseOriginMoveStart(evt)),this.triggerEventHandlers(["mousedown","down"],[evt]),result)},mouseMoveListener:function(evt){var pos;if(!this.checkFrameRate(evt))return!1;pos=this.getMousePosition(evt),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.selectingMode?(this._moveSelecting(pos),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[evt,this.mode])):this.mouseOriginMove(evt)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(pos[0],pos[1],this.mouse,evt,"mouse"):this.highlightElements(pos[0],pos[1],evt,-1),this.triggerEventHandlers(["mousemove","move"],[evt,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(evt){var i;if(!1===this.selectingMode&&this.triggerEventHandlers(["mouseup","up"],[evt]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(evt),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[evt]),this.stopSelectionMode();else for(i=0;i<this.downObjects.length;i++)this.downObjects[i].triggerEventHandlers(["mouseup","up"],[evt]);this.downObjects.length=0,this.hasMouseUp&&(Env.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(evt){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(evt,"zoom"))return!0;var wd=(evt=evt||window.event).detail?-evt.detail:evt.wheelDelta/40,pos=new Coords(Const.COORDS_BY_SCREEN,this.getMousePosition(evt),this);return wd>0?this.zoomIn(pos.usrCoords[1],pos.usrCoords[2]):this.zoomOut(pos.usrCoords[1],pos.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[evt]),evt.preventDefault(),!1},keyDownListener:function(evt){var id,el,res,dir,actPos,id_node=evt.target.id,sX=0,sY=0,dx=Type.evaluate(this.attr.keyboard.dx)/this.unitX,dy=Type.evaluate(this.attr.keyboard.dy)/this.unitY,doZoom=!1,done=!0;return!(!this.attr.keyboard.enabled||""===id_node)&&(id=id_node.replace(this.containerObj.id+"_",""),el=this.select(id),Type.exists(el.coords)&&(actPos=el.coords.usrCoords.slice(1)),(Type.evaluate(this.attr.keyboard.panshift)||Type.evaluate(this.attr.keyboard.panctrl))&&(doZoom=!0),Type.evaluate(this.attr.keyboard.panshift)&&evt.shiftKey||Type.evaluate(this.attr.keyboard.panctrl)&&evt.ctrlKey?38===evt.keyCode?this.clickUpArrow():40===evt.keyCode?this.clickDownArrow():37===evt.keyCode?this.clickLeftArrow():39===evt.keyCode?this.clickRightArrow():done=!1:(Type.exists(el.visProp)&&(Type.exists(el.visProp.snaptogrid)&&el.visProp.snaptogrid&&Type.evaluate(el.visProp.snapsizex)&&Type.evaluate(el.visProp.snapsizey)?(sX=(res=el.getSnapSizes())[0],sY=res[1],dx=Math.max(sX,dx),dy=Math.max(sY,dy)):Type.exists(el.visProp.attracttogrid)&&el.visProp.attracttogrid&&Type.evaluate(el.visProp.attractordistance)&&Type.evaluate(el.visProp.attractorunit)&&(sY=sX=1.1*Type.evaluate(el.visProp.attractordistance),"screen"===Type.evaluate(el.visProp.attractorunit)&&(sX/=this.unitX,sY/=this.unitX),dx=Math.max(sX,dx),dy=Math.max(sY,dy))),38===evt.keyCode?dir=[0,dy]:40===evt.keyCode?dir=[0,-dy]:37===evt.keyCode?dir=[-dx,0]:39===evt.keyCode?dir=[dx,0]:doZoom&&"+"===evt.key?this.zoomIn():doZoom&&"-"===evt.key?this.zoomOut():doZoom&&"o"===evt.key?this.zoom100():done=!1,dir&&el.isDraggable&&el.visPropCalc.visible&&(this.geonextCompatibilityMode&&(Type.isPoint(el)||el.elementClass===Const.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!Type.evaluate(el.visProp.fixed)&&(Type.exists(el.coords)&&(dir[0]+=actPos[0],dir[1]+=actPos[1]),el.setPosition(JXG.COORDS_BY_USER,dir),Type.exists(el.coords)&&this.updateInfobox(el),this.triggerEventHandlers(["hit"],[evt,el]))),this.update(),done&&Type.exists(evt.preventDefault)&&evt.preventDefault(),!0)},keyFocusInListener:function(evt){var id,el,id_node=evt.target.id;if(!this.attr.keyboard.enabled||""===id_node)return!1;id=id_node.replace(this.containerObj.id+"_",""),el=this.select(id),Type.exists(el.highlight)&&el.highlight(!0),Type.exists(el.coords)&&this.updateInfobox(el),this.triggerEventHandlers(["hit"],[evt,el])},keyFocusOutListener:function(evt){if(!this.attr.keyboard.enabled)return!1;this.dehighlightAll(),this.displayInfobox(!1)},updateContainerDims:function(){var w,h,bb,css;w=(bb=this.containerObj.getBoundingClientRect()).width,h=bb.height,window&&window.getComputedStyle&&(css=window.getComputedStyle(this.containerObj,null),w-=parseFloat(css.getPropertyValue("border-left-width"))+parseFloat(css.getPropertyValue("border-right-width")),h-=parseFloat(css.getPropertyValue("border-top-width"))+parseFloat(css.getPropertyValue("border-bottom-width"))),w<=0||h<=0||Type.isNaN(w)||Type.isNaN(h)||(isNaN(this.getBoundingBox()[0])&&this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"keep"),Type.exists(this._prevDim)&&this._prevDim.w===w&&this._prevDim.h===h||(this.resizeContainer(w,h,!0),this._prevDim={w:w,h:h}))},startResizeObserver:function(){var that=this;Env.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this.resizeObserver=new ResizeObserver((function(entries){that._isResizing||(that._isResizing=!0,window.setTimeout((function(){try{that.updateContainerDims()}catch(err){that.stopResizeObserver()}finally{that._isResizing=!1}}),that.attr.resize.throttle))})),this.resizeObserver.observe(this.containerObj))},stopResizeObserver:function(){Env.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&Type.exists(this.resizeObserver)&&this.resizeObserver.unobserve(this.containerObj)},resizeListener:function(){var that=this;Env.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this._isScrolling||this._isResizing||(this._isResizing=!0,window.setTimeout((function(){that.updateContainerDims(),that._isResizing=!1}),this.attr.resize.throttle)))},scrollListener:function(evt){var that=this;Env.isBrowser&&(this._isScrolling||(this._isScrolling=!0,window.setTimeout((function(){that._isScrolling=!1}),66)))},startIntersectionObserver:function(){var that=this;try{this.intersectionObserver=new IntersectionObserver((function(entries){isNaN(that.getBoundingBox()[0])&&that.updateContainerDims()}),{root:null,rootMargin:"0px",threshold:.8}),this.intersectionObserver.observe(that.containerObj)}catch(err){console.log("JSXGraph: IntersectionObserver not available in this browser.")}},stopIntersectionObserver:function(){Type.exists(this.intersectionObserver)&&this.intersectionObserver.unobserve(this.containerObj)},initInfobox:function(){var attr=Type.copyAttributes({},this.options,"infobox");return attr.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],attr),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.displayInfobox(!1),this},updateInfobox:function(el){var x,y,xc,yc,vpinfoboxdigits,vpsi=Type.evaluate(el.visProp.showinfobox);return!Type.evaluate(this.attr.showinfobox)&&"inherit"===vpsi||!vpsi||Type.isPoint(el)&&(xc=el.coords.usrCoords[1],yc=el.coords.usrCoords[2],vpinfoboxdigits=Type.evaluate(el.visProp.infoboxdigits),this.infobox.setCoords(xc+this.infobox.distanceX/this.unitX,yc+this.infobox.distanceY/this.unitY),"string"!=typeof el.infoboxText?("auto"===vpinfoboxdigits?(x=Type.autoDigits(xc),y=Type.autoDigits(yc)):Type.isNumber(vpinfoboxdigits)?(x=Type.toFixed(xc,vpinfoboxdigits),y=Type.toFixed(yc,vpinfoboxdigits)):(x=xc,y=yc),this.highlightInfobox(x,y,el)):this.highlightCustomInfobox(el.infoboxText,el),this.displayInfobox(!0)),this},displayInfobox:function(val){return this.infobox.hiddenByParent===val&&(this.infobox.hiddenByParent=!val,this.infobox.prepareUpdate().updateVisibility(val).updateRenderer()),this},showInfobox:function(val){return this.displayInfobox(val)},highlightInfobox:function(x,y,el){return this.highlightCustomInfobox("("+x+", "+y+")",el),this},highlightCustomInfobox:function(text,el){return this.infobox.setText(text),this},dehighlightAll:function(){var el,pEl,needsDehighlight=!1;for(el in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(el)&&(pEl=this.highlightedObjects[el],(this.hasMouseHandlers||this.hasPointerHandlers)&&pEl.noHighlight(),needsDehighlight=!0);return this.highlightedObjects={},"canvas"===this.renderer.type&&needsDehighlight&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(x,y){return[x,y]},getUsrCoordsOfMouse:function(evt){var cPos=this.getCoordsTopLeftCorner(),absPos=Env.getPosition(evt,null,this.document),x=absPos[0]-cPos[0],y=absPos[1]-cPos[1];return new Coords(Const.COORDS_BY_SCREEN,[x,y],this).usrCoords.slice(1)},getAllUnderMouse:function(evt){var elList=this.getAllObjectsUnderMouse(evt);return elList.push(this.getUsrCoordsOfMouse(evt)),elList},getAllObjectsUnderMouse:function(evt){var el,pEl,cPos=this.getCoordsTopLeftCorner(),absPos=Env.getPosition(evt,null,this.document),dx=absPos[0]-cPos[0],dy=absPos[1]-cPos[1],elList=[],len=this.objectsList.length;for(el=0;el<len;el++)(pEl=this.objectsList[el]).visPropCalc.visible&&pEl.hasPoint&&pEl.hasPoint(dx,dy)&&(elList[elList.length]=pEl);return elList},updateCoords:function(){var el,ob,len=this.objectsList.length;for(ob=0;ob<len;ob++)el=this.objectsList[ob],Type.exists(el.coords)&&(Type.evaluate(el.visProp.frozen)?el.coords.screen2usr():el.coords.usr2screen());return this},moveOrigin:function(x,y,diff){var ox,oy,ul,lr;return Type.exists(x)&&Type.exists(y)&&(ox=this.origin.scrCoords[1],oy=this.origin.scrCoords[2],this.origin.scrCoords[1]=x,this.origin.scrCoords[2]=y,diff&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy),ul=new Coords(Const.COORDS_BY_SCREEN,[0,0],this).usrCoords,lr=new Coords(Const.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords,(ul[1]<this.maxboundingbox[0]||ul[2]>this.maxboundingbox[1]||lr[1]>this.maxboundingbox[2]||lr[2]<this.maxboundingbox[3])&&(this.origin.scrCoords[1]=ox,this.origin.scrCoords[2]=oy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(str){var term,m,left,right,name,el,property,functions=[],i=str.indexOf("<data>"),j=str.indexOf("</data>"),xyFun=function(board,el,f,what){return function(){var e,t;t=(e=board.select(el.id)).coords.usrCoords[what],2===what?e.setPositionDirectly(Const.COORDS_BY_USER,[f(),t]):e.setPositionDirectly(Const.COORDS_BY_USER,[t,f()]),e.prepareUpdate().update()}},visFun=function(board,el,f){return function(){var e,v;e=board.select(el.id),v=f(),e.setAttribute({visible:v})}},colFun=function(board,el,f,what){return function(){var e,v;e=board.select(el.id),v=f(),"strokewidth"===what?e.visProp.strokewidth=v:(v=Color.rgba2rgbo(v),e.visProp[what+"color"]=v[0],e.visProp[what+"opacity"]=v[1])}},posFun=function(board,el,f){return function(){board.select(el.id).position=f()}},styleFun=function(board,el,f){return function(){board.select(el.id).setStyle(f())}};if(!(i<0)){for(;i>=0;){if(m=(term=str.slice(i+6,j)).indexOf("="),left=term.slice(0,m),right=term.slice(m+1),m=left.indexOf("."),name=left.slice(0,m),el=this.elementsByName[Type.unescapeHTML(name)],property=left.slice(m+1).replace(/\s+/g,"").toLowerCase(),right=Type.createFunction(right,this,"",!0),Type.exists(this.elementsByName[name]))switch(property){case"x":functions.push(xyFun(this,el,right,2));break;case"y":functions.push(xyFun(this,el,right,1));break;case"visible":functions.push(visFun(this,el,right));break;case"position":functions.push(posFun(this,el,right));break;case"stroke":functions.push(colFun(this,el,right,"stroke"));break;case"style":functions.push(styleFun(this,el,right));break;case"strokewidth":functions.push(colFun(this,el,right,"strokewidth"));break;case"fill":functions.push(colFun(this,el,right,"fill"));break;case"label":break;default:JXG.debug("property '"+property+"' in conditions not yet implemented:"+right)}else JXG.debug("debug conditions: |"+name+"| undefined");i=(str=str.slice(j+7)).indexOf("<data>"),j=str.indexOf("</data>")}this.updateConditions=function(){var i;for(i=0;i<functions.length;i++)functions[i]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var p1=new Coords(Const.COORDS_BY_USER,[0,0],this),p2=new Coords(Const.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),x=p1.scrCoords[1]-p2.scrCoords[1],y=p1.scrCoords[2]-p2.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(x)>25;)this.options.grid.snapSizeX*=2,x/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(y)>25;)this.options.grid.snapSizeY*=2,y/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(x,y){var bb=this.getBoundingBox(),zX=this.attr.zoom.factorx,zY=this.attr.zoom.factory,dX=(bb[2]-bb[0])*(1-1/zX),dY=(bb[1]-bb[3])*(1-1/zY),lr=.5,tr=.5,mi=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&zX>1||this.zoomY>this.attr.zoom.max&&zY>1||this.zoomX<mi&&zX<1||this.zoomY<mi&&zY<1?this:(Type.isNumber(x)&&Type.isNumber(y)&&(lr=(x-bb[0])/(bb[2]-bb[0]),tr=(bb[1]-y)/(bb[1]-bb[3])),this.setBoundingBox([bb[0]+dX*lr,bb[1]-dY*tr,bb[2]-dX*(1-lr),bb[3]+dY*(1-tr)],this.keepaspectratio,"update"),this.applyZoom())},zoomOut:function(x,y){var bb=this.getBoundingBox(),zX=this.attr.zoom.factorx,zY=this.attr.zoom.factory,dX=(bb[2]-bb[0])*(1-zX),dY=(bb[1]-bb[3])*(1-zY),lr=.5,tr=.5,mi=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<mi||this.zoomY<mi?this:(Type.isNumber(x)&&Type.isNumber(y)&&(lr=(x-bb[0])/(bb[2]-bb[0]),tr=(bb[1]-y)/(bb[1]-bb[3])),this.setBoundingBox([bb[0]+dX*lr,bb[1]-dY*tr,bb[2]-dX*(1-lr),bb[3]+dY*(1-tr)],this.keepaspectratio,"update"),this.applyZoom())},zoom100:function(){var bb,dX,dY;return Type.exists(this.attr.boundingbox)?this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"reset"):(dX=((bb=this.getBoundingBox())[2]-bb[0])*(1-this.zoomX)*.5,dY=(bb[1]-bb[3])*(1-this.zoomY)*.5,this.setBoundingBox([bb[0]+dX,bb[1]-dY,bb[2]-dX,bb[3]+dY],this.keepaspectratio,"reset")),this.applyZoom()},zoomAllPoints:function(){var el,borderX,borderY,pEl,minX=0,maxX=0,minY=0,maxY=0,len=this.objectsList.length;for(el=0;el<len;el++)pEl=this.objectsList[el],Type.isPoint(pEl)&&pEl.visPropCalc.visible&&(pEl.coords.usrCoords[1]<minX?minX=pEl.coords.usrCoords[1]:pEl.coords.usrCoords[1]>maxX&&(maxX=pEl.coords.usrCoords[1]),pEl.coords.usrCoords[2]>maxY?maxY=pEl.coords.usrCoords[2]:pEl.coords.usrCoords[2]<minY&&(minY=pEl.coords.usrCoords[2]));return 50,borderX=50/this.unitX,borderY=50/this.unitY,this.setBoundingBox([minX-borderX,maxY+borderY,maxX+borderX,minY-borderY],this.keepaspectratio,"update"),this.applyZoom()},zoomElements:function(elements){var i,box,cx,cy,dx,dy,d,newBBox=[1/0,-1/0,-1/0,1/0];if(!Type.isArray(elements)||0===elements.length)return this;for(i=0;i<elements.length;i++)box=this.select(elements[i]).bounds(),Type.isArray(box)&&(box[0]<newBBox[0]&&(newBBox[0]=box[0]),box[1]>newBBox[1]&&(newBBox[1]=box[1]),box[2]>newBBox[2]&&(newBBox[2]=box[2]),box[3]<newBBox[3]&&(newBBox[3]=box[3]));return Type.isArray(newBBox)&&(cx=.5*(newBBox[0]+newBBox[2]),cy=.5*(newBBox[1]+newBBox[3]),dx=1.5*(newBBox[2]-newBBox[0])*.5,dy=1.5*(newBBox[1]-newBBox[3])*.5,d=Math.max(dx,dy),this.setBoundingBox([cx-d,cy+d,cx+d,cy-d],this.keepaspectratio,"update")),this},setZoom:function(fX,fY){var oX=this.attr.zoom.factorx,oY=this.attr.zoom.factory;return this.attr.zoom.factorx=fX/this.zoomX,this.attr.zoom.factory=fY/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=oX,this.attr.zoom.factory=oY,this},removeObject:function(object,saveMethod){var el,i;if(Type.isArray(object)){for(i=0;i<object.length;i++)this.removeObject(object[i]);return this}if(object=this.select(object),!Type.exists(object)||Type.isString(object))return this;try{for(el in object.childElements)object.childElements.hasOwnProperty(el)&&object.childElements[el].board.removeObject(object.childElements[el]);for(el in object.objects)object.objects.hasOwnProperty(el)&&object.objects[el].board.removeObject(object.objects[el]);if(saveMethod)for(el in this.objects)this.objects.hasOwnProperty(el)&&Type.exists(this.objects[el].childElements)&&Type.exists(this.objects[el].childElements.hasOwnProperty(object.id))&&(delete this.objects[el].childElements[object.id],delete this.objects[el].descendants[object.id]);else if(Type.exists(object.ancestors))for(el in object.ancestors)object.ancestors.hasOwnProperty(el)&&Type.exists(object.ancestors[el].childElements)&&Type.exists(object.ancestors[el].childElements.hasOwnProperty(object.id))&&(delete object.ancestors[el].childElements[object.id],delete object.ancestors[el].descendants[object.id]);if(object._pos>-1)for(this.objectsList.splice(object._pos,1),el=object._pos;el<this.objectsList.length;el++)this.objectsList[el]._pos--;else object.type!==Const.OBJECT_TYPE_TURTLE&&JXG.debug("Board.removeObject: object "+object.id+" not found in list.");delete this.objects[object.id],delete this.elementsByName[object.name],object.visProp&&Type.evaluate(object.visProp.trace)&&object.clearTrace(),Type.exists(object.remove)&&object.remove()}catch(e){JXG.debug(object.id+": Could not be removed: "+e)}return this.update(),this},removeAncestors:function(object){var anc;for(anc in object.ancestors)object.ancestors.hasOwnProperty(anc)&&this.removeAncestors(object.ancestors[anc]);return this.removeObject(object),this},initGeonextBoard:function(){var p1,p2,p3;return p1=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),p2=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),p3=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[p1,p2],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[p1,p3],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(canvasWidth,canvasHeight,dontset,dontSetBoundingBox){var box;return dontSetBoundingBox||(box=this.getBoundingBox()),this.canvasWidth=parseFloat(canvasWidth),this.canvasHeight=parseFloat(canvasHeight),dontset||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),dontSetBoundingBox||this.setBoundingBox(box,this.keepaspectratio,"keep"),this},showDependencies:function(){var el,t,c,f,i;for(el in t="<p>\n",this.objects)if(this.objects.hasOwnProperty(el)){for(c in i=0,this.objects[el].childElements)this.objects[el].childElements.hasOwnProperty(c)&&(i+=1);for(c in i>=0&&(t+="<strong>"+this.objects[el].id+":</strong> "),this.objects[el].childElements)this.objects[el].childElements.hasOwnProperty(c)&&(t+=this.objects[el].childElements[c].id+"("+this.objects[el].childElements[c].name+"), ");t+="<p>\n"}return t+="</p>\n",(f=window.open()).document.open(),f.document.write(t),f.document.close(),this},showXML:function(){var f=window.open("");return f.document.open(),f.document.write("<pre>"+Type.escapeHTML(this.xmlString)+"</pre>"),f.document.close(),this},prepareUpdate:function(){var el,pEl,len=this.objectsList.length;for(el=0;el<len;el++)(pEl=this.objectsList[el]).needsUpdate=pEl.needsRegularUpdate||this.needsFullUpdate;for(el in this.groups)this.groups.hasOwnProperty(el)&&((pEl=this.groups[el]).needsUpdate=pEl.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(drag){var el,pEl;for(drag=this.select(drag),el=0;el<this.objectsList.length;el++)pEl=this.objectsList[el],this.needsFullUpdate&&pEl.elementClass===Const.OBJECT_CLASS_TEXT&&pEl.updateSize(),pEl.update(!Type.exists(drag)||pEl.id!==drag.id).updateVisibility();for(el in this.groups)this.groups.hasOwnProperty(el)&&this.groups[el].update(drag);return this},updateRenderer:function(){var el,len=this.objectsList.length;if("canvas"===this.renderer.type)this.updateRendererCanvas();else for(el=0;el<len;el++)this.objectsList[el].updateRenderer();return this},updateRendererCanvas:function(){var el,pEl,i,mini,la,olen=this.objectsList.length,layers=this.options.layer,len=this.options.layer.numlayers,last=Number.NEGATIVE_INFINITY;for(i=0;i<len;i++){for(la in mini=Number.POSITIVE_INFINITY,layers)layers.hasOwnProperty(la)&&layers[la]>last&&layers[la]<mini&&(mini=layers[la]);for(last=mini,el=0;el<olen;el++)(pEl=this.objectsList[el]).visProp.layer===mini&&pEl.prepareUpdate().updateRenderer()}return this},addHook:function(hook,m,context){return JXG.deprecated("Board.addHook()","Board.on()"),m=Type.def(m,"update"),context=Type.def(context,this),this.hooks.push([m,hook]),this.on(m,hook,context),this.hooks.length-1},addEvent:JXG.shortcut(JXG.Board.prototype,"on"),removeHook:function(id){return JXG.deprecated("Board.removeHook()","Board.off()"),this.hooks[id]&&(this.off(this.hooks[id][0],this.hooks[id][1]),this.hooks[id]=null),this},removeEvent:JXG.shortcut(JXG.Board.prototype,"off"),updateHooks:function(m){var arg=Array.prototype.slice.call(arguments,0);return JXG.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),arg[0]=Type.def(arg[0],"update"),this.triggerEventHandlers([arg[0]],arguments),this},addChild:function(board){return Type.exists(board)&&Type.exists(board.containerObj)&&(this.dependentBoards.push(board),this.update()),this},removeChild:function(board){var i;for(i=this.dependentBoards.length-1;i>=0;i--)this.dependentBoards[i]===board&&this.dependentBoards.splice(i,1);return this},update:function(drag){var i,len,b,insert,storeActiveEl;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,"all"===this.attr.minimizereflow&&this.containerObj&&"vml"!==this.renderer.type&&(storeActiveEl=this.document.activeElement,insert=this.renderer.removeToInsertLater(this.containerObj)),"svg"===this.attr.minimizereflow&&"svg"===this.renderer.type&&(storeActiveEl=this.document.activeElement,insert=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(drag).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),insert&&(insert(),storeActiveEl.focus()),len=this.dependentBoards.length,i=0;i<len;i++)b=this.dependentBoards[i],Type.exists(b)&&b!==this&&(b.updateQuality=this.updateQuality,b.prepareUpdate().updateElements().updateConditions(),b.renderer.suspendRedraw(),b.updateRenderer(),b.renderer.unsuspendRedraw(),b.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var i;for(i=0;i<this.grids.length;i++)this.removeObject(this.grids[i]);return this.grids.length=0,this.update(),this},create:function(elementType,parents,attributes){var el,i;for(elementType=elementType.toLowerCase(),Type.exists(parents)||(parents=[]),Type.exists(attributes)||(attributes={}),i=0;i<parents.length;i++)!Type.isString(parents[i])||"text"===elementType&&2===i||"solidofrevolution3d"===elementType&&2===i||!("input"!==elementType&&"checkbox"!==elementType&&"button"!==elementType||2!==i&&3!==i)||"curve"===elementType&&i>0||(parents[i]=this.select(parents[i]));if(!Type.isFunction(JXG.elements[elementType]))throw new Error("JSXGraph: create: Unknown element type given: "+elementType);return el=JXG.elements[elementType](this,parents,attributes),Type.exists(el)?(el.prepareUpdate&&el.update&&el.updateRenderer&&el.fullUpdate(),el):(JXG.debug("JSXGraph: create: failure creating "+elementType),el)},createElement:function(){return JXG.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var el;for(el=0;el<this.objectsList.length;el++)this.objectsList[el].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(bbox,keepaspectratio,setZoom){var h,w,ux,uy,offX=0,offY=0,dim=Env.getDimensions(this.container,this.document);return Type.isArray(bbox)?(bbox[0]<this.maxboundingbox[0]||bbox[1]>this.maxboundingbox[1]||bbox[2]>this.maxboundingbox[2]||bbox[3]<this.maxboundingbox[3]||(Type.exists(setZoom)||(setZoom="reset"),ux=this.unitX,uy=this.unitY,this.canvasWidth=parseInt(dim.width,10),this.canvasHeight=parseInt(dim.height,10),w=this.canvasWidth,h=this.canvasHeight,keepaspectratio?(this.unitX=w/(bbox[2]-bbox[0]),this.unitY=h/(bbox[1]-bbox[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?(this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY),offY=.5*(h/this.unitY-(bbox[1]-bbox[3]))):(this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),offX=.5*(w/this.unitX-(bbox[2]-bbox[0]))),this.keepaspectratio=!0):(this.unitX=w/(bbox[2]-bbox[0]),this.unitY=h/(bbox[1]-bbox[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*(bbox[0]-offX),this.unitY*(bbox[1]+offY)),"update"===setZoom?(this.zoomX*=this.unitX/ux,this.zoomY*=this.unitY/uy):"reset"===setZoom&&(this.zoomX=Type.exists(this.attr.zoomx)?this.attr.zoomx:1,this.zoomY=Type.exists(this.attr.zoomy)?this.attr.zoomy:1)),this):this},getBoundingBox:function(){var ul=new Coords(Const.COORDS_BY_SCREEN,[0,0],this).usrCoords,lr=new Coords(Const.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords;return[ul[1],ul[2],lr[1],lr[2]]},addAnimation:function(element){var that=this;return this.animationObjects[element.id]=element,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval((function(){that.animate()}),element.board.attr.animationdelay)),this},stopAllAnimation:function(){var el;for(el in this.animationObjects)this.animationObjects.hasOwnProperty(el)&&Type.exists(this.animationObjects[el])&&(this.animationObjects[el]=null,delete this.animationObjects[el]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var props,el,o,newCoords,r,p,c,cbtmp,count=0,obj=null;for(el in this.animationObjects)if(this.animationObjects.hasOwnProperty(el)&&Type.exists(this.animationObjects[el])){if(count+=1,(o=this.animationObjects[el]).animationPath&&(newCoords=Type.isFunction(o.animationPath)?o.animationPath((new Date).getTime()-o.animationStart):o.animationPath.pop(),!Type.exists(newCoords)||!Type.isArray(newCoords)&&isNaN(newCoords)?delete o.animationPath:(o.setPositionDirectly(Const.COORDS_BY_USER,newCoords),o.fullUpdate(),obj=o)),o.animationData){for(r in c=0,o.animationData)o.animationData.hasOwnProperty(r)&&(p=o.animationData[r].pop(),Type.exists(p)?(c+=1,(props={})[r]=p,o.setAttribute(props)):delete o.animationData[p]);0===c&&delete o.animationData}Type.exists(o.animationData)||Type.exists(o.animationPath)||(this.animationObjects[el]=null,delete this.animationObjects[el],Type.exists(o.animationCallback)&&(cbtmp=o.animationCallback,o.animationCallback=null,cbtmp()))}return 0===count?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(obj),this},migratePoint:function(src,dest,copyName){var child,childId,prop,found,i,srcLabelId,srcHasLabel=!1;for(childId in src=this.select(src),dest=this.select(dest),Type.exists(src.label)&&(srcLabelId=src.label.id,srcHasLabel=!0,this.removeObject(src.label)),src.childElements)if(src.childElements.hasOwnProperty(childId)){for(prop in found=!1,child=src.childElements[childId])child.hasOwnProperty(prop)&&child[prop]===src&&(child[prop]=dest,found=!0);for(found&&delete src.childElements[childId],i=0;i<child.parents.length;i++)child.parents[i]===src.id&&(child.parents[i]=dest.id);dest.addChild(child)}return copyName&&(srcHasLabel&&(delete dest.childElements[srcLabelId],delete dest.descendants[srcLabelId]),dest.label&&this.removeObject(dest.label),delete this.elementsByName[dest.name],dest.name=src.name,srcHasLabel&&dest.createLabel()),this.removeObject(src),Type.exists(dest.name)&&""!==dest.name&&(this.elementsByName[dest.name]=dest),this.fullUpdate(),this},emulateColorblindness:function(deficiency){var e,o;if(Type.exists(deficiency)||(deficiency="none"),this.currentCBDef===deficiency)return this;for(e in this.objects)this.objects.hasOwnProperty(e)&&(o=this.objects[e],"none"!==deficiency?("none"===this.currentCBDef&&(o.visPropOriginal={strokecolor:o.visProp.strokecolor,fillcolor:o.visProp.fillcolor,highlightstrokecolor:o.visProp.highlightstrokecolor,highlightfillcolor:o.visProp.highlightfillcolor}),o.setAttribute({strokecolor:Color.rgb2cb(Type.evaluate(o.visPropOriginal.strokecolor),deficiency),fillcolor:Color.rgb2cb(Type.evaluate(o.visPropOriginal.fillcolor),deficiency),highlightstrokecolor:Color.rgb2cb(Type.evaluate(o.visPropOriginal.highlightstrokecolor),deficiency),highlightfillcolor:Color.rgb2cb(Type.evaluate(o.visPropOriginal.highlightfillcolor),deficiency)})):Type.exists(o.visPropOriginal)&&JXG.extend(o.visProp,o.visPropOriginal));return this.currentCBDef=deficiency,this.update(),this},select:function(str,onlyByIdOrName){var flist,olist,i,l,s=str;if(null===s)return s;if(Type.isString(s)&&""!==s)Type.exists(this.objects[s])?s=this.objects[s]:Type.exists(this.elementsByName[s])?s=this.elementsByName[s]:Type.exists(this.groups[s])&&(s=this.groups[s]);else if(!onlyByIdOrName&&(Type.isFunction(s)||Type.isObject(s)&&!Type.isFunction(s.setAttribute))){for(olist={},l=(flist=Type.filterElements(this.objectsList,s)).length,i=0;i<l;i++)olist[flist[i].id]=flist[i];s=new Composition(olist)}else Type.isObject(s)&&Type.exists(s.id)&&!Type.exists(this.objects[s.id])&&(s=null);return s},hasPoint:function(x,y){var px=x,py=y,bbox=this.getBoundingBox();return Type.exists(x)&&Type.isArray(x.usrCoords)&&(px=x.usrCoords[1],py=x.usrCoords[2]),!!(Type.isNumber(px)&&Type.isNumber(py)&&bbox[0]<px&&px<bbox[2]&&bbox[1]>py&&py>bbox[3])},updateCSSTransforms:function(){var obj=this.containerObj,o=obj,o2=obj;for(this.cssTransMat=Env.getCSSTransformMatrix(o),o=o.offsetParent;o;){for(this.cssTransMat=Mat.matMatMult(Env.getCSSTransformMatrix(o),this.cssTransMat),o2=o2.parentNode;o2!==o;)this.cssTransMat=Mat.matMatMult(Env.getCSSTransformMatrix(o),this.cssTransMat),o2=o2.parentNode||o2.host;o=o.offsetParent}return this.cssTransMat=Mat.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(pos){this.isSelecting=!0,this.selectingBox=[[pos[0],pos[1]],[pos[0],pos[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(pos){this.isSelecting&&(this.selectingBox[1]=[pos[0],pos[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(evt){var pos=this.getMousePosition(evt);this.isSelecting=!1,this.selectingBox[1]=[pos[0],pos[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var A=this.selectingBox[0],B=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(JXG.COORDS_BY_SCREEN,[A[0],A[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(JXG.COORDS_BY_SCREEN,[A[0],B[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(JXG.COORDS_BY_SCREEN,[B[0],B[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(JXG.COORDS_BY_SCREEN,[B[0],A[1]])},_testForSelection:function(evt){this._isRequiredKeyPressed(evt,"selection")&&(Type.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(attr){var selectionattr;return Type.exists(this.selectionPolygon)||!0===(selectionattr=Type.copyAttributes(attr,Options,"board","selection")).enabled&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],selectionattr)),this},__evt__down:function(e){},__evt__mousedown:function(e){},__evt__pendown:function(e){},__evt__pointerdown:function(e){},__evt__touchstart:function(e){},__evt__up:function(e){},__evt__mouseup:function(e){},__evt__pointerup:function(e){},__evt__touchend:function(e){},__evt__move:function(e,mode){},__evt__mousemove:function(e,mode){},__evt__penmove:function(e,mode){},__evt__pointermove:function(e,mode){},__evt__touchmove:function(e,mode){},__evt__hit:function(e,el,target){},__evt__mousehit:function(e,el,target){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},toFullscreen:function(id){var wrap_id,wrap_node,inner_node;return id=id||this.container,this._fullscreen_inner_id=id,inner_node=this.document.getElementById(id),wrap_id="fullscreenwrap_"+id,this.document.getElementById(wrap_id)?wrap_node=this.document.getElementById(wrap_id):((wrap_node=document.createElement("div")).classList.add("JXG_wrap_private"),wrap_node.setAttribute("id",wrap_id),inner_node.parentNode.insertBefore(wrap_node,inner_node),wrap_node.appendChild(inner_node)),this._fullscreen_res=Env._getScaleFactors(inner_node),wrap_node.requestFullscreen=wrap_node.requestFullscreen||wrap_node.webkitRequestFullscreen||wrap_node.mozRequestFullScreen||wrap_node.msRequestFullscreen,wrap_node.requestFullscreen&&wrap_node.requestFullscreen(),this},fullscreenListener:function(evt){var res,inner_id,inner_node;if(inner_id=this._fullscreen_inner_id,Type.exists(inner_id)){if(this.document.fullscreenElement=this.document.fullscreenElement||this.document.webkitFullscreenElement||this.document.mozFullscreenElement||this.document.msFullscreenElement,inner_node=this.document.getElementById(inner_id),this.document.fullscreenElement)res=this._fullscreen_res,inner_node._cssFullscreenStore={id:this.document.fullscreenElement.id,isFullscreen:!0,margin:inner_node.style.margin,width:inner_node.style.width,scale:res.scale,vshift:res.vshift},inner_node.style.margin="",inner_node.style.width=res.width+"px",Env.scaleJSXGraphDiv(document.fullscreenElement.id,inner_id,res.scale,res.vshift),this.document.fullscreenElement=null;else if(Type.exists(inner_node._cssFullscreenStore)){try{this.document.styleSheets[this.document.styleSheets.length-1].deleteRule(0)}catch(err){console.log("JSXGraph: Could not remove CSS rules for full screen mode")}inner_node._cssFullscreenStore.isFullscreen=!1,inner_node.style.margin=inner_node._cssFullscreenStore.margin,inner_node.style.width=inner_node._cssFullscreenStore.width}this.updateCSSTransforms()}},createRoulette:function(c1,c2,start_c1,stepsize,direction,time,pointlist){var brd=this;return new function(){var c1dist,alpha=0,Tx=0,Ty=0,t1=start_c1,t2=Numerics.root((function(t){var c1x=c1.X(t1),c1y=c1.Y(t1),c2x=c2.X(t),c2y=c2.Y(t);return(c1x-c2x)*(c1x-c2x)+(c1y-c2y)*(c1y-c2y)}),[0,2*Math.PI]),t1_new=0,t2_new=0,rotation=brd.create("transform",[function(){return alpha}],{type:"rotate"}),rotationLocal=brd.create("transform",[function(){return alpha},function(){return c1.X(t1)},function(){return c1.Y(t1)}],{type:"rotate"}),translate=brd.create("transform",[function(){return Tx},function(){return Ty}],{type:"translate"}),arclen=function(c,a,b){var cpxa=Numerics.D(c.X)(a),cpya=Numerics.D(c.Y)(a),cpxb=Numerics.D(c.X)(b),cpyb=Numerics.D(c.Y)(b),cpxab=Numerics.D(c.X)(.5*(a+b)),cpyab=Numerics.D(c.Y)(.5*(a+b)),fa=Math.sqrt(cpxa*cpxa+cpya*cpya),fb=Math.sqrt(cpxb*cpxb+cpyb*cpyb);return(fa+4*Math.sqrt(cpxab*cpxab+cpyab*cpyab)+fb)*(b-a)/6},exactDist=function(t){return c1dist-arclen(c2,t2,t)},beta=Math.PI/18,beta9=9*beta,interval=null;return this.rolling=function(){var h,g,hp,gp,z;c1dist=arclen(c1,t1,t1_new=t1+direction*stepsize),t2_new=Numerics.root(exactDist,t2),h=new Complex(c1.X(t1_new),c1.Y(t1_new)),g=new Complex(c2.X(t2_new),c2.Y(t2_new)),hp=new Complex(Numerics.D(c1.X)(t1_new),Numerics.D(c1.Y)(t1_new)),gp=new Complex(Numerics.D(c2.X)(t2_new),Numerics.D(c2.Y)(t2_new)),z=Complex.C.div(hp,gp),alpha=Math.atan2(z.imaginary,z.real),z.div(Complex.C.abs(z)),z.mult(g),Tx=h.real-z.real,Ty=h.imaginary-z.imaginary,alpha<-beta&&alpha>-beta9?(alpha=-beta,rotationLocal.applyOnce(pointlist)):alpha>beta&&alpha<beta9?(alpha=beta,rotationLocal.applyOnce(pointlist)):(rotation.applyOnce(pointlist),translate.applyOnce(pointlist),t1=t1_new,t2=t2_new),brd.update()},this.start=function(){return time>0&&(interval=window.setInterval(this.rolling,time)),this},this.stop=function(){return window.clearInterval(interval),this},this}}}),JXG.Board})),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/color","utils/base64","math/numerics"],(function(JXG,Options,AbstractRenderer,Const,Type,Color,Base64,Numerics){return JXG.SVGRenderer=function(container,dim){var i;for(this.type="svg",this.isIE=-1!==navigator.appVersion.indexOf("MSIE")||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=container,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.display="block",this.resize(dim.width,dim.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],i=0;i<Options.layer.numlayers;i++)this.layer[i]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[i]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("display","none"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},JXG.SVGRenderer.prototype=new AbstractRenderer,JXG.extend(JXG.SVGRenderer.prototype,{_createArrowHead:function(el,idAppendix,type){var node2,node3,v,h,id=el.id+"Triangle";return Type.exists(idAppendix)&&(id+=idAppendix),(node2=this.createPrim("marker",id)).setAttributeNS(null,"stroke",Type.evaluate(el.visProp.strokecolor)),node2.setAttributeNS(null,"stroke-opacity",Type.evaluate(el.visProp.strokeopacity)),node2.setAttributeNS(null,"fill",Type.evaluate(el.visProp.strokecolor)),node2.setAttributeNS(null,"fill-opacity",Type.evaluate(el.visProp.strokeopacity)),node2.setAttributeNS(null,"stroke-width",0),node2.setAttributeNS(null,"orient","auto"),node2.setAttributeNS(null,"markerUnits","strokeWidth"),node3=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),h=5,"End"===idAppendix?(v=0,2===type?node3.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z"):3===type?node3.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z"):4===type?(h=3.31,node3.setAttributeNS(null,"d","M 0.00,3.31 C 3.53,3.84 7.13,4.50 10.00,6.63 C 9.33,5.52 8.67,4.42 8.00,3.31 C 8.67,2.21 9.33,1.10 10.00,0.00 C 7.13,2.13 3.53,2.79 0.00,3.31")):5===type?(h=3.28,node3.setAttributeNS(null,"d","M 0.00,3.28 C 3.39,4.19 6.81,5.07 10.00,6.55 C 9.38,5.56 9.00,4.44 9.00,3.28 C 9.00,2.11 9.38,0.99 10.00,0.00 C 6.81,1.49 3.39,2.37 0.00,3.28")):6===type?(h=2.84,node3.setAttributeNS(null,"d","M 0.00,2.84 C 3.39,3.59 6.79,4.35 10.00,5.68 C 9.67,4.73 9.33,3.78 9.00,2.84 C 9.33,1.89 9.67,0.95 10.00,0.00 C 6.79,1.33 3.39,2.09 0.00,2.84")):7===type?(h=5.2,node3.setAttributeNS(null,"d","M 0.00,5.20 C 4.04,5.20 7.99,6.92 10.00,10.39 M 10.00,0.00 C 7.99,3.47 4.04,5.20 0.00,5.20")):node3.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"),el.elementClass===Const.OBJECT_CLASS_LINE&&(v=2===type?4.9:3===type?3.3:4===type||5===type||6===type?6.66:7===type?0:10)):(v=10,2===type?node3.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z"):3===type?(v=3.3,node3.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):4===type?(h=3.31,node3.setAttributeNS(null,"d","M 10.00,3.31 C 6.47,3.84 2.87,4.50 0.00,6.63 C 0.67,5.52 1.33,4.42 2.00,3.31 C 1.33,2.21 0.67,1.10 0.00,0.00 C 2.87,2.13 6.47,2.79 10.00,3.31")):5===type?(h=3.28,node3.setAttributeNS(null,"d","M 10.00,3.28 C 6.61,4.19 3.19,5.07 0.00,6.55 C 0.62,5.56 1.00,4.44 1.00,3.28 C 1.00,2.11 0.62,0.99 0.00,0.00 C 3.19,1.49 6.61,2.37 10.00,3.28")):6===type?(h=2.84,node3.setAttributeNS(null,"d","M 10.00,2.84 C 6.61,3.59 3.21,4.35 0.00,5.68 C 0.33,4.73 0.67,3.78 1.00,2.84 C 0.67,1.89 0.33,0.95 0.00,0.00 C 3.21,1.33 6.61,2.09 10.00,2.84")):7===type?(h=5.2,node3.setAttributeNS(null,"d","M 10.00,5.20 C 5.96,5.20 2.01,6.92 0.00,10.39 M 0.00,0.00 C 2.01,3.47 5.96,5.20 10.00,5.20")):node3.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"),el.elementClass===Const.OBJECT_CLASS_LINE&&(v=2===type?5.1:3===type?.02:4===type||5===type||6===type?3.33:7===type?10:.05)),7===type&&(node2.setAttributeNS(null,"fill","none"),node2.setAttributeNS(null,"stroke-width",1)),node2.setAttributeNS(null,"refY",h),node2.setAttributeNS(null,"refX",v),node2.appendChild(node3),node2},_setArrowColor:function(node,color,opacity,el,type){node&&(Type.isString(color)&&(7!==type?this._setAttribute((function(){node.setAttributeNS(null,"stroke",color),node.setAttributeNS(null,"fill",color),node.setAttributeNS(null,"stroke-opacity",opacity),node.setAttributeNS(null,"fill-opacity",opacity)}),el.visPropOld.fillcolor):this._setAttribute((function(){node.setAttributeNS(null,"fill","none"),node.setAttributeNS(null,"stroke",color),node.setAttributeNS(null,"stroke-opacity",opacity)}),el.visPropOld.fillcolor)),this.isIE&&el.rendNode.parentNode.insertBefore(el.rendNode,el.rendNode))},_setArrowWidth:function(node,width,parentNode,size){var s,d;node&&(d=(s=width)*size,node.setAttributeNS(null,"viewBox","0 0 "+10*s+" "+10*s),node.setAttributeNS(null,"markerHeight",d),node.setAttributeNS(null,"markerWidth",d),node.setAttributeNS(null,"display","inherit"),this.isIE&&parentNode.parentNode.insertBefore(parentNode,parentNode))},updateTicks:function(ticks){var i,j,c,node,x,y,len2,str,tickStr="",len=ticks.ticks.length,isReal=!0;for(i=0;i<len;i++){for(x=(c=ticks.ticks[i])[0],y=c[1],len2=x.length,str=" M "+x[0]+" "+y[0],Type.isNumber(x[0])||(isReal=!1),j=1;isReal&&j<len2;++j)Type.isNumber(x[j])?str+=" L "+x[j]+" "+y[j]:isReal=!1;isReal&&(tickStr+=str)}node=ticks.rendNode,Type.exists(node)||(node=this.createPrim("path",ticks.id),this.appendChildPrim(node,Type.evaluate(ticks.visProp.layer)),ticks.rendNode=node),node.setAttributeNS(null,"stroke",Type.evaluate(ticks.visProp.strokecolor)),node.setAttributeNS(null,"fill","none"),node.setAttributeNS(null,"stroke-opacity",Type.evaluate(ticks.visProp.strokeopacity)),node.setAttributeNS(null,"stroke-width",Type.evaluate(ticks.visProp.strokewidth)),this.updatePathPrim(node,tickStr,ticks.board)},displayCopyright:function(str,fontsize){var t,node=this.createPrim("text","licenseText");node.setAttributeNS(null,"x","20px"),node.setAttributeNS(null,"y",2+fontsize+"px"),node.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+fontsize+"px; fill:#356AA0;  opacity:0.3;"),t=this.container.ownerDocument.createTextNode(str),node.appendChild(t),this.appendChildPrim(node,0)},drawInternalText:function(el){var node=this.createPrim("text",el.id);return node.style.whiteSpace="nowrap",el.rendNodeText=this.container.ownerDocument.createTextNode(""),node.appendChild(el.rendNodeText),this.appendChildPrim(node,Type.evaluate(el.visProp.layer)),node},updateInternalText:function(el){var v,content=el.plaintext,ev_ax=el.getAnchorX(),ev_ay=el.getAnchorY();el.rendNode.getAttributeNS(null,"class")!==el.visProp.cssclass&&(el.rendNode.setAttributeNS(null,"class",Type.evaluate(el.visProp.cssclass)),el.needsSizeUpdate=!0),isNaN(el.coords.scrCoords[1]+el.coords.scrCoords[2])||(v=el.coords.scrCoords[1],el.visPropOld.left!==ev_ax+v&&(el.rendNode.setAttributeNS(null,"x",v+"px"),"left"===ev_ax?el.rendNode.setAttributeNS(null,"text-anchor","start"):"right"===ev_ax?el.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===ev_ax&&el.rendNode.setAttributeNS(null,"text-anchor","middle"),el.visPropOld.left=ev_ax+v),v=el.coords.scrCoords[2],el.visPropOld.top!==ev_ay+v&&(el.rendNode.setAttributeNS(null,"y",v+.5*this.vOffsetText+"px"),"bottom"===ev_ay?el.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):"top"===ev_ay?el.rendNode.setAttributeNS(null,"dy","1.6ex"):"middle"===ev_ay&&el.rendNode.setAttributeNS(null,"dy","0.6ex"),el.visPropOld.top=ev_ay+v)),el.htmlStr!==content&&(el.rendNodeText.data=content,el.htmlStr=content),this.transformImage(el,el.transformations)},updateInternalTextStyle:function(el,strokeColor,strokeOpacity,duration){this.setObjectFillColor(el,strokeColor,strokeOpacity)},drawImage:function(el){var node=this.createPrim("image",el.id);node.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(node,Type.evaluate(el.visProp.layer)),el.rendNode=node,this.updateImage(el)},transformImage:function(el,t){var m,node=el.rendNode,str="";t.length>0&&(str+=" matrix("+[(m=this.joinTransforms(el,t))[1][1],m[2][1],m[1][2],m[2][2],m[1][0],m[2][0]].join(",")+") ",node.setAttributeNS(null,"transform",str))},updateImageURL:function(el){var url=Type.evaluate(el.url);return el._src!==url&&(el.imgIsLoaded=!1,el.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",url),el._src=url,!0)},updateImageStyle:function(el,doHighlight){var css=Type.evaluate(doHighlight?el.visProp.highlightcssclass:el.visProp.cssclass);el.rendNode.setAttributeNS(null,"class",css)},drawForeignObject:function(el){el.rendNode=this.appendChildPrim(this.createPrim("foreignObject",el.id),Type.evaluate(el.visProp.layer)),this.appendNodesToElement(el,"foreignObject"),this.updateForeignObject(el)},updateForeignObject:function(el){el._useUserSize?el.rendNode.style.overflow="hidden":el.rendNode.style.overflow="visible",this.updateRectPrim(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2]-el.size[1],el.size[0],el.size[1]),el.rendNode.innerHTML=el.content,this._updateVisual(el,{stroke:!0,dash:!0},!0)},appendChildPrim:function(node,level){return Type.exists(level)?level>=Options.layer.numlayers&&(level=Options.layer.numlayers-1):level=0,this.layer[level].appendChild(node),node},createPrim:function(type,id){var node=this.container.ownerDocument.createElementNS(this.svgNamespace,type);return node.setAttributeNS(null,"id",this.container.id+"_"+id),node.style.position="absolute","path"===type&&(node.setAttributeNS(null,"stroke-linecap","round"),node.setAttributeNS(null,"stroke-linejoin","round"),node.setAttributeNS(null,"fill-rule","evenodd")),node},remove:function(shape){Type.exists(shape)&&Type.exists(shape.parentNode)&&shape.parentNode.removeChild(shape)},setLayer:function(el,level){Type.exists(level)?level>=Options.layer.numlayers&&(level=Options.layer.numlayers-1):level=0,this.layer[level].appendChild(el.rendNode)},makeArrows:function(el,a){var node2,ev_fa=a.evFirst,ev_la=a.evLast;el.visPropOld.firstarrow!==ev_fa||el.visPropOld.lastarrow!==ev_la?(ev_fa?(node2=el.rendNodeTriangleStart,Type.exists(node2)?this.defs.appendChild(node2):(node2=this._createArrowHead(el,"End",a.typeFirst),this.defs.appendChild(node2),el.rendNodeTriangleStart=node2,el.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+el.id+"TriangleEnd)"))):(node2=el.rendNodeTriangleStart,Type.exists(node2)&&this.remove(node2)),ev_la?(node2=el.rendNodeTriangleEnd,Type.exists(node2)?this.defs.appendChild(node2):(node2=this._createArrowHead(el,"Start",a.typeLast),this.defs.appendChild(node2),el.rendNodeTriangleEnd=node2,el.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+el.id+"TriangleStart)"))):(node2=el.rendNodeTriangleEnd,Type.exists(node2)&&this.remove(node2)),el.visPropOld.firstarrow=ev_fa,el.visPropOld.lastarrow=ev_la):this.isIE&&el.visPropCalc.visible&&(ev_fa||ev_la)&&el.rendNode.parentNode.insertBefore(el.rendNode,el.rendNode)},updateEllipsePrim:function(node,x,y,rx,ry){var huge;huge=2e5,x=Math.abs(x)<huge?x:huge*x/Math.abs(x),y=Math.abs(y)<huge?y:huge*y/Math.abs(y),rx=Math.abs(rx)<huge?rx:huge*rx/Math.abs(rx),ry=Math.abs(ry)<huge?ry:huge*ry/Math.abs(ry),node.setAttributeNS(null,"cx",x),node.setAttributeNS(null,"cy",y),node.setAttributeNS(null,"rx",Math.abs(rx)),node.setAttributeNS(null,"ry",Math.abs(ry))},updateLinePrim:function(node,p1x,p1y,p2x,p2y){var huge;huge=2e5,isNaN(p1x+p1y+p2x+p2y)||(p1x=Math.abs(p1x)<huge?p1x:huge*p1x/Math.abs(p1x),p1y=Math.abs(p1y)<huge?p1y:huge*p1y/Math.abs(p1y),p2x=Math.abs(p2x)<huge?p2x:huge*p2x/Math.abs(p2x),p2y=Math.abs(p2y)<huge?p2y:huge*p2y/Math.abs(p2y),node.setAttributeNS(null,"x1",p1x),node.setAttributeNS(null,"y1",p1y),node.setAttributeNS(null,"x2",p2x),node.setAttributeNS(null,"y2",p2y))},updatePathPrim:function(node,pointString){""===pointString&&(pointString="M 0 0"),node.setAttributeNS(null,"d",pointString)},updatePathStringPoint:function(el,size,type){var s="",scr=el.coords.scrCoords,sqrt32=size*Math.sqrt(3)*.5,s05=.5*size;return"x"===type?s=" M "+(scr[1]-size)+" "+(scr[2]-size)+" L "+(scr[1]+size)+" "+(scr[2]+size)+" M "+(scr[1]+size)+" "+(scr[2]-size)+" L "+(scr[1]-size)+" "+(scr[2]+size):"+"===type?s=" M "+(scr[1]-size)+" "+scr[2]+" L "+(scr[1]+size)+" "+scr[2]+" M "+scr[1]+" "+(scr[2]-size)+" L "+scr[1]+" "+(scr[2]+size):"<>"===type?s=" M "+(scr[1]-size)+" "+scr[2]+" L "+scr[1]+" "+(scr[2]+size)+" L "+(scr[1]+size)+" "+scr[2]+" L "+scr[1]+" "+(scr[2]-size)+" Z ":"^"===type?s=" M "+scr[1]+" "+(scr[2]-size)+" L "+(scr[1]-sqrt32)+" "+(scr[2]+s05)+" L "+(scr[1]+sqrt32)+" "+(scr[2]+s05)+" Z ":"v"===type?s=" M "+scr[1]+" "+(scr[2]+size)+" L "+(scr[1]-sqrt32)+" "+(scr[2]-s05)+" L "+(scr[1]+sqrt32)+" "+(scr[2]-s05)+" Z ":">"===type?s=" M "+(scr[1]+size)+" "+scr[2]+" L "+(scr[1]-s05)+" "+(scr[2]-sqrt32)+" L "+(scr[1]-s05)+" "+(scr[2]+sqrt32)+" Z ":"<"===type&&(s=" M "+(scr[1]-size)+" "+scr[2]+" L "+(scr[1]+s05)+" "+(scr[2]-sqrt32)+" L "+(scr[1]+s05)+" "+(scr[2]+sqrt32)+" Z "),s},updatePathStringPrim:function(el){var i,scr,len,nextSymb=" M ",pStr="";if(el.numberPoints<=0)return"";if(len=Math.min(el.points.length,el.numberPoints),1===el.bezierDegree)for(i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" M ":(scr[1]=Math.max(Math.min(scr[1],5e3),-5e3),scr[2]=Math.max(Math.min(scr[2],5e3),-5e3),pStr+=nextSymb+scr[1]+" "+scr[2],nextSymb=" L ");else if(3===el.bezierDegree)for(i=0;i<len;)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" M ":(pStr+=nextSymb+scr[1]+" "+scr[2]," C "===nextSymb&&(i+=1,pStr+=" "+(scr=el.points[i].scrCoords)[1]+" "+scr[2],i+=1,pStr+=" "+(scr=el.points[i].scrCoords)[1]+" "+scr[2]),nextSymb=" C "),i+=1;return pStr},updatePathStringBezierPrim:function(el){var i,j,k,scr,lx,ly,len,nextSymb=" M ",pStr="",f=Type.evaluate(el.visProp.strokewidth),isNoPlot="plot"!==Type.evaluate(el.visProp.curvetype);if(el.numberPoints<=0)return"";for(isNoPlot&&el.board.options.curve.RDPsmoothing&&(el.points=Numerics.RamerDouglasPeucker(el.points,.5)),len=Math.min(el.points.length,el.numberPoints),j=1;j<3;j++)for(nextSymb=" M ",i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" M ":(scr[1]=Math.max(Math.min(scr[1],5e3),-5e3),scr[2]=Math.max(Math.min(scr[2],5e3),-5e3)," M "===nextSymb?pStr+=nextSymb+scr[1]+" "+scr[2]:(k=2*j,pStr+=[nextSymb,lx+.333*(scr[1]-lx)+f*(k*Math.random()-j)," ",ly+.333*(scr[2]-ly)+f*(k*Math.random()-j)," ",lx+.666*(scr[1]-lx)+f*(k*Math.random()-j)," ",ly+.666*(scr[2]-ly)+f*(k*Math.random()-j)," ",scr[1]," ",scr[2]].join("")),nextSymb=" C ",lx=scr[1],ly=scr[2]);return pStr},updatePolygonPrim:function(node,el){var i,scrCoords,pStr="",len=el.vertices.length;for(node.setAttributeNS(null,"stroke","none"),"polygonalchain"===el.elType&&len++,i=0;i<len-1;i++){if(!el.vertices[i].isReal)return void node.setAttributeNS(null,"points","");pStr=pStr+(scrCoords=el.vertices[i].coords.scrCoords)[1]+","+scrCoords[2],i<len-2&&(pStr+=" ")}-1===pStr.indexOf("NaN")&&node.setAttributeNS(null,"points",pStr)},updateRectPrim:function(node,x,y,w,h){node.setAttributeNS(null,"x",x),node.setAttributeNS(null,"y",y),node.setAttributeNS(null,"width",w),node.setAttributeNS(null,"height",h)},setPropertyPrim:function(node,key,val){"stroked"!==key&&node.setAttributeNS(null,key,val)},display:function(el,val){var node;el&&el.rendNode&&(el.visPropOld.visible=val,node=el.rendNode,val?(node.setAttributeNS(null,"display","inline"),node.style.visibility="inherit"):(node.setAttributeNS(null,"display","none"),node.style.visibility="hidden"))},show:function(el){JXG.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(el,!0)},hide:function(el){JXG.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(el,!1)},setBuffering:function(el,type){el.rendNode.setAttribute("buffered-rendering",type)},setDashStyle:function(el){var dashStyle=Type.evaluate(el.visProp.dash),node=el.rendNode;dashStyle>0?node.setAttributeNS(null,"stroke-dasharray",this.dashArray[dashStyle-1]):node.hasAttributeNS(null,"stroke-dasharray")&&node.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(el){var node,node2,node3,fillNode=el.rendNode,ev_g=Type.evaluate(el.visProp.gradient);"linear"===ev_g||"radial"===ev_g?(node=this.createPrim(ev_g+"Gradient",el.id+"_gradient"),node2=this.createPrim("stop",el.id+"_gradient1"),node3=this.createPrim("stop",el.id+"_gradient2"),node.appendChild(node2),node.appendChild(node3),this.defs.appendChild(node),fillNode.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+el.id+"_gradient)"),el.gradNode1=node2,el.gradNode2=node3,el.gradNode=node):fillNode.removeAttributeNS(null,"style")},updateGradientAngle:function(node,radians){var f=1,co=Math.cos(radians),si=Math.sin(radians);Math.abs(co)>Math.abs(si)?f/=Math.abs(co):f/=Math.abs(si),co>=0?(node.setAttributeNS(null,"x1",0),node.setAttributeNS(null,"x2",co*f)):(node.setAttributeNS(null,"x1",-co*f),node.setAttributeNS(null,"x2",0)),si>=0?(node.setAttributeNS(null,"y1",0),node.setAttributeNS(null,"y2",si*f)):(node.setAttributeNS(null,"y1",-si*f),node.setAttributeNS(null,"y2",0))},updateGradientCircle:function(node,cx,cy,r,fx,fy,fr){node.setAttributeNS(null,"cx",100*cx+"%"),node.setAttributeNS(null,"cy",100*cy+"%"),node.setAttributeNS(null,"r",100*r+"%"),node.setAttributeNS(null,"fx",100*fx+"%"),node.setAttributeNS(null,"fy",100*fy+"%"),node.setAttributeNS(null,"fr",100*fr+"%")},updateGradient:function(el){var col,op,node2=el.gradNode1,node3=el.gradNode2,ev_g=Type.evaluate(el.visProp.gradient);Type.exists(node2)&&Type.exists(node3)&&(op=(op=Type.evaluate(el.visProp.fillopacity))>0?op:0,col=Type.evaluate(el.visProp.fillcolor),node2.setAttributeNS(null,"style","stop-color:"+col+";stop-opacity:"+op),node3.setAttributeNS(null,"style","stop-color:"+Type.evaluate(el.visProp.gradientsecondcolor)+";stop-opacity:"+Type.evaluate(el.visProp.gradientsecondopacity)),node2.setAttributeNS(null,"offset",100*Type.evaluate(el.visProp.gradientstartoffset)+"%"),node3.setAttributeNS(null,"offset",100*Type.evaluate(el.visProp.gradientendoffset)+"%"),"linear"===ev_g?this.updateGradientAngle(el.gradNode,Type.evaluate(el.visProp.gradientangle)):"radial"===ev_g&&this.updateGradientCircle(el.gradNode,Type.evaluate(el.visProp.gradientcx),Type.evaluate(el.visProp.gradientcy),Type.evaluate(el.visProp.gradientr),Type.evaluate(el.visProp.gradientfx),Type.evaluate(el.visProp.gradientfy),Type.evaluate(el.visProp.gradientfr)))},setObjectTransition:function(el,duration){var transitionStr,i,len,nodes=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(void 0===duration&&(duration=Type.evaluate(el.visProp.transitionduration)),duration!==el.visPropOld.transitionduration){for(transitionStr=el.elementClass===Const.OBJECT_CLASS_TEXT&&"html"===Type.evaluate(el.visProp.display)?" color "+duration+"ms, opacity "+duration+"ms":" fill "+duration+"ms, fill-opacity "+duration+"ms, stroke "+duration+"ms, stroke-opacity "+duration+"ms",len=nodes.length,i=0;i<len;++i)el[nodes[i]]&&(el[nodes[i]].style.transition=transitionStr);el.visPropOld.transitionduration=duration}},_setAttribute:function(setFunc,testAttribute){""===testAttribute?setFunc():window.setTimeout(setFunc,1)},setObjectFillColor:function(el,color,opacity,rendNode){var node,c,rgbo,oo,rgba=Type.evaluate(color),o=Type.evaluate(opacity),grad=Type.evaluate(el.visProp.gradient);o=o>0?o:0,el.visPropOld.fillcolor===rgba&&el.visPropOld.fillopacity===o&&null===grad||(Type.exists(rgba)&&!1!==rgba&&(9!==rgba.length?(c=rgba,oo=o):(rgbo=Color.rgba2rgbo(rgba),c=rgbo[0],oo=o*rgbo[1]),node=void 0===rendNode?el.rendNode:rendNode,"none"!==c&&this._setAttribute((function(){node.setAttributeNS(null,"fill",c)}),el.visPropOld.fillcolor),el.type===JXG.OBJECT_TYPE_IMAGE?this._setAttribute((function(){node.setAttributeNS(null,"opacity",oo)}),el.visPropOld.fillopacity):("none"===c?(oo=0,node.setAttributeNS(null,"pointer-events","visibleStroke")):node.setAttributeNS(null,"pointer-events","visiblePainted"),this._setAttribute((function(){node.setAttributeNS(null,"fill-opacity",oo)}),el.visPropOld.fillopacity)),"linear"!==grad&&"radial"!==grad||this.updateGradient(el)),el.visPropOld.fillcolor=rgba,el.visPropOld.fillopacity=o)},setObjectStrokeColor:function(el,color,opacity){var c,rgbo,oo,node,rgba=Type.evaluate(color),o=Type.evaluate(opacity);o=o>0?o:0,el.visPropOld.strokecolor===rgba&&el.visPropOld.strokeopacity===o||(Type.exists(rgba)&&!1!==rgba&&(9!==rgba.length?(c=rgba,oo=o):(rgbo=Color.rgba2rgbo(rgba),c=rgbo[0],oo=o*rgbo[1]),node=el.rendNode,el.elementClass===Const.OBJECT_CLASS_TEXT?"html"===Type.evaluate(el.visProp.display)?this._setAttribute((function(){node.style.color=c,node.style.opacity=oo}),el.visPropOld.strokecolor):this._setAttribute((function(){node.setAttributeNS(null,"style","fill:"+c),node.setAttributeNS(null,"style","fill-opacity:"+oo)}),el.visPropOld.strokecolor):this._setAttribute((function(){node.setAttributeNS(null,"stroke",c),node.setAttributeNS(null,"stroke-opacity",oo)}),el.visPropOld.strokecolor),el.elementClass!==Const.OBJECT_CLASS_CURVE&&el.elementClass!==Const.OBJECT_CLASS_LINE||(Type.evaluate(el.visProp.firstarrow)&&this._setArrowColor(el.rendNodeTriangleStart,c,oo,el,el.visPropCalc.typeFirst),Type.evaluate(el.visProp.lastarrow)&&this._setArrowColor(el.rendNodeTriangleEnd,c,oo,el,el.visPropCalc.typeLast))),el.visPropOld.strokecolor=rgba,el.visPropOld.strokeopacity=o)},setObjectStrokeWidth:function(el,width){var node,w=Type.evaluate(width);isNaN(w)||el.visPropOld.strokewidth===w||(node=el.rendNode,this.setPropertyPrim(node,"stroked","true"),Type.exists(w)&&this.setPropertyPrim(node,"stroke-width",w+"px"),el.visPropOld.strokewidth=w)},setLineCap:function(el){var capStyle=Type.evaluate(el.visProp.linecap);void 0!==capStyle&&""!==capStyle&&el.visPropOld.linecap!==capStyle&&Type.exists(el.rendNode)&&(this.setPropertyPrim(el.rendNode,"stroke-linecap",capStyle),el.visPropOld.linecap=capStyle)},setShadow:function(el){var ev_s=Type.evaluate(el.visProp.shadow);el.visPropOld.shadow!==ev_s&&(Type.exists(el.rendNode)&&(ev_s?el.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):el.rendNode.removeAttributeNS(null,"filter")),el.visPropOld.shadow=ev_s)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(w,h){this.svgRoot.setAttribute("width",parseFloat(w)),this.svgRoot.setAttribute("height",parseFloat(h))},createTouchpoints:function(n){var i,na1,na2,node;for(this.touchpoints=[],i=0;i<n;i++)na1="touchpoint1_"+i,node=this.createPrim("path",na1),this.appendChildPrim(node,19),node.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(node),this.setPropertyPrim(node,"stroked","true"),this.setPropertyPrim(node,"stroke-width","1px"),node.setAttributeNS(null,"stroke","#000000"),node.setAttributeNS(null,"stroke-opacity",1),node.setAttributeNS(null,"display","none"),na2="touchpoint2_"+i,node=this.createPrim("ellipse",na2),this.appendChildPrim(node,19),this.updateEllipsePrim(node,0,0,0,0),this.touchpoints.push(node),this.setPropertyPrim(node,"stroked","true"),this.setPropertyPrim(node,"stroke-width","1px"),node.setAttributeNS(null,"stroke","#000000"),node.setAttributeNS(null,"stroke-opacity",1),node.setAttributeNS(null,"fill","#ffffff"),node.setAttributeNS(null,"fill-opacity",0),node.setAttributeNS(null,"display","none")},showTouchpoint:function(i){this.touchpoints&&i>=0&&2*i<this.touchpoints.length&&(this.touchpoints[2*i].setAttributeNS(null,"display","inline"),this.touchpoints[2*i+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(i){this.touchpoints&&i>=0&&2*i<this.touchpoints.length&&(this.touchpoints[2*i].setAttributeNS(null,"display","none"),this.touchpoints[2*i+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(i,pos){var x,y;this.touchpoints&&i>=0&&2*i<this.touchpoints.length&&(x=pos[0],y=pos[1],this.touchpoints[2*i].setAttributeNS(null,"d","M "+(x-37)+" "+y+" L "+(x+37)+" "+y+" M "+x+" "+(y-37)+" L "+x+" "+(y+37)),this.updateEllipsePrim(this.touchpoints[2*i+1],pos[0],pos[1],25,25))},_getValuesOfDOMElements:function(node){var values=[];if(1===node.nodeType)for(node=node.firstChild;node;)void 0!==node.id&&void 0!==node.value&&values.push([node.id,node.value]),values=values.concat(this._getValuesOfDOMElements(node)),node=node.nextSibling;return values},_getDataUri:function(url,callback){var image=new Image;image.onload=function(){var canvas=document.createElement("canvas");canvas.width=this.naturalWidth,canvas.height=this.naturalHeight,canvas.getContext("2d").drawImage(this,0,0),callback(canvas.toDataURL("image/png")),canvas.remove()},image.src=url},_getImgDataURL:function(svgRoot){var images,len,canvas,ctx,ur,i;if((len=(images=svgRoot.getElementsByTagName("image")).length)>0)for(canvas=document.createElement("canvas"),i=0;i<len;i++){images[i].setAttribute("crossorigin","anonymous"),ctx=canvas.getContext("2d"),canvas.width=images[i].getAttribute("width"),canvas.height=images[i].getAttribute("height");try{ctx.drawImage(images[i],0,0,canvas.width,canvas.height),ur=canvas.toDataURL(),images[i].setAttribute("xlink:href",ur)}catch(err){console.log("CORS problem! Image can not be used",err)}}return!0},dumpToDataURI:function(ignoreTexts){var svg,i,len,svgRoot=this.svgRoot,btoa=window.btoa||Base64.encode,values=[];if(this.container.hasChildNodes()&&Type.exists(this.foreignObjLayer))for(ignoreTexts||this.foreignObjLayer.setAttribute("display","inline");svgRoot.nextSibling;)values=values.concat(this._getValuesOfDOMElements(svgRoot.nextSibling)),this.foreignObjLayer.appendChild(svgRoot.nextSibling);if(this._getImgDataURL(svgRoot),svgRoot.setAttribute("xmlns","http://www.w3.org/2000/svg"),svg=(new XMLSerializer).serializeToString(svgRoot),!0!==ignoreTexts)for(len=values.length,i=0;i<len;i++)svg=svg.replace('id="'+values[i][0]+'"','id="'+values[i][0]+'" value="'+values[i][1]+'"');if((svg.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g)||[]).length>1&&(svg=svg.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")),svg=svg.replace(/&nbsp;/g," "),Type.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes()){for(;this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);this.foreignObjLayer.setAttribute("display","none")}return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(svg)))},dumpToCanvas:function(canvasId,w,h,ignoreTexts){var svg,tmpImg,cv,ctx;return(cv=this.container.ownerDocument.getElementById(canvasId)).width=cv.width,ctx=cv.getContext("2d"),void 0!==w&&void 0!==h&&(cv.style.width=parseFloat(w)+"px",cv.style.height=parseFloat(h)+"px",cv.setAttribute("width",parseFloat(w)),cv.setAttribute("height",parseFloat(h))),tmpImg=new Image,svg=this.dumpToDataURI(ignoreTexts),tmpImg.src=svg,"Promise"in window?new Promise((function(resolve,reject){try{tmpImg.onload=function(){ctx.drawImage(tmpImg,0,0,w,h),resolve()}}catch(e){reject(e)}})):(tmpImg.onload=function(){window.setTimeout((function(){try{ctx.drawImage(tmpImg,0,0,w,h)}catch(err){console.log("screenshots not longer supported on IE")}}),200)},this)},screenshot:function(board,imgId,ignoreTexts){var node,canvas,id,img,button,buttonText,w,h,zbar,zbarDisplay,_copyCanvasToImg,doc=this.container.ownerDocument,parent=this.container.parentNode,bas=board.attr.screenshot,newImg=!1;return"no"===this.type||(w=bas.scale*this.container.getBoundingClientRect().width,h=bas.scale*this.container.getBoundingClientRect().height,void 0===imgId||""===imgId?(newImg=!0,(img=new Image).style.width=w+"px",img.style.height=h+"px"):(newImg=!1,img=doc.getElementById(imgId)),newImg&&((node=doc.createElement("div")).style.cssText=bas.css,node.style.width=w+"px",node.style.height=h+"px",node.style.zIndex=this.container.style.zIndex+120,node.style.position="absolute",node.style.top=this.container.offsetTop+"px",node.style.left=this.container.offsetLeft+"px"),canvas=doc.createElement("canvas"),id=Math.random().toString(36).substr(2,5),canvas.setAttribute("id",id),canvas.setAttribute("width",w),canvas.setAttribute("height",h),canvas.style.width=w+"px",canvas.style.height=w+"px",canvas.style.display="none",parent.appendChild(canvas),newImg&&(button=doc.createElement("span"),buttonText=doc.createTextNode("✖"),button.style.cssText=bas.cssButton,button.appendChild(buttonText),button.onclick=function(){node.parentNode.removeChild(node)},node.appendChild(img),node.appendChild(button),parent.insertBefore(node,this.container.nextSibling)),zbar=doc.getElementById(this.container.id+"_navigationbar"),Type.exists(zbar)&&(zbarDisplay=zbar.style.display,zbar.style.display="none"),_copyCanvasToImg=function(){img.src=canvas.toDataURL("image/png"),parent.removeChild(canvas)},"Promise"in window?this.dumpToCanvas(id,w,h,ignoreTexts).then(_copyCanvasToImg):(this.dumpToCanvas(id,w,h,ignoreTexts),window.setTimeout(_copyCanvasToImg,200)),Type.exists(zbar)&&(zbar.style.display=zbarDisplay)),this}}),JXG.SVGRenderer})),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],(function(JXG,AbstractRenderer,Const,Type,Color,Mat,Numerics){return JXG.VMLRenderer=function(container){this.type="vml",this.container=container,this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,Type.exists(JXG.vmlStylesheet)||(container.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),JXG.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),JXG.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{container.ownerDocument.namespaces.jxgvml||container.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(tagName){return container.ownerDocument.createElement("<jxgvml:"+tagName+' class="jxgvml">')}}catch(e){this.createNode=function(tagName){return container.ownerDocument.createElement("<"+tagName+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},JXG.VMLRenderer.prototype=new AbstractRenderer,JXG.extend(JXG.VMLRenderer.prototype,{_setAttr:function(node,key,val,iFlag){try{8===this.container.ownerDocument.documentMode?node[key]=val:node.setAttribute(key,val,iFlag)}catch(e){JXG.debug("_setAttr: "+key+" "+val+"<br>\n")}},updateTicks:function(ticks){var i,len,c,x,y,r=this.resolution,tickArr=[];for(len=ticks.ticks.length,i=0;i<len;i++)x=(c=ticks.ticks[i])[0],y=c[1],Type.isNumber(x[0])&&Type.isNumber(x[1])&&tickArr.push(" m "+Math.round(r*x[0])+", "+Math.round(r*y[0])+" l "+Math.round(r*x[1])+", "+Math.round(r*y[1])+" ");Type.exists(ticks.rendNode)||(ticks.rendNode=this.createPrim("path",ticks.id),this.appendChildPrim(ticks.rendNode,Type.evaluate(ticks.visProp.layer))),this._setAttr(ticks.rendNode,"stroked","true"),this._setAttr(ticks.rendNode,"strokecolor",Type.evaluate(ticks.visProp.strokecolor),1),this._setAttr(ticks.rendNode,"strokeweight",Type.evaluate(ticks.visProp.strokewidth)),this._setAttr(ticks.rendNodeStroke,"opacity",100*Type.evaluate(ticks.visProp.strokeopacity)+"%"),this.updatePathPrim(ticks.rendNode,tickArr,ticks.board)},displayCopyright:function(str,fontsize){var node,t;(node=this.createNode("textbox")).style.position="absolute",this._setAttr(node,"id",this.container.id+"_licenseText"),node.style.left=20,node.style.top=2,node.style.fontSize=fontsize,node.style.color="#356AA0",node.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(node,"opacity","30%"),node.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",t=this.container.ownerDocument.createTextNode(str),node.appendChild(t),this.appendChildPrim(node,0)},drawInternalText:function(el){var node;return(node=this.createNode("textbox")).style.position="absolute",el.rendNodeText=this.container.ownerDocument.createTextNode(""),node.appendChild(el.rendNodeText),this.appendChildPrim(node,9),node.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",node},updateInternalText:function(el){var v,maxX,maxY,minX,minY,i,content=el.plaintext,m=this.joinTransforms(el,el.transformations),offset=[0,0],node=el.rendNode,p=[],ev_ax=el.getAnchorX(),ev_ay=el.getAnchorY();if(!isNaN(el.coords.scrCoords[1]+el.coords.scrCoords[2])){for("right"===ev_ax?offset[0]=1:"middle"===ev_ax&&(offset[0]=.5),"bottom"===ev_ay?offset[1]=1:"middle"===ev_ay&&(offset[1]=.5),p[0]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]-offset[0]*el.size[0],el.coords.scrCoords[2]+(1-offset[1])*el.size[1]+this.vOffsetText]),p[0][1]/=p[0][0],p[0][2]/=p[0][0],p[1]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]+(1-offset[0])*el.size[0],el.coords.scrCoords[2]+(1-offset[1])*el.size[1]+this.vOffsetText]),p[1][1]/=p[1][0],p[1][2]/=p[1][0],p[2]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]+(1-offset[0])*el.size[0],el.coords.scrCoords[2]-offset[1]*el.size[1]+this.vOffsetText]),p[2][1]/=p[2][0],p[2][2]/=p[2][0],p[3]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]-offset[0]*el.size[0],el.coords.scrCoords[2]-offset[1]*el.size[1]+this.vOffsetText]),p[3][1]/=p[3][0],p[3][2]/=p[3][0],maxX=p[0][1],minX=p[0][1],maxY=p[0][2],minY=p[0][2],i=1;i<4;i++)maxX=Math.max(maxX,p[i][1]),minX=Math.min(minX,p[i][1]),maxY=Math.max(maxY,p[i][2]),minY=Math.min(minY,p[i][2]);v=1===offset[0]?Math.floor(el.board.canvasWidth-maxX):Math.floor(minX),el.visPropOld.left!==ev_ax+v&&(1===offset[0]?(el.rendNode.style.right=v+"px",el.rendNode.style.left="auto"):(el.rendNode.style.left=v+"px",el.rendNode.style.right="auto"),el.visPropOld.left=ev_ax+v),v=1===offset[1]?Math.floor(el.board.canvasHeight-maxY):Math.floor(minY),el.visPropOld.top!==ev_ay+v&&(1===offset[1]?(el.rendNode.style.bottom=v+"px",el.rendNode.style.top="auto"):(el.rendNode.style.top=v+"px",el.rendNode.style.bottom="auto"),el.visPropOld.top=ev_ay+v)}el.htmlStr!==content&&(el.rendNodeText.data=content,el.htmlStr=content),node.filters.item(0).M11=m[1][1],node.filters.item(0).M12=m[1][2],node.filters.item(0).M21=m[2][1],node.filters.item(0).M22=m[2][2],node.filters.item(0).enabled=!0},drawImage:function(el){var node;(node=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(node,"id",this.container.id+"_"+el.id),this.container.appendChild(node),this.appendChildPrim(node,Type.evaluate(el.visProp.layer)),node.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",el.rendNode=node,this.updateImage(el)},transformImage:function(el,t){var m,maxX,maxY,minX,minY,i,node=el.rendNode,p=[];if(t.length>0){for(m=this.joinTransforms(el,t),p[0]=Mat.matVecMult(m,el.coords.scrCoords),p[0][1]/=p[0][0],p[0][2]/=p[0][0],p[1]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]+el.size[0],el.coords.scrCoords[2]]),p[1][1]/=p[1][0],p[1][2]/=p[1][0],p[2]=Mat.matVecMult(m,[1,el.coords.scrCoords[1]+el.size[0],el.coords.scrCoords[2]-el.size[1]]),p[2][1]/=p[2][0],p[2][2]/=p[2][0],p[3]=Mat.matVecMult(m,[1,el.coords.scrCoords[1],el.coords.scrCoords[2]-el.size[1]]),p[3][1]/=p[3][0],p[3][2]/=p[3][0],maxX=p[0][1],minX=p[0][1],maxY=p[0][2],minY=p[0][2],i=1;i<4;i++)maxX=Math.max(maxX,p[i][1]),minX=Math.min(minX,p[i][1]),maxY=Math.max(maxY,p[i][2]),minY=Math.min(minY,p[i][2]);node.style.left=Math.floor(minX)+"px",node.style.top=Math.floor(minY)+"px",node.filters.item(0).M11=m[1][1],node.filters.item(0).M12=m[1][2],node.filters.item(0).M21=m[2][1],node.filters.item(0).M22=m[2][2],node.filters.item(0).enabled=!0}},updateImageURL:function(el){var url=Type.evaluate(el.url);this._setAttr(el.rendNode,"src",url)},appendChildPrim:function(node,level){return Type.exists(level)||(level=0),node.style.zIndex=level,this.container.appendChild(node),node},appendNodesToElement:function(el,type){"shape"!==type&&"path"!==type&&"polygon"!==type||(el.rendNodePath=this.getElementById(el.id+"_path")),el.rendNodeFill=this.getElementById(el.id+"_fill"),el.rendNodeStroke=this.getElementById(el.id+"_stroke"),el.rendNodeShadow=this.getElementById(el.id+"_shadow"),el.rendNode=this.getElementById(el.id)},createPrim:function(type,id){var node,pathNode,fillNode=this.createNode("fill"),strokeNode=this.createNode("stroke"),shadowNode=this.createNode("shadow");return this._setAttr(fillNode,"id",this.container.id+"_"+id+"_fill"),this._setAttr(strokeNode,"id",this.container.id+"_"+id+"_stroke"),this._setAttr(shadowNode,"id",this.container.id+"_"+id+"_shadow"),"circle"===type||"ellipse"===type?((node=this.createNode("oval")).appendChild(fillNode),node.appendChild(strokeNode),node.appendChild(shadowNode)):"polygon"===type||"path"===type||"shape"===type||"line"===type?((node=this.createNode("shape")).appendChild(fillNode),node.appendChild(strokeNode),node.appendChild(shadowNode),pathNode=this.createNode("path"),this._setAttr(pathNode,"id",this.container.id+"_"+id+"_path"),node.appendChild(pathNode)):((node=this.createNode(type)).appendChild(fillNode),node.appendChild(strokeNode),node.appendChild(shadowNode)),node.style.position="absolute",node.style.left="0px",node.style.top="0px",this._setAttr(node,"id",this.container.id+"_"+id),node},remove:function(node){Type.exists(node)&&node.removeNode(!0)},makeArrows:function(el){var nodeStroke,ev_fa=Type.evaluate(el.visProp.firstarrow),ev_la=Type.evaluate(el.visProp.lastarrow);el.visPropOld.firstarrow===ev_fa&&el.visPropOld.lastarrow===ev_la||(ev_fa?(nodeStroke=el.rendNodeStroke,this._setAttr(nodeStroke,"startarrow","block"),this._setAttr(nodeStroke,"startarrowlength","long")):(nodeStroke=el.rendNodeStroke,Type.exists(nodeStroke)&&this._setAttr(nodeStroke,"startarrow","none")),ev_la?(nodeStroke=el.rendNodeStroke,this._setAttr(nodeStroke,"id",this.container.id+"_"+el.id+"stroke"),this._setAttr(nodeStroke,"endarrow","block"),this._setAttr(nodeStroke,"endarrowlength","long")):(nodeStroke=el.rendNodeStroke,Type.exists(nodeStroke)&&this._setAttr(nodeStroke,"endarrow","none")),el.visPropOld.firstarrow=ev_fa,el.visPropOld.lastarrow=ev_la)},updateEllipsePrim:function(node,x,y,rx,ry){node.style.left=Math.floor(x-rx)+"px",node.style.top=Math.floor(y-ry)+"px",node.style.width=Math.floor(2*Math.abs(rx))+"px",node.style.height=Math.floor(2*Math.abs(ry))+"px"},updateLinePrim:function(node,p1x,p1y,p2x,p2y,board){var s,r=this.resolution;isNaN(p1x+p1y+p2x+p2y)||(s=["m ",Math.floor(r*p1x),", ",Math.floor(r*p1y)," l ",Math.floor(r*p2x),", ",Math.floor(r*p2y)],this.updatePathPrim(node,s,board))},updatePathPrim:function(node,pointString,board){var x=board.canvasWidth,y=board.canvasHeight;pointString.length<=0&&(pointString=["m 0,0"]),node.style.width=x,node.style.height=y,this._setAttr(node,"coordsize",[Math.floor(this.resolution*x),Math.floor(this.resolution*y)].join(",")),this._setAttr(node,"path",pointString.join(""))},updatePathStringPoint:function(el,size,type){var s=[],mround=Math.round,scr=el.coords.scrCoords,sqrt32=size*Math.sqrt(3)*.5,s05=.5*size,r=this.resolution;return"x"===type?s.push([" m ",mround(r*(scr[1]-size)),", ",mround(r*(scr[2]-size))," l ",mround(r*(scr[1]+size)),", ",mround(r*(scr[2]+size))," m ",mround(r*(scr[1]+size)),", ",mround(r*(scr[2]-size))," l ",mround(r*(scr[1]-size)),", ",mround(r*(scr[2]+size))].join("")):"+"===type?s.push([" m ",mround(r*(scr[1]-size)),", ",mround(r*scr[2])," l ",mround(r*(scr[1]+size)),", ",mround(r*scr[2])," m ",mround(r*scr[1]),", ",mround(r*(scr[2]-size))," l ",mround(r*scr[1]),", ",mround(r*(scr[2]+size))].join("")):"<>"===type?s.push([" m ",mround(r*(scr[1]-size)),", ",mround(r*scr[2])," l ",mround(r*scr[1]),", ",mround(r*(scr[2]+size))," l ",mround(r*(scr[1]+size)),", ",mround(r*scr[2])," l ",mround(r*scr[1]),", ",mround(r*(scr[2]-size))," x e "].join("")):"^"===type?s.push([" m ",mround(r*scr[1]),", ",mround(r*(scr[2]-size))," l ",mround(r*(scr[1]-sqrt32)),", ",mround(r*(scr[2]+s05))," l ",mround(r*(scr[1]+sqrt32)),", ",mround(r*(scr[2]+s05))," x e "].join("")):"v"===type?s.push([" m ",mround(r*scr[1]),", ",mround(r*(scr[2]+size))," l ",mround(r*(scr[1]-sqrt32)),", ",mround(r*(scr[2]-s05))," l ",mround(r*(scr[1]+sqrt32)),", ",mround(r*(scr[2]-s05))," x e "].join("")):">"===type?s.push([" m ",mround(r*(scr[1]+size)),", ",mround(r*scr[2])," l ",mround(r*(scr[1]-s05)),", ",mround(r*(scr[2]-sqrt32))," l ",mround(r*(scr[1]-s05)),", ",mround(r*(scr[2]+sqrt32))," l ",mround(r*(scr[1]+size)),", ",mround(r*scr[2])].join("")):"<"===type&&s.push([" m ",mround(r*(scr[1]-size)),", ",mround(r*scr[2])," l ",mround(r*(scr[1]+s05)),", ",mround(r*(scr[2]-sqrt32))," l ",mround(r*(scr[1]+s05)),", ",mround(r*(scr[2]+sqrt32))," x e "].join("")),s},updatePathStringPrim:function(el){var i,scr,pStr=[],r=this.resolution,mround=Math.round,nextSymb=" m ",len=Math.min(el.numberPoints,8192);if(el.numberPoints<=0)return"";if(len=Math.min(len,el.points.length),1===el.bezierDegree)for(i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" m ":(scr[1]>2e4?scr[1]=2e4:scr[1]<-2e4&&(scr[1]=-2e4),scr[2]>2e4?scr[2]=2e4:scr[2]<-2e4&&(scr[2]=-2e4),pStr.push([nextSymb,mround(r*scr[1]),", ",mround(r*scr[2])].join("")),nextSymb=" l ");else if(3===el.bezierDegree)for(i=0;i<len;)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" m ":(pStr.push([nextSymb,mround(r*scr[1]),", ",mround(r*scr[2])].join(""))," c "===nextSymb&&(i+=1,scr=el.points[i].scrCoords,pStr.push([" ",mround(r*scr[1]),", ",mround(r*scr[2])].join("")),i+=1,scr=el.points[i].scrCoords,pStr.push([" ",mround(r*scr[1]),", ",mround(r*scr[2])].join(""))),nextSymb=" c "),i+=1;return pStr.push(" e"),pStr},updatePathStringBezierPrim:function(el){var i,j,k,scr,lx,ly,pStr=[],f=Type.evaluate(el.visProp.strokewidth),r=this.resolution,mround=Math.round,nextSymb=" m ",isNoPlot="plot"!==Type.evaluate(el.visProp.curvetype),len=Math.min(el.numberPoints,8192);if(el.numberPoints<=0)return"";for(isNoPlot&&el.board.options.curve.RDPsmoothing&&(el.points=Numerics.RamerDouglasPeucker(el.points,1)),len=Math.min(len,el.points.length),j=1;j<3;j++)for(nextSymb=" m ",i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb=" m ":(scr[1]>2e4?scr[1]=2e4:scr[1]<-2e4&&(scr[1]=-2e4),scr[2]>2e4?scr[2]=2e4:scr[2]<-2e4&&(scr[2]=-2e4)," m "===nextSymb?pStr.push([nextSymb,mround(r*scr[1])," ",mround(r*scr[2])].join("")):(k=2*j,pStr.push([nextSymb,mround(r*(lx+.333*(scr[1]-lx)+f*(k*Math.random()-j)))," ",mround(r*(ly+.333*(scr[2]-ly)+f*(k*Math.random()-j)))," ",mround(r*(lx+.666*(scr[1]-lx)+f*(k*Math.random()-j)))," ",mround(r*(ly+.666*(scr[2]-ly)+f*(k*Math.random()-j)))," ",mround(r*scr[1])," ",mround(r*scr[2])].join(""))),nextSymb=" c ",lx=scr[1],ly=scr[2]);return pStr.push(" e"),pStr},updatePolygonPrim:function(node,el){var i,scr,len=el.vertices.length,r=this.resolution,pStr=[];if(this._setAttr(node,"stroked","false"),scr=el.vertices[0].coords.scrCoords,!isNaN(scr[1]+scr[2])){for(pStr.push(["m ",Math.floor(r*scr[1]),",",Math.floor(r*scr[2])," l "].join("")),i=1;i<len-1;i++){if(!el.vertices[i].isReal)return void this.updatePathPrim(node,"",el.board);if(scr=el.vertices[i].coords.scrCoords,isNaN(scr[1]+scr[2]))return;pStr.push(Math.floor(r*scr[1])+","+Math.floor(r*scr[2])),i<len-2&&pStr.push(", ")}pStr.push(" x e"),this.updatePathPrim(node,pStr,el.board)}},updateRectPrim:function(node,x,y,w,h){node.style.left=Math.floor(x)+"px",node.style.top=Math.floor(y)+"px",w>=0&&(node.style.width=w+"px"),h>=0&&(node.style.height=h+"px")},setPropertyPrim:function(node,key,val){var v,keyVml="";switch(key){case"stroke":keyVml="strokecolor";break;case"stroke-width":keyVml="strokeweight";break;case"stroke-dasharray":keyVml="dashstyle"}""!==keyVml&&(v=Type.evaluate(val),this._setAttr(node,keyVml,v))},display:function(el,val){el&&el.rendNode&&(el.visPropOld.visible=val,el.rendNode.style.visibility=val?"inherit":"hidden")},show:function(el){JXG.deprecated("Board.renderer.show()","Board.renderer.display()"),el&&el.rendNode&&(el.rendNode.style.visibility="inherit")},hide:function(el){JXG.deprecated("Board.renderer.hide()","Board.renderer.display()"),el&&el.rendNode&&(el.rendNode.style.visibility="hidden")},setDashStyle:function(el,visProp){var node;visProp.dash>=0&&(node=el.rendNodeStroke,this._setAttr(node,"dashstyle",this.dashArray[visProp.dash]))},setGradient:function(el){var nodeFill=el.rendNodeFill,ev_g=Type.evaluate(el.visProp.gradient);"linear"===ev_g?(this._setAttr(nodeFill,"type","gradient"),this._setAttr(nodeFill,"color2",Type.evaluate(el.visProp.gradientsecondcolor)),this._setAttr(nodeFill,"opacity2",Type.evaluate(el.visProp.gradientsecondopacity)),this._setAttr(nodeFill,"angle",Type.evaluate(el.visProp.gradientangle))):"radial"===ev_g?(this._setAttr(nodeFill,"type","gradientradial"),this._setAttr(nodeFill,"color2",Type.evaluate(el.visProp.gradientsecondcolor)),this._setAttr(nodeFill,"opacity2",Type.evaluate(el.visProp.gradientsecondopacity)),this._setAttr(nodeFill,"focusposition",100*Type.evaluate(el.visProp.gradientpositionx)+"%,"+100*Type.evaluate(el.visProp.gradientpositiony)+"%"),this._setAttr(nodeFill,"focussize","0,0")):this._setAttr(nodeFill,"type","solid")},setObjectFillColor:function(el,color,opacity){var c,rgbo,oo,rgba=Type.evaluate(color),o=Type.evaluate(opacity),node=el.rendNode;o=o>0?o:0,el.visPropOld.fillcolor===rgba&&el.visPropOld.fillopacity===o||(Type.exists(rgba)&&!1!==rgba&&(9!==rgba.length?(c=rgba,oo=o):(c=(rgbo=Color.rgba2rgbo(rgba))[0],oo=o*rgbo[1]),"none"===c||!1===c?this._setAttr(el.rendNode,"filled","false"):(this._setAttr(el.rendNode,"filled","true"),this._setAttr(el.rendNode,"fillcolor",c),Type.exists(oo)&&el.rendNodeFill&&this._setAttr(el.rendNodeFill,"opacity",100*oo+"%")),el.type===Const.OBJECT_TYPE_IMAGE&&node.filters.length>1&&(node.filters.item(1).opacity=Math.round(100*oo),node.filters.item(1).enabled=!0)),el.visPropOld.fillcolor=rgba,el.visPropOld.fillopacity=o)},setObjectStrokeColor:function(el,color,opacity){var c,rgbo,oo,nodeStroke,rgba=Type.evaluate(color),o=Type.evaluate(opacity),node=el.rendNode;o=o>0?o:0,el.visPropOld.strokecolor===rgba&&el.visPropOld.strokeopacity===o||(Type.exists(rgba)&&!1!==rgba&&(9!==rgba.length?(c=rgba,oo=o):(c=(rgbo=color.rgba2rgbo(rgba))[0],oo=o*rgbo[1]),el.elementClass===Const.OBJECT_CLASS_TEXT?(node.filters.length>1&&(node.filters.item(1).opacity=Math.round(100*oo),node.filters.item(1).enabled=!0),node.style.color=c):(!1!==c&&(this._setAttr(node,"stroked","true"),this._setAttr(node,"strokecolor",c)),nodeStroke=el.rendNodeStroke,Type.exists(oo)&&el.type!==Const.OBJECT_TYPE_IMAGE&&this._setAttr(nodeStroke,"opacity",100*oo+"%"))),el.visPropOld.strokecolor=rgba,el.visPropOld.strokeopacity=o)},setObjectStrokeWidth:function(el,width){var node,w=Type.evaluate(width);isNaN(w)||el.visPropOld.strokewidth===w||(node=el.rendNode,this.setPropertyPrim(node,"stroked","true"),Type.exists(w)&&(this.setPropertyPrim(node,"stroke-width",w),0===w&&Type.exists(el.rendNodeStroke)&&this._setAttr(node,"stroked","false")),el.visPropOld.strokewidth=w)},setShadow:function(el){var nodeShadow=el.rendNodeShadow,ev_s=Type.evaluate(el.visProp.shadow);nodeShadow&&el.visPropOld.shadow!==ev_s&&(ev_s?(this._setAttr(nodeShadow,"On","True"),this._setAttr(nodeShadow,"Offset","3pt,3pt"),this._setAttr(nodeShadow,"Opacity","60%"),this._setAttr(nodeShadow,"Color","#aaaaaa")):this._setAttr(nodeShadow,"On","False"),el.visPropOld.shadow=ev_s)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),JXG.VMLRenderer})),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],(function(JXG,AbstractRenderer,Const,Env,Type,UUID,Color,Coords,Mat,Geometry,Numerics){return JXG.CanvasRenderer=function(container,dim){if(this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=UUID.genUUID(),this.canvasNamespace=null,Env.isBrowser)this.container=container,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',dim.width,'px" height="',dim.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.canvasRoot.style.display="block",this.context=this.canvasRoot.getContext("2d");else if(Env.isNode())try{this.canvasId="object"===("undefined"==typeof module?"undefined":_typeof(module))?module.require("canvas"):require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")}catch(err){console.log("Warning: 'canvas' not found. You might need to call 'npm install canvas'")}this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},JXG.CanvasRenderer.prototype=new AbstractRenderer,JXG.extend(JXG.CanvasRenderer.prototype,{_drawPolygon:function(shape,degree,doFill){var i,len=shape.length,context=this.context;if(len>0){if(doFill&&(context.lineWidth=0),context.beginPath(),context.moveTo(shape[0][0],shape[0][1]),1===degree)for(i=1;i<len;i++)context.lineTo(shape[i][0],shape[i][1]);else for(i=1;i<len;i+=3)context.bezierCurveTo(shape[i][0],shape[i][1],shape[i+1][0],shape[i+1][1],shape[i+2][0],shape[i+2][1]);doFill?(context.lineTo(shape[0][0],shape[0][1]),context.closePath(),context.fill()):context.stroke()}},_fill:function(el){var context=this.context;context.save(),this._setColor(el,"fill")&&context.fill(),context.restore()},_rotatePoint:function(angle,x,y){return[x*Math.cos(angle)-y*Math.sin(angle),x*Math.sin(angle)+y*Math.cos(angle)]},_rotateShape:function(shape,angle){var i,rv=[],len=shape.length;if(len<=0)return shape;for(i=0;i<len;i++)rv.push(this._rotatePoint(angle,shape[i][0],shape[i][1]));return rv},updateGradientAngle:function(el,radians){var c1,c2,x1,x2,y1,y2,x1s,x2s,y1s,y2s,dx,dy,f=1,co=Math.cos(-radians),si=Math.sin(-radians),bb=el.getBoundingBox();return Math.abs(co)>Math.abs(si)?f/=Math.abs(co):f/=Math.abs(si),co>=0?(x1=0,x2=co*f):(x1=-co*f,x2=0),si>=0?(y1=0,y2=si*f):(y1=-si*f,y2=0),c1=new Coords(Const.COORDS_BY_USER,[bb[0],bb[1]],el.board),dx=(c2=new Coords(Const.COORDS_BY_USER,[bb[2],bb[3]],el.board)).scrCoords[1]-c1.scrCoords[1],dy=c2.scrCoords[2]-c1.scrCoords[2],x1s=c1.scrCoords[1]+dx*x1,y1s=c1.scrCoords[2]+dy*y1,x2s=c1.scrCoords[1]+dx*x2,y2s=c1.scrCoords[2]+dy*y2,this.context.createLinearGradient(x1s,y1s,x2s,y2s)},updateGradientCircle:function(el,cx,cy,r,fx,fy,fr){var c1,c2,cxs,cys,rs,fxs,fys,frs,dx,dy,bb=el.getBoundingBox();return c1=new Coords(Const.COORDS_BY_USER,[bb[0],bb[1]],el.board),dx=(c2=new Coords(Const.COORDS_BY_USER,[bb[2],bb[3]],el.board)).scrCoords[1]-c1.scrCoords[1],dy=c1.scrCoords[2]-c2.scrCoords[2],cxs=c1.scrCoords[1]+dx*cx,cys=c2.scrCoords[2]+dy*cy,fxs=c1.scrCoords[1]+dx*fx,fys=c2.scrCoords[2]+dy*fy,rs=r*(dx+dy)*.5,frs=fr*(dx+dy)*.5,this.context.createRadialGradient(fxs,fys,frs,cxs,cys,rs)},updateGradient:function(el){var col,op,gradient,ev_g=Type.evaluate(el.visProp.gradient);return op=(op=Type.evaluate(el.visProp.fillopacity))>0?op:0,col=Type.evaluate(el.visProp.fillcolor),"linear"===ev_g?gradient=this.updateGradientAngle(el,Type.evaluate(el.visProp.gradientangle)):"radial"===ev_g&&(gradient=this.updateGradientCircle(el,Type.evaluate(el.visProp.gradientcx),Type.evaluate(el.visProp.gradientcy),Type.evaluate(el.visProp.gradientr),Type.evaluate(el.visProp.gradientfx),Type.evaluate(el.visProp.gradientfy),Type.evaluate(el.visProp.gradientfr))),gradient.addColorStop(Type.evaluate(el.visProp.gradientstartoffset),col),gradient.addColorStop(Type.evaluate(el.visProp.gradientendoffset),Type.evaluate(el.visProp.gradientsecondcolor)),gradient},_setColor:function(el,type,targetType){var hl,sw,rgba,rgbo,c,o,oo,grad,hasColor=!0,ev=el.visProp;return type=type||"stroke",targetType=targetType||type,hl=this._getHighlighted(el),"linear"===(grad=Type.evaluate(el.visProp.gradient))||"radial"===grad?(this.context[targetType+"Style"]=this.updateGradient(el),hasColor):("none"!==(rgba=Type.evaluate(ev[hl+type+"color"]))&&!1!==rgba?(o=(o=Type.evaluate(ev[hl+type+"opacity"]))>0?o:0,9!==rgba.length?(c=rgba,oo=o):(c=(rgbo=Color.rgba2rgbo(rgba))[0],oo=o*rgbo[1]),this.context.globalAlpha=oo,this.context[targetType+"Style"]=c):hasColor=!1,sw=parseFloat(Type.evaluate(ev[hl+"strokewidth"])),"stroke"!==type||isNaN(sw)||(0===sw?this.context.globalAlpha=0:this.context.lineWidth=sw),"stroke"===type&&void 0!==ev.linecap&&""!==ev.linecap&&(this.context.lineCap=ev.linecap),hasColor)},_stroke:function(el){var context=this.context,ev_dash=Type.evaluate(el.visProp.dash);context.save(),ev_dash>0?context.setLineDash&&context.setLineDash(this.dashArray[ev_dash]):this.context.lineDashArray=[],this._setColor(el,"stroke")&&context.stroke(),context.restore()},_translateShape:function(shape,x,y){var i,rv=[],len=shape.length;if(len<=0)return shape;for(i=0;i<len;i++)rv.push([shape[i][0]+x,shape[i][1]+y]);return rv},drawPoint:function(el){var f=Type.evaluate(el.visProp.face),size=Type.evaluate(el.visProp.size),scr=el.coords.scrCoords,sqrt32=size*Math.sqrt(3)*.5,s05=.5*size,stroke05=parseFloat(Type.evaluate(el.visProp.strokewidth))/2,context=this.context;if(el.visPropCalc.visible)switch(f){case"cross":case"x":context.beginPath(),context.moveTo(scr[1]-size,scr[2]-size),context.lineTo(scr[1]+size,scr[2]+size),context.moveTo(scr[1]+size,scr[2]-size),context.lineTo(scr[1]-size,scr[2]+size),context.lineCap="round",context.lineJoin="round",context.closePath(),this._stroke(el);break;case"circle":case"o":context.beginPath(),context.arc(scr[1],scr[2],size+1+stroke05,0,2*Math.PI,!1),context.closePath(),this._fill(el),this._stroke(el);break;case"square":case"[]":if(size<=0)break;context.save(),this._setColor(el,"stroke","fill")&&context.fillRect(scr[1]-size-stroke05,scr[2]-size-stroke05,2*size+3*stroke05,2*size+3*stroke05),context.restore(),context.save(),this._setColor(el,"fill"),context.fillRect(scr[1]-size+stroke05,scr[2]-size+stroke05,2*size-stroke05,2*size-stroke05),context.restore();break;case"plus":case"+":context.beginPath(),context.moveTo(scr[1]-size,scr[2]),context.lineTo(scr[1]+size,scr[2]),context.moveTo(scr[1],scr[2]-size),context.lineTo(scr[1],scr[2]+size),context.lineCap="round",context.lineJoin="round",context.closePath(),this._stroke(el);break;case"diamond":case"<>":context.beginPath(),context.moveTo(scr[1]-size,scr[2]),context.lineTo(scr[1],scr[2]+size),context.lineTo(scr[1]+size,scr[2]),context.lineTo(scr[1],scr[2]-size),context.closePath(),this._fill(el),this._stroke(el);break;case"triangleup":case"a":case"^":context.beginPath(),context.moveTo(scr[1],scr[2]-size),context.lineTo(scr[1]-sqrt32,scr[2]+s05),context.lineTo(scr[1]+sqrt32,scr[2]+s05),context.closePath(),this._fill(el),this._stroke(el);break;case"triangledown":case"v":context.beginPath(),context.moveTo(scr[1],scr[2]+size),context.lineTo(scr[1]-sqrt32,scr[2]-s05),context.lineTo(scr[1]+sqrt32,scr[2]-s05),context.closePath(),this._fill(el),this._stroke(el);break;case"triangleleft":case"<":context.beginPath(),context.moveTo(scr[1]-size,scr[2]),context.lineTo(scr[1]+s05,scr[2]-sqrt32),context.lineTo(scr[1]+s05,scr[2]+sqrt32),context.closePath(),this._fill(el),this._stroke(el);break;case"triangleright":case">":context.beginPath(),context.moveTo(scr[1]+size,scr[2]),context.lineTo(scr[1]-s05,scr[2]-sqrt32),context.lineTo(scr[1]-s05,scr[2]+sqrt32),context.closePath(),this._fill(el),this._stroke(el)}},updatePoint:function(el){this.drawPoint(el)},drawArrows:function(el,scr1,scr2,hl,a){var x1,y1,x2,y2,w0,w,arrowHead,arrowTail,type_fa,type_la,doFill,i,len,d1x,d1y,d2x,d2y,last,ang1,ang2,context=this.context,type=1,degree_fa=1,degree_la=1,ev_fa=a.evFirst,ev_la=a.evLast;if("none"!==Type.evaluate(el.visProp.strokecolor)&&(ev_fa||ev_la)){if(el.elementClass===Const.OBJECT_CLASS_LINE)x1=scr1.scrCoords[1],y1=scr1.scrCoords[2],x2=scr2.scrCoords[1],y2=scr2.scrCoords[2],ang1=ang2=Math.atan2(y2-y1,x2-x1);else{if(x1=el.points[0].scrCoords[1],y1=el.points[0].scrCoords[2],(last=el.points.length-1)<1)return;x2=el.points[el.points.length-1].scrCoords[1],y2=el.points[el.points.length-1].scrCoords[2],d1x=el.points[1].scrCoords[1]-el.points[0].scrCoords[1],d1y=el.points[1].scrCoords[2]-el.points[0].scrCoords[2],d2x=el.points[last].scrCoords[1]-el.points[last-1].scrCoords[1],d2y=el.points[last].scrCoords[2]-el.points[last-1].scrCoords[2],ev_fa&&(ang1=Math.atan2(d1y,d1x)),ev_la&&(ang2=Math.atan2(d2y,d2x))}if(w0=Type.evaluate(el.visProp[hl+"strokewidth"]),ev_fa)if(w=w0*a.sizeFirst,type_fa=type=a.typeFirst,2===type)arrowTail=[[w,.5*-w],[0,0],[w,.5*w],[.5*w,0]];else if(3===type)arrowTail=[[w/3,.5*-w],[0,.5*-w],[0,.5*w],[w/3,.5*w]];else if(4===type)for(w/=10,degree_fa=3,len=(arrowTail=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,i=0;i<len;i++)arrowTail[i][0]*=-w,arrowTail[i][1]*=w,arrowTail[i][0]+=10*w,arrowTail[i][1]-=3.31*w;else if(5===type)for(w/=10,degree_fa=3,len=(arrowTail=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,i=0;i<len;i++)arrowTail[i][0]*=-w,arrowTail[i][1]*=w,arrowTail[i][0]+=10*w,arrowTail[i][1]-=3.28*w;else if(6===type)for(w/=10,degree_fa=3,len=(arrowTail=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,i=0;i<len;i++)arrowTail[i][0]*=-w,arrowTail[i][1]*=w,arrowTail[i][0]+=10*w,arrowTail[i][1]-=2.84*w;else if(7===type)for(w=w0,degree_fa=3,len=(arrowTail=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,i=0;i<len;i++)arrowTail[i][0]*=-w,arrowTail[i][1]*=w,arrowTail[i][0]+=10*w,arrowTail[i][1]-=5.2*w;else arrowTail=[[w,.5*-w],[0,0],[w,.5*w]];if(ev_la)if(w=w0*a.sizeLast,type_la=type=a.typeLast,2===type)arrowHead=[[-w,.5*-w],[0,0],[-w,.5*w],[.5*-w,0]];else if(3===type)arrowHead=[[-w/3,.5*-w],[0,.5*-w],[0,.5*w],[-w/3,.5*w]];else if(4===type)for(w/=10,degree_la=3,len=(arrowHead=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,i=0;i<len;i++)arrowHead[i][0]*=w,arrowHead[i][1]*=w,arrowHead[i][0]-=10*w,arrowHead[i][1]-=3.31*w;else if(5===type)for(w/=10,degree_la=3,len=(arrowHead=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,i=0;i<len;i++)arrowHead[i][0]*=w,arrowHead[i][1]*=w,arrowHead[i][0]-=10*w,arrowHead[i][1]-=3.28*w;else if(6===type)for(w/=10,degree_la=3,len=(arrowHead=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,i=0;i<len;i++)arrowHead[i][0]*=w,arrowHead[i][1]*=w,arrowHead[i][0]-=10*w,arrowHead[i][1]-=2.84*w;else if(7===type)for(w=w0,degree_la=3,len=(arrowHead=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,i=0;i<len;i++)arrowHead[i][0]*=w,arrowHead[i][1]*=w,arrowHead[i][0]-=10*w,arrowHead[i][1]-=5.2*w;else arrowHead=[[-w,.5*-w],[0,0],[-w,.5*w]];context.save(),this._setColor(el,"stroke","fill")&&(this._setColor(el,"stroke"),ev_fa&&(doFill=7!==type_fa,this._drawPolygon(this._translateShape(this._rotateShape(arrowTail,ang1),x1,y1),degree_fa,doFill)),ev_la&&(doFill=7!==type_la,this._drawPolygon(this._translateShape(this._rotateShape(arrowHead,ang2),x2,y2),degree_la,doFill))),context.restore()}},drawLine:function(el){var c1_org,c2_org,hl,w,arrowData,c1=new Coords(Const.COORDS_BY_USER,el.point1.coords.usrCoords,el.board),c2=new Coords(Const.COORDS_BY_USER,el.point2.coords.usrCoords,el.board),margin=null;el.visPropCalc.visible&&(hl=this._getHighlighted(el),w=Type.evaluate(el.visProp[hl+"strokewidth"]),((arrowData=this.getArrowHeadData(el,w,hl)).evFirst||arrowData.evLast)&&(margin=-4),Geometry.calcStraight(el,c1,c2,margin),this.handleTouchpoints(el,c1,c2,arrowData),c1_org=new Coords(Const.COORDS_BY_USER,c1.usrCoords,el.board),c2_org=new Coords(Const.COORDS_BY_USER,c2.usrCoords,el.board),this.getPositionArrowHead(el,c1,c2,arrowData),this.context.beginPath(),this.context.moveTo(c1.scrCoords[1],c1.scrCoords[2]),this.context.lineTo(c2.scrCoords[1],c2.scrCoords[2]),this._stroke(el),(arrowData.evFirst||arrowData.evLast)&&this.drawArrows(el,c1_org,c2_org,hl,arrowData))},updateLine:function(el){this.drawLine(el)},drawTicks:function(){},updateTicks:function(ticks){var i,c,x,y,len2,j,len=ticks.ticks.length,context=this.context;for(context.beginPath(),i=0;i<len;i++)for(x=(c=ticks.ticks[i])[0],y=c[1],len2=x.length,context.moveTo(x[0],y[0]),j=1;j<len2;++j)context.lineTo(x[j],y[j]);context.lineCap="round",this._stroke(ticks)},drawCurve:function(el){var hl,w,arrowData;Type.evaluate(el.visProp.handdrawing)?this.updatePathStringBezierPrim(el):this.updatePathStringPrim(el),el.numberPoints>1&&(hl=this._getHighlighted(el),w=Type.evaluate(el.visProp[hl+"strokewidth"]),((arrowData=this.getArrowHeadData(el,w,hl)).evFirst||arrowData.evLast)&&this.drawArrows(el,null,null,hl,arrowData))},updateCurve:function(el){this.drawCurve(el)},drawEllipse:function(el){var m1=el.center.coords.scrCoords[1],m2=el.center.coords.scrCoords[2],sX=el.board.unitX,sY=el.board.unitY,rX=2*el.Radius(),rY=2*el.Radius(),aWidth=rX*sX,aHeight=rY*sY,aX=m1-aWidth/2,aY=m2-aHeight/2,hB=aWidth/2*.5522848,vB=aHeight/2*.5522848,eX=aX+aWidth,eY=aY+aHeight,mX=aX+aWidth/2,mY=aY+aHeight/2,context=this.context;rX>0&&rY>0&&!isNaN(m1+m2)&&(context.beginPath(),context.moveTo(aX,mY),context.bezierCurveTo(aX,mY-vB,mX-hB,aY,mX,aY),context.bezierCurveTo(mX+hB,aY,eX,mY-vB,eX,mY),context.bezierCurveTo(eX,mY+vB,mX+hB,eY,mX,eY),context.bezierCurveTo(mX-hB,eY,aX,mY+vB,aX,mY),context.closePath(),this._fill(el),this._stroke(el))},updateEllipse:function(el){return this.drawEllipse(el)},displayCopyright:function(str,fontSize){var context=this.context;context.save(),context.font=fontSize+"px Arial",context.fillStyle="#aaa",context.lineWidth=.5,context.fillText(str,10,2+fontSize),context.restore()},drawInternalText:function(el){var ev_fs=Type.evaluate(el.visProp.fontsize),fontUnit=Type.evaluate(el.visProp.fontunit),ev_ax=el.getAnchorX(),ev_ay=el.getAnchorY(),context=this.context;return context.save(),this._setColor(el,"stroke","fill")&&!isNaN(el.coords.scrCoords[1]+el.coords.scrCoords[2])&&(context.font=(ev_fs>0?ev_fs:0)+fontUnit+" Arial",this.transformImage(el,el.transformations),"left"===ev_ax?context.textAlign="left":"right"===ev_ax?context.textAlign="right":"middle"===ev_ax&&(context.textAlign="center"),"bottom"===ev_ay?context.textBaseline="bottom":"top"===ev_ay?context.textBaseline="top":"middle"===ev_ay&&(context.textBaseline="middle"),context.fillText(el.plaintext,el.coords.scrCoords[1],el.coords.scrCoords[2])),context.restore(),null},updateInternalText:function(el){this.drawInternalText(el)},setObjectStrokeColor:function(el,color,opacity){var c,rgbo,oo,node,rgba=Type.evaluate(color),o=Type.evaluate(opacity);o=o>0?o:0,el.visPropOld.strokecolor===rgba&&el.visPropOld.strokeopacity===o||(Type.exists(rgba)&&!1!==rgba&&(9!==rgba.length?(c=rgba,oo=o):(c=(rgbo=Color.rgba2rgbo(rgba))[0],oo=o*rgbo[1]),node=el.rendNode,el.elementClass===Const.OBJECT_CLASS_TEXT&&"html"===Type.evaluate(el.visProp.display)&&(node.style.color=c,node.style.opacity=oo)),el.visPropOld.strokecolor=rgba,el.visPropOld.strokeopacity=o)},drawImage:function(el){el.rendNode=new Image,el._src="",this.updateImage(el)},updateImage:function(el){var context=this.context,o=Type.evaluate(el.visProp.fillopacity),paintImg=Type.bind((function(){el.imgIsLoaded=!0,el.size[0]<=0||el.size[1]<=0||(context.save(),context.globalAlpha=o,this.transformImage(el,el.transformations),context.drawImage(el.rendNode,el.coords.scrCoords[1],el.coords.scrCoords[2]-el.size[1],el.size[0],el.size[1]),context.restore())}),this);this.updateImageURL(el)?el.rendNode.onload=paintImg:el.imgIsLoaded&&paintImg()},transformImage:function(el,t){var m,len=t.length,ctx=this.context;len>0&&(m=this.joinTransforms(el,t),Math.abs(Numerics.det(m))>=Mat.eps&&ctx.transform(m[1][1],m[2][1],m[1][2],m[2][2],m[1][0],m[2][0]))},updateImageURL:function(el){var url;return url=Type.evaluate(el.url),el._src!==url&&(el.imgIsLoaded=!1,el.rendNode.src=url,el._src=url,!0)},remove:function(shape){Type.exists(shape)&&Type.exists(shape.parentNode)&&shape.parentNode.removeChild(shape)},updatePathStringPrim:function(el){var i,scr,scr1,scr2,len,nextSymb="M",context=this.context;if(!(el.numberPoints<=0)){if(len=Math.min(el.points.length,el.numberPoints),context.beginPath(),1===el.bezierDegree)for(i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb="M":(scr[1]>5e3?scr[1]=5e3:scr[1]<-5e3&&(scr[1]=-5e3),scr[2]>5e3?scr[2]=5e3:scr[2]<-5e3&&(scr[2]=-5e3),"M"===nextSymb?context.moveTo(scr[1],scr[2]):context.lineTo(scr[1],scr[2]),nextSymb="L");else if(3===el.bezierDegree)for(i=0;i<len;)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb="M":("M"===nextSymb?context.moveTo(scr[1],scr[2]):(i+=1,scr1=el.points[i].scrCoords,i+=1,scr2=el.points[i].scrCoords,context.bezierCurveTo(scr[1],scr[2],scr1[1],scr1[2],scr2[1],scr2[2])),nextSymb="C"),i+=1;context.lineCap="round",this._fill(el),this._stroke(el)}},updatePathStringBezierPrim:function(el){var i,j,k,scr,lx,ly,len,nextSymb="M",f=Type.evaluate(el.visProp.strokewidth),isNoPlot="plot"!==Type.evaluate(el.visProp.curvetype),context=this.context;if(!(el.numberPoints<=0)){for(isNoPlot&&el.board.options.curve.RDPsmoothing&&(el.points=Numerics.RamerDouglasPeucker(el.points,.5)),len=Math.min(el.points.length,el.numberPoints),context.beginPath(),j=1;j<3;j++)for(nextSymb="M",i=0;i<len;i++)scr=el.points[i].scrCoords,isNaN(scr[1])||isNaN(scr[2])?nextSymb="M":(scr[1]>5e3?scr[1]=5e3:scr[1]<-5e3&&(scr[1]=-5e3),scr[2]>5e3?scr[2]=5e3:scr[2]<-5e3&&(scr[2]=-5e3),"M"===nextSymb?context.moveTo(scr[1],scr[2]):(k=2*j,context.bezierCurveTo(lx+.333*(scr[1]-lx)+f*(k*Math.random()-j),ly+.333*(scr[2]-ly)+f*(k*Math.random()-j),lx+.666*(scr[1]-lx)+f*(k*Math.random()-j),ly+.666*(scr[2]-ly)+f*(k*Math.random()-j),scr[1],scr[2])),nextSymb="C",lx=scr[1],ly=scr[2]);context.lineCap="round",this._fill(el),this._stroke(el)}},updatePolygonPrim:function(node,el){var scrCoords,i,j,len=el.vertices.length,context=this.context,isReal=!0;if(!(len<=0)&&el.visPropCalc.visible){for("polygonalchain"===el.elType&&len++,context.beginPath(),i=0;!el.vertices[i].isReal&&i<len-1;)i++,isReal=!1;for(scrCoords=el.vertices[i].coords.scrCoords,context.moveTo(scrCoords[1],scrCoords[2]),j=i;j<len-1;j++)el.vertices[j].isReal||(isReal=!1),scrCoords=el.vertices[j].coords.scrCoords,context.lineTo(scrCoords[1],scrCoords[2]);context.closePath(),isReal&&this._fill(el)}},display:function(el,val){el&&el.rendNode&&(el.visPropOld.visible=val,el.rendNode.style.visibility=val?"inherit":"hidden")},show:function(el){JXG.deprecated("Board.renderer.show()","Board.renderer.display()"),Type.exists(el.rendNode)&&(el.rendNode.style.visibility="inherit")},hide:function(el){JXG.deprecated("Board.renderer.hide()","Board.renderer.display()"),Type.exists(el.rendNode)&&(el.rendNode.style.visibility="hidden")},setGradient:function(el){var op;op=(op=Type.evaluate(el.visProp.fillopacity))>0?op:0},setShadow:function(el){el.visPropOld.shadow!==el.visProp.shadow&&(el.visPropOld.shadow=el.visProp.shadow)},highlight:function(obj){return obj.elementClass===Const.OBJECT_CLASS_TEXT&&"html"===Type.evaluate(obj.visProp.display)?this.updateTextStyle(obj,!0):(obj.board.prepareUpdate(),obj.board.renderer.suspendRedraw(obj.board),obj.board.updateRenderer(),obj.board.renderer.unsuspendRedraw()),this},noHighlight:function(obj){return obj.elementClass===Const.OBJECT_CLASS_TEXT&&"html"===Type.evaluate(obj.visProp.display)?this.updateTextStyle(obj,!1):(obj.board.prepareUpdate(),obj.board.renderer.suspendRedraw(obj.board),obj.board.updateRenderer(),obj.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(board){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),board&&board.attr.showcopyright&&this.displayCopyright(JXG.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(w,h){this.container?(this.canvasRoot.style.width=parseFloat(w)+"px",this.canvasRoot.style.height=parseFloat(h)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(w)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(h)+"px")):(this.canvasRoot.width=2*parseFloat(w),this.canvasRoot.height=2*parseFloat(h)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),JXG.CanvasRenderer})),define("renderer/no",["jxg","renderer/abstract"],(function(JXG,AbstractRenderer){return JXG.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},JXG.extend(JXG.NoRenderer.prototype,{drawPoint:function(element){},updatePoint:function(element){},changePointStyle:function(element){},drawLine:function(element){},updateLine:function(element){},drawTicks:function(element){},updateTicks:function(element){},drawCurve:function(element){},updateCurve:function(element){},drawEllipse:function(element){},updateEllipse:function(element){},drawPolygon:function(element){},updatePolygon:function(element){},displayCopyright:function(str,fontsize){},drawInternalText:function(element){},updateInternalText:function(element){},drawText:function(element){},updateText:function(element){},updateTextStyle:function(element,doHighlight){},updateInternalTextStyle:function(element,strokeColor,strokeOpacity){},drawImage:function(element){},updateImage:function(element){},transformImage:function(element,transformations){},updateImageURL:function(element){},appendChildPrim:function(node,level){},appendNodesToElement:function(element,type){},createPrim:function(type,id){return null},remove:function(node){},makeArrows:function(element){},updateEllipsePrim:function(node,x,y,rx,ry){},updateLinePrim:function(node,p1x,p1y,p2x,p2y,board){},updatePathPrim:function(node,pathString,board){},updatePathStringPoint:function(element,size,type){},updatePathStringPrim:function(element){},updatePathStringBezierPrim:function(element){},updatePolygonPrim:function(node,element){},updateRectPrim:function(node,x,y,w,h){},setPropertyPrim:function(node,key,val){},display:function(element,value){element&&(element.visPropOld.visible=value)},show:function(element){},hide:function(element){},setBuffering:function(node,type){},setDashStyle:function(element){},setDraft:function(element){},removeDraft:function(element){},setGradient:function(element){},updateGradient:function(element){},setObjectTransition:function(element,duration){},setObjectFillColor:function(element,color,opacity){},setObjectStrokeColor:function(element,color,opacity){},setObjectStrokeWidth:function(element,width){},setShadow:function(element){},highlight:function(element){},noHighlight:function(element){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(board){},getElementById:function(id){return null},resize:function(w,h){},removeToInsertLater:function(){return function(){}}}),JXG.NoRenderer.prototype=new AbstractRenderer,JXG.NoRenderer})),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],(function(JXG,Env,Type,Board,FileReader,Options,SVGRenderer,VMLRenderer,CanvasRenderer,NoRenderer){return JXG.JSXGraph={rendererType:(Options.board.renderer="no",Env.supportsVML()&&(Options.board.renderer="vml",document.onmousemove=function(){var t;return document.body&&(t=document.body.scrollLeft,t+=document.body.scrollTop),t}),Env.supportsCanvas()&&(Options.board.renderer="canvas"),Env.supportsSVG()&&(Options.board.renderer="svg"),Env.isNode()&&Env.supportsCanvas()&&(Options.board.renderer="canvas"),(Env.isNode()||"no"===Options.renderer)&&(Options.text.display="internal",Options.infobox.display="internal"),Options.board.renderer),initRenderer:function(box,dim,doc,attrRenderer){var boxid;if(Type.exists(doc)&&!1!==doc||"object"!==("undefined"==typeof document?"undefined":_typeof(document))||(doc=document),"object"===_typeof(doc)&&null!==box)for(boxid=doc.getElementById(box);boxid.firstChild;)boxid.removeChild(boxid.firstChild);else boxid=box;return void 0!==attrRenderer&&"auto"!==attrRenderer||(attrRenderer=this.rendererType),"svg"===attrRenderer?new SVGRenderer(boxid,dim):"vml"===attrRenderer?new VMLRenderer(boxid):"canvas"===attrRenderer?new CanvasRenderer(boxid,dim):new NoRenderer},_setAttributes:function(attributes){var attr=Type.copyAttributes(attributes,Options,"board");return attr.zoom=Type.copyAttributes(attr,Options,"board","zoom"),attr.pan=Type.copyAttributes(attr,Options,"board","pan"),attr.drag=Type.copyAttributes(attr,Options,"board","drag"),attr.keyboard=Type.copyAttributes(attr,Options,"board","keyboard"),attr.selection=Type.copyAttributes(attr,Options,"board","selection"),attr.navbar=Type.copyAttributes(attr.navbar,Options,"navbar"),attr.screenshot=Type.copyAttributes(attr,Options,"board","screenshot"),attr.resize=Type.copyAttributes(attr,Options,"board","resize"),attr.fullscreen=Type.copyAttributes(attr,Options,"board","fullscreen"),attr.movetarget=attributes.moveTarget||attributes.movetarget||Options.board.moveTarget,attr},_fillBoard:function(board,attr,dimensions){board.initInfobox(),board.maxboundingbox=attr.maxboundingbox,board.resizeContainer(dimensions.width,dimensions.height,!0,!0),board._createSelectionPolygon(attr),board.renderer.drawZoomBar(board,attr.navbar),JXG.boards[board.id]=board},_setARIA:function(container,attr){var doc_glob,node_jsx,newNode,parent,id_label,id_description,doc=attr.document||document;"object"===_typeof(doc)&&(doc_glob=(node_jsx=doc.getElementById(container)).ownerDocument,parent=node_jsx.parentNode,id_label=container+"_ARIAlabel",id_description=container+"_ARIAdescription",(newNode=doc_glob.createElement("div")).innerHTML=attr.title,newNode.setAttribute("id",id_label),newNode.style.display="none",parent.insertBefore(newNode,node_jsx),(newNode=doc_glob.createElement("div")).innerHTML=attr.description,newNode.setAttribute("id",id_description),newNode.style.display="none",parent.insertBefore(newNode,node_jsx),node_jsx.setAttribute("aria-labelledby",id_label),node_jsx.setAttribute("aria-describedby",id_description))},_removeARIANodes:function(board){var node,id,doc;"object"===_typeof(doc=board.document||document)&&(id=board.containerObj.getAttribute("aria-labelledby"),(node=doc.getElementById(id))&&node.parentNode&&node.parentNode.removeChild(node),id=board.containerObj.getAttribute("aria-describedby"),(node=doc.getElementById(id))&&node.parentNode&&node.parentNode.removeChild(node))},initBoard:function(box,attributes){var originX,originY,unitX,unitY,renderer,w,h,dimensions,bbox,attr,axattr,axattr_x,axattr_y,board,offX=0,offY=0;return attributes=attributes||{},attr=this._setAttributes(attributes),dimensions=Env.getDimensions(box,attr.document),attr.unitx||attr.unity?(originX=Type.def(attr.originx,150),originY=Type.def(attr.originy,150),unitX=Type.def(attr.unitx,50),unitY=Type.def(attr.unity,50)):((bbox=attr.boundingbox)[0]<attr.maxboundingbox[0]&&(bbox[0]=attr.maxboundingbox[0]),bbox[1]>attr.maxboundingbox[1]&&(bbox[1]=attr.maxboundingbox[1]),bbox[2]>attr.maxboundingbox[2]&&(bbox[2]=attr.maxboundingbox[2]),bbox[3]<attr.maxboundingbox[3]&&(bbox[3]=attr.maxboundingbox[3]),w=parseInt(dimensions.width,10),h=parseInt(dimensions.height,10),Type.exists(bbox)&&attr.keepaspectratio?(unitX=w/(bbox[2]-bbox[0]),unitY=h/(bbox[1]-bbox[3]),Math.abs(unitX)<Math.abs(unitY)?offY=.5*(h/(unitY=Math.abs(unitX)*unitY/Math.abs(unitY))-(bbox[1]-bbox[3])):offX=.5*(w/(unitX=Math.abs(unitY)*unitX/Math.abs(unitX))-(bbox[2]-bbox[0]))):(unitX=w/(bbox[2]-bbox[0]),unitY=h/(bbox[1]-bbox[3])),originX=-unitX*(bbox[0]-offX),originY=unitY*(bbox[1]+offY)),renderer=this.initRenderer(box,dimensions,attr.document,attr.renderer),this._setARIA(box,attr),(board=new Board(box,renderer,attr.id,[originX,originY],attr.zoomfactor*attr.zoomx,attr.zoomfactor*attr.zoomy,unitX,unitY,dimensions.width,dimensions.height,attr)).keepaspectratio=attr.keepaspectratio,this._fillBoard(board,attr,dimensions),board.suspendUpdate(),attr.axis&&(axattr="object"===_typeof(attr.axis)?attr.axis:{},axattr_x=Type.deepCopy(Options.board.defaultAxes.x,axattr),axattr_y=Type.deepCopy(Options.board.defaultAxes.y,axattr),attr.defaultaxes.x&&(axattr_x=Type.deepCopy(axattr_x,attr.defaultaxes.x)),attr.defaultaxes.y&&(axattr_y=Type.deepCopy(axattr_y,attr.defaultaxes.y)),board.defaultAxes={},board.defaultAxes.x=board.create("axis",[[0,0],[1,0]],axattr_x),board.defaultAxes.y=board.create("axis",[[0,0],[0,1]],axattr_y)),attr.grid&&board.create("grid",[],"object"===_typeof(attr.grid)?attr.grid:{}),board.unsuspendUpdate(),board},loadBoardFromFile:function(box,file,format,attributes,callback){var attr,renderer,board,dimensions,encoding;return attributes=attributes||{},attr=this._setAttributes(attributes),dimensions=Env.getDimensions(box,attr.document),renderer=this.initRenderer(box,dimensions,attr.document,attr.renderer),this._setARIA(box,attr),board=new Board(box,renderer,"",[150,150],1,1,50,50,dimensions.width,dimensions.height,attr),this._fillBoard(board,attr,dimensions),encoding=attr.encoding||"iso-8859-1",FileReader.parseFileContent(file,board,format,!0,encoding,callback),board},loadBoardFromString:function(box,string,format,attributes,callback){var attr,renderer,board,dimensions;return attributes=attributes||{},attr=this._setAttributes(attributes),dimensions=Env.getDimensions(box,attr.document),renderer=this.initRenderer(box,dimensions,attr.document),this._setARIA(box,attr),board=new Board(box,renderer,"",[150,150],1,1,50,50,dimensions.width,dimensions.height,attr),this._fillBoard(board,attr,dimensions),FileReader.parseString(string,board,format,!0,callback),board},freeBoard:function(board){var el;for(el in"string"==typeof board&&(board=JXG.boards[board]),this._removeARIANodes(board),board.removeEventHandlers(),board.suspendUpdate(),board.objects)board.objects.hasOwnProperty(el)&&board.objects[el].remove();for(;board.containerObj.firstChild;)board.containerObj.removeChild(board.containerObj.firstChild);for(el in board.objects)board.objects.hasOwnProperty(el)&&delete board.objects[el];delete board.renderer,board.jc.creator.clearCache(),delete board.jc,delete JXG.boards[board.id]},registerElement:function(element,creator){JXG.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),JXG.registerElement(element,creator)}},Env.isBrowser&&"object"===("undefined"==typeof window?"undefined":_typeof(window))&&"object"===("undefined"==typeof document?"undefined":_typeof(document))&&Env.addEvent(window,"load",(function(){var type,i,j,div,id,board,txt,width,height,maxWidth,aspectRatio,cssClasses,bbox,axis,grid,code,src,request,postpone=!1,scripts=document.getElementsByTagName("script"),init=function(code,type,bbox){var board=JXG.JSXGraph.initBoard(id,{boundingbox:bbox,keepaspectratio:!0,grid:grid,axis:axis,showReload:!0});if(type.toLowerCase().indexOf("script")>-1)board.construct(code);else try{board.jc.parse(code)}catch(e2){JXG.debug(e2)}return board},makeReload=function makeReload(board,code,type,bbox){return function(){var newBoard;JXG.JSXGraph.freeBoard(board),(newBoard=init(code,type,bbox)).reload=makeReload(newBoard,code,type,bbox)}};for(i=0;i<scripts.length;i++)if(type=scripts[i].getAttribute("type",!1),Type.exists(type)&&("text/jessiescript"===type.toLowerCase()||"jessiescript"===type.toLowerCase()||"text/jessiecode"===type.toLowerCase()||"jessiecode"===type.toLowerCase())){if(cssClasses=scripts[i].getAttribute("class",!1)||"",width=scripts[i].getAttribute("width",!1)||"",height=scripts[i].getAttribute("height",!1)||"",maxWidth=scripts[i].getAttribute("maxwidth",!1)||"100%",aspectRatio=scripts[i].getAttribute("aspectratio",!1)||"1/1",bbox=scripts[i].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",id=scripts[i].getAttribute("container",!1),src=scripts[i].getAttribute("src",!1),4!==(bbox=bbox.split(",")).length)bbox=[-5,5,5,-5];else for(j=0;j<bbox.length;j++)bbox[j]=parseFloat(bbox[j]);if(axis=Type.str2Bool(scripts[i].getAttribute("axis",!1)||"false"),grid=Type.str2Bool(scripts[i].getAttribute("grid",!1)||"false"),Type.exists(id))div=document.getElementById(id);else{id="jessiescript_autgen_jxg_"+i,(div=document.createElement("div")).setAttribute("id",id),txt=""!==width?"width:"+width+";":"",txt+=""!==height?"height:"+height+";":"",txt+=""!==maxWidth?"max-width:"+maxWidth+";":"",txt+=""!==aspectRatio?"aspect-ratio:"+aspectRatio+";":"",div.setAttribute("style",txt),div.setAttribute("class","jxgbox "+cssClasses);try{document.body.insertBefore(div,scripts[i])}catch(e){"object"===("undefined"==typeof jQuery?"undefined":_typeof(jQuery))&&jQuery(div).insertBefore(scripts[i])}}code="",Type.exists(src)?(postpone=!0,(request=new XMLHttpRequest).open("GET",src),request.overrideMimeType("text/plain; charset=x-user-defined"),request.addEventListener("load",(function(){if(!(this.status<400))throw new Error("\nJSXGraph: failed to load file",src,":",this.responseText);code=this.responseText+"\n"+code,(board=init(code,type,bbox)).reload=makeReload(board,code,type,bbox)})),request.addEventListener("error",(function(e){throw new Error("\nJSXGraph: failed to load file",src,":",e)})),request.send()):postpone=!1,document.getElementById(id)?(code=(code=scripts[i].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),scripts[i].innerHTML=code,postpone||((board=init(code,type,bbox)).reload=makeReload(board,code,type,bbox))):JXG.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}}),window),JXG.JSXGraph})),define("base/point",["jxg","options","math/math","math/geometry","base/constants","base/element","utils/type","base/coordselement"],(function(JXG,Options,Mat,Geometry,Const,GeometryElement,Type,CoordsElement){return JXG.Point=function(board,coordinates,attributes){this.constructor(board,attributes,Const.OBJECT_TYPE_POINT,Const.OBJECT_CLASS_POINT),this.element=this.board.select(attributes.anchor),this.coordsConstructor(coordinates),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createGradient(),this.createLabel()},JXG.Point.prototype=new GeometryElement,Type.copyPrototypeMethods(JXG.Point,CoordsElement,"coordsConstructor"),JXG.extend(JXG.Point.prototype,{hasPoint:function(x,y){var r,prec,type,coordsScr=this.coords.scrCoords,unit=Type.evaluate(this.visProp.sizeunit);return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,r=parseFloat(Type.evaluate(this.visProp.size)),"user"===unit&&(r*=Math.sqrt(this.board.unitX*this.board.unitY)),(r+=.5*parseFloat(Type.evaluate(this.visProp.strokewidth)))<prec&&(r=prec),Math.abs(coordsScr[1]-x)<r+2&&Math.abs(coordsScr[2]-y)<r+2},update:function(fromParent){return this.needsUpdate?(this.updateCoords(fromParent),Type.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(fromParent){var c,i;if(0===this.transformations.length||null===this.baseElement)return this;for(this===this.baseElement?(c=this.transformations[0].apply(this.baseElement,"self"),this.coords.setCoordinates(Const.COORDS_BY_USER,c)):c=this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(Const.COORDS_BY_USER,c),i=1;i<this.transformations.length;i++)this.coords.setCoordinates(Const.COORDS_BY_USER,this.transformations[i].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(el1,el2,i,j){var func;el1=this.board.select(el1),el2=this.board.select(el2),func=Geometry.intersectionFunction(this.board,el1,el2,i,j,Type.evaluate(this.visProp.alwaysintersect)),this.addConstraint([func]);try{el1.addChild(this),el2.addChild(this)}catch(e){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+_typeof(el1)+"' and '"+_typeof(el2)+"'.")}this.type=Const.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[el1.id,el2.id,i,j],this.generatePolynomial=function(){var poly1=el1.generatePolynomial(this),poly2=el2.generatePolynomial(this);return 0===poly1.length||0===poly2.length?[]:[poly1[0],poly2[0]]},this.prepareUpdate().update()},setStyle:function(i){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][i],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][i],this.board.renderer.changePointStyle(this),this},normalizeFace:function(s){return JXG.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),Options.normalizePointFace(s)},face:function(f){JXG.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:f})},size:function(s){JXG.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:s})},isOn:function(el,tol){var arr,crds;return tol=tol||Mat.eps,Type.isPoint(el)?this.Dist(el)<tol:el.elementClass===Const.OBJECT_CLASS_LINE?("segment"!==el.elType||Type.evaluate(this.visProp.alwaysintersect)||(arr=JXG.Math.Geometry.projectCoordsToSegment(this.coords.usrCoords,el.point1.coords.usrCoords,el.point2.coords.usrCoords))[1]>=0&&arr[1]<=1)&&Geometry.distPointLine(this.coords.usrCoords,el.stdform)<tol:el.elementClass===Const.OBJECT_CLASS_CIRCLE?Type.evaluate(el.visProp.hasinnerpoints)?this.Dist(el.center)<el.Radius()+tol:Math.abs(this.Dist(el.center)-el.Radius())<tol:el.elementClass===Const.OBJECT_CLASS_CURVE?(crds=Geometry.projectPointToCurve(this,el,this.board)[0],Geometry.distance(this.coords.usrCoords,crds.usrCoords,3)<tol):el.type===Const.OBJECT_TYPE_POLYGON?!(!Type.evaluate(el.visProp.hasinnerpoints)||!el.pnpoly(this.coords.usrCoords[1],this.coords.usrCoords[2],JXG.COORDS_BY_USER))||(arr=Geometry.projectCoordsToPolygon(this.coords.usrCoords,el),Geometry.distance(this.coords.usrCoords,arr,3)<tol):el.type===Const.OBJECT_TYPE_TURTLE&&(crds=Geometry.projectPointToTurtle(this,el,this.board),Geometry.distance(this.coords.usrCoords,crds.usrCoords,3)<tol)},cloneToBackground:function(){var copy={};return copy.id=this.id+"T"+this.numTraces,this.numTraces+=1,copy.coords=this.coords,copy.visProp=Type.deepCopy(this.visProp,this.visProp.traceattributes,!0),copy.visProp.layer=this.board.options.layer.trace,copy.elementClass=Const.OBJECT_CLASS_POINT,copy.board=this.board,Type.clearVisPropOld(copy),copy.visPropCalc={visible:Type.evaluate(copy.visProp.visible)},this.board.renderer.drawPoint(copy),this.traces[copy.id]=copy.rendNode,this}}),JXG.createPoint=function(board,parents,attributes){var el,attr;if(attr=Type.copyAttributes(attributes,board.options,"point"),!(el=CoordsElement.create(JXG.Point,board,parents,attr)))throw new Error("JSXGraph: Can't create point with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return el},JXG.createGlider=function(board,parents,attributes){var el,coords,attr=Type.copyAttributes(attributes,board.options,"glider");return coords=1===parents.length?[0,0]:parents.slice(0,2),(el=board.create("point",coords,attr)).makeGlider(parents[parents.length-1]),el},JXG.createIntersectionPoint=function(board,parents,attributes){var el,el1,el2,func,i,j,attr=Type.copyAttributes(attributes,board.options,"intersection");parents.push(0,0),el1=board.select(parents[0]),el2=board.select(parents[1]),i=parents[2]||0,j=parents[3]||0,el=board.create("point",[0,0,0],attr),func=Geometry.intersectionFunction(board,el1,el2,i,j,el.visProp.alwaysintersect),el.addConstraint([func]);try{el1.addChild(el),el2.addChild(el)}catch(e){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.")}return el.type=Const.OBJECT_TYPE_INTERSECTION,el.elType="intersection",el.setParents([el1.id,el2.id]),el.intersectionNumbers=[i,j],el.getParents=function(){return this.parents.concat(this.intersectionNumbers)},el.generatePolynomial=function(){var poly1=el1.generatePolynomial(el),poly2=el2.generatePolynomial(el);return 0===poly1.length||0===poly2.length?[]:[poly1[0],poly2[0]]},el},JXG.createOtherIntersectionPoint=function(board,parents,attributes){var el,el1,el2,other;if(3!==parents.length||!Type.isPoint(parents[2])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE&&parents[0].elementClass!==Const.OBJECT_CLASS_CIRCLE||parents[1].elementClass!==Const.OBJECT_CLASS_LINE&&parents[1].elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+_typeof(parents[0])+"',  '"+_typeof(parents[1])+"'and  '"+_typeof(parents[2])+"'.\nPossible parent types: [circle|line,circle|line,point]");return el1=board.select(parents[0]),el2=board.select(parents[1]),other=board.select(parents[2]),(el=board.create("point",[function(){var c=Geometry.meet(el1.stdform,el2.stdform,0,el1.board);return Math.abs(other.X()-c.usrCoords[1])>Mat.eps||Math.abs(other.Y()-c.usrCoords[2])>Mat.eps||Math.abs(other.Z()-c.usrCoords[0])>Mat.eps?c:Geometry.meet(el1.stdform,el2.stdform,1,el1.board)}],attributes)).type=Const.OBJECT_TYPE_INTERSECTION,el.elType="otherintersection",el.setParents([el1.id,el2.id,other]),el1.addChild(el),el2.addChild(el),el.generatePolynomial=function(){var poly1=el1.generatePolynomial(el),poly2=el2.generatePolynomial(el);return 0===poly1.length||0===poly2.length?[]:[poly1[0],poly2[0]]},el},JXG.createPolePoint=function(board,parents,attributes){var el,el1,el2,firstParentIsConic,secondParentIsConic,firstParentIsLine,secondParentIsLine;if(parents.length>1&&(firstParentIsConic=parents[0].type===Const.OBJECT_TYPE_CONIC||parents[0].elementClass===Const.OBJECT_CLASS_CIRCLE,secondParentIsConic=parents[1].type===Const.OBJECT_TYPE_CONIC||parents[1].elementClass===Const.OBJECT_CLASS_CIRCLE,firstParentIsLine=parents[0].elementClass===Const.OBJECT_CLASS_LINE,secondParentIsLine=parents[1].elementClass===Const.OBJECT_CLASS_LINE),2!==parents.length||!(firstParentIsConic&&secondParentIsLine||firstParentIsLine&&secondParentIsConic))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent type: [conic|circle,line], [line,conic|circle]");return secondParentIsLine?(el1=board.select(parents[0]),el2=board.select(parents[1])):(el1=board.select(parents[1]),el2=board.select(parents[0])),(el=board.create("point",[function(){var q=el1.quadraticform,s=el2.stdform.slice(0,3);return[JXG.Math.Numerics.det([s,q[1],q[2]]),JXG.Math.Numerics.det([q[0],s,q[2]]),JXG.Math.Numerics.det([q[0],q[1],s])]}],attributes)).elType="polepoint",el.setParents([el1.id,el2.id]),el1.addChild(el),el2.addChild(el),el},JXG.registerElement("point",JXG.createPoint),JXG.registerElement("glider",JXG.createGlider),JXG.registerElement("intersection",JXG.createIntersectionPoint),JXG.registerElement("otherintersection",JXG.createOtherIntersectionPoint),JXG.registerElement("polepoint",JXG.createPolePoint),{Point:JXG.Point,createPoint:JXG.createPoint,createGlider:JXG.createGlider,createIntersection:JXG.createIntersectionPoint,createOtherIntersection:JXG.createOtherIntersectionPoint,createPolePoint:JXG.createPolePoint}})),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],(function(JXG,Mat,Geometry,Numerics,Statistics,Const,Coords,GeometryElement,Type,Point){return JXG.Line=function(board,p1,p2,attributes){this.constructor(board,attributes,Const.OBJECT_TYPE_LINE,Const.OBJECT_CLASS_LINE),this.point1=this.board.select(p1),this.point2=this.board.select(p2),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1._is_new?(this.addChild(this.point1),delete this.point1._is_new):this.point1.addChild(this),this.point2._is_new?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=JXG.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L"})},JXG.Line.prototype=new GeometryElement,JXG.extend(JXG.Line.prototype,{hasPoint:function(x,y){var s,vnew,p1c,p2c,d,pos,i,prec,type,c=[],v=[1,x,y],sw=Type.evaluate(this.visProp.strokewidth);return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,prec+=.5*sw,c[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,c[1]=this.stdform[1]/this.board.unitX,c[2]=this.stdform[2]/-this.board.unitY,s=Geometry.distPointLine(v,c),!(isNaN(s)||s>prec)&&(!(!Type.evaluate(this.visProp.straightfirst)||!Type.evaluate(this.visProp.straightlast))||(p1c=this.point1.coords,p2c=this.point2.coords,vnew=[0,c[1],c[2]],vnew=Mat.crossProduct(vnew,v),(vnew=Mat.crossProduct(vnew,c))[1]/=vnew[0],vnew[2]/=vnew[0],vnew[0]=1,vnew=new Coords(Const.COORDS_BY_SCREEN,vnew.slice(1),this.board).usrCoords,d=p1c.distance(Const.COORDS_BY_USER,p2c),p1c=p1c.usrCoords.slice(0),p2c=p2c.usrCoords.slice(0),d<Mat.eps?pos=0:(d===Number.POSITIVE_INFINITY&&(d=1/Mat.eps,Math.abs(p2c[0])<Mat.eps?(d/=Geometry.distance([0,0,0],p2c),p2c=[1,p1c[1]+p2c[1]*d,p1c[2]+p2c[2]*d]):(d/=Geometry.distance([0,0,0],p1c),p1c=[1,p2c[1]+p1c[1]*d,p2c[2]+p1c[2]*d])),d=p2c[i=1]-p1c[i],Math.abs(d)<Mat.eps&&(d=p2c[i=2]-p1c[i]),pos=(vnew[i]-p1c[i])/d),!(!Type.evaluate(this.visProp.straightfirst)&&pos<0)&&!(!Type.evaluate(this.visProp.straightlast)&&pos>1)))},update:function(){var funps;return this.needsUpdate?(this.constrained&&(Type.isFunction(this.funps)?(funps=this.funps())&&funps.length&&2===funps.length&&(this.point1=funps[0],this.point2=funps[1]):(Type.isFunction(this.funp1)&&(funps=this.funp1(),Type.isPoint(funps)?this.point1=funps:funps&&funps.length&&2===funps.length&&this.point1.setPositionDirectly(Const.COORDS_BY_USER,funps)),Type.isFunction(this.funp2)&&(funps=this.funp2(),Type.isPoint(funps)?this.point2=funps:funps&&funps.length&&2===funps.length&&this.point2.setPositionDirectly(Const.COORDS_BY_USER,funps)))),this.updateSegmentFixedLength(),this.updateStdform(),Type.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var d,dnew,d1,d2,drag1,drag2,x,y;return this.hasFixedLength?(d=this.point1.Dist(this.point2),dnew=this.fixedLength(),d1=this.fixedLengthOldCoords[0].distance(Const.COORDS_BY_USER,this.point1.coords),d2=this.fixedLengthOldCoords[1].distance(Const.COORDS_BY_USER,this.point2.coords),(d1>Mat.eps||d2>Mat.eps||d!==dnew)&&(drag1=this.point1.isDraggable&&this.point1.type!==Const.OBJECT_TYPE_GLIDER&&!Type.evaluate(this.point1.visProp.fixed),drag2=this.point2.isDraggable&&this.point2.type!==Const.OBJECT_TYPE_GLIDER&&!Type.evaluate(this.point2.visProp.fixed),d>Mat.eps?d1>d2&&drag2||d1<=d2&&drag2&&!drag1?(this.point2.setPositionDirectly(Const.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*dnew/d,this.point1.Y()+(this.point2.Y()-this.point1.Y())*dnew/d]),this.point2.fullUpdate()):(d1<=d2&&drag1||d1>d2&&drag1&&!drag2)&&(this.point1.setPositionDirectly(Const.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*dnew/d,this.point2.Y()+(this.point1.Y()-this.point2.Y())*dnew/d]),this.point1.fullUpdate()):(x=Math.random()-.5,y=Math.random()-.5,d=Math.sqrt(x*x+y*y),drag2?(this.point2.setPositionDirectly(Const.COORDS_BY_USER,[this.point1.X()+x*dnew/d,this.point1.Y()+y*dnew/d]),this.point2.fullUpdate()):drag1&&(this.point1.setPositionDirectly(Const.COORDS_BY_USER,[this.point2.X()+x*dnew/d,this.point2.Y()+y*dnew/d]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(Const.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(Const.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var v=Mat.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=v[0],this.stdform[1]=v[1],this.stdform[2]=v[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&Mat.innerProduct(this.stdform,this.stdform,3)>=Mat.eps*Mat.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(p){var u1=this.point1.symbolic.x,u2=this.point1.symbolic.y,v1=this.point2.symbolic.x,v2=this.point2.symbolic.y,w1=p.symbolic.x,w2=p.symbolic.y;return[["(",u2,")*(",w1,")-(",u2,")*(",v1,")+(",w2,")*(",v1,")-(",u1,")*(",w2,")+(",u1,")*(",v2,")-(",w1,")*(",v2,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=Mat.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=Mat.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(straightFirst,straightLast){return this.visProp.straightfirst=straightFirst,this.visProp.straightlast=straightLast,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new Coords(Const.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(relCoords){Type.exists(this.label)&&(this.label.relativeCoords=new Coords(Const.COORDS_BY_SCREEN,[relCoords[0],-relCoords[1]],this.board))},getLabelAnchor:function(){var x,y,fs=0,c1=new Coords(Const.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),c2=new Coords(Const.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),ev_sf=Type.evaluate(this.visProp.straightfirst),ev_sl=Type.evaluate(this.visProp.straightlast);if((ev_sf||ev_sl)&&Geometry.calcStraight(this,c1,c2,0),c1=c1.scrCoords,c2=c2.scrCoords,!Type.exists(this.label))return new Coords(Const.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(Type.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":c1[1]<=c2[1]?(x=c1[1],y=c1[2]):(x=c2[1],y=c2[2]);break;case"rt":case"lrt":case"urt":c1[1]>c2[1]?(x=c1[1],y=c1[2]):(x=c2[1],y=c2[2]);break;default:x=.5*(c1[1]+c2[1]),y=.5*(c1[2]+c2[2])}return(ev_sf||ev_sl)&&(Type.exists(this.label)&&(fs=Type.evaluate(this.label.visProp.fontsize)),Math.abs(x)<Mat.eps?x=fs:this.board.canvasWidth+Mat.eps>x&&x>this.board.canvasWidth-fs-Mat.eps&&(x=this.board.canvasWidth-fs),Mat.eps+fs>y&&y>-Mat.eps?y=fs:this.board.canvasHeight+Mat.eps>y&&y>this.board.canvasHeight-fs-Mat.eps&&(y=this.board.canvasHeight-fs)),new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board)},cloneToBackground:function(){var r,s,er,copy={};return copy.id=this.id+"T"+this.numTraces,copy.elementClass=Const.OBJECT_CLASS_LINE,this.numTraces++,copy.point1=this.point1,copy.point2=this.point2,copy.stdform=this.stdform,copy.board=this.board,copy.visProp=Type.deepCopy(this.visProp,this.visProp.traceattributes,!0),copy.visProp.layer=this.board.options.layer.trace,Type.clearVisPropOld(copy),copy.visPropCalc={visible:Type.evaluate(copy.visProp.visible)},s=this.getSlope(),r=this.getRise(),copy.getSlope=function(){return s},copy.getRise=function(){return r},er=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(copy),this.board.renderer.enhancedRendering=er,this.traces[copy.id]=copy.rendNode,this},addTransform:function(transform){var i,list=Type.isArray(transform)?transform:[transform],len=list.length;for(i=0;i<len;i++)this.point1.transformations.push(list[i]),this.point2.transformations.push(list[i]);return this},snapToGrid:function(pos){var c1,c2,dc,ticks,x,y,sX,sY;return Type.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):Type.exists(pos)&&(sX=Type.evaluate(this.visProp.snapsizex),sY=Type.evaluate(this.visProp.snapsizey),x=(c1=new Coords(Const.COORDS_BY_SCREEN,[pos.Xprev,pos.Yprev],this.board)).usrCoords[1],y=c1.usrCoords[2],sX<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(sX=(ticks=this.board.defaultAxes.x.defaultTicks).ticksDelta*(Type.evaluate(ticks.visProp.minorticks)+1)),sY<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(sY=(ticks=this.board.defaultAxes.y.defaultTicks).ticksDelta*(Type.evaluate(ticks.visProp.minorticks)+1)),sX>0&&sY>0&&(c2=Geometry.projectPointToLine({coords:c1},this,this.board),dc=Statistics.subtract([1,Math.round(x/sX)*sX,Math.round(y/sY)*sY],c2.usrCoords),this.board.create("transform",dc.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var forceIt=Type.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(forceIt),this.point2.handleSnapToPoints(forceIt)),this},X:function(t){var x,b=this.stdform[2];return x=Math.abs(this.point1.coords.usrCoords[0])>Mat.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],t=2*(t-.5),(1-Math.abs(t))*x-t*b},Y:function(t){var y,a=this.stdform[1];return y=Math.abs(this.point1.coords.usrCoords[0])>Mat.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],t=2*(t-.5),(1-Math.abs(t))*y+t*a},Z:function(t){var z=Math.abs(this.point1.coords.usrCoords[0])>Mat.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return t=2*(t-.5),(1-Math.abs(t))*z},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var p1c=this.point1.coords.usrCoords,p2c=this.point2.coords.usrCoords;return[Math.min(p1c[1],p2c[1]),Math.max(p1c[2],p2c[2]),Math.max(p1c[1],p2c[1]),Math.min(p1c[2],p2c[2])]},remove:function(){this.removeAllTicks(),GeometryElement.prototype.remove.call(this)}}),JXG.createLine=function(board,parents,attributes){var ps,el,p1,p2,i,attr,isDraggable,c=[],doTransform=!1,constrained=!1;if(2===parents.length){if(Type.isArray(parents[0])&&parents[0].length>1)attr=Type.copyAttributes(attributes,board.options,"line","point1"),p1=board.create("point",parents[0],attr);else if(Type.isString(parents[0])||Type.isPoint(parents[0]))p1=board.select(parents[0]);else if(Type.isFunction(parents[0])&&Type.isPoint(parents[0]()))p1=parents[0](),constrained=!0;else if(Type.isFunction(parents[0])&&parents[0]().length&&parents[0]().length>=2)attr=Type.copyAttributes(attributes,board.options,"line","point1"),p1=Point.createPoint(board,parents[0](),attr),constrained=!0;else{if(!Type.isObject(parents[0])||!Type.isTransformationOrArray(parents[1]))throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");doTransform=!0,attr=Type.copyAttributes(attributes,board.options,"line","point1"),p1=board.create("point",[parents[0].point1,parents[1]],attr)}if(doTransform)attr=Type.copyAttributes(attributes,board.options,"line","point2"),p2=board.create("point",[parents[0].point2,parents[1]],attr);else if(Type.isArray(parents[1])&&parents[1].length>1)attr=Type.copyAttributes(attributes,board.options,"line","point2"),p2=board.create("point",parents[1],attr);else if(Type.isString(parents[1])||Type.isPoint(parents[1]))p2=board.select(parents[1]);else if(Type.isFunction(parents[1])&&Type.isPoint(parents[1]()))p2=parents[1](),constrained=!0;else{if(!(Type.isFunction(parents[1])&&parents[1]().length&&parents[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");attr=Type.copyAttributes(attributes,board.options,"line","point2"),p2=Point.createPoint(board,parents[1](),attr),constrained=!0}attr=Type.copyAttributes(attributes,board.options,"line"),el=new JXG.Line(board,p1,p2,attr),constrained?(el.constrained=!0,el.funp1=parents[0],el.funp2=parents[1]):doTransform||(el.isDraggable=!0),el.setParents([p1.id,p2.id])}else if(3===parents.length){for(isDraggable=!0,i=0;i<3;i++)if(Type.isNumber(parents[i]))c[i]=Type.createFunction(parents[i]);else{if(!Type.isFunction(parents[i]))throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");c[i]=parents[i],isDraggable=!1}attr=Type.copyAttributes(attributes,board.options,"line","point1"),p1=isDraggable?board.create("point",[c[2]()*c[2]()+c[1]()*c[1](),c[2]()-c[1]()*c[0]()+c[2](),-c[1]()-c[2]()*c[0]()-c[1]()],attr):board.create("point",[function(){return.5*(c[2]()*c[2]()+c[1]()*c[1]())},function(){return.5*(c[2]()-c[1]()*c[0]()+c[2]())},function(){return.5*(-c[1]()-c[2]()*c[0]()-c[1]())}],attr),attr=Type.copyAttributes(attributes,board.options,"line","point2"),p2=isDraggable?board.create("point",[c[2]()*c[2]()+c[1]()*c[1](),-c[1]()*c[0]()+c[2](),-c[2]()*c[0]()-c[1]()],attr):board.create("point",[function(){return c[2]()*c[2]()+c[1]()*c[1]()},function(){return-c[1]()*c[0]()+c[2]()},function(){return-c[2]()*c[0]()-c[1]()}],attr),p1.prepareUpdate().update(),p2.prepareUpdate().update(),attr=Type.copyAttributes(attributes,board.options,"line"),(el=new JXG.Line(board,p1,p2,attr)).isDraggable=isDraggable,el.setParents([p1,p2])}else if(1===parents.length&&Type.isFunction(parents[0])&&2===parents[0]().length&&Type.isPoint(parents[0]()[0])&&Type.isPoint(parents[0]()[1]))ps=parents[0](),attr=Type.copyAttributes(attributes,board.options,"line"),(el=new JXG.Line(board,ps[0],ps[1],attr)).constrained=!0,el.funps=parents[0],el.setParents(ps);else{if(!(1===parents.length&&Type.isFunction(parents[0])&&3===parents[0]().length&&Type.isNumber(parents[0]()[0])&&Type.isNumber(parents[0]()[1])&&Type.isNumber(parents[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");ps=parents[0],attr=Type.copyAttributes(attributes,board.options,"line","point1"),p1=board.create("point",[function(){var c=ps();return[.5*(c[2]*c[2]+c[1]*c[1]),.5*(c[2]-c[1]*c[0]+c[2]),.5*(-c[1]-c[2]*c[0]-c[1])]}],attr),attr=Type.copyAttributes(attributes,board.options,"line","point2"),p2=board.create("point",[function(){var c=ps();return[c[2]*c[2]+c[1]*c[1],-c[1]*c[0]+c[2],-c[2]*c[0]-c[1]]}],attr),attr=Type.copyAttributes(attributes,board.options,"line"),(el=new JXG.Line(board,p1,p2,attr)).constrained=!0,el.funps=parents[0],el.setParents([p1,p2])}return el},JXG.registerElement("line",JXG.createLine),JXG.createSegment=function(board,parents,attributes){var el,attr;if(attributes.straightFirst=!1,attributes.straightLast=!1,attr=Type.copyAttributes(attributes,board.options,"segment"),el=board.create("line",parents.slice(0,2),attr),3===parents.length){if(el.hasFixedLength=!0,Type.isNumber(parents[2]))el.fixedLength=function(){return parents[2]};else{if(!Type.isFunction(parents[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+_typeof(parents[2])+"'.\nPossible third parent types: number or function");el.fixedLength=parents[2]}el.getParents=function(){return this.parents.concat(this.fixedLength())},el.fixedLengthOldCoords=[],el.fixedLengthOldCoords[0]=new Coords(Const.COORDS_BY_USER,el.point1.coords.usrCoords.slice(1,3),board),el.fixedLengthOldCoords[1]=new Coords(Const.COORDS_BY_USER,el.point2.coords.usrCoords.slice(1,3),board)}return el.elType="segment",el},JXG.registerElement("segment",JXG.createSegment),JXG.createArrow=function(board,parents,attributes){var el,attr;return attributes.straightFirst=!1,attributes.straightLast=!1,attr=Type.copyAttributes(attributes,board.options,"arrow"),(el=board.create("line",parents,attr)).type=Const.OBJECT_TYPE_VECTOR,el.elType="arrow",el},JXG.registerElement("arrow",JXG.createArrow),JXG.createAxis=function(board,parents,attributes){var attr,attr_ticks,el,els,dist;if(!Type.isArray(parents[0])&&!Type.isPoint(parents[0])||!Type.isArray(parents[1])&&!Type.isPoint(parents[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");for(els in attr=Type.copyAttributes(attributes,board.options,"axis"),(el=board.create("line",parents,attr)).type=Const.OBJECT_TYPE_AXIS,el.isDraggable=!1,el.point1.isDraggable=!1,el.point2.isDraggable=!1,el.ancestors)el.ancestors.hasOwnProperty(els)&&(el.ancestors[els].type=Const.OBJECT_TYPE_AXISPOINT);return attr_ticks=Type.copyAttributes(attributes,board.options,"axis","ticks"),dist=Type.exists(attr_ticks.ticksdistance)?attr_ticks.ticksdistance:Type.isArray(attr_ticks.ticks)?attr_ticks.ticks:1,el.defaultTicks=board.create("ticks",[el,dist],attr_ticks),el.defaultTicks.dump=!1,el.elType="axis",el.subs={ticks:el.defaultTicks},el.inherits.push(el.defaultTicks),el},JXG.registerElement("axis",JXG.createAxis),JXG.createTangent=function(board,parents,attributes){var p,c,j,el,tangent;if(1===parents.length)p=parents[0],c=p.slideObject;else{if(2!==parents.length)throw new Error("JSXGraph: Can't create tangent with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(Type.isPoint(parents[0]))p=parents[0],c=parents[1];else{if(!Type.isPoint(parents[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");c=parents[0],p=parents[1]}}if(c.elementClass===Const.OBJECT_CLASS_LINE?(tangent=board.create("line",[c.point1,c.point2],attributes)).glider=p:c.elementClass===Const.OBJECT_CLASS_CURVE&&c.type!==Const.OBJECT_TYPE_CONIC?"plot"!==Type.evaluate(c.visProp.curvetype)?(tangent=board.create("line",[function(){var g=c.X,f=c.Y;return-p.X()*Numerics.D(f)(p.position)+p.Y()*Numerics.D(g)(p.position)},function(){return Numerics.D(c.Y)(p.position)},function(){return-Numerics.D(c.X)(p.position)}],attributes),p.addChild(tangent),tangent.glider=p):(tangent=board.create("line",[function(){var p1,p2,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position);if(1===c.bezierDegree)i===c.numberPoints-1&&i--;else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?1:(1===c.bezierDegree?(p1=c.points[i].usrCoords,p2=c.points[i+1].usrCoords):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,p2=[1,(p1=p.coords.usrCoords)[1]+dx,p1[2]+dy]),p1[2]*p2[1]-p1[1]*p2[2])},function(){var p1,p2,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position);if(1===c.bezierDegree)i===c.numberPoints-1&&i--;else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?0:(1===c.bezierDegree?(p1=c.points[i].usrCoords,p2=c.points[i+1].usrCoords):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,p2=[1,(p1=p.coords.usrCoords)[1]+dx,p1[2]+dy]),p2[2]-p1[2])},function(){var p1,p2,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position);if(1===c.bezierDegree)i===c.numberPoints-1&&i--;else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?0:(1===c.bezierDegree?(p1=c.points[i].usrCoords,p2=c.points[i+1].usrCoords):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,p2=[1,(p1=p.coords.usrCoords)[1]+dx,p1[2]+dy]),p1[1]-p2[1])}],attributes),p.addChild(tangent),tangent.glider=p):c.type===Const.OBJECT_TYPE_TURTLE?(tangent=board.create("line",[function(){var i=Math.floor(p.position);for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&i--,i<0?1:el.Y(i)*el.X(i+1)-el.X(i)*el.Y(i+1)},function(){var i=Math.floor(p.position);for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&i--,i<0?0:el.Y(i+1)-el.Y(i)},function(){var i=Math.floor(p.position);for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&i--,i<0?0:el.X(i)-el.X(i+1)}],attributes),p.addChild(tangent),tangent.glider=p):c.elementClass!==Const.OBJECT_CLASS_CIRCLE&&c.type!==Const.OBJECT_TYPE_CONIC||(tangent=board.create("line",[function(){return Mat.matVecMult(c.quadraticform,p.coords.usrCoords)[0]},function(){return Mat.matVecMult(c.quadraticform,p.coords.usrCoords)[1]},function(){return Mat.matVecMult(c.quadraticform,p.coords.usrCoords)[2]}],attributes),p.addChild(tangent),tangent.glider=p),!Type.exists(tangent))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return tangent.elType="tangent",tangent.type=Const.OBJECT_TYPE_TANGENT,tangent.setParents(parents),tangent},JXG.createRadicalAxis=function(board,parents,attributes){var el,el1,el2;if(2!==parents.length||parents[0].elementClass!==Const.OBJECT_CLASS_CIRCLE||parents[1].elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent type: [circle,circle]");return el1=board.select(parents[0]),el2=board.select(parents[1]),(el=board.create("line",[function(){var a=el1.stdform,b=el2.stdform;return Mat.matVecMult(Mat.transpose([a.slice(0,3),b.slice(0,3)]),[b[3],-a[3]])}],attributes)).elType="radicalaxis",el.setParents([el1.id,el2.id]),el1.addChild(el),el2.addChild(el),el},JXG.createPolarLine=function(board,parents,attributes){var el,el1,el2,firstParentIsConic,secondParentIsConic,firstParentIsPoint,secondParentIsPoint;if(parents.length>1&&(firstParentIsConic=parents[0].type===Const.OBJECT_TYPE_CONIC||parents[0].elementClass===Const.OBJECT_CLASS_CIRCLE,secondParentIsConic=parents[1].type===Const.OBJECT_TYPE_CONIC||parents[1].elementClass===Const.OBJECT_CLASS_CIRCLE,firstParentIsPoint=Type.isPoint(parents[0]),secondParentIsPoint=Type.isPoint(parents[1])),2!==parents.length||!(firstParentIsConic&&secondParentIsPoint||firstParentIsPoint&&secondParentIsConic))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent type: [conic|circle,point], [point,conic|circle]");return secondParentIsPoint?(el1=board.select(parents[0]),el2=board.select(parents[1])):(el1=board.select(parents[1]),el2=board.select(parents[0])),(el=board.create("tangent",[el1,el2],attributes)).elType="polarline",el},JXG.registerElement("tangent",JXG.createTangent),JXG.registerElement("polar",JXG.createTangent),JXG.registerElement("radicalaxis",JXG.createRadicalAxis),JXG.registerElement("polarline",JXG.createPolarLine),{Line:JXG.Line,createLine:JXG.createLine,createTangent:JXG.createTangent,createPolar:JXG.createTangent,createSegment:JXG.createSegment,createAxis:JXG.createAxis,createArrow:JXG.createArrow,createRadicalAxis:JXG.createRadicalAxis,createPolarLine:JXG.createPolarLine}})),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],(function(JXG,Const,Mat,Geometry,Type){return JXG.Group=function(board,id,name,objects,attributes){var number,objArray,i,obj;for(this.board=board,this.objects={},number=this.board.numObjects,this.board.numObjects+=1,""!==id&&Type.exists(id)?this.id=id:this.id=this.board.id+"Group"+number,this.board.groups[this.id]=this,this.type=Const.OBJECT_TYPE_POINT,this.elementClass=Const.OBJECT_CLASS_POINT,""!==name&&Type.exists(name)?this.name=name:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=attributes.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],objArray=Type.isArray(objects)?objects:Array.prototype.slice.call(arguments,3),i=0;i<objArray.length;i++)obj=this.board.select(objArray[i]),!Type.evaluate(obj.visProp.fixed)&&Type.exists(obj.coords)&&this.addPoint(obj);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},JXG.extend(JXG.Group.prototype,{ungroup:function(){var el,p,i;for(el in this.objects)this.objects.hasOwnProperty(el)&&(p=this.objects[el].point,Type.isArray(p.groups)&&(i=Type.indexOf(p.groups,this.id))>=0&&delete p.groups[i]);return this.objects={},this},addParents:function(parents){var i,len,par;for(len=(par=Type.isArray(parents)?parents:arguments).length,i=0;i<len;++i)Type.isId(this.board,par[i])?this.parents.push(par[i]):Type.exists(par[i].id)&&this.parents.push(par[i].id);this.parents=Type.uniqueArray(this.parents)},setParents:function(parents){return this.parents=[],this.addParents(parents),this},getParents:function(){return Type.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(el){var obj;""!==el&&Type.exists(this.objects[el])&&(obj=this.objects[el].point,this.coords[obj.id]={usrCoords:obj.coords.usrCoords.slice(0)})},update:function(){var drag,el,actionCenter,desc,s,sx,sy,alpha,t,center,obj=null;if(!this.needsUpdate)return this;if("nothing"===(drag=this._update_find_drag_type()).action)return this._updateCoordsCache(drag.id),this;if(obj=this.objects[drag.id].point,"translation"===drag.action)t=[obj.coords.usrCoords[1]-this.coords[drag.id].usrCoords[1],obj.coords.usrCoords[2]-this.coords[drag.id].usrCoords[2]];else if("rotation"===drag.action||"scaling"===drag.action){if(actionCenter="rotation"===drag.action?"rotationCenter":"scaleCenter",Type.isPoint(this[actionCenter]))center=this[actionCenter].coords.usrCoords.slice(1);else if("centroid"===this[actionCenter])center=this._update_centroid_center();else if(Type.isArray(this[actionCenter]))center=this[actionCenter];else{if(!Type.isFunction(this[actionCenter]))return this;center=this[actionCenter]()}if("rotation"===drag.action)alpha=Geometry.rad(this.coords[drag.id].usrCoords.slice(1),center,this.objects[drag.id].point),(t=this.board.create("transform",[alpha,center[0],center[1]],{type:"rotate"})).update();else{if("scaling"!==drag.action)return this;if(s=Geometry.distance(this.coords[drag.id].usrCoords.slice(1),center),Math.abs(s)<Mat.eps)return this;s=Geometry.distance(obj.coords.usrCoords.slice(1),center)/s,sx=this.scaleDirections[drag.id].indexOf("x")>=0?s:1,sy=this.scaleDirections[drag.id].indexOf("y")>=0?s:1,(t=this.board.create("transform",[1,0,0,center[0]*(1-sx),sx,0,center[1]*(1-sy),0,sy],{type:"generic"})).update()}}for(el in this._update_apply_transformation(drag,t),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(el))for(desc in this.objects[el].descendants)this.objects[el].descendants.hasOwnProperty(desc)&&(this.objects[el].descendants.needsUpdate=this.objects[el].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(el in this.board.updateElements(drag),this.objects)this.objects.hasOwnProperty(el)&&this._updateCoordsCache(el);return this},_update_find_drag_type:function(){var el,obj,dragObjId,action="nothing",changed=[];for(el in this.objects)this.objects.hasOwnProperty(el)&&(obj=this.objects[el].point).coords.distance(Const.COORDS_BY_USER,this.coords[el])>Mat.eps&&changed.push(obj.id);return 0===changed.length?{action:action,id:"",changed:changed}:(dragObjId=changed[0],obj=this.objects[dragObjId].point,changed.length>1?action="translation":Type.isInArray(this.rotationPoints,obj)&&Type.exists(this.rotationCenter)?action="rotation":Type.isInArray(this.scalePoints,obj)&&Type.exists(this.scaleCenter)?action="scaling":Type.isInArray(this.translationPoints,obj)&&(action="translation"),{action:action,id:dragObjId,changed:changed})},_update_centroid_center:function(){var center,len,el;for(el in center=[0,0],len=0,this.coords)this.coords.hasOwnProperty(el)&&(center[0]+=this.coords[el].usrCoords[1],center[1]+=this.coords[el].usrCoords[2],++len);return len>0&&(center[0]/=len,center[1]/=len),center},_update_apply_transformation:function(drag,t){var el,obj;for(el in this.objects)this.objects.hasOwnProperty(el)&&(Type.exists(this.board.objects[el])?(obj=this.objects[el].point).id!==drag.id?"translation"===drag.action?Type.isInArray(drag.changed,obj.id)||obj.coords.setCoordinates(Const.COORDS_BY_USER,[this.coords[el].usrCoords[1]+t[0],this.coords[el].usrCoords[2]+t[1]]):"rotation"!==drag.action&&"scaling"!==drag.action||t.applyOnce([obj]):"rotation"!==drag.action&&"scaling"!==drag.action||obj.coords.setCoordinates(Const.COORDS_BY_USER,Mat.matVecMult(t.matrix,this.coords[obj.id].usrCoords)):delete this.objects[el])},addPoint:function(object){return this.objects[object.id]={point:this.board.select(object)},this._updateCoordsCache(object.id),this.translationPoints.push(object),object.groups.push(this.id),object.groups=Type.uniqueArray(object.groups),this},addPoints:function(objects){var p;for(p=0;p<objects.length;p++)this.addPoint(objects[p]);return this},addGroup:function(group){var el;for(el in group.objects)group.objects.hasOwnProperty(el)&&this.addPoint(group.objects[el].point);return this},removePoint:function(point){return delete this.objects[point.id],this},setRotationCenter:function(object){return this.rotationCenter=object,this},setRotationPoints:function(objects){return this._setActionPoints("rotation",objects)},addRotationPoint:function(point){return this._addActionPoint("rotation",point)},removeRotationPoint:function(point){return this._removeActionPoint("rotation",point)},setTranslationPoints:function(objects){return this._setActionPoints("translation",objects)},addTranslationPoint:function(point){return this._addActionPoint("translation",point)},removeTranslationPoint:function(point){return this._removeActionPoint("translation",point)},setScaleCenter:function(object){return this.scaleCenter=object,this},setScalePoints:function(objects,direction){var objs,i,len;for(len=(objs=Type.isArray(objects)?objects:arguments).length,i=0;i<len;++i)this.scaleDirections[this.board.select(objs[i]).id]=direction||"xy";return this._setActionPoints("scale",objects)},addScalePoint:function(point,direction){return this._addActionPoint("scale",point),this.scaleDirections[this.board.select(point).id]=direction||"xy",this},removeScalePoint:function(point){return this._removeActionPoint("scale",point)},_setActionPoints:function(action,objects){var objs,i,len;for(len=(objs=Type.isArray(objects)?objects:arguments).length,this[action+"Points"]=[],i=0;i<len;++i)this._addActionPoint(action,objs[i]);return this},_addActionPoint:function(action,point){return this[action+"Points"].push(this.board.select(point)),this},_removeActionPoint:function(action,point){var idx=this[action+"Points"].indexOf(this.board.select(point));return idx>-1&&this[action+"Points"].splice(idx,1),this},setProperty:function(){JXG.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var el;for(el in this.objects)this.objects.hasOwnProperty(el)&&this.objects[el].point.setAttribute.apply(this.objects[el].point,arguments);return this}}),JXG.createGroup=function(board,parents,attributes){var attr=Type.copyAttributes(attributes,board.options,"group"),g=new JXG.Group(board,attr.id,attr.name,parents,attr);return g.elType="group",g.setParents(parents),g},JXG.registerElement("group",JXG.createGroup),{Group:JXG.Group,createGroup:JXG.createGroup}})),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type"],(function(JXG,Const,Coords,Mat,Numerics,Geometry,Type){return JXG.createEllipse=function(board,parents,attributes){var polarForm,curve,M,C,majorAxis,i,hasPointOrg,F=[],attr_foci=Type.copyAttributes(attributes,board.options,"conic","foci"),attr_center=Type.copyAttributes(attributes,board.options,"conic","center"),attr_curve=Type.copyAttributes(attributes,board.options,"conic");for(i=0;i<2;i++)if(parents[i].length>1)F[i]=board.create("point",parents[i],attr_foci);else if(Type.isPoint(parents[i]))F[i]=board.select(parents[i]);else if(Type.isFunction(parents[i])&&Type.isPoint(parents[i]()))F[i]=parents[i]();else{if(!Type.isString(parents[i]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");F[i]=board.select(parents[i])}if(Type.isNumber(parents[2]))majorAxis=Type.createFunction(parents[2],board);else if(Type.isFunction(parents[2])&&Type.isNumber(parents[2]()))majorAxis=parents[2];else{if(Type.isPoint(parents[2]))C=board.select(parents[2]);else if(parents[2].length>1)C=board.create("point",parents[2],attr_foci);else if(Type.isFunction(parents[2])&&Type.isPoint(parents[2]()))C=parents[2]();else{if(!Type.isString(parents[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");C=board.select(parents[2])}majorAxis=function(){return C.Dist(F[0])+C.Dist(F[1])}}for(Type.exists(parents[4])||(parents[4]=2*Math.PI),Type.exists(parents[3])||(parents[3]=0),M=board.create("point",[function(){return.5*(F[0].X()+F[1].X())},function(){return.5*(F[0].Y()+F[1].Y())}],attr_center),(curve=board.create("curve",[function(x){return 0},function(x){return 0},parents[3],parents[4]],attr_curve)).majorAxis=majorAxis,hasPointOrg=curve.hasPoint,polarForm=function(phi,suspendUpdate){var r,rr,ax,ay,bx,by,axbx,ayby,f;suspendUpdate||(rr=(r=majorAxis())*r,ax=F[0].X(),ay=F[0].Y(),axbx=ax-(bx=F[1].X()),ayby=ay-(by=F[1].Y()),f=(rr-ax*ax-ay*ay+bx*bx+by*by)/(2*r),curve.quadraticform=[[f*f-bx*bx-by*by,f*axbx/r+bx,f*ayby/r+by],[f*axbx/r+bx,axbx*axbx/rr-1,axbx*ayby/rr],[f*ayby/r+by,axbx*ayby/rr,ayby*ayby/rr-1]])},curve.X=function(phi,suspendUpdate){var r=majorAxis(),c=F[1].Dist(F[0]),b=.5*(c*c-r*r)/(c*Math.cos(phi)-r),beta=Math.atan2(F[1].Y()-F[0].Y(),F[1].X()-F[0].X());return suspendUpdate||polarForm(0,suspendUpdate),F[0].X()+Math.cos(beta+phi)*b},curve.Y=function(phi,suspendUpdate){var r=majorAxis(),c=F[1].Dist(F[0]),b=.5*(c*c-r*r)/(c*Math.cos(phi)-r),beta=Math.atan2(F[1].Y()-F[0].Y(),F[1].X()-F[0].X());return F[0].Y()+Math.sin(beta+phi)*b},curve.midpoint=curve.center=M,curve.type=Const.OBJECT_TYPE_CONIC,curve.subs={center:curve.center},curve.inherits.push(curve.center,F[0],F[1]),Type.isPoint(C)&&curve.inherits.push(C),curve.hasPoint=function(x,y){var ac,bc,r,p;return Type.evaluate(this.visProp.hasinnerpoints)?(ac=F[0].coords,bc=F[1].coords,r=this.majorAxis(),(p=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board)).distance(Const.COORDS_BY_USER,ac)+p.distance(Const.COORDS_BY_USER,bc)<=r):hasPointOrg.apply(this,arguments)},M.addChild(curve),i=0;i<2;i++)Type.isPoint(F[i])&&F[i].addChild(curve);return Type.isPoint(C)&&C.addChild(curve),curve.setParents(parents),curve},JXG.createHyperbola=function(board,parents,attributes){var polarForm,curve,M,C,majorAxis,i,F=[],attr_foci=Type.copyAttributes(attributes,board.options,"conic","foci"),attr_center=Type.copyAttributes(attributes,board.options,"conic","center"),attr_curve=Type.copyAttributes(attributes,board.options,"conic");for(i=0;i<2;i++)if(parents[i].length>1)F[i]=board.create("point",parents[i],attr_foci);else if(Type.isPoint(parents[i]))F[i]=board.select(parents[i]);else if(Type.isFunction(parents[i])&&Type.isPoint(parents[i]()))F[i]=parents[i]();else{if(!Type.isString(parents[i]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");F[i]=board.select(parents[i])}if(Type.isNumber(parents[2]))majorAxis=Type.createFunction(parents[2],board);else if(Type.isFunction(parents[2])&&Type.isNumber(parents[2]()))majorAxis=parents[2];else{if(Type.isPoint(parents[2]))C=board.select(parents[2]);else if(parents[2].length>1)C=board.create("point",parents[2],attr_foci);else if(Type.isFunction(parents[2])&&Type.isPoint(parents[2]()))C=parents[2]();else{if(!Type.isString(parents[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");C=board.select(parents[2])}majorAxis=function(){return C.Dist(F[0])-C.Dist(F[1])}}for(Type.exists(parents[4])||(parents[4]=1.0001*Math.PI),Type.exists(parents[3])||(parents[3]=-1.0001*Math.PI),M=board.create("point",[function(){return.5*(F[0].X()+F[1].X())},function(){return.5*(F[0].Y()+F[1].Y())}],attr_center),(curve=board.create("curve",[function(x){return 0},function(x){return 0},parents[3],parents[4]],attr_curve)).majorAxis=majorAxis,polarForm=function(phi,suspendUpdate){var r,rr,ax,ay,bx,by,axbx,ayby,f;suspendUpdate||(rr=(r=majorAxis())*r,ax=F[0].X(),ay=F[0].Y(),axbx=ax-(bx=F[1].X()),ayby=ay-(by=F[1].Y()),f=(rr-ax*ax-ay*ay+bx*bx+by*by)/(2*r),curve.quadraticform=[[f*f-bx*bx-by*by,f*axbx/r+bx,f*ayby/r+by],[f*axbx/r+bx,axbx*axbx/rr-1,axbx*ayby/rr],[f*ayby/r+by,axbx*ayby/rr,ayby*ayby/rr-1]])},curve.X=function(phi,suspendUpdate){var r=majorAxis(),c=F[1].Dist(F[0]),b=.5*(c*c-r*r)/(c*Math.cos(phi)+r),beta=Math.atan2(F[1].Y()-F[0].Y(),F[1].X()-F[0].X());return suspendUpdate||polarForm(0,suspendUpdate),F[0].X()+Math.cos(beta+phi)*b},curve.Y=function(phi,suspendUpdate){var r=majorAxis(),c=F[1].Dist(F[0]),b=.5*(c*c-r*r)/(c*Math.cos(phi)+r),beta=Math.atan2(F[1].Y()-F[0].Y(),F[1].X()-F[0].X());return F[0].Y()+Math.sin(beta+phi)*b},curve.midpoint=curve.center=M,curve.subs={center:curve.center},curve.inherits.push(curve.center,F[0],F[1]),Type.isPoint(C)&&curve.inherits.push(C),curve.type=Const.OBJECT_TYPE_CONIC,M.addChild(curve),i=0;i<2;i++)Type.isPoint(F[i])&&F[i].addChild(curve);return Type.isPoint(C)&&C.addChild(curve),curve.setParents(parents),curve},JXG.createParabola=function(board,parents,attributes){var polarForm,curve,M,attr_line,F1=parents[0],l=parents[1],attr_foci=Type.copyAttributes(attributes,board.options,"conic","foci"),attr_center=Type.copyAttributes(attributes,board.options,"conic","center"),attr_curve=Type.copyAttributes(attributes,board.options,"conic");if(parents[0].length>1)F1=board.create("point",parents[0],attr_foci);else if(Type.isPoint(parents[0]))F1=board.select(parents[0]);else if(Type.isFunction(parents[0])&&Type.isPoint(parents[0]()))F1=parents[0]();else{if(!Type.isString(parents[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line]");F1=board.select(parents[0])}return Type.isArray(l)&&2===l.length&&(attr_line=Type.copyAttributes(attributes,board.options,"conic","line"),l=board.create("line",l,attr_line)),Type.exists(parents[3])||(parents[3]=2*Math.PI),Type.exists(parents[2])||(parents[2]=0),M=board.create("point",[function(){return Geometry.projectPointToLine(F1,l,board).usrCoords}],attr_center),(curve=board.create("curve",[function(x){return 0},function(x){return 0},parents[2],parents[3]],attr_curve)).midpoint=curve.center=M,curve.subs={center:curve.center},curve.inherits.push(curve.center),polarForm=function(t,suspendUpdate){var a,b,c,ab,px,py;suspendUpdate||(a=l.stdform[1],b=l.stdform[2],c=l.stdform[0],ab=a*a+b*b,px=F1.X(),py=F1.Y(),curve.quadraticform=[[c*c-ab*(px*px+py*py),c*a+ab*px,c*b+ab*py],[c*a+ab*px,-b*b,a*b],[c*b+ab*py,a*b,-a*a]])},curve.X=function(phi,suspendUpdate){var a,beta=l.getAngle(),d=Geometry.distPointLine(F1.coords.usrCoords,l.stdform),A=l.point1.coords.usrCoords,B=l.point2.coords.usrCoords,M=F1.coords.usrCoords;return 0===A[0]?A=[1,B[1]+l.stdform[2],B[2]-l.stdform[1]]:0===B[0]&&(B=[1,A[1]+l.stdform[2],A[2]-l.stdform[1]]),a=((B[1]-A[1])*(M[2]-A[2])-(B[2]-A[2])*(M[1]-A[1])>=0?1:-1)*d/(1-Math.sin(phi)),suspendUpdate||polarForm(0,suspendUpdate),F1.X()+Math.cos(phi+beta)*a},curve.Y=function(phi,suspendUpdate){var a,beta=l.getAngle(),d=Geometry.distPointLine(F1.coords.usrCoords,l.stdform),A=l.point1.coords.usrCoords,B=l.point2.coords.usrCoords,M=F1.coords.usrCoords;return 0===A[0]?A=[1,B[1]+l.stdform[2],B[2]-l.stdform[1]]:0===B[0]&&(B=[1,A[1]+l.stdform[2],A[2]-l.stdform[1]]),a=((B[1]-A[1])*(M[2]-A[2])-(B[2]-A[2])*(M[1]-A[1])>=0?1:-1)*d/(1-Math.sin(phi)),F1.Y()+Math.sin(phi+beta)*a},curve.type=Const.OBJECT_TYPE_CONIC,M.addChild(curve),Type.isPoint(F1)&&(F1.addChild(curve),curve.inherits.push(F1)),l.addChild(curve),curve.setParents(parents),curve},JXG.createConic=function(board,parents,attributes){var polarForm,curve,fitConic,degconic,sym,eigen,a,b,c,c1,c2,i,definingMat,givenByPoints,rotationMatrix=[[1,0,0],[0,1,0],[0,0,1]],M=[[1,0,0],[0,1,0],[0,0,1]],points=[],p=[],attr_point=Type.copyAttributes(attributes,board.options,"conic","point"),attr_center=Type.copyAttributes(attributes,board.options,"conic","center"),attr_curve=Type.copyAttributes(attributes,board.options,"conic");if(5===parents.length)givenByPoints=!0;else{if(6!==parents.length)throw new Error("JSXGraph: Can't create generic Conic with "+parents.length+" parameters.");givenByPoints=!1}if(givenByPoints)for(i=0;i<5;i++)if(parents[i].length>1)points[i]=board.create("point",parents[i],attr_point);else if(Type.isPoint(parents[i]))points[i]=board.select(parents[i]);else if(Type.isFunction(parents[i])&&Type.isPoint(parents[i]()))points[i]=parents[i]();else{if(!Type.isString(parents[i]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+_typeof(parents[i])+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");points[i]=board.select(parents[i])}else(definingMat=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=Type.isFunction(parents[2])?function(){return parents[2]()}:function(){return parents[2]},definingMat[0][1]=Type.isFunction(parents[4])?function(){return parents[4]()}:function(){return parents[4]},definingMat[0][2]=Type.isFunction(parents[5])?function(){return parents[5]()}:function(){return parents[5]},definingMat[1][1]=Type.isFunction(parents[0])?function(){return parents[0]()}:function(){return parents[0]},definingMat[1][2]=Type.isFunction(parents[3])?function(){return parents[3]()}:function(){return parents[3]},definingMat[2][2]=Type.isFunction(parents[1])?function(){return parents[1]()}:function(){return parents[1]};if(sym=function(A){var i,j;for(i=0;i<3;i++)for(j=i;j<3;j++)A[i][j]+=A[j][i];for(i=0;i<3;i++)for(j=0;j<i;j++)A[i][j]=A[j][i];return A},degconic=function(v,w){var i,j,mat=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i++)for(j=0;j<3;j++)mat[i][j]=v[i]*w[j];return sym(mat)},fitConic=function(A,B,p){var i,j,pBp,pAp,Mv,mat=[[0,0,0],[0,0,0],[0,0,0]];for(Mv=Mat.matVecMult(B,p),pBp=Mat.innerProduct(p,Mv),Mv=Mat.matVecMult(A,p),pAp=Mat.innerProduct(p,Mv),i=0;i<3;i++)for(j=0;j<3;j++)mat[i][j]=pBp*A[i][j]-pAp*B[i][j];return mat},curve=board.create("curve",[function(x){return 0},function(x){return 0},0,2*Math.PI],attr_curve),polarForm=function(phi,suspendUpdate){var i,j,len,v;if(!suspendUpdate){if(givenByPoints){for(i=0;i<5;i++)p[i]=points[i].coords.usrCoords;c1=degconic(Mat.crossProduct(p[0],p[1]),Mat.crossProduct(p[2],p[3])),c2=degconic(Mat.crossProduct(p[0],p[2]),Mat.crossProduct(p[1],p[3])),M=fitConic(c1,c2,p[4])}else for(i=0;i<3;i++)for(j=i;j<3;j++)M[i][j]=definingMat[i][j](),j>i&&(M[j][i]=M[i][j]);for(curve.quadraticform=M,(eigen=Numerics.Jacobi(M))[0][0][0]<0&&(eigen[0][0][0]*=-1,eigen[0][1][1]*=-1,eigen[0][2][2]*=-1),i=0;i<3;i++){for(len=0,j=0;j<3;j++)len+=eigen[1][j][i]*eigen[1][j][i];len=Math.sqrt(len)}rotationMatrix=eigen[1],c=Math.sqrt(Math.abs(eigen[0][0][0])),a=Math.sqrt(Math.abs(eigen[0][1][1])),b=Math.sqrt(Math.abs(eigen[0][2][2]))}return eigen[0][1][1]<=0&&eigen[0][2][2]<=0?v=Mat.matVecMult(rotationMatrix,[1/c,Math.cos(phi)/a,Math.sin(phi)/b]):eigen[0][1][1]<=0&&eigen[0][2][2]>0?v=Mat.matVecMult(rotationMatrix,[Math.cos(phi)/c,1/a,Math.sin(phi)/b]):eigen[0][2][2]<0&&(v=Mat.matVecMult(rotationMatrix,[Math.sin(phi)/c,Math.cos(phi)/a,1/b])),Type.exists(v)?(v[1]/=v[0],v[2]/=v[0],v[0]=1):v=[1,NaN,NaN],v},curve.X=function(phi,suspendUpdate){return polarForm(phi,suspendUpdate)[1]},curve.Y=function(phi,suspendUpdate){return polarForm(phi,suspendUpdate)[2]},curve.midpoint=board.create("point",[function(){var m=curve.quadraticform;return[m[1][1]*m[2][2]-m[1][2]*m[1][2],m[1][2]*m[0][2]-m[2][2]*m[0][1],m[0][1]*m[1][2]-m[1][1]*m[0][2]]}],attr_center),curve.type=Const.OBJECT_TYPE_CONIC,curve.center=curve.midpoint,curve.subs={center:curve.center},curve.inherits.push(curve.center),curve.inherits=curve.inherits.concat(points),givenByPoints){for(i=0;i<5;i++)Type.isPoint(points[i])&&points[i].addChild(curve);curve.setParents(parents)}return curve.addChild(curve.center),curve},JXG.registerElement("ellipse",JXG.createEllipse),JXG.registerElement("hyperbola",JXG.createHyperbola),JXG.registerElement("parabola",JXG.createParabola),JXG.registerElement("conic",JXG.createConic),{createEllipse:JXG.createEllipse,createHyperbola:JXG.createHyperbola,createParabola:JXG.createParabola,createConic:JXG.createConic}})),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],(function(JXG,GeometryElement,Coords,Const,Conic,GeonextParser,Type){return JXG.Circle=function(board,method,par1,par2,attributes){this.constructor(board,attributes,Const.OBJECT_TYPE_CIRCLE,Const.OBJECT_CLASS_CIRCLE),this.method=method,this.midpoint=this.board.select(par1),this.center=this.board.select(par1),this.point2=null,this.radius=0,this.line=null,this.circle=null,this.points=[],"twoPoints"===method?(this.point2=board.select(par2),this.radius=this.Radius()):"pointRadius"===method?(this.gxtterm=par2,this.updateRadius=Type.createFunction(par2,this.board,null,!0),this.updateRadius()):"pointLine"===method?(this.line=board.select(par2),this.radius=this.line.point1.coords.distance(Const.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"===method&&(this.circle=board.select(par2),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),Type.exists(this.center._is_new)?(this.addChild(this.center),delete this.center._is_new):this.center.addChild(this),"pointRadius"===method?this.notifyParents(par2):"pointLine"===method?this.line.addChild(this):"pointCircle"===method?this.circle.addChild(this):"twoPoints"===method&&(Type.exists(this.point2._is_new)?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this)),this.methodMap=Type.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},JXG.Circle.prototype=new GeometryElement,JXG.extend(JXG.Circle.prototype,{hasPoint:function(x,y){var prec,type,dx,dy,dist,mp=this.center.coords.usrCoords,p=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board),r=this.Radius();return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,dx=mp[1]-p.usrCoords[1],dy=mp[2]-p.usrCoords[2],dist=Math.sqrt(dx*dx+dy*dy),prec+=.5*Type.evaluate(this.visProp.strokewidth),prec/=Math.sqrt(this.board.unitX*this.board.unitY),Type.evaluate(this.visProp.hasinnerpoints)?dist<r+prec:Math.abs(dist-r)<prec},generatePolynomial:function(p){var m1=this.center.symbolic.x,m2=this.center.symbolic.y,g1=p.symbolic.x,g2=p.symbolic.y,rsq=this.generateRadiusSquared();return""===rsq?[]:["(("+g1+")-("+m1+"))^2 + (("+g2+")-("+m2+"))^2 - ("+rsq+")"]},generateRadiusSquared:function(){var m1,m2,p1,p2,rsq="";return"twoPoints"===this.method?(m1=this.center.symbolic.x,m2=this.center.symbolic.y,rsq="(("+(p1=this.point2.symbolic.x)+")-("+m1+"))^2 + (("+(p2=this.point2.symbolic.y)+")-("+m2+"))^2"):"pointRadius"===this.method?Type.isNumber(this.radius)&&(rsq=(this.radius*this.radius).toString()):"pointLine"===this.method?(p1=this.line.point1.symbolic.x,p2=this.line.point1.symbolic.y,rsq="(("+p1+")-("+this.line.point2.symbolic.x+"))^2 + (("+p2+")-("+this.line.point2.symbolic.y+"))^2"):"pointCircle"===this.method&&(rsq=this.circle.Radius()),rsq},update:function(){var x,y,z,r,c,i;if(this.needsUpdate)for(Type.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),"pointLine"===this.method?this.radius=this.line.point1.coords.distance(Const.COORDS_BY_USER,this.line.point2.coords):"pointCircle"===this.method?this.radius=this.circle.Radius():"pointRadius"===this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform(),z=this.center.coords.usrCoords[0],x=this.center.coords.usrCoords[1]/z,y=this.center.coords.usrCoords[2]/z,z/=z,r=this.Radius(),c=.551915024494,this.numberPoints=13,this.dataX=[x+r,x+r,x+r*c,x,x-r*c,x-r,x-r,x-r,x-r*c,x,x+r*c,x+r,x+r],this.dataY=[y,y+r*c,y+r,y+r,y+r,y+r*c,y,y-r*c,y-r,y-r,y-r,y-r*c,y],this.bezierDegree=3,i=0;i<this.numberPoints;i++)this.points[i]=new Coords(Const.COORDS_BY_USER,[this.dataX[i],this.dataY[i]],this.board);return this},updateQuadraticform:function(){var m=this.center,mX=m.X(),mY=m.Y(),r=this.Radius();this.quadraticform=[[mX*mX+mY*mY-r*r,-mX,-mY],[-mX,1,0],[-mY,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=Type.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(contentStr){Type.isString(contentStr)&&GeonextParser.findDependencies(this,contentStr,this.board)},setRadius:function(r){return this.updateRadius=Type.createFunction(r,this.board,null,!0),this.board.update(),this},Radius:function(value){return Type.exists(value)?(this.setRadius(value),this.Radius()):"twoPoints"===this.method?Type.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||Type.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):"pointLine"===this.method||"pointCircle"===this.method?this.radius:"pointRadius"===this.method?this.updateRadius():NaN},getRadius:function(){return JXG.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var x,y,r=this.Radius(),c=this.center.coords.usrCoords,SQRTH=.7071067811865476;switch(Type.evaluate(this.visProp.label.position)){case"lft":x=c[1]-r,y=c[2];break;case"llft":x=c[1]-SQRTH*r,y=c[2]-SQRTH*r;break;case"rt":x=c[1]+r,y=c[2];break;case"lrt":x=c[1]+SQRTH*r,y=c[2]-SQRTH*r;break;case"urt":x=c[1]+SQRTH*r,y=c[2]+SQRTH*r;break;case"top":x=c[1],y=c[2]+r;break;case"bot":x=c[1],y=c[2]-r;break;default:x=c[1]-SQRTH*r,y=c[2]+SQRTH*r}return new Coords(Const.COORDS_BY_USER,[x,y],this.board)},cloneToBackground:function(){var er,r=this.Radius(),copy={id:this.id+"T"+this.numTraces,elementClass:Const.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return r},getRadius:function(){return r},board:this.board,visProp:Type.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return copy.visProp.layer=this.board.options.layer.trace,this.numTraces++,Type.clearVisPropOld(copy),copy.visPropCalc={visible:Type.evaluate(copy.visProp.visible)},er=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(copy),this.board.renderer.enhancedRendering=er,this.traces[copy.id]=copy.rendNode,this},addTransform:function(transform){var i,list=Type.isArray(transform)?transform:[transform],len=list.length;for(i=0;i<len;i++)this.center.transformations.push(list[i]),"twoPoints"===this.method&&this.point2.transformations.push(list[i]);return this},snapToGrid:function(){var forceIt=Type.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(forceIt,!0),"twoPoints"===this.method&&this.point2.handleSnapToGrid(forceIt,!0),this},snapToPoints:function(){var forceIt=Type.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(forceIt),"twoPoints"===this.method&&this.point2.handleSnapToPoints(forceIt),this},X:function(t){return this.Radius()*Math.cos(2*t*Math.PI)+this.center.coords.usrCoords[1]},Y:function(t){return this.Radius()*Math.sin(2*t*Math.PI)+this.center.coords.usrCoords[2]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var r=this.Radius();return r*r*Math.PI},bounds:function(){var uc=this.center.coords.usrCoords,r=this.Radius();return[uc[1]-r,uc[2]+r,uc[1]+r,uc[2]-r]},getParents:function(){return 1===this.parents.length?this.parents.concat(this.radius):this.parents}}),JXG.createCircle=function(board,parents,attributes){var el,p,i,attr,obj,point_style=["center","point2"];if(p=[],obj=board.select(parents[0]),Type.isObject(obj)&&obj.elementClass===Const.OBJECT_CLASS_CIRCLE&&Type.isTransformationOrArray(parents[1]))return attr=Type.copyAttributes(attributes,board.options,"circle"),(el=Conic.createEllipse(board,[obj.center,obj.center,function(){return 2*obj.Radius()}],attr)).addTransform(parents[1]),el;for(i=0;i<parents.length;i++)if(Type.isPointType(board,parents[i])){if(!1===(p=p.concat(Type.providePoints(board,[parents[i]],attributes,"circle",[point_style[i]])))[p.length-1])throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else p.push(parents[i]);if(attr=Type.copyAttributes(attributes,board.options,"circle"),2===p.length&&Type.isPoint(p[0])&&Type.isPoint(p[1]))el=new JXG.Circle(board,"twoPoints",p[0],p[1],attr);else if((Type.isNumber(p[0])||Type.isFunction(p[0])||Type.isString(p[0]))&&Type.isPoint(p[1]))el=new JXG.Circle(board,"pointRadius",p[1],p[0],attr);else if((Type.isNumber(p[1])||Type.isFunction(p[1])||Type.isString(p[1]))&&Type.isPoint(p[0]))el=new JXG.Circle(board,"pointRadius",p[0],p[1],attr);else if(p[0].elementClass===Const.OBJECT_CLASS_CIRCLE&&Type.isPoint(p[1]))el=new JXG.Circle(board,"pointCircle",p[1],p[0],attr);else if(p[1].elementClass===Const.OBJECT_CLASS_CIRCLE&&Type.isPoint(p[0]))el=new JXG.Circle(board,"pointCircle",p[0],p[1],attr);else if(p[0].elementClass===Const.OBJECT_CLASS_LINE&&Type.isPoint(p[1]))el=new JXG.Circle(board,"pointLine",p[1],p[0],attr);else if(p[1].elementClass===Const.OBJECT_CLASS_LINE&&Type.isPoint(p[0]))el=new JXG.Circle(board,"pointLine",p[0],p[1],attr);else{if(!(3===parents.length&&Type.isPoint(p[0])&&Type.isPoint(p[1])&&Type.isPoint(p[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]");if(!JXG.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");el=JXG.elements.circumcircle(board,p,attr)}for(el.isDraggable=!0,el.setParents(p),el.elType="circle",i=0;i<p.length;i++)Type.isPoint(p[i])&&el.inherits.push(p[i]);return el},JXG.registerElement("circle",JXG.createCircle),{Circle:JXG.Circle,createCircle:JXG.createCircle}})),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element"],(function(JXG,Const,Coords,Statistics,Geometry,Type,GeometryElement){return JXG.Polygon=function(board,vertices,attributes){this.constructor(board,attributes,Const.OBJECT_TYPE_POLYGON,Const.OBJECT_CLASS_AREA);var i,l,len,j,p,attr_line=Type.copyAttributes(attributes,board.options,"polygon","borders");for(this.withLines=attributes.withlines,this.attr_line=attr_line,this.vertices=[],i=0;i<vertices.length;i++)this.vertices[i]=this.board.select(vertices[i]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(len=this.vertices.length-1,j=0;j<len;j++)i=(j+1)%len,attr_line.id=attr_line.ids&&attr_line.ids[i],attr_line.name=attr_line.names&&attr_line.names[i],attr_line.strokecolor=Type.isArray(attr_line.colors)&&attr_line.colors[i%attr_line.colors.length]||attr_line.strokecolor,attr_line.visible=Type.exists(attributes.borders.visible)?attributes.borders.visible:attributes.visible,!1===attr_line.strokecolor&&(attr_line.strokecolor="none"),(l=board.create("segment",[this.vertices[i],this.vertices[i+1]],attr_line)).dump=!1,this.borders[i]=l,l.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),i=0;i<this.vertices.length-1;i++)p=this.board.select(this.vertices[i]),Type.exists(p._is_new)?(this.addChild(p),delete p._is_new):p.addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=JXG.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},JXG.Polygon.prototype=new GeometryElement,JXG.extend(JXG.Polygon.prototype,{pnpoly:function(x_in,y_in,coord_type){var i,j,len,x,y,crds,v=this.vertices,isIn=!1;for(coord_type===Const.COORDS_BY_USER?(x=(crds=new Coords(Const.COORDS_BY_USER,[x_in,y_in],this.board)).scrCoords[1],y=crds.scrCoords[2]):(x=x_in,y=y_in),i=0,j=(len=this.vertices.length)-2;i<len-1;j=i++)v[i].coords.scrCoords[2]>y!=v[j].coords.scrCoords[2]>y&&x<(v[j].coords.scrCoords[1]-v[i].coords.scrCoords[1])*(y-v[i].coords.scrCoords[2])/(v[j].coords.scrCoords[2]-v[i].coords.scrCoords[2])+v[i].coords.scrCoords[1]&&(isIn=!isIn);return isIn},hasPoint:function(x,y){var i,len;if(Type.evaluate(this.visProp.hasinnerpoints)&&this.pnpoly(x,y))return!0;for(len=this.borders.length,i=0;i<len;i++)if(this.borders[i].hasPoint(x,y))return!0;return!1},updateRenderer:function(){var i,len;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(len=this.vertices.length,this.isReal=!0,i=0;i<len;++i)if(!this.vertices[i].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var a,b,x,y,i;if(0===this.vertices.length)return new Coords(Const.COORDS_BY_USER,[1,0,0],this.board);for(x=a=this.vertices[0].X(),y=b=this.vertices[0].Y(),i=0;i<this.vertices.length;i++)this.vertices[i].X()<a&&(a=this.vertices[i].X()),this.vertices[i].X()>x&&(x=this.vertices[i].X()),this.vertices[i].Y()>b&&(b=this.vertices[i].Y()),this.vertices[i].Y()<y&&(y=this.vertices[i].Y());return new Coords(Const.COORDS_BY_USER,[.5*(a+x),.5*(b+y)],this.board)},getLabelAnchor:JXG.shortcut(JXG.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var er,copy={};return copy.id=this.id+"T"+this.numTraces,this.numTraces++,copy.vertices=this.vertices,copy.visProp=Type.deepCopy(this.visProp,this.visProp.traceattributes,!0),copy.visProp.layer=this.board.options.layer.trace,copy.board=this.board,Type.clearVisPropOld(copy),copy.visPropCalc={visible:Type.evaluate(copy.visProp.visible)},er=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(copy),this.board.renderer.enhancedRendering=er,this.traces[copy.id]=copy.rendNode,this},hideElement:function(borderless){var i;if(JXG.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!borderless)for(i=0;i<this.borders.length;i++)this.borders[i].hideElement();this.hasLabel&&Type.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(borderless){var i;if(JXG.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!borderless)for(i=0;i<this.borders.length;i++)this.borders[i].showElement().updateRenderer();return Type.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(Geometry.signedPolygon(this.vertices,!0))},Perimeter:function(){var i,len=this.vertices.length,val=0;for(i=1;i<len;++i)val+=this.vertices[i].Dist(this.vertices[i-1]);return val},boundingBox:function(){var i,v,box=[0,0,0,0],le=this.vertices.length-1;if(0===le)return box;for(box[0]=this.vertices[0].X(),box[2]=box[0],box[1]=this.vertices[0].Y(),box[3]=box[1],i=1;i<le;++i)(v=this.vertices[i].X())<box[0]?box[0]=v:v>box[2]&&(box[2]=v),(v=this.vertices[i].Y())>box[1]?box[1]=v:v<box[3]&&(box[3]=v);return box},bounds:function(){return this.boundingBox()},remove:function(){var i;for(i=0;i<this.borders.length;i++)this.board.removeObject(this.borders[i]);GeometryElement.prototype.remove.call(this)},findPoint:function(p){var i;if(!Type.isPoint(p))return-1;for(i=0;i<this.vertices.length;i++)if(this.vertices[i].id===p.id)return i;return-1},addPoints:function(p){var args=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(args))},insertPoints:function(idx,p){var i,le;if(0===arguments.length)return this;if(idx<-1||idx>this.vertices.length-2)return this;for(le=arguments.length-1,i=1;i<le+1;i++)this.vertices.splice(idx+i,0,Type.providePoints(this.board,[arguments[i]],{},"polygon",["vertices"])[0]);if(-1===idx&&(this.vertices[this.vertices.length-1]=this.vertices[0]),this.withLines)for(idx<0?this.borders[this.borders.length-1].point2=this.vertices[this.vertices.length-1]:this.borders[idx].point2=this.vertices[idx+1],i=idx+1;i<idx+1+le;i++)this.borders.splice(i,0,this.board.create("segment",[this.vertices[i],this.vertices[i+1]],this.attr_line));return this.board.update(),this},removePoints:function(p){var i,j,idx,nvertices=[],nborders=[],nidx=[],partition=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),i=0;i<arguments.length;i++)idx=arguments[i],Type.isPoint(idx)&&(idx=this.findPoint(idx)),Type.isNumber(idx)&&idx>-1&&idx<this.vertices.length&&-1===Type.indexOf(nidx,idx)&&nidx.push(idx);for(i=0;i<nidx.length;i++)this.vertices[nidx[i]].removeChild(this);for(nidx=nidx.sort(),nvertices=this.vertices.slice(),nborders=this.borders.slice(),this.withLines&&partition.push([nidx[nidx.length-1]]),i=nidx.length-1;i>-1;i--)nvertices[nidx[i]]=-1,this.withLines&&nidx[i]-1>nidx[i-1]&&(partition[partition.length-1][1]=nidx[i],partition.push([nidx[i-1]]));for(this.withLines&&(partition[partition.length-1][1]=nidx[0]),this.vertices=[],i=0;i<nvertices.length;i++)Type.isPoint(nvertices[i])&&this.vertices.push(nvertices[i]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(i=0;i<partition.length;i++){for(j=partition[i][1]-1;j<partition[i][0]+1;j++)j<0?(j=0,this.board.removeObject(this.borders[nborders.length-1]),nborders[nborders.length-1]=-1):j>nborders.length-1&&(j=nborders.length-1),this.board.removeObject(this.borders[j]),nborders[j]=-1;0!==partition[i][1]&&partition[i][0]!==nvertices.length-1&&(nborders[partition[i][0]-1]=this.board.create("segment",[nvertices[Math.max(partition[i][1]-1,0)],nvertices[Math.min(partition[i][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],i=0;i<nborders.length;i++)-1!==nborders[i]&&this.borders.push(nborders[i]);partition[0][1]!==this.vertices.length-1&&0!==partition[partition.length-1][1]||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var i,attr=GeometryElement.prototype.getAttributes.call(this);if(this.withLines)for(attr.lines=attr.lines||{},attr.lines.ids=[],attr.lines.colors=[],i=0;i<this.borders.length;i++)attr.lines.ids.push(this.borders[i].id),attr.lines.colors.push(this.borders[i].visProp.strokecolor);return attr},snapToGrid:function(){var i,force;for(force=!!Type.evaluate(this.visProp.snaptogrid),i=0;i<this.vertices.length;i++)this.vertices[i].handleSnapToGrid(force,!0)},setPositionDirectly:function(method,coords,oldcoords){var dc,i,len,c=new Coords(method,coords,this.board),oldc=new Coords(method,oldcoords,this.board);for(len=this.vertices.length-1,i=0;i<len;i++)if(!this.vertices[i].draggable())return this;return dc=Statistics.subtract(c.usrCoords,oldc.usrCoords),this.board.create("transform",dc.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(polygon){var lenIn,inputList,i,j,S,E,cross,clip=JXG.Math.Geometry.sortVertices(this.vertices),subject=JXG.Math.Geometry.sortVertices(polygon.vertices),lenClip=clip.length-1,lenSubject=subject.length-1,outputList=[],isInside=function(c1,c2,c3){return(c2[1]-c1[1])*(c3[2]-c1[2])-(c2[2]-c1[2])*(c3[1]-c1[1])>=0};for(i=0;i<lenSubject;i++)outputList.push(subject[i]);for(i=0;i<lenClip;i++)for(inputList=outputList.slice(0),outputList=[],S=inputList[(lenIn=inputList.length)-1],j=0;j<lenIn;j++)E=inputList[j],isInside(clip[i],clip[i+1],E)?(isInside(clip[i],clip[i+1],S)||((cross=JXG.Math.Geometry.meetSegmentSegment(S,E,clip[i],clip[i+1]))[0][1]/=cross[0][0],cross[0][2]/=cross[0][0],cross[0][0]=1,outputList.push(cross[0])),outputList.push(E)):isInside(clip[i],clip[i+1],S)&&((cross=JXG.Math.Geometry.meetSegmentSegment(S,E,clip[i],clip[i+1]))[0][1]/=cross[0][0],cross[0][2]/=cross[0][0],cross[0][0]=1,outputList.push(cross[0])),S=E;return outputList},intersect:function(polygon){return this.sutherlandHodgman(polygon)}}),JXG.createPolygon=function(board,parents,attributes){var el,i,le,obj,attr,attr_points,points=[],is_transform=!1;if(Type.copyAttributes(attributes,board.options,"polygon"),null===(obj=board.select(parents[0]))&&(obj=parents[0]),Type.isObject(obj)&&obj.type===Const.OBJECT_TYPE_POLYGON&&Type.isTransformationOrArray(parents[1]))for(is_transform=!0,le=obj.vertices.length-1,attr_points=Type.copyAttributes(attributes,board.options,"polygon","vertices"),i=0;i<le;i++)attr_points.withlabel&&(attr_points.name=""===obj.vertices[i].name?"":obj.vertices[i].name+"'"),points.push(board.create("point",[obj.vertices[i],parents[1]],attr_points));else if(!1===(points=Type.providePoints(board,parents,attributes,"polygon",["vertices"])))throw new Error("JSXGraph: Can't create polygon / polygonalchain with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(attr=Type.copyAttributes(attributes,board.options,"polygon"),(el=new JXG.Polygon(board,points,attr)).isDraggable=!0,is_transform)for(el.prepareUpdate().update().updateVisibility().updateRenderer(),le=obj.vertices.length-1,i=0;i<le;i++)points[i].prepareUpdate().update().updateVisibility().updateRenderer();return el},JXG.createRegularPolygon=function(board,parents,attributes){var el,i,n,rot,len,pointsExist,attr,p=[];if(n=parents[(len=parents.length)-1],Type.isNumber(n)&&(3!==parents.length||n<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(Type.isNumber(board.select(n))?(len--,pointsExist=!1):(n=len,pointsExist=!0),!1===(p=Type.providePoints(board,parents.slice(0,len),attributes,"regularpolygon",["vertices"])))throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(attr=Type.copyAttributes(attributes,board.options,"regularpolygon","vertices"),i=2;i<n;i++)rot=board.create("transform",[Math.PI*(2-(n-2)/n),p[i-1]],{type:"rotate"}),pointsExist?(p[i].addTransform(p[i-2],rot),p[i].fullUpdate()):(Type.isArray(attr.ids)&&attr.ids.length>=n-2&&(attr.id=attr.ids[i-2]),p[i]=board.create("point",[p[i-2],rot],attr),p[i].type=Const.OBJECT_TYPE_CAS,p[i].isDraggable=!0,p[i].visProp.fixed=!1);return attr=Type.copyAttributes(attributes,board.options,"regularpolygon"),(el=board.create("polygon",p,attr)).elType="regularpolygon",el},JXG.createPolygonalChain=function(board,parents,attributes){var attr,el;return attr=Type.copyAttributes(attributes,board.options,"polygonalchain"),(el=board.create("polygon",parents,attr)).elType="polygonalchain",el.vertices.pop(),board.removeObject(el.borders[el.borders.length-1]),el.borders.pop(),el},JXG.registerElement("polygon",JXG.createPolygon),JXG.registerElement("regularpolygon",JXG.createRegularPolygon),JXG.registerElement("polygonalchain",JXG.createPolygonalChain),{Polygon:JXG.Polygon,createPolygon:JXG.createPolygon,createRegularPolygon:JXG.createRegularPolygon}})),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/numerics","math/plot","math/geometry","parser/geonext","utils/type","math/qdt"],(function(JXG,Const,Coords,GeometryElement,Mat,Numerics,Plot,Geometry,GeonextParser,Type,QDT){return JXG.Curve=function(board,parents,attributes){this.constructor(board,attributes,Const.OBJECT_TYPE_CURVE,Const.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=Type.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.ticks=[],this.qdt=null,Type.exists(parents[0])?this.varname=parents[0]:this.varname="x",this.xterm=parents[1],this.yterm=parents[2],this.generateTerm(this.varname,this.xterm,this.yterm,parents[3],parents[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),Type.isString(this.xterm)&&this.notifyParents(this.xterm),Type.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=Type.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},JXG.Curve.prototype=new GeometryElement,JXG.extend(JXG.Curve.prototype,{minX:function(){return"polar"===Type.evaluate(this.visProp.curvetype)?0:new Coords(Const.COORDS_BY_SCREEN,[.1*-this.board.canvasWidth,0],this.board,!1).usrCoords[1]},maxX:function(){return"polar"===Type.evaluate(this.visProp.curvetype)?2*Math.PI:new Coords(Const.COORDS_BY_SCREEN,[1.1*this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(t){return NaN},Y:function(t){return NaN},Z:function(t){return 1},hasPoint:function(x,y,start){var t,checkPoint,len,invMat,c,i,tX,tY,points,qdt,prec,type,ux2,uy2,ev_ct,mi,res=[],steps=Type.evaluate(this.visProp.numberpointslow),d=(this.maxX()-this.minX())/steps,dist=1/0;if(Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,x=(checkPoint=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board,!1)).usrCoords[1],y=checkPoint.usrCoords[2],prec+=.5*Type.evaluate(this.visProp.strokewidth),prec*=prec,ux2=this.board.unitX*this.board.unitX,uy2=this.board.unitY*this.board.unitY,mi=this.minX(),this.maxX(),Type.exists(this._visibleArea)&&(mi=this._visibleArea[0],d=(this._visibleArea[1]-mi)/steps),"parameter"===(ev_ct=Type.evaluate(this.visProp.curvetype))||"polar"===ev_ct)for(this.transformations.length>0&&(this.updateTransformMatrix(),invMat=Mat.inverse(this.transformMat),x=(c=Mat.matVecMult(invMat,[1,x,y]))[1],y=c[2]),i=0,t=mi;i<steps;i++){if((dist=(x-(tX=this.X(t,true)))*(x-tX)*ux2+(y-(tY=this.Y(t,true)))*(y-tY)*uy2)<=prec)return!0;t+=d}else if("plot"===ev_ct||"functiongraph"===ev_ct){for((!Type.exists(start)||start<0)&&(start=0),Type.exists(this.qdt)&&Type.evaluate(this.visProp.useqdt)&&3!==this.bezierDegree?len=(points=(qdt=this.qdt.query(new Coords(Const.COORDS_BY_USER,[x,y],this.board))).points).length:(points=this.points,len=this.numberPoints-1),i=start;i<len;i++)if(3===this.bezierDegree?res.push(Geometry.projectCoordsToBeziersegment([1,x,y],this,i)):qdt?(points[i].prev&&(res=Geometry.projectCoordsToSegment([1,x,y],points[i].prev.usrCoords,points[i].usrCoords)),points[i].next&&points[i+1]!==points[i].next&&(res=Geometry.projectCoordsToSegment([1,x,y],points[i].usrCoords,points[i].next.usrCoords))):res=Geometry.projectCoordsToSegment([1,x,y],points[i].usrCoords,points[i+1].usrCoords),res[1]>=0&&res[1]<=1&&(x-res[0][1])*(x-res[0][1])*ux2+(y-res[0][2])*(y-res[0][2])*uy2<=prec)return!0;return!1}return dist<prec},allocatePoints:function(){var i,len;if(len=this.numberPoints,this.points.length<this.numberPoints)for(i=this.points.length;i<len;i++)this.points[i]=new Coords(Const.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(Type.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=Plot.checkReal(this.points),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var len,mi,ma,x,y,i,version=this.visProp.plotversion,suspendUpdate=!1;if(this.updateTransformMatrix(),this.updateDataArray(),mi=this.minX(),ma=this.maxX(),Type.exists(this.dataX))for(this.numberPoints=this.dataX.length,len=this.numberPoints,this.allocatePoints(),i=0;i<len;i++)x=i,Type.exists(this.dataY)?(y=i,this.points[i].setCoordinates(Const.COORDS_BY_USER,[this.dataX[i],this.dataY[i]],!1)):(y=this.X(x),this.points[i].setCoordinates(Const.COORDS_BY_USER,[this.dataX[i],this.Y(y,suspendUpdate)],!1)),this.points[i]._t=i,suspendUpdate=!0;else if(Type.evaluate(this.visProp.doadvancedplot)?1===version||Type.evaluate(this.visProp.doadvancedplotold)?Plot.updateParametricCurveOld(this,mi,ma):2===version?Plot.updateParametricCurve_v2(this,mi,ma):3===version?Plot.updateParametricCurve_v3(this,mi,ma):4===version?Plot.updateParametricCurve_v4(this,mi,ma):Plot.updateParametricCurve_v2(this,mi,ma):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=Type.evaluate(this.visProp.numberpointshigh):this.numberPoints=Type.evaluate(this.visProp.numberpointslow),this.allocatePoints(),Plot.updateParametricCurveNaive(this,mi,ma,this.numberPoints)),len=this.numberPoints,Type.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new QDT(this.board.getBoundingBox()),i=0;i<this.points.length;i++)this.qdt.insert(this.points[i]),i>0&&(this.points[i].prev=this.points[i-1]),i<len-1&&(this.points[i].next=this.points[i+1]);for("plot"!==Type.evaluate(this.visProp.curvetype)&&Type.evaluate(this.visProp.rdpsmoothing)&&(this.points=Numerics.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),len=this.numberPoints,i=0;i<len;i++)this.updateTransform(this.points[i]);return this},updateTransformMatrix:function(){var t,i,len=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],i=0;i<len;i++)(t=this.transformations[i]).update(),this.transformMat=Mat.matMatMult(t.matrix,this.transformMat);return this},updateTransform:function(p){var c;return this.transformations.length>0&&(c=Mat.matVecMult(this.transformMat,p.usrCoords),p.setCoordinates(Const.COORDS_BY_USER,c,!1,!0)),p},addTransform:function(transform){var i,list=Type.isArray(transform)?transform:[transform],len=list.length;for(i=0;i<len;i++)this.transformations.push(list[i]);return this},interpolationFunctionFromArray:function(which){var data="data"+which,that=this;return function(t,suspendedUpdate){var i,j,t0,t1,arr=that[data],len=arr.length,f=[];if(isNaN(t))return NaN;if(t<0)return Type.isFunction(arr[0])?arr[0]():arr[0];if(3===that.bezierDegree){if(t>=(len-1)/3)return Type.isFunction(arr[arr.length-1])?arr[arr.length-1]():arr[arr.length-1];for(i=3*Math.floor(t),t1=1-(t0=t%1),j=0;j<4;j++)Type.isFunction(arr[i+j])?f[j]=arr[i+j]():f[j]=arr[i+j];return t1*t1*(t1*f[0]+3*t0*f[1])+(3*t1*f[2]+t0*f[3])*t0*t0}if((i=t>len-2?len-2:parseInt(Math.floor(t),10))===t)return Type.isFunction(arr[i])?arr[i]():arr[i];for(j=0;j<2;j++)Type.isFunction(arr[i+j])?f[j]=arr[i+j]():f[j]=arr[i+j];return f[0]+(f[1]-f[0])*(t-i)}},generateTerm:function(varname,xterm,yterm,mi,ma){var fx,fy;Type.isArray(xterm)?(this.dataX=xterm,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray.apply(this,["X"]),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=Type.createFunction(xterm,this.board,varname),Type.isString(xterm)?this.visProp.curvetype="functiongraph":(Type.isFunction(xterm)||Type.isNumber(xterm))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),Type.isArray(yterm)?(this.dataY=yterm,this.Y=this.interpolationFunctionFromArray.apply(this,["Y"])):this.Y=Type.createFunction(yterm,this.board,varname),Type.isFunction(xterm)&&Type.isArray(yterm)&&(fx=Type.createFunction(yterm[0],this.board,""),fy=Type.createFunction(yterm[1],this.board,""),this.X=function(phi){return xterm(phi)*Math.cos(phi)+fx()},this.Y=function(phi){return xterm(phi)*Math.sin(phi)+fy()},this.visProp.curvetype="polar"),Type.exists(mi)&&(this.minX=Type.createFunction(mi,this.board,"")),Type.exists(ma)&&(this.maxX=Type.createFunction(ma,this.board,""))},notifyParents:function(contentStr){var fstr,dep,obj,isJessieCode=!1;for(fstr in obj={xterm:1,yterm:1})if(obj.hasOwnProperty(fstr)&&this.hasOwnProperty(fstr)&&this[fstr].origin)for(dep in isJessieCode=!0,this[fstr].origin.deps)this[fstr].origin.deps.hasOwnProperty(dep)&&this[fstr].origin.deps[dep].addChild(this);isJessieCode||GeonextParser.findDependencies(this,contentStr,this.board)},getLabelAnchor:function(){var c,x,y,ax=.05*this.board.canvasWidth,ay=.05*this.board.canvasHeight,bx=.95*this.board.canvasWidth,by=.95*this.board.canvasHeight;switch(Type.evaluate(this.visProp.label.position)){case"ulft":x=ax,y=ay;break;case"llft":x=ax,y=by;break;case"rt":x=bx,y=.5*by;break;case"lrt":x=bx,y=by;break;case"urt":x=bx,y=ay;break;case"top":x=.5*bx,y=ay;break;case"bot":x=.5*bx,y=by;break;default:x=ax,y=.5*by}return c=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board,!1),Geometry.projectCoordsToCurve(c.usrCoords[1],c.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var er,copy={id:this.id+"T"+this.numTraces,elementClass:Const.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:Type.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return copy.visProp.layer=this.board.options.layer.trace,copy.visProp.curvetype=this.visProp.curvetype,this.numTraces++,Type.clearVisPropOld(copy),copy.visPropCalc={visible:Type.evaluate(copy.visProp.visible)},er=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(copy),this.board.renderer.enhancedRendering=er,this.traces[copy.id]=copy.rendNode,this},bounds:function(){var i,bezier,up,minX=1/0,maxX=-1/0,minY=1/0,maxY=-1/0,l=this.points.length;if(3===this.bezierDegree){for(i=0;i<l;i++)this.points[i].X=Type.bind((function(){return this.usrCoords[1]}),this.points[i]),this.points[i].Y=Type.bind((function(){return this.usrCoords[2]}),this.points[i]);return up=(bezier=Numerics.bezier(this.points))[3](),minX=Numerics.fminbr((function(t){return bezier[0](t)}),[0,up]),maxX=Numerics.fminbr((function(t){return-bezier[0](t)}),[0,up]),minY=Numerics.fminbr((function(t){return bezier[1](t)}),[0,up]),maxY=Numerics.fminbr((function(t){return-bezier[1](t)}),[0,up]),minX=bezier[0](minX),maxX=bezier[0](maxX),minY=bezier[1](minY),[minX,maxY=bezier[1](maxY),maxX,minY]}for(i=0;i<l;i++)minX>this.points[i].usrCoords[1]&&(minX=this.points[i].usrCoords[1]),maxX<this.points[i].usrCoords[1]&&(maxX=this.points[i].usrCoords[1]),minY>this.points[i].usrCoords[2]&&(minY=this.points[i].usrCoords[2]),maxY<this.points[i].usrCoords[2]&&(maxY=this.points[i].usrCoords[2]);return[minX,maxY,maxX,minY]},getParents:function(){var p=[this.xterm,this.yterm,this.minX(),this.maxX()];return 0!==this.parents.length&&(p=this.parents),p},moveTo:function(where){var p,delta=[];return this.points.length>0&&!Type.evaluate(this.visProp.fixed)&&(p=this.points[0],delta=3===where.length?[where[0]-p.usrCoords[0],where[1]-p.usrCoords[1],where[2]-p.usrCoords[2]]:[where[0]-p.usrCoords[1],where[1]-p.usrCoords[2]],this.setPosition(Const.COORDS_BY_USER,delta)),this},getTransformationSource:function(){var isTransformed,curve_org;return Type.exists(this._transformationSource)&&(curve_org=this._transformationSource).elementClass===Const.OBJECT_CLASS_CURVE&&(isTransformed=!0),[isTransformed,curve_org]}}),JXG.createCurve=function(board,parents,attributes){var obj,cu,attr=Type.copyAttributes(attributes,board.options,"curve");return obj=board.select(parents[0],!0),Type.isObject(obj)&&(obj.type===Const.OBJECT_TYPE_CURVE||obj.type===Const.OBJECT_TYPE_ANGLE||obj.type===Const.OBJECT_TYPE_ARC||obj.type===Const.OBJECT_TYPE_CONIC||obj.type===Const.OBJECT_TYPE_SECTOR)&&Type.isTransformationOrArray(parents[1])?(obj.type===Const.OBJECT_TYPE_SECTOR?attr=Type.copyAttributes(attributes,board.options,"sector"):obj.type===Const.OBJECT_TYPE_ARC?attr=Type.copyAttributes(attributes,board.options,"arc"):obj.type===Const.OBJECT_TYPE_ANGLE?(Type.exists(attributes.withLabel)||(attributes.withLabel=!1),attr=Type.copyAttributes(attributes,board.options,"angle")):attr=Type.copyAttributes(attributes,board.options,"curve"),attr=Type.copyAttributes(attr,board.options,"curve"),(cu=new JXG.Curve(board,["x",[],[]],attr)).updateDataArray=function(){var i,le=obj.numberPoints;for(this.bezierDegree=obj.bezierDegree,this.dataX=[],this.dataY=[],i=0;i<le;i++)this.dataX.push(obj.points[i].usrCoords[1]),this.dataY.push(obj.points[i].usrCoords[2]);return this},cu.addTransform(parents[1]),obj.addChild(cu),cu.setParents([obj]),cu._transformationSource=obj,cu):(attr=Type.copyAttributes(attributes,board.options,"curve"),new JXG.Curve(board,["x"].concat(parents),attr))},JXG.registerElement("curve",JXG.createCurve),JXG.createFunctiongraph=function(board,parents,attributes){var attr,par=["x","x"].concat(parents);return(attr=Type.copyAttributes(attributes,board.options,"curve")).curvetype="functiongraph",new JXG.Curve(board,par,attr)},JXG.registerElement("functiongraph",JXG.createFunctiongraph),JXG.registerElement("plot",JXG.createFunctiongraph),JXG.createSpline=function(board,parents,attributes){var el,funcs,ret;return funcs=function(){var D,x=[],y=[];return[function(t,suspended){var i,j,c;if(!suspended){if(x=[],y=[],2===parents.length&&Type.isArray(parents[0])&&Type.isArray(parents[1])&&parents[0].length===parents[1].length)for(i=0;i<parents[0].length;i++)Type.isFunction(parents[0][i])?x.push(parents[0][i]()):x.push(parents[0][i]),Type.isFunction(parents[1][i])?y.push(parents[1][i]()):y.push(parents[1][i]);else for(i=0;i<parents.length;i++)if(Type.isPoint(parents[i]))x.push(parents[i].X()),y.push(parents[i].Y());else if(Type.isArray(parents[i])&&2===parents[i].length)for(j=0;j<parents.length;j++)Type.isFunction(parents[j][0])?x.push(parents[j][0]()):x.push(parents[j][0]),Type.isFunction(parents[j][1])?y.push(parents[j][1]()):y.push(parents[j][1]);else Type.isFunction(parents[i])&&2===parents[i]().length&&(c=parents[i](),x.push(c[0]),y.push(c[1]));D=Numerics.splineDef(x,y)}return Numerics.splineEval(t,x,y,D)},function(){return x[0]},function(){return x[x.length-1]}]},(attributes=Type.copyAttributes(attributes,board.options,"curve")).curvetype="functiongraph",ret=funcs(),(el=new JXG.Curve(board,["x","x",ret[0],ret[1],ret[2]],attributes)).setParents(parents),el.elType="spline",el},JXG.registerElement("spline",JXG.createSpline),JXG.createCardinalSpline=function(board,parents,attributes){var el,getPointLike,points,tau,type,p,q,i,le,splineArr,errStr="\nPossible parent types: [points:array, tau:number|function, type:string]";if(!Type.exists(parents[0])||!Type.isArray(parents[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+errStr);if(!Type.exists(parents[1])||!Type.isNumber(parents[1])&&!Type.isFunction(parents[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+errStr);if(!Type.exists(parents[2])||!Type.isString(parents[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+errStr);if(attributes=Type.copyAttributes(attributes,board.options,"curve"),(attributes=Type.copyAttributes(attributes,board.options,"cardinalspline")).curvetype="parameter",p=parents[0],q=[],!attributes.isarrayofcoordinates&&2===p.length&&Type.isArray(p[0])&&Type.isArray(p[1])&&p[0].length===p[1].length)for(i=0;i<p[0].length;i++)q[i]=[],Type.isFunction(p[0][i])?q[i].push(p[0][i]()):q[i].push(p[0][i]),Type.isFunction(p[1][i])?q[i].push(p[1][i]()):q[i].push(p[1][i]);else for(i=0;i<p.length;i++)Type.isString(p[i])?q.push(board.select(p[i])):Type.isPoint(p[i])?q.push(p[i]):Type.isArray(p[i])&&2===p[i].length?(q[i]=[],Type.isFunction(p[i][0])?q[i].push(p[i][0]()):q[i].push(p[i][0]),Type.isFunction(p[i][1])?q[i].push(p[i][1]()):q[i].push(p[i][1])):Type.isFunction(p[i])&&2===p[i]().length&&q.push(parents[i]());if(!0===attributes.createpoints)points=Type.providePoints(board,q,attributes,"cardinalspline",["points"]);else for(points=[],getPointLike=function(ii){return{X:function(){return q[ii][0]},Y:function(){return q[ii][1]},Dist:function(p){var dx=this.X()-p.X(),dy=this.Y()-p.Y();return Math.sqrt(dx*dx+dy*dy)}}},i=0;i<q.length;i++)Type.isPoint(q[i])?points.push(q[i]):points.push(getPointLike(i));for(tau=parents[1],type=parents[2],splineArr=["x"].concat(Numerics.CardinalSpline(points,tau,type)),el=new JXG.Curve(board,splineArr,attributes),le=points.length,el.setParents(points),i=0;i<le;i++)p=points[i],Type.isPoint(p)&&(Type.exists(p._is_new)?(el.addChild(p),delete p._is_new):p.addChild(el));return el.elType="cardinalspline",el},JXG.registerElement("cardinalspline",JXG.createCardinalSpline),JXG.createMetapostSpline=function(board,parents,attributes){var el,getPointLike,points,controls,p,q,i,le,errStr="\nPossible parent types: [points:array, controls:object";if(!Type.exists(parents[0])||!Type.isArray(parents[0]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 1 'points' has to be array of points or coordinate pairs"+errStr);if(!Type.exists(parents[1])||!Type.isObject(parents[1]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 2 'controls' has to be a JavaScript object'"+errStr);if(attributes=Type.copyAttributes(attributes,board.options,"curve"),(attributes=Type.copyAttributes(attributes,board.options,"metapostspline")).curvetype="parameter",p=parents[0],q=[],!attributes.isarrayofcoordinates&&2===p.length&&Type.isArray(p[0])&&Type.isArray(p[1])&&p[0].length===p[1].length)for(i=0;i<p[0].length;i++)q[i]=[],Type.isFunction(p[0][i])?q[i].push(p[0][i]()):q[i].push(p[0][i]),Type.isFunction(p[1][i])?q[i].push(p[1][i]()):q[i].push(p[1][i]);else for(i=0;i<p.length;i++)Type.isString(p[i])?q.push(board.select(p[i])):Type.isPoint(p[i])?q.push(p[i]):Type.isArray(p[i])&&2===p[i].length?(q[i]=[],Type.isFunction(p[i][0])?q[i].push(p[i][0]()):q[i].push(p[i][0]),Type.isFunction(p[i][1])?q[i].push(p[i][1]()):q[i].push(p[i][1])):Type.isFunction(p[i])&&2===p[i]().length&&q.push(parents[i]());if(!0===attributes.createpoints)points=Type.providePoints(board,q,attributes,"metapostspline",["points"]);else for(points=[],getPointLike=function(ii){return{X:function(){return q[ii][0]},Y:function(){return q[ii][1]}}},i=0;i<q.length;i++)Type.isPoint(q[i])?points.push(q[i]):points.push(getPointLike);for(controls=parents[1],(el=new JXG.Curve(board,["t",[],[],0,p.length-1],attributes)).updateDataArray=function(){var res,i,len=points.length,p=[];for(i=0;i<len;i++)p.push([points[i].X(),points[i].Y()]);res=JXG.Math.Metapost.curve(p,controls),this.dataX=res[0],this.dataY=res[1]},el.bezierDegree=3,le=points.length,el.setParents(points),i=0;i<le;i++)Type.isPoint(points[i])&&points[i].addChild(el);return el.elType="metapostspline",el},JXG.registerElement("metapostspline",JXG.createMetapostSpline),JXG.createRiemannsum=function(board,parents,attributes){var n,type,f,par,c,attr;if((attr=Type.copyAttributes(attributes,board.options,"riemannsum")).curvetype="plot",f=parents[0],n=Type.createFunction(parents[1],board,""),!Type.exists(n))throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(type=Type.createFunction(parents[2],board,"",!1),!Type.exists(type))throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return par=[[0],[0]].concat(parents.slice(3)),(c=board.create("curve",par,attr)).sum=0,c.Value=function(){return this.sum},c.updateDataArray=function(){var u=Numerics.riemann(f,n(),type(),this.minX(),this.maxX());this.dataX=u[0],this.dataY=u[1],this.sum=u[2]},c},JXG.registerElement("riemannsum",JXG.createRiemannsum),JXG.createTracecurve=function(board,parents,attributes){var c,glider,tracepoint,attr;if(2!==parents.length)throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(glider=board.select(parents[0]),tracepoint=board.select(parents[1]),glider.type!==Const.OBJECT_TYPE_GLIDER||!Type.isPoint(tracepoint))throw new Error("JSXGraph: Can't create trace curve with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [glider, point]");return(attr=Type.copyAttributes(attributes,board.options,"tracecurve")).curvetype="plot",(c=board.create("curve",[[0],[0]],attr)).updateDataArray=function(){var i,step,t,el,pEl,x,y,from,savetrace,le=attr.numberpoints,savePos=glider.position,slideObj=glider.slideObject,mi=slideObj.minX();for(step=(slideObj.maxX()-mi)/le,this.dataX=[],this.dataY=[],slideObj.elementClass!==Const.OBJECT_CLASS_CURVE&&le++,i=0;i<le;i++){for(el in t=mi+i*step,x=slideObj.X(t)/slideObj.Z(t),y=slideObj.Y(t)/slideObj.Z(t),glider.setPositionDirectly(Const.COORDS_BY_USER,[x,y]),from=!1,this.board.objects)if(this.board.objects.hasOwnProperty(el)&&((pEl=this.board.objects[el])===glider&&(from=!0),from&&pEl.needsRegularUpdate&&(savetrace=pEl.visProp.trace,pEl.visProp.trace=!1,pEl.needsUpdate=!0,pEl.update(!0),pEl.visProp.trace=savetrace,pEl===tracepoint)))break;this.dataX[i]=tracepoint.X(),this.dataY[i]=tracepoint.Y()}for(el in glider.position=savePos,from=!1,this.board.objects)if(this.board.objects.hasOwnProperty(el)&&((pEl=this.board.objects[el])===glider&&(from=!0),from&&pEl.needsRegularUpdate&&(savetrace=pEl.visProp.trace,pEl.visProp.trace=!1,pEl.needsUpdate=!0,pEl.update(!0),pEl.visProp.trace=savetrace,pEl===tracepoint)))break},c},JXG.registerElement("tracecurve",JXG.createTracecurve),JXG.createStepfunction=function(board,parents,attributes){var c,attr;if(2!==parents.length)throw new Error("JSXGraph: Can't create step function with given parent'\nPossible parent types: [array, array|function]");return attr=Type.copyAttributes(attributes,board.options,"stepfunction"),(c=board.create("curve",parents,attr)).updateDataArray=function(){var i,j=0,len=this.xterm.length;if(this.dataX=[],this.dataY=[],0!==len)for(this.dataX[j]=this.xterm[0],this.dataY[j]=this.yterm[0],++j,i=1;i<len;++i)this.dataX[j]=this.xterm[i],this.dataY[j]=this.dataY[j-1],++j,this.dataX[j]=this.xterm[i],this.dataY[j]=this.yterm[i],++j},c},JXG.registerElement("stepfunction",JXG.createStepfunction),JXG.createDerivative=function(board,parents,attributes){var c,curve,dx,dy,attr;if(1!==parents.length&&parents[0].class!==Const.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create derivative curve with given parent'\nPossible parent types: [curve]");return attr=Type.copyAttributes(attributes,board.options,"curve"),curve=parents[0],dx=Numerics.D(curve.X),dy=Numerics.D(curve.Y),(c=board.create("curve",[function(t){return curve.X(t)},function(t){return dy(t)/dx(t)},curve.minX(),curve.maxX()],attr)).setParents(curve),c},JXG.registerElement("derivative",JXG.createDerivative),JXG.createCurveIntersection=function(board,parents,attributes){var c;if(2!==parents.length)throw new Error("JSXGraph: Can't create curve intersection with given parent'\nPossible parent types: [array, array|function]");return(c=board.create("curve",[[],[]],attributes)).updateDataArray=function(){var a=JXG.Math.Clip.intersection(parents[0],parents[1],this.board);this.dataX=a[0],this.dataY=a[1]},c},JXG.createCurveUnion=function(board,parents,attributes){var c;if(2!==parents.length)throw new Error("JSXGraph: Can't create curve union with given parent'\nPossible parent types: [array, array|function]");return(c=board.create("curve",[[],[]],attributes)).updateDataArray=function(){var a=JXG.Math.Clip.union(parents[0],parents[1],this.board);this.dataX=a[0],this.dataY=a[1]},c},JXG.createCurveDifference=function(board,parents,attributes){var c;if(2!==parents.length)throw new Error("JSXGraph: Can't create curve difference with given parent'\nPossible parent types: [array, array|function]");return(c=board.create("curve",[[],[]],attributes)).updateDataArray=function(){var a=JXG.Math.Clip.difference(parents[0],parents[1],this.board);this.dataX=a[0],this.dataY=a[1]},c},JXG.registerElement("curvedifference",JXG.createCurveDifference),JXG.registerElement("curveintersection",JXG.createCurveIntersection),JXG.registerElement("curveunion",JXG.createCurveUnion),JXG.createBoxPlot=function(board,parents,attributes){var box,i,len,attr=Type.copyAttributes(attributes,board.options,"boxplot");if(3!==parents.length)throw new Error("JSXGraph: Can't create box plot with given parent'\nPossible parent types: [array, number|function, number|function] containing quantiles, axis, width");if(parents[0].length<5)throw new Error("JSXGraph: Can't create box plot with given parent[0]'\nparent[0] has to conatin at least 5 quantiles.");for(box=board.create("curve",[[],[]],attr),len=parents[0].length,box.Q=[],i=0;i<len;i++)box.Q[i]=Type.createFunction(parents[0][i],board,null,!0);return box.x=Type.createFunction(parents[1],board,null,!0),box.w=Type.createFunction(parents[2],board,null,!0),box.updateDataArray=function(){var v1,v2,l1,l2,r1,r2,w2,dir,x;w2=Type.evaluate(this.visProp.smallwidth),dir=Type.evaluate(this.visProp.dir),l1=(x=this.x())-.5*this.w(),l2=x-.5*this.w()*w2,r1=x+.5*this.w(),v1=[x,l2,r2=x+.5*this.w()*w2,x,x,l1,l1,r1,r1,x,NaN,l1,r1,NaN,x,x,l2,r2,x],v2=[this.Q[0](),this.Q[0](),this.Q[0](),this.Q[0](),this.Q[1](),this.Q[1](),this.Q[3](),this.Q[3](),this.Q[1](),this.Q[1](),NaN,this.Q[2](),this.Q[2](),NaN,this.Q[3](),this.Q[4](),this.Q[4](),this.Q[4](),this.Q[4]()],"vertical"===dir?(this.dataX=v1,this.dataY=v2):(this.dataX=v2,this.dataY=v1)},box},JXG.registerElement("boxplot",JXG.createBoxPlot),{Curve:JXG.Curve,createCardinalSpline:JXG.createCardinalSpline,createCurve:JXG.createCurve,createCurveDifference:JXG.createCurveDifference,createCurveIntersection:JXG.createCurveIntersection,createCurveUnion:JXG.createCurveUnion,createDerivative:JXG.createDerivative,createFunctiongraph:JXG.createFunctiongraph,createMetapostSpline:JXG.createMetapostSpline,createPlot:JXG.createFunctiongraph,createSpline:JXG.createSpline,createRiemannsum:JXG.createRiemannsum,createStepfunction:JXG.createStepfunction,createTracecurve:JXG.createTracecurve}})),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants"],(function(JXG,Geometry,Mat,Coords,Circle,Type,Const){return JXG.createArc=function(board,parents,attributes){var el,attr,points;if(!1===(points=Type.providePoints(board,parents,attributes,"arc",["center","radiusPoint","anglePoint"]))||points.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point], [arc, transformation]");return attr=Type.copyAttributes(attributes,board.options,"arc"),(el=board.create("curve",[[0],[0]],attr)).elType="arc",el.setParents(points),el.type=Const.OBJECT_TYPE_ARC,el.center=points[0],el.radiuspoint=points[1],el.point2=el.radiuspoint,el.anglepoint=points[2],el.point3=el.anglepoint,Type.exists(el.center._is_new)?(el.addChild(el.center),delete el.center._is_new):el.center.addChild(el),Type.exists(el.radiuspoint._is_new)?(el.addChild(el.radiuspoint),delete el.radiuspoint._is_new):el.radiuspoint.addChild(el),Type.exists(el.anglepoint._is_new)?(el.addChild(el.anglepoint),delete el.anglepoint._is_new):el.anglepoint.addChild(el),el.useDirection=attr.usedirection,el.updateDataArray=function(){var ar,phi,p0c,p1c,p2c,sgn=1,A=this.radiuspoint,B=this.center,C=this.anglepoint,ev_s=Type.evaluate(this.visProp.selection);phi=Geometry.rad(A,B,C),("minor"===ev_s&&phi>Math.PI||"major"===ev_s&&phi<Math.PI)&&(sgn=-1),this.useDirection&&(p0c=points[1].coords.usrCoords,p1c=points[3].coords.usrCoords,p2c=points[2].coords.usrCoords,(p0c[1]-p2c[1])*(p0c[2]-p1c[2])-(p0c[2]-p2c[2])*(p0c[1]-p1c[1])<0?(this.radiuspoint=points[1],this.anglepoint=points[2]):(this.radiuspoint=points[2],this.anglepoint=points[1])),A=A.coords.usrCoords,B=B.coords.usrCoords,C=C.coords.usrCoords,ar=Geometry.bezierArc(A,B,C,!1,sgn),this.dataX=ar[0],this.dataY=ar[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},el.Radius=function(){return this.radiuspoint.Dist(this.center)},el.getRadius=function(){return JXG.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},el.Value=function(){return this.Radius()*Geometry.rad(this.radiuspoint,this.center,this.anglepoint)},el.hasPoint=function(x,y){var dist,checkPoint,has,invMat,c,prec,type,r=this.Radius();return Type.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(x,y):(Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,prec/=Math.min(this.board.unitX,this.board.unitY),checkPoint=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),invMat=Mat.inverse(this.transformMat),c=Mat.matVecMult(invMat,checkPoint.usrCoords),checkPoint=new Coords(Const.COORDS_BY_USER,c,this.board)),dist=this.center.coords.distance(Const.COORDS_BY_USER,checkPoint),(has=Math.abs(dist-r)<prec)&&(has=Geometry.coordsOnArc(this,checkPoint)),has)},el.hasPointSector=function(x,y){var checkPoint=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board),r=this.Radius(),has=this.center.coords.distance(Const.COORDS_BY_USER,checkPoint)<r;return has&&(has=Geometry.coordsOnArc(this,checkPoint)),has},el.getTextAnchor=function(){return this.center.coords},el.getLabelAnchor=function(){var coords,vec,vecx,vecy,len,angle=Geometry.rad(this.radiuspoint,this.center,this.anglepoint),dx=10/this.board.unitX,dy=10/this.board.unitY,p2c=this.point2.coords.usrCoords,pmc=this.center.coords.usrCoords,bxminusax=p2c[1]-pmc[1],byminusay=p2c[2]-pmc[2],ev_s=Type.evaluate(this.visProp.selection),l_vp=this.label?this.label.visProp:this.visProp.label;return("minor"===ev_s&&angle>Math.PI||"major"===ev_s&&angle<Math.PI)&&(angle=-(2*Math.PI-angle)),vecx=(coords=new Coords(Const.COORDS_BY_USER,[pmc[1]+Math.cos(.5*angle)*bxminusax-Math.sin(.5*angle)*byminusay,pmc[2]+Math.sin(.5*angle)*bxminusax+Math.cos(.5*angle)*byminusay],this.board)).usrCoords[1]-pmc[1],vecy=coords.usrCoords[2]-pmc[2],vecx=vecx*((len=Math.sqrt(vecx*vecx+vecy*vecy))+dx)/len,vecy=vecy*(len+dy)/len,vec=[pmc[1]+vecx,pmc[2]+vecy],l_vp.position=Geometry.calcLabelQuadrant(Geometry.rad([1,0],[0,0],vec)),new Coords(Const.COORDS_BY_USER,vec,this.board)},el.updateQuadraticform=Circle.Circle.prototype.updateQuadraticform,el.updateStdform=Circle.Circle.prototype.updateStdform,el.methodMap=JXG.deepCopy(el.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),el.prepareUpdate().update(),el},JXG.registerElement("arc",JXG.createArc),JXG.createSemicircle=function(board,parents,attributes){var el,mp,attr,points;if(!1===(points=Type.providePoints(board,parents,attributes,"point"))||2!==points.length)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point]");return attr=Type.copyAttributes(attributes,board.options,"semicircle","center"),(mp=board.create("midpoint",points,attr)).dump=!1,attr=Type.copyAttributes(attributes,board.options,"semicircle"),(el=board.create("arc",[mp,points[1],points[0]],attr)).elType="semicircle",el.setParents([points[0].id,points[1].id]),el.subs={midpoint:mp},el.inherits.push(mp),el.midpoint=el.center=mp,el},JXG.registerElement("semicircle",JXG.createSemicircle),JXG.createCircumcircleArc=function(board,parents,attributes){var el,mp,attr,points;if(!1===(points=Type.providePoints(board,parents,attributes,"point"))||3!==points.length)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]");return attr=Type.copyAttributes(attributes,board.options,"circumcirclearc","center"),(mp=board.create("circumcenter",points,attr)).dump=!1,(attr=Type.copyAttributes(attributes,board.options,"circumcirclearc")).usedirection=!0,(el=board.create("arc",[mp,points[0],points[2],points[1]],attr)).elType="circumcirclearc",el.setParents([points[0].id,points[1].id,points[2].id]),el.subs={center:mp},el.inherits.push(mp),el.center=mp,el},JXG.registerElement("circumcirclearc",JXG.createCircumcircleArc),JXG.createMinorArc=function(board,parents,attributes){return attributes.selection="minor",JXG.createArc(board,parents,attributes)},JXG.registerElement("minorarc",JXG.createMinorArc),JXG.createMajorArc=function(board,parents,attributes){return attributes.selection="major",JXG.createArc(board,parents,attributes)},JXG.registerElement("majorarc",JXG.createMajorArc),{createArc:JXG.createArc,createSemicircle:JXG.createSemicircle,createCircumcircleArc:JXG.createCircumcircleArc,createMinorArc:JXG.createMinorArc,createMajorArc:JXG.createMajorArc}})),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type"],(function(JXG,Geometry,Mat,Statistics,Coords,Const,Type){return JXG.createSector=function(board,parents,attributes){var el,attr,i,s,v,points,type="invalid";if(parents[0].elementClass===Const.OBJECT_CLASS_LINE&&parents[1].elementClass===Const.OBJECT_CLASS_LINE&&(Type.isArray(parents[2])||Type.isNumber(parents[2]))&&(Type.isArray(parents[3])||Type.isNumber(parents[3]))&&(Type.isNumber(parents[4])||Type.isFunction(parents[4])||Type.isString(parents[4])))type="2lines";else{if(!1===(points=Type.providePoints(board,parents,attributes,"sector",["center","radiusPoint","anglePoint"])))throw new Error("JSXGraph: Can't create Sector with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.");type="3points"}if(attr=Type.copyAttributes(attributes,board.options,"sector"),(el=board.create("curve",[[0],[0]],attr)).type=Const.OBJECT_TYPE_SECTOR,el.elType="sector",el.autoRadius=function(){var r1=20/el.board.unitX,r2=1/0,r3=50/el.board.unitX;return Type.isPoint(el.center)&&(r2=.3333*el.center.Dist(el.point2)),Math.max(r1,Math.min(r2,r3))},"2lines"===type)el.Radius=function(){var r=Type.evaluate(parents[4]);return"auto"===r?this.autoRadius():r},el.line1=board.select(parents[0]),el.line2=board.select(parents[1]),el.line1.addChild(el),el.line2.addChild(el),el.setParents(parents),el.point1={visProp:{}},el.point2={visProp:{}},el.point3={visProp:{}},s=Geometry.meetLineLine(el.line1.stdform,el.line2.stdform,0,board),Type.isArray(parents[2])?(2===parents[2].length&&(parents[2]=[1].concat(parents[2])),v=Geometry.projectPointToLine({coords:{usrCoords:parents[2]}},el.line1,board),v=Statistics.subtract(v.usrCoords,s.usrCoords),el.direction1=Mat.innerProduct(v,[0,el.line1.stdform[2],-el.line1.stdform[1]],3)>=0?1:-1):el.direction1=parents[2]>=0?1:-1,Type.isArray(parents[3])?(2===parents[3].length&&(parents[3]=[1].concat(parents[3])),v=Geometry.projectPointToLine({coords:{usrCoords:parents[3]}},el.line2,board),v=Statistics.subtract(v.usrCoords,s.usrCoords),el.direction2=Mat.innerProduct(v,[0,el.line2.stdform[2],-el.line2.stdform[1]],3)>=0?1:-1):el.direction2=parents[3]>=0?1:-1,el.updateDataArray=function(){var r,l1,l2,A,C,ar,B=[0,0,0];if(l1=this.line1,l2=this.line2,B=Mat.crossProduct(l1.stdform,l2.stdform),Math.abs(B[0])>Mat.eps*Mat.eps&&(B[1]/=B[0],B[2]/=B[0],B[0]/=B[0]),r=this.direction1*this.Radius(),A=Statistics.add(B,[0,r*l1.stdform[2],-r*l1.stdform[1]]),r=this.direction2*this.Radius(),C=Statistics.add(B,[0,r*l2.stdform[2],-r*l2.stdform[1]]),this.point2.coords=new Coords(Const.COORDS_BY_USER,A,el.board),this.point1.coords=new Coords(Const.COORDS_BY_USER,B,el.board),this.point3.coords=new Coords(Const.COORDS_BY_USER,C,el.board),Math.abs(A[0])<Mat.eps||Math.abs(B[0])<Mat.eps||Math.abs(C[0])<Mat.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);ar=Geometry.bezierArc(A,B,C,!0,1),this.dataX=ar[0],this.dataY=ar[1],this.bezierDegree=3},el.methodMap=JXG.deepCopy(el.methodMap,{radius:"Radius",getRadius:"Radius",setRadius:"setRadius"});else if("3points"===type){for(el.point1=points[0],el.point2=points[1],el.point3=points[2],i=0;i<3;i++)Type.exists(points[i]._is_new)?(el.addChild(points[i]),delete points[i]._is_new):points[i].addChild(el);el.useDirection=attributes.usedirection,el.setParents(points),Type.exists(points[3])&&(el.point4=points[3],el.point4.addChild(el)),el.methodMap=JXG.deepCopy(el.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"Radius",getRadius:"Radius",setRadius:"setRadius"}),el.updateDataArray=function(){var ar,p0c,p1c,p2c,phi,A=this.point2,B=this.point1,C=this.point3,sgn=1,vp_s=Type.evaluate(this.visProp.selection);if(!A.isReal||!B.isReal||!C.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);phi=Geometry.rad(A,B,C),("minor"===vp_s&&phi>Math.PI||"major"===vp_s&&phi<Math.PI)&&(sgn=-1),this.useDirection&&Type.exists(this.point4)&&(p0c=this.point2.coords.usrCoords,p1c=this.point4.coords.usrCoords,p2c=this.point3.coords.usrCoords,(p0c[1]-p2c[1])*(p0c[2]-p1c[2])-(p0c[2]-p2c[2])*(p0c[1]-p1c[1])>=0&&(C=this.point2,A=this.point3)),A=A.coords.usrCoords,B=B.coords.usrCoords,C=C.coords.usrCoords,ar=Geometry.bezierArc(A,B,C,!0,sgn),this.dataX=ar[0],this.dataY=ar[1],this.bezierDegree=3},el.Radius=function(){return this.point2.Dist(this.point1)},(attr=Type.copyAttributes(attributes,board.options,"sector","arc")).withLabel=!1,attr.name+="_arc",el.arc=board.create("arc",[el.point1,el.point2,el.point3],attr),el.addChild(el.arc)}return el.center=el.point1,el.radiuspoint=el.point2,el.anglepoint=el.point3,el.hasPointCurve=function(x,y){var angle,alpha,beta,prec,type,has,checkPoint=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board),r=this.Radius(),dist=this.center.coords.distance(Const.COORDS_BY_USER,checkPoint),vp_s=Type.evaluate(this.visProp.selection);return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,prec/=Math.min(this.board.unitX,this.board.unitY),(has=Math.abs(dist-r)<prec)&&(angle=Geometry.rad(this.point2,this.center,checkPoint.usrCoords.slice(1)),alpha=0,beta=Geometry.rad(this.point2,this.center,this.point3),("minor"===vp_s&&beta>Math.PI||"major"===vp_s&&beta<Math.PI)&&(alpha=beta,beta=2*Math.PI),(angle<alpha||angle>beta)&&(has=!1)),has},el.hasPointSector=function(x,y){var angle,alpha,beta,checkPoint=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board),r=this.Radius(),has=this.point1.coords.distance(Const.COORDS_BY_USER,checkPoint)<r,vp_s=Type.evaluate(this.visProp.selection);return has&&(angle=Geometry.rad(this.radiuspoint,this.center,checkPoint.usrCoords.slice(1)),alpha=0,beta=Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===vp_s&&beta>Math.PI||"major"===vp_s&&beta<Math.PI)&&(alpha=beta,beta=2*Math.PI),(angle<alpha||angle>beta)&&(has=!1)),has},el.hasPoint=function(x,y){return Type.evaluate(this.visProp.highlightonsector)||Type.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(x,y):this.hasPointCurve(x,y)},el.getTextAnchor=function(){return this.point1.coords},el.getLabelAnchor=function(){var coords,vec,vecx,vecy,len,angle=Geometry.rad(this.point2,this.point1,this.point3),dx=13/this.board.unitX,dy=13/this.board.unitY,p2c=this.point2.coords.usrCoords,pmc=this.point1.coords.usrCoords,bxminusax=p2c[1]-pmc[1],byminusay=p2c[2]-pmc[2],vp_s=Type.evaluate(this.visProp.selection),l_vp=this.label?this.label.visProp:this.visProp.label;return("minor"===vp_s&&angle>Math.PI||"major"===vp_s&&angle<Math.PI)&&(angle=-(2*Math.PI-angle)),vecx=(coords=new Coords(Const.COORDS_BY_USER,[pmc[1]+Math.cos(.5*angle)*bxminusax-Math.sin(.5*angle)*byminusay,pmc[2]+Math.sin(.5*angle)*bxminusax+Math.cos(.5*angle)*byminusay],this.board)).usrCoords[1]-pmc[1],vecy=coords.usrCoords[2]-pmc[2],vecx=vecx*((len=Math.sqrt(vecx*vecx+vecy*vecy))+dx)/len,vecy=vecy*(len+dy)/len,vec=[pmc[1]+vecx,pmc[2]+vecy],l_vp.position=Geometry.calcLabelQuadrant(Geometry.rad([1,0],[0,0],vec)),new Coords(Const.COORDS_BY_USER,vec,this.board)},el.setRadius=function(val){el.Radius=function(){var r=Type.evaluate(val);return"auto"===r?this.autoRadius():r}},el.getRadius=function(){return JXG.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},"3points"===type&&(el.setPositionDirectly=function(method,coords,oldcoords){var dc,c=new Coords(method,coords,this.board),oldc=new Coords(method,oldcoords,this.board);return el.point1.draggable()&&el.point2.draggable()&&el.point3.draggable()?(dc=Statistics.subtract(c.usrCoords,oldc.usrCoords),this.board.create("transform",dc.slice(1),{type:"translate"}).applyOnce([el.point1,el.point2,el.point3]),this):this}),el.prepareUpdate().update(),el},JXG.registerElement("sector",JXG.createSector),JXG.createCircumcircleSector=function(board,parents,attributes){var el,mp,attr,points;if(!1===(points=Type.providePoints(board,parents,attributes,"point")))throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.");return(mp=board.create("circumcenter",points.slice(0,3),attr)).dump=!1,attr=Type.copyAttributes(attributes,board.options,"circumcirclesector"),(el=board.create("sector",[mp,points[0],points[2],points[1]],attr)).elType="circumcirclesector",el.setParents(points),el.center=mp,el.subs={center:mp},el},JXG.registerElement("circumcirclesector",JXG.createCircumcircleSector),JXG.createMinorSector=function(board,parents,attributes){return attributes.selection="minor",JXG.createSector(board,parents,attributes)},JXG.registerElement("minorsector",JXG.createMinorSector),JXG.createMajorSector=function(board,parents,attributes){return attributes.selection="major",JXG.createSector(board,parents,attributes)},JXG.registerElement("majorsector",JXG.createMajorSector),JXG.createAngle=function(board,parents,attributes){var el,radius,attr,attrsub,i,points,type="invalid";if(parents[0].elementClass===Const.OBJECT_CLASS_LINE&&parents[1].elementClass===Const.OBJECT_CLASS_LINE&&(Type.isArray(parents[2])||Type.isNumber(parents[2]))&&(Type.isArray(parents[3])||Type.isNumber(parents[3])))type="2lines";else{if(!1===(points=Type.providePoints(board,parents,attributes,"point")))throw new Error("JSXGraph: Can't create angle with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.");type="3points"}if(attr=Type.copyAttributes(attributes,board.options,"angle"),Type.exists(attr.name)&&""!==attr.name||(attr.name=board.generateName({type:Const.OBJECT_TYPE_ANGLE})),radius=Type.exists(attr.radius)?attr.radius:0,"2lines"===type?(parents.push(radius),(el=board.create("sector",parents,attr)).updateDataArraySector=el.updateDataArray,el.setAngle=function(val){},el.free=function(val){}):((el=board.create("sector",[points[1],points[0],points[2]],attr)).arc.visProp.priv=!0,el.point=el.point2=el.radiuspoint=points[0],el.pointsquare=el.point3=el.anglepoint=points[2],el.Radius=function(){var r=Type.evaluate(radius);return"auto"===r?el.autoRadius():r},el.updateDataArraySector=function(){var ar,phi,A=this.point2,B=this.point1,C=this.point3,r=this.Radius(),d=B.Dist(A),sgn=1,vp_s=Type.evaluate(this.visProp.selection);phi=Geometry.rad(A,B,C),("minor"===vp_s&&phi>Math.PI||"major"===vp_s&&phi<Math.PI)&&(sgn=-1),A=A.coords.usrCoords,B=B.coords.usrCoords,C=C.coords.usrCoords,A=[1,B[1]+(A[1]-B[1])*r/d,B[2]+(A[2]-B[2])*r/d],C=[1,B[1]+(C[1]-B[1])*r/d,B[2]+(C[2]-B[2])*r/d],ar=Geometry.bezierArc(A,B,C,!0,sgn),this.dataX=ar[0],this.dataY=ar[1],this.bezierDegree=3},el.setAngle=function(val){var t1,t2,val2,p=this.anglepoint,q=this.radiuspoint;return p.draggable()&&(t1=this.board.create("transform",[val,this.center],{type:"rotate"}),p.addTransform(q,t1),t1.update(),p.moveTo(Mat.matVecMult(t1.matrix,q.coords.usrCoords)),val2=Type.isFunction(val)?function(){return 2*Math.PI-val()}:function(){return 2*Math.PI-val},t2=this.board.create("transform",[val2,this.center],{type:"rotate"}),p.coords.on("update",(function(){t2.update(),q.moveTo(Mat.matVecMult(t2.matrix,p.coords.usrCoords))})),p.setParents(q)),this},el.free=function(){var p=this.anglepoint;return p.transformations.length>0&&(p.transformations.pop(),p.isDraggable=!0,p.parents=[],p.coords.off("update")),this},el.setParents(points)),Type.exists(el.visProp.text)&&el.label.setText(Type.evaluate(el.visProp.text)),el.elType="angle",el.type=Const.OBJECT_TYPE_ANGLE,el.subs={},el.updateDataArraySquare=function(){var A,B,C,d1,d2,v,l1,l2,r=this.Radius();"2lines"===type&&this.updateDataArraySector(),A=this.point2,B=this.point1,C=this.point3,A=A.coords.usrCoords,B=B.coords.usrCoords,C=C.coords.usrCoords,d1=Geometry.distance(A,B,3),d2=Geometry.distance(C,B,3),A=[1,B[1]+(A[1]-B[1])*r/d1,B[2]+(A[2]-B[2])*r/d1],C=[1,B[1]+(C[1]-B[1])*r/d2,B[2]+(C[2]-B[2])*r/d2],v=Mat.crossProduct(C,B),l1=[-A[1]*v[1]-A[2]*v[2],A[0]*v[1],A[0]*v[2]],v=Mat.crossProduct(A,B),l2=[-C[1]*v[1]-C[2]*v[2],C[0]*v[1],C[0]*v[2]],(v=Mat.crossProduct(l1,l2))[1]/=v[0],v[2]/=v[0],this.dataX=[B[1],A[1],v[1],C[1],B[1]],this.dataY=[B[2],A[2],v[2],C[2],B[2]],this.bezierDegree=1},el.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},el.updateDataArray=function(){var type=Type.evaluate(this.visProp.type),deg=Geometry.trueAngle(this.point2,this.point1,this.point3),vp_s=Type.evaluate(this.visProp.selection);("minor"===vp_s&&deg>180||"major"===vp_s&&deg<180)&&(deg=360-deg),Math.abs(deg-90)<Type.evaluate(this.visProp.orthosensitivity)+Mat.eps&&(type=Type.evaluate(this.visProp.orthotype)),"none"===type?this.updateDataArrayNone():"square"===type?this.updateDataArraySquare():"sector"===type?this.updateDataArraySector():"sectordot"===type&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||"sectordot"!==type&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},attrsub=Type.copyAttributes(attributes,board.options,"angle","dot"),el.dot=board.create("point",[function(){var A,B,r,d,a2,co,si,mat,vp_s;return Type.exists(el.dot)&&!el.dot.visProp.visible?[0,0]:(A=el.point2.coords.usrCoords,B=el.point1.coords.usrCoords,r=el.Radius(),d=Geometry.distance(A,B,3),a2=Geometry.rad(el.point2,el.point1,el.point3),("minor"===(vp_s=Type.evaluate(el.visProp.selection))&&a2>Math.PI||"major"===vp_s&&a2<Math.PI)&&(a2=-(2*Math.PI-a2)),a2*=.5,co=Math.cos(a2),si=Math.sin(a2),A=[1,B[1]+(A[1]-B[1])*r/d,B[2]+(A[2]-B[2])*r/d],mat=[[1,0,0],[B[1]-.5*B[1]*co+.5*B[2]*si,.5*co,.5*-si],[B[2]-.5*B[1]*si-.5*B[2]*co,.5*si,.5*co]],Mat.matVecMult(mat,A))}],attrsub),el.dot.dump=!1,el.subs.dot=el.dot,"2lines"===type)for(i=0;i<2;i++)board.select(parents[i]).addChild(el.dot);else for(i=0;i<3;i++)board.select(points[i]).addChild(el.dot);return el.getLabelAnchor=function(){var vec,A,B,r,d,a2,co,si,mat,dx=12,vp_s=Type.evaluate(el.visProp.selection),l_vp=this.label?this.label.visProp:this.visProp.label;return Type.exists(this.label.visProp.fontSize)&&(dx=Type.evaluate(this.label.visProp.fontSize)),dx/=this.board.unitX,A=el.point2.coords.usrCoords,B=el.point1.coords.usrCoords,r=el.Radius(),d=Geometry.distance(A,B,3),a2=Geometry.rad(el.point2,el.point1,el.point3),("minor"===vp_s&&a2>Math.PI||"major"===vp_s&&a2<Math.PI)&&(a2=-(2*Math.PI-a2)),a2*=.5,co=Math.cos(a2),si=Math.sin(a2),A=[1,B[1]+(A[1]-B[1])*r/d,B[2]+(A[2]-B[2])*r/d],mat=[[1,0,0],[B[1]-.5*B[1]*co+.5*B[2]*si,.5*co,.5*-si],[B[2]-.5*B[1]*si-.5*B[2]*co,.5*si,.5*co]],(vec=Mat.matVecMult(mat,A))[1]/=vec[0],vec[2]/=vec[0],vec[0]/=vec[0],d=Geometry.distance(vec,B,3),vec=[vec[0],B[1]+(vec[1]-B[1])*(r+dx)/d,B[2]+(vec[2]-B[2])*(r+dx)/d],l_vp.position=Geometry.calcLabelQuadrant(Geometry.rad([1,0],[0,0],vec)),new Coords(Const.COORDS_BY_USER,vec,this.board)},el.Value=function(){return Geometry.rad(this.point2,this.point1,this.point3)},el.methodMap=Type.deepCopy(el.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),el},JXG.registerElement("angle",JXG.createAngle),JXG.createNonreflexAngle=function(board,parents,attributes){var el;return attributes.selection="minor",(el=JXG.createAngle(board,parents,attributes)).Value=function(){var v=Geometry.rad(this.point2,this.point1,this.point3);return v<Math.PI?v:2*Math.PI-v},el},JXG.registerElement("nonreflexangle",JXG.createNonreflexAngle),JXG.createReflexAngle=function(board,parents,attributes){var el;return attributes.selection="major",(el=JXG.createAngle(board,parents,attributes)).Value=function(){var v=Geometry.rad(this.point2,this.point1,this.point3);return v>=Math.PI?v:2*Math.PI-v},el},JXG.registerElement("reflexangle",JXG.createReflexAngle),{createSector:JXG.createSector,createCircumcircleSector:JXG.createCircumcircleSector,createMinorSector:JXG.createMinorSector,createMajorSector:JXG.createMajorSector,createAngle:JXG.createAngle,createReflexAngle:JXG.createReflexAngle,createNonreflexAngle:JXG.createNonreflexAngle}})),define("base/transformation",["jxg","base/constants","math/math","utils/type"],(function(JXG,Const,Mat,Type){return JXG.Transformation=function(board,type,params){this.elementClass=Const.OBJECT_CLASS_OTHER,this.type=Const.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=board,this.isNumericMatrix=!1,this.setMatrix(board,type,params),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bindTo",melt:"melt"}},JXG.Transformation.prototype={},JXG.extend(JXG.Transformation.prototype,{update:function(){return this},setMatrix:function(board,type,params){var i;for(this.isNumericMatrix=!0,i=0;i<params.length;i++)if("number"!=typeof params[i]){this.isNumericMatrix=!1;break}if("translate"===type){if(2!==params.length)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=Type.createEvalFunction(board,params,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if("scale"===type){if(2!==params.length)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=Type.createEvalFunction(board,params,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===type)params.length<4&&(params[0]=board.select(params[0])),2===params.length&&(params[1]=board.select(params[1])),4===params.length&&(this.evalParam=Type.createEvalFunction(board,params,4)),this.update=function(){var x,y,z,xoff,yoff,d,v,p;1===params.length?v=params[0].stdform:2===params.length?v=Mat.crossProduct(params[1].coords.usrCoords,params[0].coords.usrCoords):4===params.length&&(v=Mat.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),x=v[1],y=v[2],d=(p=[-(z=v[0])*x,-z*y,x*x+y*y])[2],xoff=p[0]/p[2],yoff=p[1]/p[2],x=-v[2],y=v[1],this.matrix[1][1]=(x*x-y*y)/d,this.matrix[1][2]=2*x*y/d,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=xoff*(1-this.matrix[1][1])-yoff*this.matrix[1][2],this.matrix[2][0]=yoff*(1-this.matrix[2][2])-xoff*this.matrix[2][1]};else if("rotate"===type)3===params.length?this.evalParam=Type.createEvalFunction(board,params,3):params.length>0&&params.length<=2&&(this.evalParam=Type.createEvalFunction(board,params,1),2!==params.length||Type.isArray(params[1])||(params[1]=board.select(params[1]))),this.update=function(){var x,y,beta=this.evalParam(0),co=Math.cos(beta),si=Math.sin(beta);this.matrix[1][1]=co,this.matrix[1][2]=-si,this.matrix[2][1]=si,this.matrix[2][2]=co,params.length>1&&(3===params.length?(x=this.evalParam(1),y=this.evalParam(2)):Type.isArray(params[1])?(x=params[1][0],y=params[1][1]):(x=params[1].X(),y=params[1].Y()),this.matrix[1][0]=x*(1-co)+y*si,this.matrix[2][0]=y*(1-co)-x*si)};else if("shear"===type){if(2!==params.length)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=Type.createEvalFunction(board,params,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if("generic"===type){if(9!==params.length)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=Type.createEvalFunction(board,params,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(p,self){return this.update(),Type.exists(self)?Mat.matVecMult(this.matrix,p.initialCoords.usrCoords):Mat.matVecMult(this.matrix,p.coords.usrCoords)},applyOnce:function(p){var c,len,i;for(Type.isArray(p)||(p=[p]),len=p.length,i=0;i<len;i++)this.update(),c=Mat.matVecMult(this.matrix,p[i].coords.usrCoords),p[i].coords.setCoordinates(Const.COORDS_BY_USER,c)},bindTo:function(p){var i,len;if(Type.isArray(p))for(len=p.length,i=0;i<len;i++)p[i].transformations.push(this);else p.transformations.push(this)},setProperty:function(term){JXG.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(term){},melt:function(t){var i,len,len0,k,s,j,res=[];for(len=t.matrix.length,len0=this.matrix[0].length,i=0;i<len;i++)res[i]=[];for(this.update(),t.update(),i=0;i<len;i++)for(j=0;j<len0;j++){for(s=0,k=0;k<len;k++)s+=t.matrix[i][k]*this.matrix[k][j];res[i][j]=s}return this.update=function(){var len=this.matrix.length,len0=this.matrix[0].length;for(i=0;i<len;i++)for(j=0;j<len0;j++)this.matrix[i][j]=res[i][j]},this},getParents:function(){var p=[[].concat.apply([],this.matrix)];return 0!==this.parents.length&&(p=this.parents),p}}),JXG.createTransform=function(board,parents,attributes){return new JXG.Transformation(board,attributes.type,parents)},JXG.registerElement("transform",JXG.createTransform),{Transformation:JXG.Transformation,createTransform:JXG.createTransform}})),define("element/composition",["jxg","math/math","math/geometry","math/numerics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/polygon"],(function(JXG,Mat,Geometry,Numerics,Coords,Type,Const,Point,Line,Circle,Transform,Composition,Curve,Polygon){return JXG.createOrthogonalProjection=function(board,parents,attributes){var l,p,t,attr;if(parents[0]=board.select(parents[0]),parents[1]=board.select(parents[1]),Type.isPointType(board,parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_LINE)p=Type.providePoints(board,[parents[0]],attributes,"point")[0],l=parents[1];else{if(!Type.isPointType(board,parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line]");p=Type.providePoints(board,[parents[1]],attributes,"point")[0],l=parents[0]}return attr=Type.copyAttributes(attributes,board.options,"orthogonalprojection"),t=board.create("point",[function(){return Geometry.projectPointToLine(p,l,board)}],attr),Type.exists(p._is_new)?(t.addChild(p),delete p._is_new):p.addChild(t),l.addChild(t),t.elType="orthogonalprojection",t.setParents([p.id,t.id]),t.update(),t.generatePolynomial=function(){var a1=l.point1.symbolic.x,a2=l.point1.symbolic.y,b1=l.point2.symbolic.x,b2=l.point2.symbolic.y,p1=p.symbolic.x,p2=p.symbolic.y,t1=t.symbolic.x,t2=t.symbolic.y;return["("+a2+")*("+t1+")-("+a2+")*("+b1+")+("+t2+")*("+b1+")-("+a1+")*("+t2+")+("+a1+")*("+b2+")-("+t1+")*("+b2+")","("+p2+")*("+a2+")-("+p2+")*("+b2+")-("+t2+")*("+a2+")+("+t2+")*("+b2+")+("+p1+")*("+a1+")-("+p1+")*("+b1+")-("+t1+")*("+a1+")+("+t1+")*("+b1+")"]},t},JXG.createPerpendicular=function(board,parents,attributes){var p,l,pd,attr;if(parents[0]=board.select(parents[0]),parents[1]=board.select(parents[1]),Type.isPointType(board,parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_LINE)l=parents[1],p=Type.providePoints(board,[parents[0]],attributes,"point")[0];else{if(!Type.isPointType(board,parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [line,point]");l=parents[0],p=Type.providePoints(board,[parents[1]],attributes,"point")[0]}return attr=Type.copyAttributes(attributes,board.options,"perpendicular"),(pd=Line.createLine(board,[function(){return l.stdform[2]*p.X()-l.stdform[1]*p.Y()},function(){return-l.stdform[2]*p.Z()},function(){return l.stdform[1]*p.Z()}],attr)).elType="perpendicular",pd.setParents([l.id,p.id]),Type.exists(p._is_new)?(pd.addChild(p),delete p._is_new):p.addChild(pd),l.addChild(pd),pd},JXG.createPerpendicularPoint=function(board,parents,attributes){var l,p,t;if(parents[0]=board.select(parents[0]),parents[1]=board.select(parents[1]),Type.isPointType(board,parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_LINE)p=Type.providePoints(board,[parents[0]],attributes,"point")[0],l=parents[1];else{if(!Type.isPointType(board,parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line]");p=Type.providePoints(board,[parents[1]],attributes,"point")[0],l=parents[0]}return t=board.create("point",[function(){return Geometry.perpendicular(l,p,board)[0]}],attributes),Type.exists(p._is_new)?(t.addChild(p),delete p._is_new):p.addChild(t),l.addChild(t),t.elType="perpendicularpoint",t.setParents([p.id,l.id]),t.update(),t.generatePolynomial=function(){var a1=l.point1.symbolic.x,a2=l.point1.symbolic.y,b1=l.point2.symbolic.x,b2=l.point2.symbolic.y,p1=p.symbolic.x,p2=p.symbolic.y,t1=t.symbolic.x,t2=t.symbolic.y;return["("+a2+")*("+t1+")-("+a2+")*("+b1+")+("+t2+")*("+b1+")-("+a1+")*("+t2+")+("+a1+")*("+b2+")-("+t1+")*("+b2+")","("+p2+")*("+a2+")-("+p2+")*("+b2+")-("+t2+")*("+a2+")+("+t2+")*("+b2+")+("+p1+")*("+a1+")-("+p1+")*("+b1+")-("+t1+")*("+a1+")+("+t1+")*("+b1+")"]},t},JXG.createPerpendicularSegment=function(board,parents,attributes){var p,l,pd,t,attr;if(parents[0]=board.select(parents[0]),parents[1]=board.select(parents[1]),Type.isPointType(board,parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_LINE)l=parents[1],p=Type.providePoints(board,[parents[0]],attributes,"point")[0];else{if(!Type.isPointType(board,parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [line,point]");l=parents[0],p=Type.providePoints(board,[parents[1]],attributes,"point")[0]}return attr=Type.copyAttributes(attributes,board.options,"perpendicularsegment","point"),(t=JXG.createPerpendicularPoint(board,[l,p],attr)).dump=!1,Type.exists(attributes.layer)||(attributes.layer=board.options.layer.line),attr=Type.copyAttributes(attributes,board.options,"perpendicularsegment"),(pd=Line.createLine(board,[function(){return Geometry.perpendicular(l,p,board)[1]?[t,p]:[p,t]}],attr)).point=t,Type.exists(p._is_new)?(pd.addChild(p),delete p._is_new):p.addChild(pd),l.addChild(pd),pd.elType="perpendicularsegment",pd.setParents([p.id,l.id]),pd.subs={point:t},pd.inherits.push(t),pd},JXG.createMidpoint=function(board,parents,attributes){var a,b,t,i,attr;for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);if(2===parents.length&&Type.isPointType(board,parents[0])&&Type.isPointType(board,parents[1]))parents=Type.providePoints(board,parents,attributes,"point"),a=parents[0],b=parents[1];else{if(1!==parents.length||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");a=parents[0].point1,b=parents[0].point2}return attr=Type.copyAttributes(attributes,board.options,"midpoint"),t=board.create("point",[function(){var x=a.coords.usrCoords[1]+b.coords.usrCoords[1];return isNaN(x)||Math.abs(a.coords.usrCoords[0])<Mat.eps||Math.abs(b.coords.usrCoords[0])<Mat.eps?NaN:.5*x},function(){var y=a.coords.usrCoords[2]+b.coords.usrCoords[2];return isNaN(y)||Math.abs(a.coords.usrCoords[0])<Mat.eps||Math.abs(b.coords.usrCoords[0])<Mat.eps?NaN:.5*y}],attr),Type.exists(a._is_new)?(t.addChild(a),delete a._is_new):a.addChild(t),Type.exists(b._is_new)?(t.addChild(b),delete b._is_new):b.addChild(t),t.elType="midpoint",t.setParents([a.id,b.id]),t.prepareUpdate().update(),t.generatePolynomial=function(){var a1=a.symbolic.x,a2=a.symbolic.y,b1=b.symbolic.x,b2=b.symbolic.y,t1=t.symbolic.x,t2=t.symbolic.y;return["("+a2+")*("+t1+")-("+a2+")*("+b1+")+("+t2+")*("+b1+")-("+a1+")*("+t2+")+("+a1+")*("+b2+")-("+t1+")*("+b2+")","("+a1+")^2 - 2*("+a1+")*("+t1+")+("+a2+")^2-2*("+a2+")*("+t2+")-("+b1+")^2+2*("+b1+")*("+t1+")-("+b2+")^2+2*("+b2+")*("+t2+")"]},t},JXG.createParallelPoint=function(board,parents,attributes){var a,b,c,p,i;for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);if(3===parents.length&&Type.isPointType(board,parents[0])&&Type.isPointType(board,parents[1])&&Type.isPointType(board,parents[2]))parents=Type.providePoints(board,parents,attributes,"point"),a=parents[0],b=parents[1],c=parents[2];else if(Type.isPointType(board,parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_LINE)c=Type.providePoints(board,[parents[0]],attributes,"point")[0],a=parents[1].point1,b=parents[1].point2;else{if(!Type.isPointType(board,parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [line,point], [point,point,point]");c=Type.providePoints(board,[parents[1]],attributes,"point")[0],a=parents[0].point1,b=parents[0].point2}return p=board.create("point",[function(){return c.coords.usrCoords[1]+b.coords.usrCoords[1]-a.coords.usrCoords[1]},function(){return c.coords.usrCoords[2]+b.coords.usrCoords[2]-a.coords.usrCoords[2]}],attributes),Type.exists(a._is_new)?(p.addChild(a),delete a._is_new):a.addChild(p),Type.exists(b._is_new)?(p.addChild(b),delete b._is_new):b.addChild(p),Type.exists(c._is_new)?(p.addChild(c),delete c._is_new):c.addChild(p),p.elType="parallelpoint",p.setParents([a.id,b.id,c.id]),p.prepareUpdate().update(),p.generatePolynomial=function(){var a1=a.symbolic.x,a2=a.symbolic.y,b1=b.symbolic.x,b2=b.symbolic.y,c1=c.symbolic.x,c2=c.symbolic.y,t1=p.symbolic.x,t2=p.symbolic.y;return["("+b2+")*("+t1+")-("+b2+")*("+c1+")-("+a2+")*("+t1+")+("+a2+")*("+c1+")-("+t2+")*("+b1+")+("+t2+")*("+a1+")+("+c2+")*("+b1+")-("+c2+")*("+a1+")","("+t2+")*("+a1+")-("+t2+")*("+c1+")-("+b2+")*("+a1+")+("+b2+")*("+c1+")-("+t1+")*("+a2+")+("+t1+")*("+c2+")+("+b1+")*("+a2+")-("+b1+")*("+c2+")"]},p},JXG.createParallel=function(board,parents,attributes){var p,pp,pl,li,i,attr,ty=1;for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);return p=null,3===parents.length?(p=(parents=Type.providePoints(board,parents,attributes,"point"))[2],ty=0):Type.isPointType(board,parents[0])?(p=Type.providePoints(board,[parents[0]],attributes,"point")[0],li=function(){return parents[1].stdform}):Type.isPointType(board,parents[1])&&(p=Type.providePoints(board,[parents[1]],attributes,"point")[0],li=function(){return parents[0].stdform}),Type.exists(attributes.layer)||(attributes.layer=board.options.layer.line),attr=Type.copyAttributes(attributes,board.options,"parallel","point"),(pp=1===ty?board.create("point",[function(){return Mat.crossProduct([1,0,0],li())}],attr):board.create("parallelpoint",parents,attr)).isDraggable=!0,attr=Type.copyAttributes(attributes,board.options,"parallel"),(pl=board.create("line",[p,pp],attr)).elType="parallel",pl.subs={point:pp},pl.inherits.push(pp),pl.setParents([parents[0].id,parents[1].id]),3===parents.length&&pl.addParents(parents[2].id),pl.point=pp,pl},JXG.createArrowParallel=function(board,parents,attributes){var p;try{return attributes.firstArrow=!1,attributes.lastArrow=!0,(p=JXG.createParallel(board,parents,attributes).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",p}catch(e){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [line,point], [point,point,point]")}},JXG.createNormal=function(board,parents,attributes){var p,c,l,i,g,f,attr,pp,attrp;for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);if(1===parents.length)p=parents[0],c=p.slideObject;else{if(2!==parents.length)throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]");if(Type.isPointType(board,parents[0]))p=Type.providePoints(board,[parents[0]],attributes,"point")[0],c=parents[1];else{if(!Type.isPointType(board,parents[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]");c=parents[0],p=Type.providePoints(board,[parents[1]],attributes,"point")[0]}}if(attr=Type.copyAttributes(attributes,board.options,"normal"),c.elementClass===Const.OBJECT_CLASS_LINE)attrp=Type.copyAttributes(attributes,board.options,"normal","point"),pp=board.create("point",[function(){var p=Mat.crossProduct([1,0,0],c.stdform);return[p[0],-p[2],p[1]]}],attrp),pp.isDraggable=!0,(l=board.create("line",[p,pp],attr)).point=pp,l.subs={point:pp},l.inherits.push(pp);else if(c.elementClass===Const.OBJECT_CLASS_CIRCLE)l=board.create("line",[c.midpoint,p],attr);else if(c.elementClass===Const.OBJECT_CLASS_CURVE)"plot"!==Type.evaluate(c.visProp.curvetype)?(g=c.X,f=c.Y,l=board.create("line",[function(){return-p.X()*Numerics.D(g)(p.position)-p.Y()*Numerics.D(f)(p.position)},function(){return Numerics.D(g)(p.position)},function(){return Numerics.D(f)(p.position)}],attr)):l=board.create("line",[function(){var p1,p2,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position),lbda=p.position-i;if(1===c.bezierdegree)i===c.numberPoints-1&&(i-=1,lbda=1);else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?1:1===c.bezierDegree?(c.Y(i)+lbda*(c.Y(i+1)-c.Y(i)))*(c.Y(i)-c.Y(i+1))-(c.X(i)+lbda*(c.X(i+1)-c.X(i)))*(c.X(i+1)-c.X(i)):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,p2=[1,(p1=p.coords.usrCoords)[1]-dy,p1[2]+dx],p1[2]*p2[1]-p1[1]*p2[2])},function(){var p1,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position);if(1===c.bezierdegree)i===c.numberPoints-1&&(i-=1);else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?0:1===c.bezierDegree?c.X(i+1)-c.X(i):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,[1,(p1=p.coords.usrCoords)[1]-dy,p1[2]+dx][2]-p1[2])},function(){var p1,p2,t,A,B,C,D,dx,dy,d,i=Math.floor(p.position);if(1===c.bezierdegree)i===c.numberPoints-1&&(i-=1);else{if(3!==c.bezierDegree)return 0;i=3*Math.floor(p.position*(c.numberPoints-1)/3),t=(p.position*(c.numberPoints-1)-i)/3,i>=c.numberPoints-1&&(i=c.numberPoints-4,t=1)}return i<0?0:1===c.bezierDegree?c.Y(i+1)-c.Y(i):(A=c.points[i].usrCoords,B=c.points[i+1].usrCoords,C=c.points[i+2].usrCoords,D=c.points[i+3].usrCoords,dx=(1-t)*(1-t)*(B[1]-A[1])+2*(1-t)*t*(C[1]-B[1])+t*t*(D[1]-C[1]),dy=(1-t)*(1-t)*(B[2]-A[2])+2*(1-t)*t*(C[2]-B[2])+t*t*(D[2]-C[2]),dx/=d=Math.sqrt(dx*dx+dy*dy),dy/=d,p2=[1,(p1=p.coords.usrCoords)[1]-dy,p1[2]+dx],p1[1]-p2[1])}],attr);else{if(c.type!==Const.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,line], [point,circle], [glider]");l=board.create("line",[function(){var el,j,i=Math.floor(p.position),lbda=p.position-i;for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&(i-=1,lbda=1),i<0?1:(el.Y(i)+lbda*(el.Y(i+1)-el.Y(i)))*(el.Y(i)-el.Y(i+1))-(el.X(i)+lbda*(el.X(i+1)-el.X(i)))*(el.X(i+1)-el.X(i))},function(){var el,j,i=Math.floor(p.position);for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&(i-=1),i<0?0:el.X(i+1)-el.X(i)},function(){var el,j,i=Math.floor(p.position);for(j=0;j<c.objects.length;j++)if((el=c.objects[j]).type===Const.OBJECT_TYPE_CURVE){if(i<el.numberPoints)break;i-=el.numberPoints}return i===el.numberPoints-1&&(i-=1),i<0?0:el.Y(i+1)-el.Y(i)}],attr)}return l.elType="normal",l.setParents(parents),Type.exists(p._is_new)?(l.addChild(p),delete p._is_new):p.addChild(l),c.addChild(l),l},JXG.createBisector=function(board,parents,attributes){var p,l,i,attr;if(parents=Type.providePoints(board,parents,attributes,"point"),Type.isPoint(parents[0])&&Type.isPoint(parents[1])&&Type.isPoint(parents[2])){for((attr=Type.copyAttributes(attributes,board.options,"bisector","point")).snapToGrid=!1,(p=board.create("point",[function(){return Geometry.angleBisector(parents[0],parents[1],parents[2],board)}],attr)).dump=!1,i=0;i<3;i++)Type.exists(parents[i]._is_new)?(p.addChild(parents[i]),delete parents[i]._is_new):parents[i].addChild(p);return Type.exists(attributes.layer)||(attributes.layer=board.options.layer.line),attr=Type.copyAttributes(attributes,board.options,"bisector"),(l=Line.createLine(board,[parents[1],p],attr)).point=p,l.elType="bisector",l.setParents(parents),l.subs={point:p},l.inherits.push(p),l}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point,point]")},JXG.createAngularBisectorsOfTwoLines=function(board,parents,attributes){var g1,g2,attr,ret,l1=board.select(parents[0]),l2=board.select(parents[1]);if(l1.elementClass!==Const.OBJECT_CLASS_LINE||l2.elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [line,line]");return Type.exists(attributes.layer)||(attributes.layer=board.options.layer.line),attr=Type.copyAttributes(attributes,board.options,"bisectorlines","line1"),g1=board.create("line",[function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[0]/d1-l2.stdform[0]/d2},function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[1]/d1-l2.stdform[1]/d2},function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[2]/d1-l2.stdform[2]/d2}],attr),Type.exists(attributes.layer)||(attributes.layer=board.options.layer.line),attr=Type.copyAttributes(attributes,board.options,"bisectorlines","line2"),g2=board.create("line",[function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[0]/d1+l2.stdform[0]/d2},function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[1]/d1+l2.stdform[1]/d2},function(){var d1=Math.sqrt(l1.stdform[1]*l1.stdform[1]+l1.stdform[2]*l1.stdform[2]),d2=Math.sqrt(l2.stdform[1]*l2.stdform[1]+l2.stdform[2]*l2.stdform[2]);return l1.stdform[2]/d1+l2.stdform[2]/d2}],attr),ret=new Composition({line1:g1,line2:g2}),g1.dump=!1,g2.dump=!1,ret.elType="bisectorlines",ret.setParents([l1.id,l2.id]),ret.subs={line1:g1,line2:g2},ret},JXG.createCircumcenter=function(board,parents,attributes){var p,i,a,b,c;if(parents=Type.providePoints(board,parents,attributes,"point"),Type.isPoint(parents[0])&&Type.isPoint(parents[1])&&Type.isPoint(parents[2])){for(a=parents[0],b=parents[1],c=parents[2],p=Point.createPoint(board,[function(){return Geometry.circumcenter(a,b,c,board)}],attributes),i=0;i<3;i++)Type.exists(parents[i]._is_new)?(p.addChild(parents[i]),delete parents[i]._is_new):parents[i].addChild(p);return p.elType="circumcenter",p.setParents(parents),p.generatePolynomial=function(){var a1=a.symbolic.x,a2=a.symbolic.y,b1=b.symbolic.x,b2=b.symbolic.y,c1=c.symbolic.x,c2=c.symbolic.y,t1=p.symbolic.x,t2=p.symbolic.y;return[["((",t1,")-(",a1,"))^2+((",t2,")-(",a2,"))^2-((",t1,")-(",b1,"))^2-((",t2,")-(",b2,"))^2"].join(""),["((",t1,")-(",a1,"))^2+((",t2,")-(",a2,"))^2-((",t1,")-(",c1,"))^2-((",t2,")-(",c2,"))^2"].join("")]},p}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]")},JXG.createIncenter=function(board,parents,attributes){var p,A,B,C,i;if(!((parents=Type.providePoints(board,parents,attributes,"point")).length>=3&&Type.isPoint(parents[0])&&Type.isPoint(parents[1])&&Type.isPoint(parents[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]");for(A=parents[0],B=parents[1],C=parents[2],p=board.create("point",[function(){var a,b,c;return a=Math.sqrt((B.X()-C.X())*(B.X()-C.X())+(B.Y()-C.Y())*(B.Y()-C.Y())),b=Math.sqrt((A.X()-C.X())*(A.X()-C.X())+(A.Y()-C.Y())*(A.Y()-C.Y())),c=Math.sqrt((B.X()-A.X())*(B.X()-A.X())+(B.Y()-A.Y())*(B.Y()-A.Y())),new Coords(Const.COORDS_BY_USER,[(a*A.X()+b*B.X()+c*C.X())/(a+b+c),(a*A.Y()+b*B.Y()+c*C.Y())/(a+b+c)],board)}],attributes),i=0;i<3;i++)Type.exists(parents[i]._is_new)?(p.addChild(parents[i]),delete parents[i]._is_new):parents[i].addChild(p);return p.elType="incenter",p.setParents(parents),p},JXG.createCircumcircle=function(board,parents,attributes){var p,c,attr,i;if(!1===(parents=Type.providePoints(board,parents,attributes,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]");try{for(attr=Type.copyAttributes(attributes,board.options,"circumcircle","center"),(p=JXG.createCircumcenter(board,parents,attr)).dump=!1,Type.exists(attributes.layer)||(attributes.layer=board.options.layer.circle),attr=Type.copyAttributes(attributes,board.options,"circumcircle"),(c=Circle.createCircle(board,[p,parents[0]],attr)).elType="circumcircle",c.setParents(parents),c.subs={center:p},c.inherits.push(c),i=0;i<3;i++)Type.exists(parents[i]._is_new)?(c.addChild(parents[i]),delete parents[i]._is_new):parents[i].addChild(c)}catch(e){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]")}return c},JXG.createIncircle=function(board,parents,attributes){var i,p,c,attr;if(!1===(parents=Type.providePoints(board,parents,attributes,"point")))throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]");try{for(attr=Type.copyAttributes(attributes,board.options,"incircle","center"),(p=JXG.createIncenter(board,parents,attr)).dump=!1,Type.exists(attributes.layer)||(attributes.layer=board.options.layer.circle),attr=Type.copyAttributes(attributes,board.options,"incircle"),(c=Circle.createCircle(board,[p,function(){var a=Math.sqrt((parents[1].X()-parents[2].X())*(parents[1].X()-parents[2].X())+(parents[1].Y()-parents[2].Y())*(parents[1].Y()-parents[2].Y())),b=Math.sqrt((parents[0].X()-parents[2].X())*(parents[0].X()-parents[2].X())+(parents[0].Y()-parents[2].Y())*(parents[0].Y()-parents[2].Y())),c=Math.sqrt((parents[1].X()-parents[0].X())*(parents[1].X()-parents[0].X())+(parents[1].Y()-parents[0].Y())*(parents[1].Y()-parents[0].Y())),s=(a+b+c)/2;return Math.sqrt((s-a)*(s-b)*(s-c)/s)}],attr)).elType="incircle",c.setParents(parents),i=0;i<3;i++)Type.exists(parents[i]._is_new)?(c.addChild(parents[i]),delete parents[i]._is_new):parents[i].addChild(c);c.center=p,c.subs={center:c.center},c.inherits.push(p)}catch(e){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+_typeof(parents[0])+"', '"+_typeof(parents[1])+"' and '"+_typeof(parents[2])+"'.\nPossible parent types: [point,point,point]")}return c},JXG.createReflection=function(board,parents,attributes){var l,org,r,r_c,t,i,attr,attr2,errStr="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]";for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);if(attr=Type.copyAttributes(attributes,board.options,"reflection"),Type.isPoint(parents[0]))org=Type.providePoints(board,[parents[0]],attr2)[0];else{if(parents[0].elementClass!==Const.OBJECT_CLASS_CURVE&&parents[0].elementClass!==Const.OBJECT_CLASS_LINE&&parents[0].type!==Const.OBJECT_TYPE_POLYGON&&parents[0].elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);org=parents[0]}if(parents[1].elementClass!==Const.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);if(l=parents[1],t=Transform.createTransform(board,[l],{type:"reflect"}),Type.isPoint(org))r=Point.createPoint(board,[org,t],attr);else if(org.elementClass===Const.OBJECT_CLASS_CURVE)r=Curve.createCurve(board,[org,t],attr);else if(org.elementClass===Const.OBJECT_CLASS_LINE)r=Line.createLine(board,[org,t],attr);else if(org.type===Const.OBJECT_TYPE_POLYGON)r=Polygon.createPolygon(board,[org,t],attr);else{if(org.elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);"euclidean"===attr.type.toLowerCase()?(attr2=Type.copyAttributes(attributes,board.options,"reflection","center"),(r_c=Point.createPoint(board,[org.center,t],attr2)).prepareUpdate().update().updateVisibility(Type.evaluate(r_c.visProp.visible)).updateRenderer(),r=Circle.createCircle(board,[r_c,function(){return org.Radius()}],attr)):r=Circle.createCircle(board,[org,t],attr)}return Type.exists(org._is_new)&&(r.addChild(org),delete org._is_new),l.addChild(r),r.elType="reflection",r.addParents(l),r.prepareUpdate().update(),Type.isPoint(r)&&(r.generatePolynomial=function(){var a1=l.point1.symbolic.x,a2=l.point1.symbolic.y,b1=l.point2.symbolic.x,b2=l.point2.symbolic.y,p1=org.symbolic.x,p2=org.symbolic.y,r1=r.symbolic.x,r2=r.symbolic.y;return[["((",r2,")-(",p2,"))*((",a2,")-(",b2,"))+((",a1,")-(",b1,"))*((",r1,")-(",p1,"))"].join(""),["((",r1,")-(",a1,"))^2+((",r2,")-(",a2,"))^2-((",p1,")-(",a1,"))^2-((",p2,")-(",a2,"))^2"].join("")]}),r},JXG.createMirrorElement=function(board,parents,attributes){var org,i,m,r,r_c,t,attr,attr2,errStr="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]";for(i=0;i<parents.length;++i)parents[i]=board.select(parents[i]);if(attr=Type.copyAttributes(attributes,board.options,"mirrorelement"),Type.isPoint(parents[0]))org=Type.providePoints(board,[parents[0]],attr)[0];else{if(parents[0].elementClass!==Const.OBJECT_CLASS_CURVE&&parents[0].elementClass!==Const.OBJECT_CLASS_LINE&&parents[0].type!==Const.OBJECT_TYPE_POLYGON&&parents[0].elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);org=parents[0]}if(!Type.isPoint(parents[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);if(attr2=Type.copyAttributes(attributes,board.options,"mirrorelement","point"),m=Type.providePoints(board,[parents[1]],attr2)[0],t=Transform.createTransform(board,[Math.PI,m],{type:"rotate"}),Type.isPoint(org))r=Point.createPoint(board,[org,t],attr);else if(org.elementClass===Const.OBJECT_CLASS_CURVE)r=Curve.createCurve(board,[org,t],attr);else if(org.elementClass===Const.OBJECT_CLASS_LINE)r=Line.createLine(board,[org,t],attr);else if(org.type===Const.OBJECT_TYPE_POLYGON)r=Polygon.createPolygon(board,[org,t],attr);else{if(org.elementClass!==Const.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'."+errStr);"euclidean"===attr.type.toLowerCase()?(attr2=Type.copyAttributes(attributes,board.options,"mirrorelement","center"),(r_c=Point.createPoint(board,[org.center,t],attr2)).prepareUpdate().update().updateVisibility(Type.evaluate(r_c.visProp.visible)).updateRenderer(),r=Circle.createCircle(board,[r_c,function(){return org.Radius()}],attr)):r=Circle.createCircle(board,[org,t],attr)}return Type.exists(org._is_new)&&(r.addChild(org),delete org._is_new),m.addChild(r),r.elType="mirrorelement",r.addParents(m),r.prepareUpdate().update(),r},JXG.createMirrorPoint=function(board,parents,attributes){var el=JXG.createMirrorElement(board,parents,attributes);return el.elType="mirrorpoint",el},JXG.createIntegral=function(board,parents,attributes){var interval,curve,attr,start,end,startx,starty,endx,endy,pa_on_curve,pa_on_axis,pb_on_curve,pb_on_axis,p,t=null;if(Type.isArray(parents[0])&&parents[1].elementClass===Const.OBJECT_CLASS_CURVE)interval=parents[0],curve=parents[1];else{if(!Type.isArray(parents[1])||parents[0].elementClass!==Const.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [[number|function,number|function],curve]");interval=parents[1],curve=parents[0]}return(attr=Type.copyAttributes(attributes,board.options,"integral")).withLabel=!1,p=board.create("curve",[[0],[0]],attr),start=interval[0],end=interval[1],Type.isFunction(start)?(starty=function(){return curve.Y(startx())},start=(startx=start)()):(startx=start,starty=curve.Y(start)),Type.isFunction(end)?(endy=function(){return curve.Y(endx())},end=(endx=end)()):(endx=end,endy=curve.Y(end)),attr=Type.copyAttributes(attributes,board.options,"integral","curveLeft"),pa_on_curve=board.create("glider",[startx,starty,curve],attr),Type.isFunction(startx)&&pa_on_curve.hideElement(),attr=Type.copyAttributes(attributes,board.options,"integral","baseLeft"),pa_on_axis=board.create("point",[function(){return"y"===Type.evaluate(p.visProp.axis)?0:pa_on_curve.X()},function(){return"y"===Type.evaluate(p.visProp.axis)?pa_on_curve.Y():0}],attr),attr=Type.copyAttributes(attributes,board.options,"integral","curveRight"),pb_on_curve=board.create("glider",[endx,endy,curve],attr),Type.isFunction(endx)&&pb_on_curve.hideElement(),attr=Type.copyAttributes(attributes,board.options,"integral","baseRight"),pb_on_axis=board.create("point",[function(){return"y"===Type.evaluate(p.visProp.axis)?0:pb_on_curve.X()},function(){return"y"===Type.evaluate(p.visProp.axis)?pb_on_curve.Y():0}],attr),!1!==(attr=Type.copyAttributes(attributes,board.options,"integral")).withlabel&&"y"!==attr.axis&&(attr=Type.copyAttributes(attributes,board.options,"integral","label"),attr=Type.copyAttributes(attr,board.options,"label"),(t=board.create("text",[function(){var off=new Coords(Const.COORDS_BY_SCREEN,[Type.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),bb=this.board.getBoundingBox(),dx=.1*(bb[2]-bb[0]),x=pb_on_curve.X();return x<bb[0]?x=bb[0]+dx:x>bb[2]&&(x=bb[2]-dx),x+off.usrCoords[1]},function(){var off=new Coords(Const.COORDS_BY_SCREEN,[0,Type.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),bb=this.board.getBoundingBox(),dy=.1*(bb[1]-bb[3]),y=pb_on_curve.Y();return y>bb[1]?y=bb[1]-dy:y<bb[3]&&(y=bb[3]+dy),y+off.usrCoords[2]},function(){var Int=Numerics.NewtonCotes([pa_on_axis.X(),pb_on_axis.X()],curve.Y);return"&int; = "+Type.toFixed(Int,4)}],attr)).dump=!1,pa_on_curve.addChild(t),pb_on_curve.addChild(t)),pa_on_curve.dump=!1,pa_on_axis.dump=!1,pb_on_curve.dump=!1,pb_on_axis.dump=!1,p.elType="integral",p.setParents([curve.id,interval]),p.subs={curveLeft:pa_on_curve,baseLeft:pa_on_axis,curveRight:pb_on_curve,baseRight:pb_on_axis},p.inherits.push(pa_on_curve,pa_on_axis,pb_on_curve,pb_on_axis),attr.withLabel&&(p.subs.label=t,p.inherits.push(t)),p.Value=function(){return Numerics.I([pa_on_axis.X(),pb_on_axis.X()],curve.Y)},p.updateDataArray=function(){var x,y,i,left,right,lowx,upx,lowy,upy;if("y"===Type.evaluate(this.visProp.axis)){for(pa_on_curve.Y()<pb_on_curve.Y()?(lowx=pa_on_curve.X(),lowy=pa_on_curve.Y(),upx=pb_on_curve.X(),upy=pb_on_curve.Y()):(lowx=pb_on_curve.X(),lowy=pb_on_curve.Y(),upx=pa_on_curve.X(),upy=pa_on_curve.Y()),left=Math.min(lowx,upx),right=Math.max(lowx,upx),x=[0,lowx],y=[lowy,lowy],i=0;i<curve.numberPoints;i++)lowy<=curve.points[i].usrCoords[2]&&left<=curve.points[i].usrCoords[1]&&curve.points[i].usrCoords[2]<=upy&&curve.points[i].usrCoords[1]<=right&&(x.push(curve.points[i].usrCoords[1]),y.push(curve.points[i].usrCoords[2]));x.push(upx),y.push(upy),x.push(0),y.push(upy),x.push(0),y.push(lowy)}else{for(pa_on_axis.X()<pb_on_axis.X()?(left=pa_on_axis.X(),right=pb_on_axis.X()):(left=pb_on_axis.X(),right=pa_on_axis.X()),x=[left,left],y=[0,curve.Y(left)],i=0;i<curve.numberPoints;i++)left<=curve.points[i].usrCoords[1]&&curve.points[i].usrCoords[1]<=right&&(x.push(curve.points[i].usrCoords[1]),y.push(curve.points[i].usrCoords[2]));x.push(right),y.push(curve.Y(right)),x.push(right),y.push(0),x.push(left),y.push(0)}this.dataX=x,this.dataY=y},pa_on_curve.addChild(p),pb_on_curve.addChild(p),pa_on_axis.addChild(p),pb_on_axis.addChild(p),p.baseLeft=pa_on_axis,p.baseRight=pb_on_axis,p.curveLeft=pa_on_curve,p.curveRight=pb_on_curve,p.methodMap=JXG.deepCopy(p.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),p.label=t,p},JXG.createGrid=function(board,parents,attributes){var c,attr;return attr=Type.copyAttributes(attributes,board.options,"grid"),(c=board.create("curve",[[null],[null]],attr)).elType="grid",c.type=Const.OBJECT_TYPE_GRID,c.updateDataArray=function(){var start,end,i,topLeft,bottomRight,gridX=Type.evaluate(this.visProp.gridx),gridY=Type.evaluate(this.visProp.gridy);for(topLeft=Type.isArray(this.visProp.topleft)?new Coords(Type.evaluate(this.visProp.tltype)||Const.COORDS_BY_USER,this.visProp.topleft,board):new Coords(Const.COORDS_BY_SCREEN,[0,0],board),bottomRight=Type.isArray(this.visProp.bottomright)?new Coords(Type.evaluate(this.visProp.brtype)||Const.COORDS_BY_USER,this.visProp.bottomright,board):new Coords(Const.COORDS_BY_SCREEN,[board.canvasWidth,board.canvasHeight],board),board.options.grid.hasGrid=!0,c.dataX=[],c.dataY=[],start=Math.floor(topLeft.usrCoords[2]/gridY)*gridY,end=Math.ceil(bottomRight.usrCoords[2]/gridY)*gridY,topLeft.usrCoords[2]<bottomRight.usrCoords[2]&&(start=Math.ceil(bottomRight.usrCoords[2]/gridY)*gridY,end=Math.floor(topLeft.usrCoords[2]/gridY)*gridY),i=start;i>end-gridY;i-=gridY)c.dataX.push(topLeft.usrCoords[1],bottomRight.usrCoords[1],NaN),c.dataY.push(i,i,NaN);for(start=Math.ceil(topLeft.usrCoords[1]/gridX)*gridX,end=Math.floor(bottomRight.usrCoords[1]/gridX)*gridX,topLeft.usrCoords[1]>bottomRight.usrCoords[1]&&(start=Math.floor(bottomRight.usrCoords[1]/gridX)*gridX,end=Math.ceil(topLeft.usrCoords[1]/gridX)*gridX),i=start;i<end+gridX;i+=gridX)c.dataX.push(i,i,NaN),c.dataY.push(topLeft.usrCoords[2],bottomRight.usrCoords[2],NaN)},c.hasPoint=function(){return!1},board.grids.push(c),c},JXG.createInequality=function(board,parents,attributes){var f,a,attr;if(attr=Type.copyAttributes(attributes,board.options,"inequality"),parents[0].elementClass===Const.OBJECT_CLASS_LINE)(a=board.create("curve",[[],[]],attr)).hasPoint=function(){return!1},a.updateDataArray=function(){var i1,i2,h,bb=board.getBoundingBox(),factor=attr.inverse?-1:1,w=1.5*Math.max(bb[2]-bb[0],bb[1]-bb[3]),dp={coords:{usrCoords:[1,(bb[0]+bb[2])/2,attr.inverse?bb[1]:bb[3]]}},slope1=parents[0].stdform.slice(1),slope2=slope1;h=1.5*Math.max(Geometry.perpendicular(parents[0],dp,board)[0].distance(Const.COORDS_BY_USER,dp.coords),w),h*=factor,dp={coords:{usrCoords:[1,(bb[0]+bb[2])/2,(bb[1]+bb[3])/2]}},i1=[1,(dp=Math.abs(Mat.innerProduct(dp.coords.usrCoords,parents[0].stdform,3))>=Mat.eps?Geometry.perpendicular(parents[0],dp,board)[0].usrCoords:dp.coords.usrCoords)[1]+slope1[1]*w,dp[2]-slope1[0]*w],i2=[1,dp[1]-slope2[1]*w,dp[2]+slope2[0]*w],this.dataX=[i1[1],i1[1]+slope1[0]*h,i2[1]+slope2[0]*h,i2[1],i1[1]],this.dataY=[i1[2],i1[2]+slope1[1]*h,i2[2]+slope2[1]*h,i2[2],i1[2]]};else if(parents[0].elementClass===Const.OBJECT_CLASS_CURVE&&"functiongraph"===parents[0].visProp.curvetype)(a=board.create("curve",[[],[]],attr)).updateDataArray=function(){var infty,first,last,len,i,curve_mi,curve_ma,firstx,lastx,bbox=this.board.getBoundingBox(),points=[],mi=parents[0].minX(),ma=parents[0].maxX(),enlarge=.3*(bbox[1]-bbox[3]);if(infty=Type.evaluate(this.visProp.inverse)?1:3,this.dataX=[],this.dataY=[],0!==(len=parents[0].points.length))for(bbox[1]+=enlarge,bbox[3]-=enlarge,last=-1;last<len-1;){for(i=last+1,first=len;i<len;i++)if(parents[0].points[i].isReal()){first=i;break}if(first>=len)break;for(i=first,last=len-1;i<len-1;i++)if(!parents[0].points[i+1].isReal()){last=i;break}for(firstx=parents[0].points[first].usrCoords[1],lastx=parents[0].points[last].usrCoords[1],curve_mi=bbox[0]<mi?mi:bbox[0],curve_ma=bbox[2]>ma?ma:bbox[2],curve_mi=0===first?curve_mi:Math.max(curve_mi,firstx),curve_ma=last===len-1?curve_ma:Math.min(curve_ma,lastx),curve_ma=last===len-1?ma:lastx,(points=[]).push([1,curve_mi=0===first?mi:firstx,bbox[infty]]),points.push([1,curve_mi,parents[0].points[first].usrCoords[2]]),i=first;i<=last;i++)points.push(parents[0].points[i].usrCoords);for(points.push([1,curve_ma,parents[0].points[last].usrCoords[2]]),points.push([1,curve_ma,bbox[infty]]),points.push(points[0]),i=0;i<points.length;i++)this.dataX.push(points[i][1]),this.dataY.push(points[i][2]);last<len-1&&(this.dataX.push(NaN),this.dataY.push(NaN))}},a.hasPoint=function(){return!1};else if(f=Type.createFunction(parents[0]),!Type.exists(f))throw new Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]");return a.addParents(parents[0]),a},JXG.registerElement("arrowparallel",JXG.createArrowParallel),JXG.registerElement("bisector",JXG.createBisector),JXG.registerElement("bisectorlines",JXG.createAngularBisectorsOfTwoLines),JXG.registerElement("msector",JXG.createMsector),JXG.registerElement("circumcircle",JXG.createCircumcircle),JXG.registerElement("circumcirclemidpoint",JXG.createCircumcenter),JXG.registerElement("circumcenter",JXG.createCircumcenter),JXG.registerElement("incenter",JXG.createIncenter),JXG.registerElement("incircle",JXG.createIncircle),JXG.registerElement("integral",JXG.createIntegral),JXG.registerElement("midpoint",JXG.createMidpoint),JXG.registerElement("mirrorelement",JXG.createMirrorElement),JXG.registerElement("mirrorpoint",JXG.createMirrorPoint),JXG.registerElement("normal",JXG.createNormal),JXG.registerElement("orthogonalprojection",JXG.createOrthogonalProjection),JXG.registerElement("parallel",JXG.createParallel),JXG.registerElement("parallelpoint",JXG.createParallelPoint),JXG.registerElement("perpendicular",JXG.createPerpendicular),JXG.registerElement("perpendicularpoint",JXG.createPerpendicularPoint),JXG.registerElement("perpendicularsegment",JXG.createPerpendicularSegment),JXG.registerElement("reflection",JXG.createReflection),JXG.registerElement("grid",JXG.createGrid),JXG.registerElement("inequality",JXG.createInequality),{createArrowParallel:JXG.createArrowParallel,createBisector:JXG.createBisector,createAngularBisectorOfTwoLines:JXG.createAngularBisectorsOfTwoLines,createCircumcircle:JXG.createCircumcircle,createCircumcenter:JXG.createCircumcenter,createIncenter:JXG.createIncenter,createIncircle:JXG.createIncircle,createIntegral:JXG.createIntegral,createMidpoint:JXG.createMidpoint,createMirrorElement:JXG.createMirrorElement,createMirrorPoint:JXG.createMirrorPoint,createNormal:JXG.createNormal,createOrthogonalProjection:JXG.createOrthogonalProjection,createParallel:JXG.createParallel,createParallelPoint:JXG.createParallelPoint,createPerpendicular:JXG.createPerpendicular,createPerpendicularPoint:JXG.createPerpendicularPoint,createPerpendicularSegmen:JXG.createPerpendicularSegment,createReflection:JXG.createReflection,createGrid:JXG.createGrid,createInequality:JXG.createInequality}})),define("element/locus",["jxg","math/symbolic","utils/type"],(function(JXG,Symbolic,Type){return JXG.createLocus=function(board,parents,attributes){var c,p;if(!Type.isArray(parents)||1!==parents.length||!Type.isPoint(parents[0]))throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return p=parents[0],(c=board.create("curve",[[null],[null]],attributes)).dontCallServer=!1,c.elType="locus",c.setParents([p.id]),c.updateDataArray=function(){var spe,cb,data;c.board.mode>0||(spe=Symbolic.generatePolynomials(board,p,!0).join("|"))!==c.spe&&(c.spe=spe,(cb=function(x,y,eq,t){var equations;c.dataX=x,c.dataY=y,c.eq=eq,c.ctime=t,c.generatePolynomial=(equations=eq,function(point){var i,x="("+point.symbolic.x+")",y="("+point.symbolic.y+")",res=[];for(i=0;i<equations.length;i++)res[i]=equations[i].replace(/\*\*/g,"^").replace(/x/g,x).replace(/y/g,y);return res})})((data=Symbolic.geometricLocusByGroebnerBase(board,p,cb)).datax,data.datay,data.polynomial,data.exectime))},c},JXG.registerElement("locus",JXG.createLocus),{createLocus:JXG.createLocus}})),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],(function(JXG,Const,Coords,GeometryElement,Mat,Type,CoordsElement){return JXG.Image=function(board,coords,attributes,url,size){this.constructor(board,attributes,Const.OBJECT_TYPE_IMAGE,Const.OBJECT_CLASS_OTHER),this.element=this.board.select(attributes.anchor),this.coordsConstructor(coords),this.W=Type.createFunction(size[0],this.board,""),this.H=Type.createFunction(size[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*board.unitX),Math.abs(this.usrSize[1]*board.unitY)],this.url=url,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=JXG.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},JXG.Image.prototype=new GeometryElement,Type.copyPrototypeMethods(JXG.Image,CoordsElement,"coordsConstructor"),JXG.extend(JXG.Image.prototype,{hasPoint:function(x,y){var dx,dy,r,type,prec,c,v,p,dot,len=this.transformations.length;return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,0===len?(dx=x-this.coords.scrCoords[1],dy=this.coords.scrCoords[2]-y,dx>=-(r=prec)&&dx-this.size[0]<=r&&dy>=-r&&dy-this.size[1]<=r):(v=[(c=(c=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board)).usrCoords)[0]-this.span[0][0],c[1]-this.span[0][1],c[2]-this.span[0][2]],0<=(p=(dot=Mat.innerProduct)(v,this.span[1]))&&p<=dot(this.span[1],this.span[1])&&0<=(p=dot(v,this.span[2]))&&p<=dot(this.span[2],this.span[2]))},update:function(fromParent){return this.needsUpdate?(this.updateCoords(fromParent),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var i,j,len=this.transformations.length,v=[];if(0===len)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(v[0]=[this.Z(),this.X(),this.Y()],v[1]=[this.Z(),this.X()+this.W(),this.Y()],v[2]=[this.Z(),this.X(),this.Y()+this.H()],i=0;i<len;i++)for(j=0;j<3;j++)v[j]=Mat.matVecMult(this.transformations[i].matrix,v[j]);for(j=0;j<3;j++)v[j][1]/=v[j][0],v[j][2]/=v[j][0],v[j][0]/=v[j][0];for(j=1;j<3;j++)v[j][0]-=v[0][0],v[j][1]-=v[0][1],v[j][2]-=v[0][2];this.span=v}return this},addTransform:function(transform){var i;if(Type.isArray(transform))for(i=0;i<transform.length;i++)this.transformations.push(transform[i]);else this.transformations.push(transform);return this},getParents:function(){var p=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return 0!==this.parents.length&&(p=this.parents),p},setSize:function(width,height){return this.W=Type.createFunction(width,this.board,""),this.H=Type.createFunction(height,this.board,""),this},W:function(){},H:function(){}}),JXG.createImage=function(board,parents,attributes){var attr,im,url=parents[0],coords=parents[1],size=parents[2];if(attr=Type.copyAttributes(attributes,board.options,"image"),!(im=CoordsElement.create(JXG.Image,board,coords,attr,url,size)))throw new Error("JSXGraph: Can't create image with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==attr.rotate&&im.addRotation(attr.rotate),im},JXG.registerElement("image",JXG.createImage),{Image:JXG.Image,createImage:JXG.createImage}})),define("element/slider",["jxg","math/math","base/constants","base/coords","utils/type","base/point"],(function(JXG,Mat,Const,Coords,Type,Point){return JXG.createSlider=function(board,parents,attributes){var pos0,pos1,smin,start,smax,sdiff,p1,p2,l1,ti,startx,starty,p3,l2,t,withText,withTicks,snapWidth,sw,s,attr;return withTicks=(attr=Type.copyAttributes(attributes,board.options,"slider")).withticks,withText=attr.withlabel,snapWidth=attr.snapwidth,attr=Type.copyAttributes(attributes,board.options,"slider","point1"),p1=board.create("point",parents[0],attr),attr=Type.copyAttributes(attributes,board.options,"slider","point2"),p2=board.create("point",parents[1],attr),attr=Type.copyAttributes(attributes,board.options,"slider","baseline"),(l1=board.create("segment",[p1,p2],attr)).updateStdform(),pos0=p1.coords.usrCoords.slice(1),pos1=p2.coords.usrCoords.slice(1),smin=parents[2][0],start=parents[2][1],smax=parents[2][2],sdiff=smax-smin,s=-1===(sw=Type.evaluate(snapWidth))?start:Math.round(start/sw)*sw,startx=pos0[0]+(pos1[0]-pos0[0])*(s-smin)/(smax-smin),starty=pos0[1]+(pos1[1]-pos0[1])*(s-smin)/(smax-smin),(attr=Type.copyAttributes(attributes,board.options,"slider")).withLabel=!1,(p3=board.create("glider",[startx,starty,l1],attr)).setAttribute({snapwidth:snapWidth}),attr=Type.copyAttributes(attributes,board.options,"slider","highline"),l2=board.create("segment",[p1,p3],attr),p3.Value=function(){var sdiff=this._smax-this._smin,ev_sw=Type.evaluate(this.visProp.snapwidth);return-1===ev_sw?this.position*sdiff+this._smin:Math.round((this.position*sdiff+this._smin)/ev_sw)*ev_sw},p3.methodMap=Type.deepCopy(p3.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),p3._smax=smax,p3._smin=smin,p3.setMax=function(val){return this._smax=val,this},p3.setValue=function(val){var sdiff=this._smax-this._smin;return Math.abs(sdiff)>Mat.eps?this.position=(val-this._smin)/sdiff:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},p3.setMin=function(val){return this._smin=val,this},withText&&(attr=Type.copyAttributes(attributes,board.options,"slider","label"),t=board.create("text",[function(){return.05*(p2.X()-p1.X())+p2.X()},function(){return.05*(p2.Y()-p1.Y())+p2.Y()},function(){var n,d=Type.evaluate(p3.visProp.digits),sl=Type.evaluate(p3.visProp.suffixlabel),ul=Type.evaluate(p3.visProp.unitlabel),pl=Type.evaluate(p3.visProp.postlabel);return 2===d&&2!==Type.evaluate(p3.visProp.precision)&&(d=Type.evaluate(p3.visProp.precision)),n=null!==sl?sl:p3.name&&""!==p3.name?p3.name+" = ":"",n+=Type.toFixed(p3.Value(),d),null!==ul&&(n+=ul),null!==pl&&(n+=pl),n}],attr),p3.label=t,p3.visProp.withlabel=!0,p3.hasLabel=!0),p3.point1=p1,p3.point2=p2,p3.baseline=l1,p3.highline=l2,withTicks&&(attr=Type.copyAttributes(attributes,board.options,"slider","ticks"),Type.exists(attr.generatelabeltext)||(attr.generateLabelText=function(tick,zero,value){var dFull=p3.point1.Dist(p3.point2),smin=p3._smin,smax=p3._smax,val=this.getDistanceFromZero(zero,tick)*(smax-smin)/dFull+smin;return dFull<Mat.eps||Math.abs(val)<Mat.eps?"0":this.formatLabelText(val)}),2,ti=board.create("ticks",[p3.baseline,p3.point1.Dist(p1)/2,function(tick){var dFull=p3.point1.Dist(p3.point2),d=p3.point1.coords.distance(Const.COORDS_BY_USER,tick);return dFull<Mat.eps?0:d/dFull*sdiff+smin}],attr),p3.ticks=ti),p3.remove=function(){withText&&board.removeObject(t),board.removeObject(l2),board.removeObject(l1),board.removeObject(p2),board.removeObject(p1),Point.Point.prototype.remove.call(p3)},p1.dump=!1,p2.dump=!1,l1.dump=!1,l2.dump=!1,withText&&(t.dump=!1),p3.elType="slider",p3.parents=parents,p3.subs={point1:p1,point2:p2,baseLine:l1,highLine:l2},p3.inherits.push(p1,p2,l1,l2),withTicks&&(ti.dump=!1,p3.subs.ticks=ti,p3.inherits.push(ti)),p3.getParents=function(){return[this.point1.coords.usrCoords.slice(1),this.point2.coords.usrCoords.slice(1),[this._smin,this.position*(this._smax-this._smin)+this._smin,this._smax]]},p3.baseline.on("up",(function(evt){var pos,c;Type.evaluate(p3.visProp.moveonup)&&!Type.evaluate(p3.visProp.fixed)&&(pos=l1.board.getMousePosition(evt,0),c=new Coords(Const.COORDS_BY_SCREEN,pos,this.board),p3.moveTo([c.usrCoords[1],c.usrCoords[2]]))})),p3.prepareUpdate().update(),board.isSuspendedUpdate||(p3.updateVisibility().updateRenderer(),p3.baseline.updateVisibility().updateRenderer(),p3.highline.updateVisibility().updateRenderer(),withTicks&&p3.ticks.updateVisibility().updateRenderer()),p3},JXG.registerElement("slider",JXG.createSlider),{createSlider:JXG.createSlider}})),define("element/measure",["jxg","utils/type","base/element"],(function(JXG,Type,GeometryElement){return JXG.createTapemeasure=function(board,parents,attributes){var pos0,pos1,attr,withTicks,withText,digits,li,p1,p2,n,ti;return pos0=parents[0],pos1=parents[1],attr=Type.copyAttributes(attributes,board.options,"tapemeasure","point1"),p1=board.create("point",pos0,attr),attr=Type.copyAttributes(attributes,board.options,"tapemeasure","point2"),p2=board.create("point",pos1,attr),p1.setAttribute({ignoredSnapToPoints:[p2]}),p2.setAttribute({ignoredSnapToPoints:[p1]}),attr=Type.copyAttributes(attributes,board.options,"tapemeasure"),withTicks=attr.withticks,withText=attr.withlabel,2===(digits=attr.digits)&&2!==attr.precision&&(digits=attr.precision),withText&&(attr.withlabel=!0),li=board.create("segment",[p1,p2],attr),withText&&(n=attributes.name&&""!==attributes.name?attributes.name+" = ":"",li.label.setText((function(){return n+Type.toFixed(p1.Dist(p2),digits)}))),withTicks&&(attr=Type.copyAttributes(attributes,board.options,"tapemeasure","ticks"),ti=board.create("ticks",[li,.1],attr),li.inherits.push(ti)),li.remove=function(){withTicks&&li.removeTicks(ti),board.removeObject(p2),board.removeObject(p1),GeometryElement.prototype.remove.call(this)},li.Value=function(){return p1.Dist(p2)},p1.dump=!1,p2.dump=!1,li.elType="tapemeasure",li.getParents=function(){return[[p1.X(),p1.Y()],[p2.X(),p2.Y()]]},li.subs={point1:p1,point2:p2},withTicks&&(ti.dump=!1),li.methodMap=JXG.deepCopy(li.methodMap,{Value:"Value"}),li.prepareUpdate().update(),board.isSuspendedUpdate||(li.updateVisibility().updateRenderer(),li.point1.updateVisibility().updateRenderer(),li.point2.updateVisibility().updateRenderer()),li},JXG.registerElement("tapemeasure",JXG.createTapemeasure),{createTapemeasure:JXG.createTapemeasure}})),define("parser/datasource",["jxg","utils/type"],(function(JXG,Type){return JXG.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},JXG.extend(JXG.DataSource.prototype,{loadFromArray:function(table,columnHeader,rowHeader){var i,j,cell;if(Type.isArray(columnHeader)&&(this.columnHeaders=columnHeader,columnHeader=!1),Type.isArray(rowHeader)&&(this.rowHeaders=rowHeader,rowHeader=!1),this.data=[],columnHeader&&(this.columnHeaders=[]),rowHeader&&(this.rowHeaders=[]),Type.exists(table)){for(this.data=[],i=0;i<table.length;i++)for(this.data[i]=[],j=0;j<table[i].length;j++)cell=table[i][j],parseFloat(cell).toString()===cell?this.data[i][j]=parseFloat(cell):this.data[i][j]="-"!==cell?cell:NaN;if(columnHeader&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),rowHeader)for(this.rowHeaders=[],i=0;i<this.data.length;i++)this.rowHeaders.push(this.data[i][0]),this.data[i]=this.data[i].slice(1)}return this},loadFromTable:function(table,columnHeader,rowHeader){var row,i,j,col,cell;if(Type.isArray(columnHeader)&&(this.columnHeaders=columnHeader,columnHeader=!1),Type.isArray(rowHeader)&&(this.rowHeaders=rowHeader,rowHeader=!1),this.data=[],columnHeader&&(this.columnHeaders=[]),rowHeader&&(this.rowHeaders=[]),table=document.getElementById(table),Type.exists(table)){for(row=table.getElementsByTagName("tr"),this.data=[],i=0;i<row.length;i++)for(col=row[i].getElementsByTagName("td"),this.data[i]=[],j=0;j<col.length;j++)cell=col[j].innerHTML,parseFloat(cell).toString()===cell?this.data[i][j]=parseFloat(cell):this.data[i][j]="-"!==cell?cell:NaN;if(columnHeader&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),rowHeader)for(this.rowHeaders=[],i=0;i<this.data.length;i++)this.rowHeaders.push(this.data[i][0]),this.data[i]=this.data[i].slice(1)}return this},addColumn:function(name,pos,data){throw new Error("not implemented")},addRow:function(name,pos,data){throw new Error("not implemented")},getColumn:function(col){var i,result=[];if(Type.isString(col))for(i=0;i<this.columnHeaders.length;i++)if(col===this.columnHeaders[i]){col=i;break}for(i=0;i<this.data.length;i++)this.data[i].length>col&&(result[i]=parseFloat(this.data[i][col]));return result},getRow:function(row){var result,i;if(Type.isString(row))for(i=0;i<this.rowHeaders.length;i++)if(row===this.rowHeaders[i]){row=i;break}for(result=[],i=0;i<this.data[row].length;i++)result[i]=this.data[row][i];return result}}),JXG.DataSource})),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],(function(JXG,Numerics,Statistics,Const,Coords,GeometryElement,DataSource,Color,Type,Env,Curve,Point,Text,Polygon,Sector,Transform,Line,Circle){return JXG.Chart=function(board,parents,attributes){var x,y,i,c,style,len;if(this.constructor(board,attributes),!Type.isArray(parents)||0===parents.length)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],Type.isNumber(parents[0]))for(y=parents,x=[],i=0;i<y.length;i++)x[i]=i+1;else if(1===parents.length&&Type.isArray(parents[0]))for(y=parents[0],x=[],len=Type.evaluate(y).length,i=0;i<len;i++)x[i]=i+1;else 2===parents.length&&(len=Math.min(parents[0].length,parents[1].length),x=parents[0].slice(0,len),y=parents[1].slice(0,len));if(Type.isArray(y)&&0===y.length)throw new Error("JSXGraph: Can't create charts without data.");for(style=attributes.chartstyle.replace(/ /g,"").split(","),i=0;i<style.length;i++){switch(style[i]){case"bar":c=this.drawBar(board,x,y,attributes);break;case"line":c=this.drawLine(board,x,y,attributes);break;case"fit":c=this.drawFit(board,x,y,attributes);break;case"spline":c=this.drawSpline(board,x,y,attributes);break;case"pie":c=this.drawPie(board,y,attributes);break;case"point":c=this.drawPoints(board,x,y,attributes);break;case"radar":c=this.drawRadar(board,parents,attributes)}this.elements.push(c)}return this.id=this.board.setId(this,"Chart"),this.elements},JXG.Chart.prototype=new GeometryElement,JXG.extend(JXG.Chart.prototype,{drawLine:function(board,x,y,attributes){return attributes.fillcolor="none",attributes.highlightfillcolor="none",board.create("curve",[x,y],attributes)},drawSpline:function(board,x,y,attributes){return attributes.fillColor="none",attributes.highlightfillcolor="none",board.create("spline",[x,y],attributes)},drawFit:function(board,x,y,attributes){var deg=attributes.degree;return deg=Math.max(parseInt(deg,10),1)||1,attributes.fillcolor="none",attributes.highlightfillcolor="none",board.create("functiongraph",[Numerics.regressionPolynomial(deg,x,y)],attributes)},drawBar:function(board,x,y,attributes){var i,text,w,xp0,xp1,xp2,yp,colors,attr,attrSub,pols=[],p=[],makeXpFun=function(i,f){return function(){return x[i]()-f*w}},hiddenPoint={fixed:!0,withLabel:!1,visible:!1,name:""};if((attr=Type.copyAttributes(attributes,board.options,"chart"))&&attr.width)w=attr.width;else{if(x.length<=1)w=1;else for(w=x[1]-x[0],i=1;i<x.length-1;i++)w=x[i+1]-x[i]<w?x[i+1]-x[i]:w;w*=.8}for(attrSub=Type.copyAttributes(attributes,board.options,"chart","label"),i=0;i<x.length;i++)Type.isFunction(x[i])?(xp0=makeXpFun(i,-.5),xp1=makeXpFun(i,0),xp2=makeXpFun(i,.5)):(xp0=x[i]-.5*w,xp1=x[i],xp2=x[i]+.5*w),yp=Type.isFunction(y[i])?y[i]():y[i],yp=y[i],"horizontal"===attr.dir?(p[0]=board.create("point",[0,xp0],hiddenPoint),p[1]=board.create("point",[yp,xp0],hiddenPoint),p[2]=board.create("point",[yp,xp2],hiddenPoint),p[3]=board.create("point",[0,xp2],hiddenPoint),Type.exists(attr.labels)&&Type.exists(attr.labels[i])&&(attrSub.anchorY="middle",(text=board.create("text",[yp,xp1,attr.labels[i]],attrSub)).visProp.anchorx=function(txt){return function(){return txt.X()>=0?"left":"right"}}(text))):(p[0]=board.create("point",[xp0,0],hiddenPoint),p[1]=board.create("point",[xp0,yp],hiddenPoint),p[2]=board.create("point",[xp2,yp],hiddenPoint),p[3]=board.create("point",[xp2,0],hiddenPoint),Type.exists(attr.labels)&&Type.exists(attr.labels[i])&&(attrSub.anchorX="middle",(text=board.create("text",[xp1,yp,attr.labels[i]],attrSub)).visProp.anchory=function(txt){return function(){return txt.Y()>=0?"bottom":"top"}}(text))),Type.isArray(attr.colors)&&(colors=attr.colors,attr.fillcolor=colors[i%colors.length]),pols[i]=board.create("polygon",p,attr),Type.exists(attr.labels)&&Type.exists(attr.labels[i])&&(pols[i].text=text);return pols},drawPoints:function(board,x,y,attributes){var i,points=[],infoboxArray=attributes.infoboxarray;for(attributes.fixed=!0,attributes.name="",i=0;i<x.length;i++)attributes.infoboxtext=!!infoboxArray&&infoboxArray[i%infoboxArray.length],points[i]=board.create("point",[x[i],y[i]],attributes);return points},drawPie:function(board,y,attributes){var i,center,p=[],sector=[],colorArray=(Statistics.sum(y),attributes.colors),highlightColorArray=attributes.highlightcolors,labelArray=attributes.labels,r=attributes.radius||4,radius=r,cent=attributes.center||[0,0],xc=cent[0],yc=cent[1],makeRadPointFun=function(j,fun,xc){return function(){var s,i,rad,t=0;for(i=0;i<=j;i++)t+=parseFloat(Type.evaluate(y[i]));for(s=t,i=j+1;i<y.length;i++)s+=parseFloat(Type.evaluate(y[i]));return rad=0!==s?2*Math.PI*t/s:0,radius()*Math[fun](rad)+xc}},highlightHandleLabel=function(f,s){var dx=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],dy=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];Type.exists(this.label)&&(this.label.rendNode.style.fontSize=s*Type.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new Coords(Const.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+dx*f,this.point1.coords.usrCoords[2]+dy*f],this.board),this.fullUpdate()},highlightFun=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),highlightHandleLabel.call(this,1.1,2))},noHighlightFun=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),highlightHandleLabel.call(this,.9090909,1))},hiddenPoint={fixed:!0,withLabel:!1,visible:!1,name:""};if(!Type.isArray(labelArray))for(labelArray=[],i=0;i<y.length;i++)labelArray[i]="";for(Type.isFunction(r)||(radius=function(){return r}),attributes.highlightonsector=attributes.highlightonsector||!1,attributes.straightfirst=!1,attributes.straightlast=!1,center=board.create("point",[xc,yc],hiddenPoint),p[0]=board.create("point",[function(){return radius()+xc},function(){return yc}],hiddenPoint),i=0;i<y.length;i++)p[i+1]=board.create("point",[makeRadPointFun(i,"cos",xc),makeRadPointFun(i,"sin",yc)],hiddenPoint),attributes.name=labelArray[i],attributes.withlabel=""!==attributes.name,attributes.fillcolor=colorArray&&colorArray[i%colorArray.length],attributes.labelcolor=colorArray&&colorArray[i%colorArray.length],attributes.highlightfillcolor=highlightColorArray&&highlightColorArray[i%highlightColorArray.length],sector[i]=board.create("sector",[center,p[i],p[i+1]],attributes),attributes.highlightonsector&&(sector[i].hasPoint=sector[i].hasPointSector),attributes.highlightbysize&&(sector[i].highlight=highlightFun,sector[i].noHighlight=noHighlightFun);return{sectors:sector,points:p,midpoint:center}},drawRadar:function(board,parents,attributes){var i,j,paramArray,numofparams,maxes,mins,la,pdata,ssa,esa,ssratio,esratio,sshifts,eshifts,starts,ends,labelArray,colorArray,radius,myAtts,cent,xc,yc,center,start_angle,rad,p,line,t,xcoord,ycoord,polygons,circles,lxoff,lyoff,cla,clabelArray,ncircles,pcircles,dr,sw,data,len=parents.length,get_anchor=function(){var x1,x2,y1,y2,relCoords=Type.evaluate(this.visProp.label.offset).slice(0);return x1=this.point1.X(),x2=this.point2.X(),y1=this.point1.Y(),y2=this.point2.Y(),x2<x1&&(relCoords[0]=-relCoords[0]),y2<y1&&(relCoords[1]=-relCoords[1]),this.setLabelRelativeCoords(relCoords),new Coords(Const.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},get_transform=function(angle,i){var t,tscale,trot;return t=board.create("transform",[-(starts[i]-sshifts[i]),0],{type:"translate"}),tscale=board.create("transform",[radius/(ends[i]+eshifts[i]-(starts[i]-sshifts[i])),1],{type:"scale"}),t.melt(tscale),trot=board.create("transform",[angle],{type:"rotate"}),t.melt(trot),t};if(len<=0)throw new Error("JSXGraph radar chart: no data");if(paramArray=attributes.paramarray,!Type.exists(paramArray))throw new Error("JSXGraph radar chart: need paramArray attribute");if((numofparams=paramArray.length)<=1)throw new Error("JSXGraph radar chart: need more than one param in paramArray");for(i=0;i<len;i++)if(numofparams!==parents[i].length)throw new Error("JSXGraph radar chart: use data length equal to number of params ("+parents[i].length+" != "+numofparams+")");for(maxes=[],mins=[],j=0;j<numofparams;j++)maxes[j]=parents[0][j],mins[j]=maxes[j];for(i=1;i<len;i++)for(j=0;j<numofparams;j++)parents[i][j]>maxes[j]&&(maxes[j]=parents[i][j]),parents[i][j]<mins[j]&&(mins[j]=parents[i][j]);for(la=[],pdata=[],i=0;i<len;i++)la[i]="",pdata[i]=[];for(ssa=[],esa=[],ssratio=attributes.startshiftratio||0,esratio=attributes.endshiftratio||0,i=0;i<numofparams;i++)ssa[i]=(maxes[i]-mins[i])*ssratio,esa[i]=(maxes[i]-mins[i])*esratio;if(sshifts=attributes.startshiftarray||ssa,eshifts=attributes.endshiftarray||esa,starts=attributes.startarray||mins,Type.exists(attributes.start))for(i=0;i<numofparams;i++)starts[i]=attributes.start;if(ends=attributes.endarray||maxes,Type.exists(attributes.end))for(i=0;i<numofparams;i++)ends[i]=attributes.end;if(sshifts.length!==numofparams)throw new Error("JSXGraph radar chart: start shifts length is not equal to number of parameters");if(eshifts.length!==numofparams)throw new Error("JSXGraph radar chart: end shifts length is not equal to number of parameters");if(starts.length!==numofparams)throw new Error("JSXGraph radar chart: starts length is not equal to number of parameters");if(ends.length!==numofparams)throw new Error("JSXGraph radar chart: snds length is not equal to number of parameters");for(labelArray=attributes.labelarray||la,colorArray=attributes.colors,attributes.highlightcolors,radius=attributes.radius||10,sw=attributes.strokewidth||1,Type.exists(attributes.highlightonsector)||(attributes.highlightonsector=!1),myAtts={name:attributes.name,id:attributes.id,strokewidth:sw,polystrokewidth:attributes.polystrokewidth||sw,strokecolor:attributes.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:attributes.fillColor||"#FFFF88",fillopacity:attributes.fillOpacity||.4,highlightfillcolor:attributes.highlightFillColor||"#FF7400",highlightstrokecolor:attributes.highlightStrokeColor||"black",gradient:attributes.gradient||"none"},xc=(cent=attributes.center||[0,0])[0],yc=cent[1],center=board.create("point",[xc,yc],{name:"",fixed:!0,withlabel:!1,visible:!1}),Math.PI/2-Math.PI/numofparams,rad=start_angle=attributes.startangle||0,p=[],line=[],i=0;i<numofparams;i++)for(rad+=2*Math.PI/numofparams,xcoord=radius*Math.cos(rad)+xc,ycoord=radius*Math.sin(rad)+yc,p[i]=board.create("point",[xcoord,ycoord],{name:"",fixed:!0,withlabel:!1,visible:!1}),line[i]=board.create("line",[center,p[i]],{name:paramArray[i],strokeColor:myAtts.strokecolor,strokeWidth:myAtts.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:myAtts.highlightstrokecolor}),line[i].getLabelAnchor=get_anchor,t=get_transform(rad,i),j=0;j<parents.length;j++)data=parents[j][i],pdata[j][i]=board.create("point",[data,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),pdata[j][i].addTransform(pdata[j][i],t);for(polygons=[],i=0;i<len;i++)for(myAtts.labelcolor=colorArray&&colorArray[i%colorArray.length],myAtts.strokecolor=colorArray&&colorArray[i%colorArray.length],myAtts.fillcolor=colorArray&&colorArray[i%colorArray.length],polygons[i]=board.create("polygon",pdata[i],{withLines:!0,withLabel:!1,fillColor:myAtts.fillcolor,fillOpacity:myAtts.fillopacity,highlightFillColor:myAtts.highlightfillcolor}),j=0;j<numofparams;j++)polygons[i].borders[j].setAttribute("strokecolor:"+colorArray[i%colorArray.length]),polygons[i].borders[j].setAttribute("strokewidth:"+myAtts.polystrokewidth);switch(attributes.legendposition||"none"){case"right":lxoff=attributes.legendleftoffset||2,lyoff=attributes.legendtopoffset||1,this.legend=board.create("legend",[xc+radius+lxoff,yc+radius-lyoff],{labels:labelArray,colors:colorArray});break;case"none":break;default:JXG.debug("Unknown legend position")}if(circles=[],attributes.showcircles){for(cla=[],i=0;i<6;i++)cla[i]=20*i;if(cla[0]="0",(ncircles=(clabelArray=attributes.circlelabelarray||cla).length)<2)throw new Error("JSXGraph radar chart: too less circles in circleLabelArray");for(pcircles=[],t=get_transform(start_angle+Math.PI/numofparams,0),myAtts.fillcolor="none",myAtts.highlightfillcolor="none",myAtts.strokecolor=attributes.strokecolor||"black",myAtts.strokewidth=attributes.circlestrokewidth||.5,myAtts.layer=0,dr=(ends[0]-starts[0])/(ncircles-1),i=0;i<ncircles;i++)pcircles[i]=board.create("point",[starts[0]+i*dr,0],{name:clabelArray[i],size:0,fixed:!0,withLabel:!0,visible:!0}),pcircles[i].addTransform(pcircles[i],t),circles[i]=board.create("circle",[center,pcircles[i]],myAtts)}return this.rendNode=polygons[0].rendNode,{circles:circles,lines:line,points:pdata,midpoint:center,polygons:polygons}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){return this}}),JXG.createChart=function(board,parents,attributes){var data,row,i,j,col,w,x,showRows,attr,originalWidth,name,strokeColor,fillColor,hStrokeColor,hFillColor,len,charts=[],table=Env.isBrowser?board.document.getElementById(parents[0]):null;if(1===parents.length&&Type.isString(parents[0])){if(Type.exists(table)){if(attr=Type.copyAttributes(attributes,board.options,"chart"),data=(table=(new DataSource).loadFromTable(parents[0],attr.withheaders,attr.withheaders)).data,col=table.columnHeaders,row=table.rowHeaders,originalWidth=attr.width,name=attr.name,strokeColor=attr.strokecolor,fillColor=attr.fillcolor,hStrokeColor=attr.highlightstrokecolor,hFillColor=attr.highlightfillcolor,board.suspendUpdate(),len=data.length,showRows=[],attr.rows&&Type.isArray(attr.rows)){for(i=0;i<len;i++)for(j=0;j<attr.rows.length;j++)if(attr.rows[j]===i||attr.withheaders&&attr.rows[j]===row[i]){showRows.push(data[i]);break}}else showRows=data;for(len=showRows.length,i=0;i<len;i++){if(x=[],attr.chartstyle&&-1!==attr.chartstyle.indexOf("bar")){for(w=originalWidth||.8,x.push(1-w/2+(i+.5)*w/len),j=1;j<showRows[i].length;j++)x.push(x[j-1]+1);attr.width=w/len}name&&name.length===len?attr.name=name[i]:attr.withheaders&&(attr.name=col[i]),strokeColor&&strokeColor.length===len?attr.strokecolor=strokeColor[i]:attr.strokecolor=Color.hsv2rgb((i+1)/len*360,.9,.6),fillColor&&fillColor.length===len?attr.fillcolor=fillColor[i]:attr.fillcolor=Color.hsv2rgb((i+1)/len*360,.9,1),hStrokeColor&&hStrokeColor.length===len?attr.highlightstrokecolor=hStrokeColor[i]:attr.highlightstrokecolor=Color.hsv2rgb((i+1)/len*360,.9,1),hFillColor&&hFillColor.length===len?attr.highlightfillcolor=hFillColor[i]:attr.highlightfillcolor=Color.hsv2rgb((i+1)/len*360,.9,.6),attr.chartstyle&&-1!==attr.chartstyle.indexOf("bar")?charts.push(new JXG.Chart(board,[x,showRows[i]],attr)):charts.push(new JXG.Chart(board,[showRows[i]],attr))}board.unsuspendUpdate()}return charts}return attr=Type.copyAttributes(attributes,board.options,"chart"),new JXG.Chart(board,parents,attr)},JXG.registerElement("chart",JXG.createChart),JXG.Legend=function(board,coords,attributes){var attr;if(this.constructor(),attr=Type.copyAttributes(attributes,board.options,"legend"),this.board=board,this.coords=new Coords(Const.COORDS_BY_USER,coords,this.board),this.myAtts={},this.label_array=attr.labelarray||attr.labels,this.color_array=attr.colorarray||attr.colors,this.lines=[],this.myAtts.strokewidth=attr.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=attr.legendstyle||attr.style,"vertical"!==this.style)throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(board,attr)},JXG.Legend.prototype=new GeometryElement,JXG.Legend.prototype.drawVerticalLegend=function(board,attributes){var i,line_length=attributes.linelength||1,offy=(attributes.rowheight||20)/this.board.unitY,getLabelAnchor=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new Coords(Const.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(i=0;i<this.label_array.length;i++)this.myAtts.name=this.label_array[i],this.myAtts.strokecolor=this.color_array[i%this.color_array.length],this.myAtts.highlightstrokecolor=this.color_array[i%this.color_array.length],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[i%this.color_array.length],strokeWidth:this.myAtts.strokewidth},this.lines[i]=board.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-i*offy],[this.coords.usrCoords[1]+line_length,this.coords.usrCoords[2]-i*offy]],this.myAtts),this.lines[i].getLabelAnchor=getLabelAnchor,this.lines[i].prepareUpdate().update().updateVisibility(Type.evaluate(this.lines[i].visProp.visible)).updateRenderer()},JXG.createLegend=function(board,parents,attributes){var start_from=[0,0];if(!Type.exists(parents)||2!==parents.length)throw new Error("JSXGraph: Legend element needs two numbers as parameters");return start_from=parents,new JXG.Legend(board,start_from,attributes)},JXG.registerElement("legend",JXG.createLegend),{Chart:JXG.Chart,Legend:JXG.Legend,createChart:JXG.createChart,createLegend:JXG.createLegend}})),define("base/turtle",["jxg","base/constants","base/element","utils/type"],(function(JXG,Const,GeometryElement,Type){return JXG.Turtle=function(board,parents,attributes){var x,y,dir;return this.constructor(board,attributes,Const.OBJECT_TYPE_TURTLE,Const.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=board,this.visProp.curveType="plot",this._attributes=Type.copyAttributes(this.visProp,board.options,"turtle"),delete this._attributes.id,x=0,y=0,dir=90,0!==parents.length&&(3===parents.length?(x=parents[0],y=parents[1],dir=parents[2]):2===parents.length?Type.isArray(parents[0])?(x=parents[0][0],y=parents[0][1],dir=parents[1]):(x=parents[0],y=parents[1]):(x=parents[0][0],y=parents[0][1])),this.init(x,y,dir),this.methodMap=Type.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},JXG.Turtle.prototype=new GeometryElement,JXG.extend(JXG.Turtle.prototype,{init:function(x,y,dir){var hiddenPointAttr={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[x,y],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,hiddenPointAttr),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],hiddenPointAttr),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-dir),this.board.update()},forward:function(len){if(0===len)return this;var t,dx=len*Math.cos(this.dir*Math.PI/180),dy=len*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((t=this.board.create("transform",[dx,dy],{type:"translate"})).applyOnce(this.turtle),t.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=dx,this.pos[1]+=dy,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(len){return this.forward(-len)},right:function(angle){(this.dir-=angle,this.dir%=360,this.turtleIsHidden)||this.board.create("transform",[-angle*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2);return this.board.update(),this},left:function(angle){return this.right(-angle)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var i,el;for(i=0;i<this.objects.length;i++)(el=this.objects[i]).type===Const.OBJECT_TYPE_CURVE&&(this.board.removeObject(el),this.objects.splice(i,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var i,el,len=this.objects.length;for(i=0;i<len;i++)el=this.objects[i],this.board.removeObject(el);return this.init(0,0,90),this},setPos:function(x,y){return Type.isArray(x)?this.pos=x:this.pos=[x,y],this.turtleIsHidden||(this.turtle.setPositionDirectly(Const.COORDS_BY_USER,[x,y]),this.turtle2.setPositionDirectly(Const.COORDS_BY_USER,[x,y+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(size){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",size)),this.objects.push(this.curve),this},setPenColor:function(color){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",color)),this.objects.push(this.curve),this},setHighlightPenColor:function(color){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",color)),this.objects.push(this.curve),this},setAttribute:function(attributes){var i,el,tmp,len=this.objects.length;for(i=0;i<len;i++)(el=this.objects[i]).type===Const.OBJECT_TYPE_CURVE&&el.setAttribute(attributes);return tmp=this.visProp.id,this.visProp=Type.deepCopy(this.curve.visProp),this.visProp.id=tmp,this._attributes=Type.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(key,val){return this._attributes[key.toLowerCase()]=val,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var status=this.stack.pop();return this.pos[0]=status[0],this.pos[1]=status[1],this.dir=status[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(target){var ax,ay,bx,by,beta;return Type.isArray(target)?(ax=this.pos[0],ay=this.pos[1],bx=target[0],by=target[1],beta=Math.atan2(by-ay,bx-ax),this.right(this.dir-180*beta/Math.PI)):Type.isNumber(target)&&this.right(this.dir-target),this},moveTo:function(target){var dx,dy,t;return Type.isArray(target)&&(dx=target[0]-this.pos[0],dy=target[1]-this.pos[1],this.turtleIsHidden||((t=this.board.create("transform",[dx,dy],{type:"translate"})).applyOnce(this.turtle),t.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=target[0],this.pos[1]=target[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(len){return this.forward(len)},bk:function(len){return this.back(len)},lt:function(angle){return this.left(angle)},rt:function(angle){return this.right(angle)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(t,co){var i,j,el,tc,len=this.objects.length;for(i=0,j=0;i<len;i++)if((el=this.objects[i]).elementClass===Const.OBJECT_CLASS_CURVE){if(j<=t&&t<j+el.numberPoints)return tc=t-j,el[co](tc);j+=el.numberPoints}return this[co]()},X:function(t){return Type.exists(t)?this.evalAt(t,"X"):this.pos[0]},Y:function(t){return Type.exists(t)?this.evalAt(t,"Y"):this.pos[1]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){var i,len=this.objects.length,np=0;for(i=0;i<len;i++)this.objects[i].elementClass===Const.OBJECT_CLASS_CURVE&&(np+=this.objects[i].numberPoints);return np},hasPoint:function(x,y){var i,el;for(i=0;i<this.objects.length;i++)if((el=this.objects[i]).type===Const.OBJECT_TYPE_CURVE&&el.hasPoint(x,y))return!0;return!1}}),JXG.createTurtle=function(board,parents,attributes){var attr;return parents=parents||[],attr=Type.copyAttributes(attributes,board.options,"turtle"),new JXG.Turtle(board,parents,attr)},JXG.registerElement("turtle",JXG.createTurtle),{Turtle:JXG.Turtle,createTurtle:JXG.createTurtle}})),define("base/ticks",["jxg","math/math","math/geometry","math/numerics","base/constants","base/element","base/coords","utils/type","base/text"],(function(JXG,Mat,Geometry,Numerics,Const,GeometryElement,Coords,Type,Text){return JXG.Ticks=function(line,ticks,attributes){if(this.constructor(line.board,attributes,Const.OBJECT_TYPE_TICKS,Const.OBJECT_CLASS_OTHER),this.line=line,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],Type.isFunction(ticks))throw this.ticksFunction=ticks,new Error("Function arguments are no longer supported.");Type.isArray(ticks)?this.fixedTicks=ticks:((Math.abs(ticks)<Mat.eps||ticks<0)&&(ticks=attributes.defaultdistance),this.ticksFunction=this.makeTicksFunction(ticks),this.equidistant=!0),this.minTicksDistance=attributes.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},JXG.Ticks.prototype=new GeometryElement,JXG.extend(JXG.Ticks.prototype,{makeTicksFunction:function(ticks){return function(){var delta,b,dist;return Type.evaluate(this.visProp.insertticks)?((dist=(b=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-b.lower)<=6*(delta=Math.pow(10,Math.floor(Math.log(.6*dist)/Math.LN10)))&&(delta*=.5),delta):ticks}},hasPoint:function(x,y){var i,t,r,type,len=this.ticks&&this.ticks.length||0;if(Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,r=Type.evaluate(this.visProp.precision[type])):r=this.board.options.precision.hasPoint,r+=.5*Type.evaluate(this.visProp.strokewidth),!Type.evaluate(this.line.visProp.scalable)||this.line.elementClass===Const.OBJECT_CLASS_CURVE)return!1;if(0!==this.line.stdform[1]&&0!==this.line.stdform[2]&&this.line.type!==Const.OBJECT_TYPE_AXIS)return!1;for(i=0;i<len;i++)if((t=this.ticks[i])[2]&&!(0===this.line.stdform[1]&&Math.abs(t[0][0]-this.line.point1.coords.scrCoords[1])<Mat.eps||0===this.line.stdform[2]&&Math.abs(t[1][0]-this.line.point1.coords.scrCoords[2])<Mat.eps)&&(Math.abs(t[0][0]-t[0][1])>=1||Math.abs(t[1][0]-t[1][1])>=1))if(0===this.line.stdform[1]){if(Math.abs(y-.5*(t[1][0]+t[1][1]))<2*r&&t[0][0]-r<x&&x<t[0][1]+r)return!0}else if(0===this.line.stdform[2]&&Math.abs(x-.5*(t[0][0]+t[0][1]))<2*r&&t[1][0]-r<y&&y<t[1][1]+r)return!0;return!1},setPositionDirectly:function(method,coords,oldcoords){var dx,dy,c=new Coords(method,coords,this.board),oldc=new Coords(method,oldcoords,this.board),bb=this.board.getBoundingBox();return this.line.type===Const.OBJECT_TYPE_AXIS&&Type.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<Mat.eps&&Math.abs(c.usrCoords[1]*oldc.usrCoords[1])>Mat.eps?(dx=oldc.usrCoords[1]/c.usrCoords[1],bb[0]*=dx,bb[2]*=dx,this.board.setBoundingBox(bb,this.board.keepaspectratio,"update")):Math.abs(this.line.stdform[2])<Mat.eps&&Math.abs(c.usrCoords[2]*oldc.usrCoords[2])>Mat.eps&&(dy=oldc.usrCoords[2]/c.usrCoords[2],bb[3]*=dy,bb[1]*=dy,this.board.setBoundingBox(bb,this.board.keepaspectratio,"update")),this):this},calculateTicksCoordinates:function(){var coordsZero,bounds,r_max,bb;if(!(this.line.elementClass===Const.OBJECT_CLASS_LINE&&(this.setTicksSizeVariables(),Math.abs(this.dx)<Mat.eps&&Math.abs(this.dy)<Mat.eps)))return coordsZero=this.getZeroCoordinates(),bounds=this.line.elementClass===Const.OBJECT_CLASS_LINE?this.getLowerAndUpperBounds(coordsZero):{lower:this.line.minX(),upper:this.line.maxX()},"polar"===Type.evaluate(this.visProp.type)&&(bb=this.board.getBoundingBox(),r_max=Math.max(Math.sqrt(bb[0]*bb[0]+bb[1]*bb[1]),Math.sqrt(bb[2]*bb[2]+bb[3]*bb[3])),bounds.upper=r_max),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(coordsZero,bounds):this.generateFixedTicks(coordsZero,bounds),this},setTicksSizeVariables:function(pos){var d,mi,ma,len,distMaj=.5*Type.evaluate(this.visProp.majorheight),distMin=.5*Type.evaluate(this.visProp.minorheight);Type.exists(pos)?(mi=this.line.minX(),ma=this.line.maxX(),(len=this.line.points.length)<2?(this.dxMaj=0,this.dyMaj=0):Mat.relDif(pos,mi)<Mat.eps?(this.dxMaj=this.line.points[0].usrCoords[2]-this.line.points[1].usrCoords[2],this.dyMaj=this.line.points[1].usrCoords[1]-this.line.points[0].usrCoords[1]):Mat.relDif(pos,ma)<Mat.eps?(this.dxMaj=this.line.points[len-2].usrCoords[2]-this.line.points[len-1].usrCoords[2],this.dyMaj=this.line.points[len-1].usrCoords[1]-this.line.points[len-2].usrCoords[1]):(this.dxMaj=-Numerics.D(this.line.Y)(pos),this.dyMaj=Numerics.D(this.line.X)(pos))):(this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2]),this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,d=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=distMaj/d*this.board.unitX,this.dyMaj*=distMaj/d*this.board.unitY,this.dxMin*=distMin/d*this.board.unitX,this.dyMin*=distMin/d*this.board.unitY,this.minStyle=Type.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=Type.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var c1x,c1y,c1z,c2x,c2y,c2z,mi,ma,ev_a=Type.evaluate(this.visProp.anchor);return this.line.elementClass===Const.OBJECT_CLASS_LINE?this.line.type===Const.OBJECT_TYPE_AXIS?Geometry.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(c1z=this.line.point1.coords.usrCoords[0],c1x=this.line.point1.coords.usrCoords[1],c1y=this.line.point1.coords.usrCoords[2],c2z=this.line.point2.coords.usrCoords[0],c2x=this.line.point2.coords.usrCoords[1],c2y=this.line.point2.coords.usrCoords[2],"right"===ev_a?this.line.point2.coords:"middle"===ev_a?new Coords(Const.COORDS_BY_USER,[.5*(c1z+c2z),.5*(c1x+c2x),.5*(c1y+c2y)],this.board):Type.isNumber(ev_a)?new Coords(Const.COORDS_BY_USER,[c1z+(c2z-c1z)*ev_a,c1x+(c2x-c1x)*ev_a,c1y+(c2y-c1y)*ev_a],this.board):this.line.point1.coords):(mi=this.line.minX(),ma=this.line.maxX(),"right"===ev_a?ma:"middle"===ev_a?.5*(mi+ma):Type.isNumber(ev_a)?mi*(1-ev_a)+ma*ev_a:mi)},getLowerAndUpperBounds:function(coordsZero,type){var lowerBound,upperBound,fA,lA,point1,point2,isPoint1inBoard,isPoint2inBoard,dZeroPoint1,dZeroPoint2,ev_sf=Type.evaluate(this.line.visProp.straightfirst),ev_sl=Type.evaluate(this.line.visProp.straightlast),ev_i=Type.evaluate(this.visProp.includeboundaries);return this.line.elementClass===Const.OBJECT_CLASS_CURVE?{lower:this.line.minX(),upper:this.line.maxX()}:(point1=new Coords(Const.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),point2=new Coords(Const.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),isPoint1inBoard=Math.abs(point1.usrCoords[0])>=Mat.eps&&point1.scrCoords[1]>=0&&point1.scrCoords[1]<=this.board.canvasWidth&&point1.scrCoords[2]>=0&&point1.scrCoords[2]<=this.board.canvasHeight,isPoint2inBoard=Math.abs(point2.usrCoords[0])>=Mat.eps&&point2.scrCoords[1]>=0&&point2.scrCoords[1]<=this.board.canvasWidth&&point2.scrCoords[2]>=0&&point2.scrCoords[2]<=this.board.canvasHeight,Type.exists(type)||"tickdistance"===type?Geometry.calcStraight(this.line,point1,point2,Type.evaluate(this.line.visProp.margin)):Geometry.calcLineDelimitingPoints(this.line,point1,point2),fA=Type.evaluate(this.line.visProp.firstarrow),lA=Type.evaluate(this.line.visProp.lastarrow),(fA||lA)&&(this.board.renderer.getPositionArrowHead(this.line,point1,point2,Type.evaluate(this.line.visProp.strokewidth)),fA&&point1.setCoordinates(Const.COORDS_BY_SCREEN,[point1.scrCoords[1],point1.scrCoords[2]]),lA&&point2.setCoordinates(Const.COORDS_BY_SCREEN,[point2.scrCoords[1],point2.scrCoords[2]])),(dZeroPoint1=this.getDistanceFromZero(coordsZero,point1))<(dZeroPoint2=this.getDistanceFromZero(coordsZero,point2))?(lowerBound=dZeroPoint1,ev_sf||!isPoint1inBoard||ev_i||(lowerBound+=Mat.eps),upperBound=dZeroPoint2,ev_sl||!isPoint2inBoard||ev_i||(upperBound-=Mat.eps)):dZeroPoint2<dZeroPoint1?(lowerBound=dZeroPoint2,ev_sl||!isPoint2inBoard||ev_i||(lowerBound+=Mat.eps),upperBound=dZeroPoint1,ev_sf||!isPoint1inBoard||ev_i||(upperBound-=Mat.eps)):(lowerBound=0,upperBound=0),{lower:lowerBound,upper:upperBound})},getDistanceFromZero:function(zero,point){var p1,p2,dirLine,dirPoint,distance;return p1=this.line.point1.coords,p2=this.line.point2.coords,distance=zero.distance(Const.COORDS_BY_USER,point),dirLine=[p2.usrCoords[0]-p1.usrCoords[0],p2.usrCoords[1]-p1.usrCoords[1],p2.usrCoords[2]-p1.usrCoords[2]],dirPoint=[point.usrCoords[0]-zero.usrCoords[0],point.usrCoords[1]-zero.usrCoords[1],point.usrCoords[2]-zero.usrCoords[2]],Mat.innerProduct(dirLine,dirPoint,3)<0&&(distance*=-1),distance},generateEquidistantTicks:function(coordsZero,bounds){var tickPosition,deltas,eps2=Mat.eps,ticksDelta=this.equidistant?this.ticksFunction(1):this.ticksDelta,ev_it=Type.evaluate(this.visProp.insertticks),ev_mt=Type.evaluate(this.visProp.minorticks);if(this.line.elementClass===Const.OBJECT_CLASS_LINE&&(deltas=this.getXandYdeltas()),ticksDelta*=Type.evaluate(this.visProp.scale),ev_it&&this.minTicksDistance>Mat.eps?(ticksDelta=this.adjustTickDistance(ticksDelta,coordsZero,deltas),ticksDelta/=ev_mt+1):ev_it||(ticksDelta/=ev_mt+1),this.ticksDelta=ticksDelta,!(ticksDelta<Mat.eps)){for(tickPosition=0,Type.evaluate(this.visProp.drawzero)||(tickPosition=ticksDelta);tickPosition<=bounds.upper+eps2&&(tickPosition>=bounds.lower-eps2&&this.processTickPosition(coordsZero,tickPosition,ticksDelta,deltas),tickPosition+=ticksDelta,!(bounds.upper-tickPosition>1e4*ticksDelta)););for(tickPosition=-ticksDelta;tickPosition>=bounds.lower-eps2&&(tickPosition<=bounds.upper+eps2&&this.processTickPosition(coordsZero,tickPosition,ticksDelta,deltas),!((tickPosition-=ticksDelta)-bounds.lower>1e4*ticksDelta)););}},adjustTickDistance:function(ticksDelta,coordsZero,deltas){var nx,ny,distScr,sgn=1,ev_minti=Type.evaluate(this.visProp.minorticks);if(this.line.elementClass===Const.OBJECT_CLASS_CURVE)return ticksDelta;if(this.getLowerAndUpperBounds(coordsZero,"ticksdistance"),nx=coordsZero.usrCoords[1]+deltas.x*ticksDelta,ny=coordsZero.usrCoords[2]+deltas.y*ticksDelta,distScr=coordsZero.distance(Const.COORDS_BY_SCREEN,new Coords(Const.COORDS_BY_USER,[nx,ny],this.board)),0===ticksDelta)return 0;for(;distScr/(ev_minti+1)<this.minTicksDistance;)ticksDelta*=1===sgn?2:5,sgn*=-1,nx=coordsZero.usrCoords[1]+deltas.x*ticksDelta,ny=coordsZero.usrCoords[2]+deltas.y*ticksDelta,distScr=coordsZero.distance(Const.COORDS_BY_SCREEN,new Coords(Const.COORDS_BY_USER,[nx,ny],this.board));return ticksDelta},processTickPosition:function(coordsZero,tickPosition,ticksDelta,deltas){var x,y,tickCoords,ti,labelVal=null;this.line.elementClass===Const.OBJECT_CLASS_LINE?(x=coordsZero.usrCoords[1]+tickPosition*deltas.x,y=coordsZero.usrCoords[2]+tickPosition*deltas.y):(x=this.line.X(coordsZero+tickPosition),y=this.line.Y(coordsZero+tickPosition)),tickCoords=new Coords(Const.COORDS_BY_USER,[x,y],this.board),this.line.elementClass===Const.OBJECT_CLASS_CURVE&&(labelVal=coordsZero+tickPosition,this.setTicksSizeVariables(labelVal)),tickCoords.major=Math.round(tickPosition/ticksDelta)%(Type.evaluate(this.visProp.minorticks)+1)==0,3===(ti=this.createTickPath(tickCoords,tickCoords.major)).length&&(this.ticks.push(ti),tickCoords.major&&Type.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(tickCoords,coordsZero,labelVal),tickCoords,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(coordsZero,bounds){var tickCoords,labelText,i,ti,x,y,fixedTick,deltas,eps2=Mat.eps,hasLabelOverrides=Type.isArray(this.visProp.labels),ev_dl=Type.evaluate(this.visProp.drawlabels);for(this.line.elementClass===Const.OBJECT_CLASS_LINE&&(deltas=this.getXandYdeltas()),i=0;i<this.fixedTicks.length;i++)this.line.elementClass===Const.OBJECT_CLASS_LINE?(fixedTick=this.fixedTicks[i],x=coordsZero.usrCoords[1]+fixedTick*deltas.x,y=coordsZero.usrCoords[2]+fixedTick*deltas.y):(fixedTick=coordsZero+this.fixedTicks[i],x=this.line.X(fixedTick),y=this.line.Y(fixedTick)),tickCoords=new Coords(Const.COORDS_BY_USER,[x,y],this.board),this.line.elementClass===Const.OBJECT_CLASS_CURVE&&this.setTicksSizeVariables(fixedTick),3===(ti=this.createTickPath(tickCoords,!0)).length&&fixedTick>=bounds.lower-eps2&&fixedTick<=bounds.upper+eps2&&(this.ticks.push(ti),ev_dl&&(hasLabelOverrides||Type.exists(this.visProp.labels[i]))?(labelText=hasLabelOverrides?Type.evaluate(this.visProp.labels[i]):fixedTick,this.labelsData.push(this.generateLabelData(this.generateLabelText(tickCoords,coordsZero,labelText),tickCoords,i))):this.labelsData.push(null))},getXandYdeltas:function(){var point1UsrCoords,point2UsrCoords,distP1P2=this.line.point1.Dist(this.line.point2);return this.line.type===Const.OBJECT_TYPE_AXIS?(point1UsrCoords=this.line.point1.coords.usrCoords,point2UsrCoords=this.line.point2.coords.usrCoords,(point1UsrCoords[1]>point2UsrCoords[1]||Math.abs(point1UsrCoords[1]-point2UsrCoords[1])<Mat.eps&&point1UsrCoords[2]>point2UsrCoords[2])&&(point1UsrCoords=this.line.point2.coords.usrCoords,point2UsrCoords=this.line.point1.coords.usrCoords)):(point1UsrCoords=this.line.point1.coords.usrCoords,point2UsrCoords=this.line.point2.coords.usrCoords),{x:(point2UsrCoords[1]-point1UsrCoords[1])/distP1P2,y:(point2UsrCoords[2]-point1UsrCoords[2])/distP1P2}},_isInsideCanvas:function(x,y,m){var cw=this.board.canvasWidth,ch=this.board.canvasHeight;return void 0===m&&(m=0),x[0]>=m&&x[0]<=cw-m&&y[0]>=m&&y[0]<=ch-m||x[1]>=m&&x[1]<=cw-m&&y[1]>=m&&y[1]<=ch-m},createTickPath:function(coords,major){var c,lineStdForm,intersection,dxs,dys,dxr,dyr,alpha,style,i,r,bb,full,delta,x=[-2e6,-2e6],y=[-2e6,-2e6];if(c=coords.scrCoords,major?(dxs=this.dxMaj,dys=this.dyMaj,style=this.majStyle):(dxs=this.dxMin,dys=this.dyMin,style=this.minStyle),lineStdForm=[-dys*c[1]-dxs*c[2],dys,dxs],major&&"polar"===Type.evaluate(this.visProp.type)){if(bb=this.board.getBoundingBox(),delta=(full=2*Math.PI)/180,c=coords.usrCoords,(r=Math.sqrt(c[1]*c[1]+c[2]*c[2]))<Math.max(Math.sqrt(bb[0]*bb[0]+bb[1]*bb[1]),Math.sqrt(bb[2]*bb[2]+bb[3]*bb[3]))){for(x=[],y=[],i=0;i<=full;i+=delta)x.push(this.board.origin.scrCoords[1]+r*Math.cos(i)*this.board.unitX),y.push(this.board.origin.scrCoords[2]+r*Math.sin(i)*this.board.unitY);return[x,y,major]}}else if("infinite"===style?(intersection=Geometry.meetLineBoard(lineStdForm,this.board),x[0]=intersection[0].scrCoords[1],x[1]=intersection[1].scrCoords[1],y[0]=intersection[0].scrCoords[2],y[1]=intersection[1].scrCoords[2]):(alpha=">"===Type.evaluate(this.visProp.face)?Math.PI/4:"<"===Type.evaluate(this.visProp.face)?-Math.PI/4:0,dxr=Math.cos(alpha)*dxs-Math.sin(alpha)*dys,dyr=Math.sin(alpha)*dxs+Math.cos(alpha)*dys,x[0]=c[1]+dxr*Type.evaluate(this.visProp.tickendings[0]),y[0]=c[2]-dyr*Type.evaluate(this.visProp.tickendings[0]),x[1]=c[1],y[1]=c[2],alpha=-alpha,dxr=Math.cos(alpha)*dxs-Math.sin(alpha)*dys,dyr=Math.sin(alpha)*dxs+Math.cos(alpha)*dys,x[2]=c[1]-dxr*Type.evaluate(this.visProp.tickendings[1]),y[2]=c[2]+dyr*Type.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(x,y))return[x,y,major];return[]},formatLabelText:function(value){var labelText,digits,ev_s=Type.evaluate(this.visProp.scalesymbol);return Type.isNumber(value)?(((labelText=(Math.round(1e13*value)/1e13).toString()).length>Type.evaluate(this.visProp.maxlabellength)||-1!==labelText.indexOf("e"))&&(digits=Type.evaluate(this.visProp.digits),3!==Type.evaluate(this.visProp.precision)&&3===digits&&(digits=Type.evaluate(this.visProp.precision)),labelText=value.toExponential(digits).toString()),Type.evaluate(this.visProp.beautifulscientificticklabels)&&(labelText=this.beautifyScientificNotationLabel(labelText)),labelText.indexOf(".")>-1&&-1===labelText.indexOf("e")&&(labelText=(labelText=labelText.replace(/0+$/,"")).replace(/\.$/,""))):labelText=value.toString(),ev_s.length>0&&("1"===labelText?labelText=ev_s:"-1"===labelText?labelText="-"+ev_s:"0"!==labelText&&(labelText+=ev_s)),Type.evaluate(this.visProp.useunicodeminus)&&(labelText=labelText.replace(/-/g,"−")),labelText},beautifyScientificNotationLabel:function(labelText){return-1===labelText.indexOf("e")?labelText:(parseFloat(labelText.substring(0,labelText.indexOf("e")))+labelText.substring(labelText.indexOf("e"))).replace(/e(.*)$/g,(function(match,$1){var temp="•10";return temp+=$1.replace(/-/g,"⁻").replace(/\+/g,"").replace(/0/g,"⁰").replace(/1/g,"¹").replace(/2/g,"²").replace(/3/g,"³").replace(/4/g,"⁴").replace(/5/g,"⁵").replace(/6/g,"⁶").replace(/7/g,"⁷").replace(/8/g,"⁸").replace(/9/g,"⁹")}))},generateLabelText:function(tick,zero,value){var distance;if(!Type.exists(value)){if(distance=this.getDistanceFromZero(zero,tick),Math.abs(distance)<Mat.eps)return"0";value=distance/Type.evaluate(this.visProp.scale)}return this.formatLabelText(value)},generateLabelData:function(labelText,tick,tickNumber){var xa,ya,m,fs;return fs=Type.evaluate(this.visProp.label.fontsize),xa=[tick.scrCoords[1],tick.scrCoords[1]],ya=[tick.scrCoords[2],tick.scrCoords[2]],m=void 0===fs?12:fs,m*=.5,this._isInsideCanvas(xa,ya,m)?(xa=Type.evaluate(this.visProp.label.offset[0]),ya=Type.evaluate(this.visProp.label.offset[1]),{x:tick.usrCoords[1]+xa/this.board.unitX,y:tick.usrCoords[2]+ya/this.board.unitY,t:labelText,i:tickNumber}):null},update:function(){return this.needsUpdate&&0!==this.board.canvasWidth&&0!==this.board.canvasHeight&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var i,j,lenData,lenLabels,attr,label,ld,visible;for(lenData=this.labelsData.length,lenLabels=this.labels.length,i=0,j=0;i<lenData;i++)null!==this.labelsData[i]&&(ld=this.labelsData[i],j<lenLabels?((label=this.labels[j]).setText(ld.t),label.setCoords(ld.x,ld.y),j++):(this.labelCounter+=1,attr={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},(attr=Type.deepCopy(attr,this.visProp.label)).id=this.id+ld.i+"Label"+this.labelCounter,label=Text.createText(this.board,[ld.x,ld.y,ld.t],attr),this.addChild(label),label.setParents(this),label.isDraggable=!1,label.dump=!1,this.labels.push(label)),"inherit"===(visible=Type.evaluate(this.visProp.label.visible))&&(visible=this.visPropCalc.visible),label.prepareUpdate().updateVisibility(visible).updateRenderer(),label.distanceX=Type.evaluate(this.visProp.label.offset[0]),label.distanceY=Type.evaluate(this.visProp.label.offset[1]));for(j=lenData=j;j<lenLabels;j++)this.board.renderer.display(this.labels[j],!1),this.labels[j].visProp.visible=this.labels[j].visPropCalc.visible=!1;return this},hideElement:function(){var i;for(JXG.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),i=0;i<this.labels.length;i++)Type.exists(this.labels[i])&&this.labels[i].hideElement();return this},showElement:function(){var i;for(JXG.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),i=0;i<this.labels.length;i++)Type.exists(this.labels[i])&&this.labels[i].showElement();return this}}),JXG.createTicks=function(board,parents,attributes){var el,dist,attr=Type.copyAttributes(attributes,board.options,"ticks");if(dist=parents.length<2?attr.ticksdistance:parents[1],parents[0].elementClass!==Const.OBJECT_CLASS_LINE&&parents[0].elementClass!==Const.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+_typeof(parents[0])+"'.");return el=new JXG.Ticks(parents[0],dist,attr),Type.isFunction(attr.generatelabelvalue)&&(el.generateLabelText=attr.generatelabelvalue),Type.isFunction(attr.generatelabeltext)&&(el.generateLabelText=attr.generatelabeltext),el.setParents(parents[0]),el.isDraggable=!0,el.fullUpdate(parents[0].visPropCalc.visible),el},JXG.createHatchmark=function(board,parents,attributes){var num,i,base,width,el,pos=[],attr=Type.copyAttributes(attributes,board.options,"hatch");if(parents[0].elementClass!==Const.OBJECT_CLASS_LINE&&parents[0].elementClass!==Const.OBJECT_CLASS_CURVE||"number"!=typeof parents[1])throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+" and ''"+_typeof(parents[2])+"'.");for(base=.5*-(((num=parents[1])-1)*(width=attr.ticksdistance)),i=0;i<num;i++)pos[i]=base+i*width;return(el=board.create("ticks",[parents[0],pos],attr)).elType="hatch",el},JXG.registerElement("ticks",JXG.createTicks),JXG.registerElement("hash",JXG.createHatchmark),JXG.registerElement("hatch",JXG.createHatchmark),{Ticks:JXG.Ticks,createTicks:JXG.createTicks,createHashmark:JXG.createHatchmark,createHatchmark:JXG.createHatchmark}})),define("parser/ca",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/env"],(function(JXG,Const,Text,Mat,Geometry,Statistics,Type,Env){return JXG.CA=function(node,createNode,parser){this.node=node,this.createNode=createNode,this.parser=parser},JXG.extend(JXG.CA.prototype,{findMapNode:function(mapname,node){var i,len,ret;if("op_assign"===node.value&&node.children[0].value===mapname)return node.children[1];if(node.children)for(len=node.children.length,i=0;i<len;++i)if(null!==(ret=this.findMapNode(mapname,node.children[i])))return ret;return null},setMath:function(node){var i,len;if(("node_op"!=node.type||"op_add"!=node.value&&"op_sub"!=node.value&&"op_mul"!=node.value&&"op_div"!=node.value&&"op_neg"!=node.value&&"op_execfun"!=node.value&&"op_exp"!=node.value)&&"node_var"!=node.type&&"node_const"!=node.type||(node.isMath=!0),node.children)for(len=node.children.length,i=0;i<len;++i)this.setMath(node.children[i])},deriveElementary:function(node,varname){var newNode,fun=node.children[0].value,arg=node.children[1];switch(fun){case"abs":newNode=this.createNode("node_op","op_div",arg[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0]))]));break;case"sqrt":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(node.type,node.value,Type.deepCopy(node.children[0]),Type.deepCopy(node.children[1]))));break;case"sin":newNode=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),Type.deepCopy(arg));break;case"cos":newNode=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),Type.deepCopy(arg)));break;case"tan":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),Type.deepCopy(arg)),this.createNode("node_const",2)));break;case"cot":newNode=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),Type.deepCopy(arg)),this.createNode("node_const",2))));break;case"exp":newNode=this.createNode(node.type,node.value,Type.deepCopy(node.children[0]),Type.deepCopy(node.children[1]));break;case"pow":newNode=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",Type.deepCopy(node.children[0]),Type.deepCopy(node.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(node.children[1][0],varname),this.createNode("node_op","op_div",Type.deepCopy(node.children[1][1]),Type.deepCopy(node.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(node.children[1][1],varname),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[Type.deepCopy(node.children[1][0])]))));break;case"log":case"ln":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),Type.deepCopy(arg[0]));break;case"log2":case"lb":case"ld":newNode=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),Type.deepCopy(arg[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":newNode=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),Type.deepCopy(arg[0])),this.createNode("node_const",.43429448190325176));break;case"asin":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0])))]));break;case"acos":newNode=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0])))])));break;case"atan":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0]))));break;case"acot":newNode=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0])))));break;case"sinh":newNode=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[Type.deepCopy(arg[0])]);break;case"cosh":newNode=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[Type.deepCopy(arg[0])]);break;case"tanh":newNode=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[Type.deepCopy(arg[0])]),this.createNode("node_const",2)));break;case"asinh":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0])),this.createNode("node_const",1))]));break;case"acosh":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0])),this.createNode("node_const",1))]));break;case"atanh":newNode=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",Type.deepCopy(arg[0]),Type.deepCopy(arg[0]))));break;default:throw newNode=this.createNode("node_const",0),console.log('Derivative of "'+fun+'" not yet implemented'),new Error("Error("+this.line+"): ")}return newNode},derivative:function(node,varname){var newNode;switch(node.type){case"node_op":switch(node.value){case"op_execfun":newNode="pow"==node.children[0].value?this.deriveElementary(node,varname):0===node.children[1].length?this.createNode("node_const",0):this.createNode("node_op","op_mul",this.deriveElementary(node,varname),this.derivative(node.children[1][0],varname));break;case"op_div":newNode=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(node.children[0],varname),Type.deepCopy(node.children[1])),this.createNode("node_op","op_mul",Type.deepCopy(node.children[0]),this.derivative(node.children[1],varname))),this.createNode("node_op","op_mul",Type.deepCopy(node.children[1]),Type.deepCopy(node.children[1])));break;case"op_mul":newNode=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",Type.deepCopy(node.children[0]),this.derivative(node.children[1],varname)),this.createNode("node_op","op_mul",this.derivative(node.children[0],varname),Type.deepCopy(node.children[1])));break;case"op_neg":newNode=this.createNode("node_op","op_neg",this.derivative(node.children[0],varname));break;case"op_add":case"op_sub":newNode=this.createNode("node_op",node.value,this.derivative(node.children[0],varname),this.derivative(node.children[1],varname));break;case"op_exp":newNode=this.createNode("node_op","op_mul",Type.deepCopy(node),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(node.children[0],varname),this.createNode("node_op","op_div",Type.deepCopy(node.children[1]),Type.deepCopy(node.children[0]))),this.createNode("node_op","op_mul",this.derivative(node.children[1],varname),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[Type.deepCopy(node.children[0])]))))}break;case"node_var":newNode=node.value===varname?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":newNode=this.createNode("node_const",0)}return newNode},expandDerivatives:function(node,parent,ast){var len,i,j,mapNode,codeNode,node2,newNode,mapName,varname,vArray,order;if(0,!node)return 0;for(this.line=node.line,this.col=node.col,len=node.children.length,i=0;i<len;++i)if(node.children[i]&&node.children[i].type)node.children[i]=this.expandDerivatives(node.children[i],node,ast);else if(Type.isArray(node.children[i]))for(j=0;j<node.children[i].length;++j)node.children[i][j]&&node.children[i][j].type&&(node.children[i][j]=this.expandDerivatives(node.children[i][j],node,ast));if("node_op"===node.type)if("op_execfun"===node.value)if(node.children[0]&&"D"===node.children[0].value){if("node_var"==node.children[1][0].type?(mapName=node.children[1][0].value,vArray=(mapNode=this.findMapNode(mapName,ast)).children[0],varname=node.children[1].length>=2?node.children[1][1].value:mapNode.children[0][0],codeNode=mapNode.children[1]):(codeNode=node.children[1][0],vArray=["x"],varname=node.children[1].length>=2?node.children[1][1].value:"x"),newNode=codeNode,(order=node.children[1].length>=3?node.children[1][2].value:1)>=1)for(;order>=1;)newNode=this.derivative(newNode,varname),newNode=this.removeTrivialNodes(newNode),order--;node2="node_op"==parent.type&&"op_assign"==parent.value?this.createNode("node_op","op_map",vArray,newNode):newNode,this.setMath(node2),node.type=node2.type,node.value=node2.value,node.children[0]=node2.children[0],node.children[1]=node2.children[1]}return node},removeTrivialNodes:function(node){var i,len,n0,n1,swap;if(Type.isArray(node))for(len=node.length,i=0;i<len;++i)node[i]=this.removeTrivialNodes(node[i]);if("node_op"!=node.type||!node.children)return node;for(len=node.children.length,i=0;i<len;++i){this.mayNotBeSimplified=!1;do{node.children[i]=this.removeTrivialNodes(node.children[i])}while(this.mayNotBeSimplified)}switch(node.value){case"op_map":if(n0=node.children[0],"node_var"==(n1=node.children[1]).type)for(i=0;i<n0.length;++i)if(n0[i]==n1.value){n1.isMath=!0;break}break;case"op_add":if(n0=node.children[0],n1=node.children[1],"node_const"==n0.type&&0===n0.value)return n1;if("node_const"==n1.type&&0===n1.value)return n0;if("node_const"==n0.type&&"node_const"==n1.type)return n0.value+=n1.value,n0;break;case"op_mul":if(n0=node.children[0],n1=node.children[1],"node_const"==n0.type&&1==n0.value)return n1;if("node_const"==n1.type&&1==n1.value)return n0;if("node_const"==n0.type&&0===n0.value)return n0;if("node_const"==n1.type&&0===n1.value)return n1;if("node_const"==n1.type&&0===n1.value)return n1;if("node_op"==n0.type&&"op_neg"==n0.value&&"node_op"==n1.type&&"op_neg"==n1.value)return node.children=[n0.children[0],n1.children[0]],this.mayNotBeSimplified=!0,node;if("op_neg"==n0.value&&"op_neg"!=n1.value)return node.type="node_op",node.value="op_neg",node.children=[this.createNode("node_op","op_mul",n0.children[0],n1)],this.mayNotBeSimplified=!0,node;if("op_neg"!=n0.value&&"op_neg"==n1.value)return node.type="node_op",node.value="op_neg",node.children=[this.createNode("node_op","op_mul",n0,n1.children[0])],this.mayNotBeSimplified=!0,node;if("op_div"==n0.value&&"node_const"==n0.children[0].type&&1==n0.children[0].value)return node.type="node_op",node.value="op_div",node.children=[n1,n0.children[1]],this.mayNotBeSimplified=!0,node;if("op_div"==n1.value&&"node_const"==n1.children[0].type&&1==n1.children[0].value)return node.type="node_op",node.value="op_div",node.children=[n0,n1.children[1]],this.mayNotBeSimplified=!0,node;if("node_const"!=n0.type&&"node_const"==n1.type)return node.children=[n1,n0],this.mayNotBeSimplified=!0,node;if("node_const"!=n0.type&&"node_op"==n1.type&&"op_neg"==n1.value&&"node_const"==n1.children[0].type)return node.children=[n1,n0],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_execfun"!=n0.value&&("node_var"==n1.type||"node_op"==n1.type&&"op_execfun"==n1.value))return node.children=[n1,n0],this.mayNotBeSimplified=!0,node;if("node_op"!=n0.type&&"node_op"==n1.type&&"op_neg"==n1.value&&"node_var"==n1.children[0].type)return node.children=[n1,n0],this.mayNotBeSimplified=!0,node;if("node_const"!=n0.type&&"node_op"==n1.type&&("op_mul"==n1.value||"op_div"==n1.value)&&"node_const"==n1.children[0].type)return swap=n1.children[0],n1.children[0]=n0,node.children=[swap,n1],this.mayNotBeSimplified=!0,node;if("node_const"!=n1.type&&"node_op"==n0.type&&"op_mul"==n0.value&&"node_const"==n0.children[0].type)return node.children=[n0.children[0],this.createNode("node_op","op_mul",n0.children[1],n1)],this.mayNotBeSimplified=!0,node;if("node_const"==n0.type&&"node_const"==n1.type)return n0.value*=n1.value,n0;if("node_const"==n0.type&&"node_op"==n1.type&&("op_mul"==n1.value||"op_div"==n1.value)&&"node_const"==n1.children[0].type)return n1.children[0].value*=n0.value,n1;if(n0.hash=this.parser.compile(n0),n1.hash=this.parser.compile(n1),n0.hash===n1.hash)return node.value="op_exp",node.children[1]=this.createNode("node_const",2),node;if("node_const"==n0.type&&"node_op"==n1.type&&("op_mul"==n1.value||"op_div"==n1.value)&&"node_const"==n1.children[0].type)return n1.children[0].value*=n0.value,n1;if("node_op"==n1.type&&"op_exp"==n1.value&&(n0.hash||(n0.hash=this.parser.compile(n0)),n1.children[0].hash||(n1.children[0].hash=this.parser.compile(n1.children[0])),n0.hash===n1.children[0].hash))return n1.children[1]=this.createNode("node_op","op_add",n1.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,n1;if("node_op"==n0.type&&"op_exp"==n0.value&&"node_op"==n1.type&&"op_exp"==n1.value&&(n0.children[0].hash=this.parser.compile(n0.children[0]),n1.children[0].hash=this.parser.compile(n1.children[0]),n0.children[0].hash===n1.children[0].hash))return n0.children[1]=this.createNode("node_op","op_add",n0.children[1],n1.children[1]),this.mayNotBeSimplified=!0,n0;break;case"op_sub":if(n0=node.children[0],n1=node.children[1],"node_const"==n0.type&&0===n0.value)return node.value="op_neg",node.children[0]=n1,node;if("node_const"==n1.type&&0===n1.value)return n0;if("node_const"==n0.type&&"node_const"==n1.type&&n0.value==n1.value)return this.createNode("node_const",0);if("node_var"==n0.type&&"node_var"==n1.type&&n0.value==n1.value)return this.createNode("node_const",0);if("node_const"==n0.type&&"node_const"==n1.type)return n0.value-=n1.value,n0;if("node_op"==n0.type&&"op_mul"==n0.value&&"node_op"==n1.type&&"op_mul"==n1.value&&(n0.children[1].hash=this.parser.compile(n0.children[1]),n1.children[1].hash=this.parser.compile(n1.children[1]),n0.children[1].hash===n1.children[1].hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_sub",n0.children[0],n1.children[0]),n0.children[1]],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_mul"==n0.value&&(n0.children[1].hash=this.parser.compile(n0.children[1]),n1.hash=this.parser.compile(n1),n0.children[1].hash===n1.hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_sub",n0.children[0],this.createNode("node_const",1)),n1],this.mayNotBeSimplified=!0,node;if("node_op"==n1.type&&"op_mul"==n1.value&&(n1.children[1].hash=this.parser.compile(n1.children[1]),n0.hash=this.parser.compile(n0),n1.children[1].hash===n0.hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),n1.children[0]),n0],this.mayNotBeSimplified=!0,node;break;case"op_neg":if("node_const"==(n0=node.children[0]).type&&0===n0.value)return n0;if("node_op"==n0.type&&"op_neg"==n0.value)return n0.children[0];break;case"op_div":if(n0=node.children[0],n1=node.children[1],"node_const"==n0.type&&"node_const"==n1.type&&n0.value==n1.value&&0!==n0.value)return n0.value=1,n0;if("node_const"==n0.type&&0===n0.value&&"node_const"==n1.type&&0!==n1.value)return n0.value=0,n0;if("node_const"==n0.type&&0===n0.value&&("node_op"==n1.type||"node_var"==n1.type))return node.type="node_const",node.value=0,node;if("node_var"==n0.type&&"node_var"==n1.type&&n0.value==n1.value)return this.createNode("node_const",1);if("node_const"==n0.type&&0!==n0.value&&"node_const"==n1.type&&0===n1.value)return n0.value>0?n0.value=1/0:n0.value=-1/0,n0;if("node_op"==n0.type&&"op_neg"==n0.value&&"node_op"==n1.type&&"op_neg"==n1.value)return node.children=[n0.children[0],n1.children[0]],this.mayNotBeSimplified=!0,node;if("op_neg"==n0.value&&"op_neg"!=n1.value)return node.type="node_op",node.value="op_neg",node.children=[this.createNode("node_op","op_div",n0.children[0],n1)],this.mayNotBeSimplified=!0,node;if("op_neg"!=n0.value&&"op_neg"==n1.value)return node.type="node_op",node.value="op_neg",node.children=[this.createNode("node_op","op_div",n0,n1.children[0])],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_exp"==n0.value&&(n1.hash||(n1.hash=this.parser.compile(n1)),n0.children[0].hash||(n0.children[0].hash=this.parser.compile(n0.children[0])),n1.hash===n0.children[0].hash))return n0.children[1]=this.createNode("node_op","op_sub",n0.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,n0;if("node_const"!=n1.type&&"node_op"==n0.type&&"op_mul"==n0.value&&"node_const"==n0.children[0].type)return node.value="op_mul",node.children=[n0.children[0],this.createNode("node_op","op_div",n0.children[1],n1)],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_exp"==n0.value&&"node_op"==n1.type&&"op_exp"==n1.value&&(n0.children[0].hash=this.parser.compile(n0.children[0]),n1.children[0].hash=this.parser.compile(n1.children[0]),n0.children[0].hash===n1.children[0].hash))return n0.children[1]=this.createNode("node_op","op_sub",n0.children[1],n1.children[1]),this.mayNotBeSimplified=!0,n0;break;case"op_exp":if(n0=node.children[0],"node_const"==(n1=node.children[1]).type&&0===n1.value)return n1.value=1,n1;if("node_const"==n1.type&&1==n1.value)return n0;if("node_const"==n0.type&&1==n0.value)return n0;if("node_const"==n0.type&&0===n0.value&&"node_const"==n1.type&&0!==n1.value)return n0;if("node_op"==n0.type&&"op_exp"==n0.value)return node.children=[n0.children[0],this.createNode("node_op","op_mul",n0.children[1],n1)],node}switch(node.value){case"op_add":if(n0=node.children[0],n1=node.children[1],"node_const"==n0.type&&"node_const"==n1.type&&n0.value==n1.value)return n0.value+=n1.value,n0;if("node_var"==n0.type&&"node_var"==n1.type&&n0.value==n1.value)return node.children[0]=this.createNode("node_const",2),node.value="op_mul",node;if("node_op"==n0.type&&"op_neg"==n0.value)return node.value="op_sub",node.children[0]=n1,node.children[1]=n0.children[0],this.mayNotBeSimplified=!0,node;if("node_op"==n1.type&&"op_neg"==n1.value)return node.value="op_sub",node.children[1]=n1.children[0],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_mul"==n0.value&&"node_op"==n1.type&&"op_mul"==n1.value&&(n0.children[1].hash=this.parser.compile(n0.children[1]),n1.children[1].hash=this.parser.compile(n1.children[1]),n0.children[1].hash===n1.children[1].hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_add",n0.children[0],n1.children[0]),n0.children[1]],this.mayNotBeSimplified=!0,node;if("node_op"==n0.type&&"op_mul"==n0.value&&(n0.children[1].hash=this.parser.compile(n0.children[1]),n1.hash=this.parser.compile(n1),n0.children[1].hash===n1.hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_add",n0.children[0],this.createNode("node_const",1)),n1],this.mayNotBeSimplified=!0,node;if("node_op"==n1.type&&"op_mul"==n1.value&&(n1.children[1].hash=this.parser.compile(n1.children[1]),n0.hash=this.parser.compile(n0),n1.children[1].hash===n0.hash))return node.value="op_mul",node.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),n1.children[0]),n0],this.mayNotBeSimplified=!0,node;break;case"op_sub":if(n0=node.children[0],"node_op"==(n1=node.children[1]).type&&"op_neg"==n1.value)return node.value="op_add",node.children[1]=n1.children[0],this.mayNotBeSimplified=!0,node;break;case"op_execfun":return this.simplifyElementary(node)}return node},simplifyElementary:function(node){var fun=node.children[0].value,arg=node.children[1];if(0==arg.length)return node;switch(fun){case"sin":case"tan":if("node_const"==arg[0].type&&0===arg[0].value)return node.type="node_const",node.value=0,node;if("node_var"==arg[0].type&&"PI"==arg[0].value)return node.type="node_const",node.value=0,node;if("node_op"==arg[0].type&&"op_mul"==arg[0].value&&"node_const"==arg[0].children[0].type&&arg[0].children[0].value%1==0&&"node_var"==arg[0].children[1].type&&"PI"==arg[0].children[1].value)return node.type="node_const",node.value=0,node;break;case"cos":if("node_const"==arg[0].type&&0===arg[0].value)return node.type="node_const",node.value=1,node;if("node_var"==arg[0].type&&"PI"==arg[0].value)return node.type="node_op",node.value="op_neg",node.children=[this.createNode("node_const",1)],node;break;case"exp":if("node_const"==arg[0].type&&0===arg[0].value)return node.type="node_const",node.value=1,node;break;case"pow":if("node_const"==arg[1].type&&0===arg[1].value)return node.type="node_const",node.value=1,node}return node}}),JXG.CA})),define("utils/dump",["jxg","utils/type"],(function(JXG,Type){return JXG.Dump={addMarkers:function(board,markers,values){var e,l,i;for(e in Type.isArray(markers)||(markers=[markers]),Type.isArray(values)||(values=[values]),l=Math.min(markers.length,values.length),markers.length=l,values.length=l,board.objects)if(board.objects.hasOwnProperty(e))for(i=0;i<l;i++)board.objects[e][markers[i]]=values[i]},deleteMarkers:function(board,markers){var e,l,i;for(e in Type.isArray(markers)||(markers=[markers]),l=markers.length,markers.length=l,board.objects)if(board.objects.hasOwnProperty(e))for(i=0;i<l;i++)delete board.objects[e][markers[i]]},str:function(s){return"string"==typeof s&&"function"!==s.substr(0,7)&&(s='"'+s+'"'),s},minimizeObject:function(instance,s){var p,pl,i,def={},copy=Type.deepCopy(instance),defaults=[];for(i=1;i<arguments.length;i++)defaults.push(arguments[i]);for(def=Type.deepCopy(def,JXG.Options.elements,!0),i=defaults.length;i>0;i--)def=Type.deepCopy(def,defaults[i-1],!0);for(p in def)def.hasOwnProperty(p)&&(pl=p.toLowerCase(),"object"!==_typeof(def[p])&&def[p]===copy[pl]&&delete copy[pl]);return copy},prepareAttributes:function(board,obj){var a,s;for(s in a=this.minimizeObject(obj.getAttributes(),JXG.Options[obj.elType]),obj.subs)obj.subs.hasOwnProperty(s)&&(a[s]=this.minimizeObject(obj.subs[s].getAttributes(),JXG.Options[obj.elType][s],JXG.Options[obj.subs[s].elType]),a[s].id=obj.subs[s].id,a[s].name=obj.subs[s].name);return a.id=obj.id,a.name=obj.name,a},setBoundingBox:function(methods,board,boardVarName){return methods.push({obj:boardVarName,method:"setBoundingBox",params:[board.getBoundingBox(),board.keepaspectratio]}),methods},dump:function(board){var e,obj,element,s,props=[],elementList=[],len=board.objectsList.length;for(this.addMarkers(board,"dumped",!1),e=0;e<len;e++)if(element={},!(obj=board.objectsList[e]).dumped&&obj.dump){for(element.type=obj.getType(),element.parents=obj.getParents().slice(),"point"===element.type&&1===element.parents[0]&&(element.parents=element.parents.slice(1)),s=0;s<element.parents.length;s++)Type.isString(element.parents[s])&&"'"!==element.parents[s][0]&&'"'!==element.parents[s][0]?element.parents[s]='"'+element.parents[s]+'"':Type.isArray(element.parents[s])&&(element.parents[s]="["+element.parents[s].toString()+"]");element.attributes=this.prepareAttributes(board,obj),"glider"===element.type&&obj.onPolygon&&props.push({obj:obj.id,prop:"onPolygon",val:!0}),elementList.push(element)}return this.deleteMarkers(board,"dumped"),{elements:elementList,props:props,methods:[]}},arrayToParamStr:function(a,converter){var i,s=[];for(i=0;i<a.length;i++)s.push(converter.call(this,a[i]));return s.join(", ")},toJCAN:function(obj){var i,list,prop;switch(_typeof(obj)){case"object":if(obj){if(list=[],Type.isArray(obj)){for(i=0;i<obj.length;i++)list.push(this.toJCAN(obj[i]));return"["+list.join(",")+"]"}for(prop in obj)obj.hasOwnProperty(prop)&&list.push(prop+": "+this.toJCAN(obj[prop]));return"<<"+list.join(", ")+">> "}return"null";case"string":return"'"+obj.replace(/\\/g,"\\\\").replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return obj.toString();case"null":return"null"}},toJessie:function(board){var i,elements,id,dump=this.dump(board),script=[];for(dump.methods=this.setBoundingBox(dump.methods,board,"$board"),elements=dump.elements,i=0;i<elements.length;i++)elements[i].attributes.name.length>0&&script.push("// "+elements[i].attributes.name),script.push("s"+i+" = "+elements[i].type+"("+elements[i].parents.join(", ")+") "+this.toJCAN(elements[i].attributes).replace(/\n/,"\\n")+";"),"axis"===elements[i].type&&(id=elements[i].attributes.id,null===board.objects[id].defaultTicks&&script.push("s"+i+".removeAllTicks();")),script.push("");for(i=0;i<dump.methods.length;i++)script.push(dump.methods[i].obj+"."+dump.methods[i].method+"("+this.arrayToParamStr(dump.methods[i].params,this.toJCAN)+");"),script.push("");for(i=0;i<dump.props.length;i++)script.push(dump.props[i].obj+"."+dump.props[i].prop+" = "+this.toJCAN(dump.props[i].val)+";"),script.push("");return script.join("\n")},toJavaScript:function(board){var i,elements,id,dump=this.dump(board),script=[];for(dump.methods=this.setBoundingBox(dump.methods,board,"board"),elements=dump.elements,i=0;i<elements.length;i++)script.push('board.create("'+elements[i].type+'", ['+elements[i].parents.join(", ")+"], "+Type.toJSON(elements[i].attributes)+");"),"axis"===elements[i].type&&(id=elements[i].attributes.id,null===board.objects[id].defaultTicks&&script.push('board.objects["'+id+'"].removeTicks(board.objects["'+id+'"].defaultTicks);'));for(i=0;i<dump.methods.length;i++)script.push(dump.methods[i].obj+"."+dump.methods[i].method+"("+this.arrayToParamStr(dump.methods[i].params,Type.toJSON)+");"),script.push("");for(i=0;i<dump.props.length;i++)script.push(dump.props[i].obj+"."+dump.props[i].prop+" = "+Type.toJSON(dump.props[i].val)+";"),script.push("");return script.join("\n")}},JXG.Dump})),define("element/comb",["jxg","utils/type","base/point"],(function(JXG,Type,Point){return JXG.createComb=function(board,parents,attributes){var p1,p2,c,attr,parent_types;if(2!==parents.length)throw parent_types=parents.map((function(parent){return"'"+_typeof(parent)+"'"})),new Error("JSXGraph: Can't create comb with parent types "+parent_types.join(", ")+".\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");if(Type.isArray(parents[0])&&parents[0].length>1)attr=Type.copyAttributes(attributes,board.options,"comb","point1"),p1=board.create("point",parents[0],attr);else if(Type.isString(parents[0])||Type.isPoint(parents[0]))p1=board.select(parents[0]);else if(Type.isFunction(parents[0])&&Type.isPoint(parents[0]()))p1=parents[0]();else{if(!(Type.isFunction(parents[0])&&parents[0]().length&&parents[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");attr=Type.copyAttributes(attributes,board.options,"comb","point1"),p1=Point.createPoint(board,parents[0](),attr)}if(Type.isArray(parents[1])&&parents[1].length>1)attr=Type.copyAttributes(attributes,board.options,"comb","point2"),p2=board.create("point",parents[1],attr);else if(Type.isString(parents[1])||Type.isPoint(parents[1]))p2=board.select(parents[1]);else if(Type.isFunction(parents[1])&&Type.isPoint(parents[1]()))p2=parents[1]();else{if(!(Type.isFunction(parents[1])&&parents[1]().length&&parents[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");attr=Type.copyAttributes(attributes,board.options,"comb","point2"),p2=Point.createPoint(board,parents[1](),attr)}return attr=Type.copyAttributes(attributes,board.options,"comb"),Type.merge(attr,Type.copyAttributes(attributes,board.options,"comb","curve")),(c=board.create("curve",[[0],[0]],attr)).updateDataArray=function(){var cs,sn,dx,dy,x,y,f,ds,angle,width,s=0,max_s=p1.Dist(p2),p1_inner=p1,p2_inner=p2;for(ds=Type.evaluate(c.visProp.frequency),angle=-Type.evaluate(c.visProp.angle),width=Type.evaluate(c.visProp.width),Type.evaluate(c.visProp.reverse)&&(p1_inner=p2,p2_inner=p1,angle=-angle),cs=Math.cos(angle),sn=Math.sin(angle),dx=(p2_inner.X()-p1_inner.X())/max_s,dy=(p2_inner.Y()-p1_inner.Y())/max_s,cs*=width/Math.abs(sn),sn*=width/Math.abs(sn),this.dataX=[],this.dataY=[];s<max_s;)x=p1_inner.X()+dx*s,y=p1_inner.Y()+dy*s,sn*=f=Math.min(cs,max_s-s)/Math.abs(cs),cs*=f,this.dataX.push(x),this.dataY.push(y),this.dataX.push(x+dx*cs+dy*sn),this.dataY.push(y-dx*sn+dy*cs),this.dataX.push(NaN),this.dataY.push(NaN),s+=ds},c},JXG.registerElement("comb",JXG.createComb),{createComb:JXG.createComb}})),define("element/slopetriangle",["jxg","utils/type","base/constants","base/polygon"],(function(JXG,Type,Const,Polygon){var priv_removeSlopeTriangle=function(){Polygon.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},priv_Value=function(){return this.tangent.getSlope()};return JXG.createSlopeTriangle=function(board,parents,attributes){var el,tangent,tglide,glider,toppoint,baseline,basepoint,label,attr,isPrivateTangent=!1;if(1===parents.length&&parents[0].type===Const.OBJECT_TYPE_TANGENT)tangent=parents[0],tglide=tangent.glider;else if(1===parents.length&&parents[0].type===Const.OBJECT_TYPE_GLIDER)tglide=parents[0],attr=Type.copyAttributes(attributes,board.options,"slopetriangle","tangent"),tangent=board.create("tangent",[tglide],attr),isPrivateTangent=!0;else{if(2!==parents.length||parents[0].elementClass!==Const.OBJECT_CLASS_LINE||!Type.isPoint(parents[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+_typeof(parents[0])+"'.");tangent=parents[0],tglide=parents[1]}return attr=Type.copyAttributes(attributes,board.options,"slopetriangle","basepoint"),basepoint=board.create("point",[function(){return[tglide.X()+1,tglide.Y()]}],attr),attr=Type.copyAttributes(attributes,board.options,"slopetriangle","baseline"),baseline=board.create("line",[tglide,basepoint],attr),attr=Type.copyAttributes(attributes,board.options,"slopetriangle","glider"),glider=board.create("glider",[tglide.X()+1,tglide.Y(),baseline],attr),attr=Type.copyAttributes(attributes,board.options,"slopetriangle","toppoint"),toppoint=board.create("point",[function(){return[glider.X(),glider.Y()+(glider.X()-tglide.X())*tangent.getSlope()]}],attr),(attr=Type.copyAttributes(attributes,board.options,"slopetriangle")).borders=Type.copyAttributes(attr.borders,board.options,"slopetriangle","borders"),(el=board.create("polygon",[tglide,glider,toppoint],attr)).Value=priv_Value,el.tangent=tangent,el._isPrivateTangent=isPrivateTangent,el.borders[2].setArrow(!1,!1),attr=Type.copyAttributes(attributes,board.options,"slopetriangle","label"),(label=board.create("text",[function(){return glider.X()+.1},function(){return.5*(glider.Y()+toppoint.Y())},function(){return""}],attr))._setText((function(){return Type.toFixed(el.Value(),Type.evaluate(label.visProp.digits))})),label.fullUpdate(),el.glider=glider,el.basepoint=basepoint,el.baseline=baseline,el.toppoint=toppoint,el.label=label,el.subs={glider:glider,basePoint:basepoint,baseLine:baseline,topPoint:toppoint,label:label},el.inherits.push(glider,basepoint,baseline,toppoint,label),el.methodMap=JXG.deepCopy(el.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),el.remove=priv_removeSlopeTriangle,el},JXG.registerElement("slopetriangle",JXG.createSlopeTriangle),{createSlopeTriangle:JXG.createSlopeTriangle}})),define("element/checkbox",["jxg","utils/env","utils/type"],(function(JXG,Env,Type){var priv_CheckboxChangeEventHandler=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};return JXG.createCheckbox=function(board,parents,attributes){var t,par,attr=Type.copyAttributes(attributes,board.options,"checkbox");return par=[parents[0],parents[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],(t=board.create("text",par,attr)).type=Type.OBJECT_TYPE_CHECKBOX,t.rendNodeCheckbox=t.rendNode.childNodes[0].childNodes[0],t.rendNodeLabel=t.rendNode.childNodes[0].childNodes[1],t.rendNodeTag=t.rendNodeCheckbox,t.rendNodeTag.disabled=!!attr.disabled,t.rendNodeLabel.innerHTML=parents[2],t.rendNodeCheckbox.id=t.rendNode.id+"_checkbox",t.rendNodeLabel.id=t.rendNode.id+"_label",t.rendNodeLabel.setAttribute("for",t.rendNodeCheckbox.id),t.visPropOld.fontsize="0px",board.renderer.updateTextStyle(t,!1),t.rendNodeCheckbox.checked=attr.checked,t._value=attr.checked,t.Value=function(){return this._value},t.update=function(){return this.needsUpdate&&(JXG.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},Env.addEvent(t.rendNodeCheckbox,"change",priv_CheckboxChangeEventHandler,t),t},JXG.registerElement("checkbox",JXG.createCheckbox),{createCheckbox:JXG.createCheckbox}})),define("element/input",["jxg","utils/env","utils/type"],(function(JXG,Env,Type){var priv_InputInputEventHandler=function(evt){this._value=this.rendNodeInput.value,this.board.update()};return JXG.createInput=function(board,parents,attributes){var t,par,attr=Type.copyAttributes(attributes,board.options,"input");return par=[parents[0],parents[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+attr.maxlength+'" style="width:100%"/></span>'],(t=board.create("text",par,attr)).type=Type.OBJECT_TYPE_INPUT,t.rendNodeLabel=t.rendNode.childNodes[0].childNodes[0],t.rendNodeInput=t.rendNode.childNodes[0].childNodes[1],t.rendNodeLabel.innerHTML=parents[3],t.rendNodeInput.value=parents[2],t.rendNodeTag=t.rendNodeInput,t.rendNodeTag.disabled=!!attr.disabled,t.rendNodeLabel.id=t.rendNode.id+"_label",t.rendNodeInput.id=t.rendNode.id+"_input",t._value=parents[2],t.update=function(){return this.needsUpdate&&(JXG.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},t.Value=function(){return this._value},t.set=function(val){return this._value=val,this.rendNodeInput.value=val,this},Env.addEvent(t.rendNodeInput,"input",priv_InputInputEventHandler,t),Env.addEvent(t.rendNodeInput,"mousedown",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),Env.addEvent(t.rendNodeInput,"touchstart",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),Env.addEvent(t.rendNodeInput,"pointerdown",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),t.visPropOld.fontsize="0px",board.renderer.updateTextStyle(t,!1),t},JXG.registerElement("input",JXG.createInput),{createInput:JXG.createInput}})),define("element/button",["jxg","utils/env","utils/type"],(function(JXG,Env,Type){var priv_ButtonClickEventHandler=function(){this._handler&&this._handler(),this.board.update()};return JXG.createButton=function(board,parents,attributes){var t,par,attr=Type.copyAttributes(attributes,board.options,"button");return par=[parents[0],parents[1],'<button type="button" style="width:100%;"></button>'],(t=board.create("text",par,attr)).type=Type.OBJECT_TYPE_BUTTON,t.rendNodeButton=t.rendNode.childNodes[0],t.rendNodeButton.id=t.rendNode.id+"_button",t.rendNodeButton.innerHTML=parents[2],t.rendNodeTag=t.rendNodeButton,t.rendNodeTag.disabled=!!attr.disabled,t.visPropOld.fontsize="0px",board.renderer.updateTextStyle(t,!1),parents[3]&&(Type.isString(parents[3])?(t._jc=new JXG.JessieCode,t._jc.use(board),t._handler=function(){t._jc.parse(parents[3])}):t._handler=parents[3]),Env.addEvent(t.rendNodeButton,"click",priv_ButtonClickEventHandler,t),Env.addEvent(t.rendNodeButton,"mousedown",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),Env.addEvent(t.rendNodeButton,"touchstart",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),Env.addEvent(t.rendNodeButton,"pointerdown",(function(evt){Type.exists(evt.stopPropagation)&&evt.stopPropagation()}),t),t},JXG.registerElement("button",JXG.createButton),{createButton:JXG.createButton}})),define("base/foreignobject",["jxg","base/constants","base/coords","base/element","math/math","utils/type","base/coordselement"],(function(JXG,Const,Coords,GeometryElement,Mat,Type,CoordsElement){return JXG.ForeignObject=function(board,coords,attributes,content,size){this.constructor(board,attributes,Const.OBJECT_TYPE_FOREIGNOBJECT,Const.OBJECT_CLASS_OTHER),this.element=this.board.select(attributes.anchor),this.coordsConstructor(coords),this._useUserSize=!1,this.size=[1,1],Type.exists(size)&&size.length>0&&(this._useUserSize=!0,this.W=Type.createFunction(size[0],this.board,""),this.H=Type.createFunction(size[1],this.board,""),this.usrSize=[this.W(),this.H()]),this.content=content,this.elType="foreignobject",this.id=this.board.setId(this,"Im"),this.board.renderer.drawForeignObject(this),this.board.finalizeAdding(this),this.methodMap=JXG.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},JXG.ForeignObject.prototype=new GeometryElement,Type.copyPrototypeMethods(JXG.ForeignObject,CoordsElement,"coordsConstructor"),JXG.extend(JXG.ForeignObject.prototype,{hasPoint:function(x,y){var dx,dy,r,type,prec,c,v,p,dot,len=this.transformations.length;return Type.isObject(Type.evaluate(this.visProp.precision))?(type=this.board._inputDevice,prec=Type.evaluate(this.visProp.precision[type])):prec=this.board.options.precision.hasPoint,0===len?(dx=x-this.coords.scrCoords[1],dy=this.coords.scrCoords[2]-y,dx>=-(r=prec)&&dx-this.size[0]<=r&&dy>=-r&&dy-this.size[1]<=r):(v=[(c=(c=new Coords(Const.COORDS_BY_SCREEN,[x,y],this.board)).usrCoords)[0]-this.span[0][0],c[1]-this.span[0][1],c[2]-this.span[0][2]],0<=(p=(dot=Mat.innerProduct)(v,this.span[1]))&&p<=dot(this.span[1],this.span[1])&&0<=(p=dot(v,this.span[2]))&&p<=dot(this.span[2],this.span[2]))},update:function(fromParent){return this.needsUpdate?(this.updateCoords(fromParent),this.updateSize(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateForeignObject")},updateSize:function(){var bb=[0,0];return this._useUserSize?(this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)]):this.rendNode.hasChildNodes()&&(bb=this.rendNode.childNodes[0].getBoundingClientRect(),this.size=[bb.width,bb.height]),this},updateSpan:function(){var i,j,len=this.transformations.length,v=[];if(0===len)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(v[0]=[this.Z(),this.X(),this.Y()],v[1]=[this.Z(),this.X()+this.W(),this.Y()],v[2]=[this.Z(),this.X(),this.Y()+this.H()],i=0;i<len;i++)for(j=0;j<3;j++)v[j]=Mat.matVecMult(this.transformations[i].matrix,v[j]);for(j=0;j<3;j++)v[j][1]/=v[j][0],v[j][2]/=v[j][0],v[j][0]/=v[j][0];for(j=1;j<3;j++)v[j][0]-=v[0][0],v[j][1]-=v[0][1],v[j][2]-=v[0][2];this.span=v}return this},addTransform:function(transform){var i;if(Type.isArray(transform))for(i=0;i<transform.length;i++)this.transformations.push(transform[i]);else this.transformations.push(transform);return this},getParents:function(){var p=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return 0!==this.parents.length&&(p=this.parents),p},setSize:function(width,height){return this.W=Type.createFunction(width,this.board,""),this.H=Type.createFunction(height,this.board,""),this._useUserSize=!0,this},W:function(){},H:function(){}}),JXG.createForeignObject=function(board,parents,attributes){var attr,fo,content=parents[0],coords=parents[1],size=[];if(parents.length>=2&&(size=parents[2]),attr=Type.copyAttributes(attributes,board.options,"foreignobject"),!(fo=CoordsElement.create(JXG.ForeignObject,board,coords,attr,content,size)))throw new Error("JSXGraph: Can't create foreignObject with parent types '"+_typeof(parents[0])+"' and '"+_typeof(parents[1])+"'.\nPossible parent types: [string, [x, y], [w, h]], [string, [x, y]], [element,transformation]");return fo},JXG.registerElement("foreignobject",JXG.createForeignObject),JXG.registerElement("fo",JXG.createForeignObject),{ForeignObject:JXG.ForeignObject,createForeignobject:JXG.createForeignObject}})),define("options3d",["jxg","options"],(function(JXG,Options){return JXG.extend(Options,{infobox:{strokeColor:"black"},axes3d:{axesPosition:"center",xAxis:{visible:!0,point2:{name:"x"}},yAxis:{visible:!0,point2:{name:"y"}},zAxis:{visible:!0,point2:{name:"z"}},xPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},yPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},zPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},xPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},yPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},zPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},xPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1}},axis3d:{highlight:!1,strokecolor:"black",strokeWidth:1,tabindex:null,point1:{visible:!1,name:""},point2:{visible:!1,name:"",label:{visible:!0}}},mesh3d:{strokeWidth:1,strokeColor:"#9a9a9a",strokeOpacity:.6,highlight:!1,fillColor:"#9a9a9a",fillOpacity:.1,tabindex:null,visible:"inherit"},line3d:{strokeWidth:1,strokeColor:"black",fixed:!0,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",point1:{visible:!1,name:""},point2:{visible:!1,name:""}},plane3d:{strokeWidth:0,strokeColor:"black",strokeOpacity:1,highlight:!1,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",gradientAngle:Math.PI,fillColor:"#a7a7a7",fillOpacity:.6},point3d:{strokeWidth:0,gradient:"radial",gradientSecondColor:"#555555",fillColor:"yellow",highlightStrokeColor:"#555555"},surface3d:{highlight:!1,tabindex:-1,strokeWidth:1,stepsU:30,stepsV:30},view3d:{needsRegularUpdate:!0}}),JXG.Options})),define("3d/threed",["jxg"],(function(JXG){return JXG.ThreeD={},JXG.ThreeD})),define("3d/view3d",["jxg","options","base/constants","utils/type","math/math","base/element","3d/threed"],(function(JXG,Options,Const,Type,Mat,GeometryElement,ThreeD){return ThreeD.View3D=function(board,parents,attributes){var bbox3d,coords,size;this.constructor(board,attributes,Const.OBJECT_TYPE_VIEW3D,Const.OBJECT_CLASS_CURVE),bbox3d=parents[2],coords=parents[0],size=parents[1],this.D3={},this.D3.objects={},this.D3.objectsList=[],this.D3.defaultAxes=null,this.D3.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.D3.bbox3d=bbox3d,this.D3.coords=coords,this.D3.size=size,this.D3.r=-1,this.timeoutAzimuth=null,this.id=this.board.setId(this,"V"),this.board.finalizeAdding(this),this.elType="view3d",this.methodMap=Type.deepCopy(this.methodMap,{})},ThreeD.View3D.prototype=new GeometryElement,JXG.extend(ThreeD.View3D.prototype,{create:function(elementType,parents,attributes){var el,prefix=[];return elementType.indexOf("3d")>0&&(!0,prefix.push(this)),el=this.board.create(elementType,prefix.concat(parents),attributes),this.add(el),el},add:function(el){this.D3.objects[el.id]=el,this.D3.objectsList.push(el)},update:function(){var e,r,a,f,mat,D3=this.D3;return Type.exists(D3.el_slide)&&Type.exists(D3.az_slide)&&this.needsUpdate?(e=D3.el_slide.Value(),r=D3.r,a=D3.az_slide.Value(),f=r*Math.sin(e),mat=[[1,0,0],[0,1,0],[0,0,1]],D3.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],D3.matrix[1][1]=r*Math.cos(a),D3.matrix[1][2]=-r*Math.sin(a),D3.matrix[2][1]=f*Math.sin(a),D3.matrix[2][2]=f*Math.cos(a),D3.matrix[2][3]=Math.cos(e),mat[1][1]=D3.size[0]/(D3.bbox3d[0][1]-D3.bbox3d[0][0]),mat[2][2]=D3.size[1]/(D3.bbox3d[1][1]-D3.bbox3d[1][0]),mat[1][0]=D3.coords[0]-mat[1][1]*D3.bbox3d[0][0],mat[2][0]=D3.coords[1]-mat[2][2]*D3.bbox3d[1][0],D3.matrix=Mat.matMatMult(mat,D3.matrix),this):this},updateRenderer:function(){return this.needsUpdate=!1,this},project3DTo2D:function(x,y,z){var vec;return vec=3===arguments.length?[1,x,y,z]:3===x.length?[1].concat(x):x,Mat.matVecMult(this.D3.matrix,vec)},project2DTo3DPlane:function(point,normal,foot){var mat,rhs,d,le,n=normal.slice(1),sol=[1,0,0,0];foot=foot||[1,0,0,0],le=Mat.norm(n,3),d=Mat.innerProduct(foot.slice(1),n,3)/le,(mat=this.D3.matrix.slice(0,3)).push([0].concat(n)),rhs=point.coords.usrCoords.concat([d]);try{1===mat[2][3]&&(mat[2][1]=mat[2][2]=.001*Mat.eps),sol=Mat.Numerics.Gauss(mat,rhs)}catch(err){sol=[0,NaN,NaN,NaN]}return sol},project3DToCube:function(c3d){var cube=this.D3.bbox3d;return c3d[1]<cube[0][0]&&(c3d[1]=cube[0][0]),c3d[1]>cube[0][1]&&(c3d[1]=cube[0][1]),c3d[2]<cube[1][0]&&(c3d[2]=cube[1][0]),c3d[2]>cube[1][1]&&(c3d[2]=cube[1][1]),c3d[3]<cube[2][0]&&(c3d[3]=cube[2][0]),c3d[3]>cube[2][1]&&(c3d[3]=cube[2][1]),c3d},intersectionLineCube:function(p,d,r){var rnew,i,r0,r1;for(rnew=r,i=0;i<3;i++)0!==d[i]&&(r0=(this.D3.bbox3d[i][0]-p[i])/d[i],r1=(this.D3.bbox3d[i][1]-p[i])/d[i],rnew=r<0?Math.max(rnew,Math.min(r0,r1)):Math.min(rnew,Math.max(r0,r1)));return rnew},isInCube:function(q){return q[0]>this.D3.bbox3d[0][0]-Mat.eps&&q[0]<this.D3.bbox3d[0][1]+Mat.eps&&q[1]>this.D3.bbox3d[1][0]-Mat.eps&&q[1]<this.D3.bbox3d[1][1]+Mat.eps&&q[2]>this.D3.bbox3d[2][0]-Mat.eps&&q[2]<this.D3.bbox3d[2][1]+Mat.eps},intersectionPlanePlane:function(plane1,plane2,d){var p,dir,r,q,ret=[[],[]];return d=d||plane2.D3.d,p=Mat.Geometry.meet3Planes(plane1.D3.normal,plane1.D3.d,plane2.D3.normal,d,Mat.crossProduct(plane1.D3.normal,plane2.D3.normal),0),dir=Mat.Geometry.meetPlanePlane(plane1.D3.dir1,plane1.D3.dir2,plane2.D3.dir1,plane2.D3.dir2),r=this.intersectionLineCube(p,dir,1/0),q=Mat.axpy(r,dir,p),this.isInCube(q)&&(ret[0]=q),r=this.intersectionLineCube(p,dir,-1/0),q=Mat.axpy(r,dir,p),this.isInCube(q)&&(ret[1]=q),ret},getMesh:function(X,Y,Z,interval_u,interval_v){var i_u,i_v,u,v,c2d,delta_u,delta_v,p=[0,0,0],steps_u=interval_u[2],steps_v=interval_v[2],dataX=[],dataY=[];for(delta_u=(Type.evaluate(interval_u[1])-Type.evaluate(interval_u[0]))/steps_u,delta_v=(Type.evaluate(interval_v[1])-Type.evaluate(interval_v[0]))/steps_v,i_u=0;i_u<=steps_u;i_u++){for(u=interval_u[0]+delta_u*i_u,i_v=0;i_v<=steps_v;i_v++)v=interval_v[0]+delta_v*i_v,p[0]=X(u,v),p[1]=Y(u,v),p[2]=Z(u,v),c2d=this.project3DTo2D(p),dataX.push(c2d[1]),dataY.push(c2d[2]);dataX.push(NaN),dataY.push(NaN)}for(i_v=0;i_v<=steps_v;i_v++){for(v=interval_v[0]+delta_v*i_v,i_u=0;i_u<=steps_u;i_u++)u=interval_u[0]+delta_u*i_u,p[0]=X(u,v),p[1]=Y(u,v),p[2]=Z(u,v),c2d=this.project3DTo2D(p),dataX.push(c2d[1]),dataY.push(c2d[2]);dataX.push(NaN),dataY.push(NaN)}return[dataX,dataY]},animateAzimuth:function(){var s=this.D3.az_slide._smin,sdiff=this.D3.az_slide._smax-s,newVal=this.D3.az_slide.Value()+.1;this.D3.az_slide.position=(newVal-s)/sdiff,this.D3.az_slide.position>1&&(this.D3.az_slide.position=0),this.board.update(),this.timeoutAzimuth=setTimeout(function(){this.animateAzimuth()}.bind(this),200)},stopAzimuth:function(){clearTimeout(this.timeoutAzimuth),this.timeoutAzimuth=null}}),ThreeD.createView3D=function(board,parents,attributes){var view,attr,x,y,w,h,coords=parents[0],size=parents[1];return attr=Type.copyAttributes(attributes,board.options,"view3d"),(view=new ThreeD.View3D(board,parents,attr)).defaultAxes=view.create("axes3d",parents,attributes),x=coords[0],y=coords[1],w=size[0],h=size[1],view.D3.az_slide=board.create("slider",[[x-1,y-2],[x+w+1,y-2],[0,1,2*Math.PI]],{style:6,name:"az",point1:{frozen:!0},point2:{frozen:!0}}),view.D3.el_slide=board.create("slider",[[x-1,y],[x-1,y+h],[0,.3,Math.PI/2]],{style:6,name:"el",point1:{frozen:!0},point2:{frozen:!0}}),view.board.highlightInfobox=function(x,y,el){var d;Type.exists(el.D3)?"auto"===(d=Type.evaluate(el.visProp.infoboxdigits))?view.board.highlightCustomInfobox("("+Type.autoDigits(el.D3.X())+" | "+Type.autoDigits(el.D3.Y())+" | "+Type.autoDigits(el.D3.Z())+")",el):view.board.highlightCustomInfobox("("+Type.toFixed(el.D3.X(),d)+" | "+Type.toFixed(el.D3.Y(),d)+" | "+Type.toFixed(el.D3.Z(),d)+")",el):view.board.highlightCustomInfobox("("+x+", "+y+")",el)},view},JXG.registerElement("view3d",ThreeD.createView3D),ThreeD.View3D})),define("3d/box3d",["jxg","utils/type","math/math","math/geometry","3d/view3d"],(function(JXG,Type,Mat,Geometry,ThreeD){ThreeD.createAxes=function(board,parents,attributes){var i,j,k,i1,i2,attr,pos,dir,from,to,vec1,vec2,range1,range2,na,na_parent,ticks_attr,view=parents[0],directions=["x","y","z"],sides=["Rear","Front"],rear=[0,0,0],front=[0,0,0],axes={};if(Type.exists(view.D3))for(i=0;i<directions.length;i++)rear[i]=view.D3.bbox3d[i][0],front[i]=view.D3.bbox3d[i][1];else for(i=0;i<directions.length;i++)rear[i]=parents[1][i],front[i]=parents[2][1];for(pos=(attr=Type.copyAttributes(attributes,board.options,"axes3d")).axesposition,i=0;i<directions.length;i++)na=(dir=directions[i])+"Axis","center"===pos?(from=[0,0,0],(to=[0,0,0])[i]=front[i],axes[na]=view.create("axis3d",[from,to],attr[na.toLowerCase()])):(na+="Border",from=rear.slice(),to=front.slice(),2===i?(from[1]=front[1],to[0]=rear[0]):(from[i]=front[i],to[2]=rear[2]),to[i]=front[i],attr[na.toLowerCase()].lastArrow=!1,axes[na]=view.create("axis3d",[from,to],attr[na.toLowerCase()]),ticks_attr={visible:!0,minorTicks:0,tickEndings:[0,1],drawLabels:!1},2===i&&(ticks_attr.tickEndings=[1,0]),axes[na+"Ticks"]=view.create("ticks",[axes[na],1],ticks_attr));for(axes.O=board.create("intersection",[axes[directions[0]+"Axis"],axes[directions[1]+"Axis"]],{name:"",visible:!1,withLabel:!1}),i=0;i<directions.length;i++)for(i1=(i+1)%3,i2=(i+2)%3,dir=directions[i],j=0;j<sides.length;j++)(from=[0,0,0])[i]=0===j?rear[i]:front[i],vec2=[0,0,0],(vec1=[0,0,0])[i1]=1,vec2[i2]=1,range1=[rear[i1],front[i1]],range2=[rear[i2],front[i2]],na=dir+"Plane"+sides[j],attr=Type.copyAttributes(attributes,board.options,"axes3d",na),axes[na]=view.create("plane3d",[from,vec1,vec2,range1,range2],attr),axes[na].D3.elType="axisplane3d";for(i=0;i<directions.length;i++)for(dir=directions[i],j=0;j<sides.length;j++)for(k=1;k<=2;k++)na=dir+"Plane"+sides[j]+directions[i1=(i+k)%3].toUpperCase()+"Axis",na_parent=dir+"Plane"+sides[j],(from=[0,0,0])[i]=(to=[0,0,0])[i]=0===j?rear[i]:front[i],from[i1]=rear[i1],to[i1]=front[i1],attr=Type.copyAttributes(attributes,board.options,"axes3d",na),axes[na]=view.create("axis3d",[from,to],attr),axes[na_parent].addChild(axes[na]),axes[na_parent].inherits.push(axes[na]);return axes},JXG.registerElement("axes3d",ThreeD.createAxes),ThreeD.createAxis=function(board,parents,attributes){var attr,el_start,el_end,xx,yy,zz,view=parents[0],start=parents[1],end=parents[2];return attr=Type.copyAttributes(attributes.point1,board.options,"axis3d","point1"),el_start=board.create("point",[(xx=start[0],yy=start[1],zz=start[2],function(){return view.project3DTo2D(xx,yy,zz)[1]}),function(xx,yy,zz){return function(){return view.project3DTo2D(xx,yy,zz)[2]}}(start[0],start[1],start[2])],attr),attr=Type.copyAttributes(attributes.point2,board.options,"axis3d","point2"),el_end=board.create("point",[function(xx,yy,zz){return function(){return view.project3DTo2D(xx,yy,zz)[1]}}(end[0],end[1],end[2]),function(xx,yy,zz){return function(){return view.project3DTo2D(xx,yy,zz)[2]}}(end[0],end[1],end[2])],attr),attr=Type.copyAttributes(attributes,board.options,"axis3d"),board.create("arrow",[el_start,el_end],attr)},JXG.registerElement("axis3d",ThreeD.createAxis),ThreeD.createMesh=function(board,parents,attr){var el,view=parents[0],point=parents[1],vec1=parents[2],range1=parents[3],vec2=parents[4],range2=parents[5];return(el=board.create("curve",[[],[]],attr)).updateDataArray=function(){var l1,l2,res,i,s1=range1[0],e1=range1[1],s2=range2[0],e2=range2[1],v1=[0,0,0],v2=[0,0,0],q=[0,0,0];for(this.dataX=[],this.dataY=[],i=0;i<3;i++)q[i]=Type.evaluate(point[i]),v1[i]=Type.evaluate(vec1[i]),v2[i]=Type.evaluate(vec2[i]);for(l1=JXG.Math.norm(v1,3),l2=JXG.Math.norm(v2,3),i=0;i<3;i++)v1[i]/=l1,v2[i]/=l2;res=view.getMesh((function(u,v){return q[0]+u*v1[0]+v*v2[0]}),(function(u,v){return q[1]+u*v1[1]+v*v2[1]}),(function(u,v){return q[2]+u*v1[2]+v*v2[2]}),[Math.ceil(s1),Math.floor(e1),(Math.ceil(e1)-Math.floor(s1))/1],[Math.ceil(s2),Math.floor(e2),(Math.ceil(e2)-Math.floor(s2))/1]),this.dataX=res[0],this.dataY=res[1]},el},JXG.registerElement("mesh3d",ThreeD.createMesh)})),define("3d/curve3d",["jxg","utils/type","3d/view3d"],(function(JXG,Type,ThreeD){ThreeD.createCurve=function(board,parents,attr){var D3,el,view=parents[0];return(D3={elType:"curve3D",X:parents[1],Y:parents[2],Z:parents[3]}).F=[D3.X,D3.Y,D3.Z],(el=board.create("curve",[[],[]],attr)).D3=D3,Type.isFunction(el.D3.X)?(el.D3.range=parents[4],el.updateDataArray=function(){var c2d,t,i,steps=Type.evaluate(this.visProp.numberpointshigh),s=Type.evaluate(this.D3.range[0]),e=Type.evaluate(this.D3.range[1]),delta=(e-s)/(steps-1),p=[0,0,0];for(this.dataX=[],this.dataY=[],t=s;t<=e;t+=delta){for(i=0;i<3;i++)p[i]=this.D3.F[i](t);c2d=view.project3DTo2D(p),this.dataX.push(c2d[1]),this.dataY.push(c2d[2])}}):Type.isArray(el.D3.X)&&(el.updateDataArray=function(){var i,c2d,le=this.D3.X.length;for(this.dataX=[],this.dataY=[],i=0;i<le;i++)c2d=view.project3DTo2D([this.D3.X[i],this.D3.Y[i],this.D3.Z[i]]),this.dataX.push(c2d[1]),this.dataY.push(c2d[2])}),el},JXG.registerElement("curve3d",ThreeD.createCurve)})),define("3d/linspace3d",["jxg","utils/type","math/math","math/geometry","3d/view3d"],(function(JXG,Type,Mat,Geometry,ThreeD){ThreeD.createLine=function(board,parents,attributes){var attr,D3,point,point1,point2,el,view=parents[0];return D3={elType:"line3d",range:parents[3]||[-1/0,1/0]},point=Type.isPoint(parents[1])?parents[1]:view.create("point3d",parents[1],{visible:!1,name:"",withLabel:!1}),D3.point=point,Type.isPoint(parents[2])&&Type.exists(parents[2].D3)?(point1=point,point2=parents[2],D3.direction=function(){return[point2.D3.X()-point.D3.X(),point2.D3.Y()-point.D3.Y(),point2.D3.Z()-point.D3.Z()]},D3.range=[0,1]):(Type.isFunction(parents[2])?D3.direction=parents[2]:3===parents[2].length?D3.direction=[1].concat(parents[2]):4===parents[2].length&&(D3.direction=parents[2]),D3.getPointCoords=function(r){var i,p=[],d=[];if(p.push(point.D3.X()),p.push(point.D3.Y()),p.push(point.D3.Z()),Type.isFunction(D3.direction))d=D3.direction();else for(i=1;i<4;i++)d.push(Type.evaluate(D3.direction[i]));return Math.abs(r)===1/0&&(r=view.intersectionLineCube(p,d,r)),[p[0]+d[0]*r,p[1]+d[1]*r,p[2]+d[2]*r]},attr=Type.copyAttributes(attributes,board.options,"line3d","point1"),point1=view.create("point3d",[function(){return D3.getPointCoords(Type.evaluate(D3.range[0]))}],attr),attr=Type.copyAttributes(attributes,board.options,"line3d","point2"),point2=view.create("point3d",[function(){return D3.getPointCoords(Type.evaluate(D3.range[1]))}],attr)),attr=Type.copyAttributes(attributes,board.options,"line3d"),(el=view.create("segment",[point1,point2],attr)).point1=point1,el.point2=point2,point1.addChild(el),point2.addChild(el),el.D3=D3,el},JXG.registerElement("line3d",ThreeD.createLine),ThreeD.createPlane=function(board,parents,attributes){var attr,D3,point,el,grid,view=parents[0],vec1=parents[2],vec2=parents[3];return D3={elType:"plane3d",dir1:[],dir2:[],range1:parents[4],range2:parents[5],vec1:vec1,vec2:vec2},point=Type.isPoint(parents[1])?parents[1]:view.create("point3d",parents[1],{visible:!1,name:"",withLabel:!1}),D3.point=point,D3.updateNormal=function(){var i;for(i=0;i<3;i++)D3.dir1[i]=Type.evaluate(D3.vec1[i]),D3.dir2[i]=Type.evaluate(D3.vec2[i]);D3.normal=Mat.crossProduct(D3.dir1,D3.dir2),D3.d=Mat.innerProduct(D3.point.D3.coords.slice(1),D3.normal,3)},D3.updateNormal(),attr=Type.copyAttributes(attributes,board.options,"plane3d"),(el=board.create("curve",[[],[]],attr)).D3=D3,el.updateDataArray=function(){var s1,e1,s2,e2,c2d,l1,l2,d,i,j,a,b,pos,pos_akt,planes=["xPlaneRear","yPlaneRear","zPlaneRear"],points=[],v1=[0,0,0],v2=[0,0,0],q=[0,0,0],p=[0,0,0];if(this.dataX=[],this.dataY=[],this.D3.updateNormal(),"axisplane3d"===this.D3.elType||!view.defaultAxes||D3.range1&&D3.range2){for(s1=Type.evaluate(this.D3.range1[0]),e1=Type.evaluate(this.D3.range1[1]),s2=Type.evaluate(this.D3.range2[0]),e2=Type.evaluate(this.D3.range2[1]),q=this.D3.point.D3.coords.slice(1),v1=this.D3.dir1.slice(),v2=this.D3.dir2.slice(),l1=Mat.norm(v1,3),l2=Mat.norm(v2,3),i=0;i<3;i++)v1[i]/=l1,v2[i]/=l2;for(j=0;j<4;j++){switch(j){case 0:a=s1,b=s2;break;case 1:a=e1,b=s2;break;case 2:a=e1,b=e2;break;case 3:a=s1,b=e2}for(i=0;i<3;i++)p[i]=q[i]+a*v1[i]+b*v2[i];c2d=view.project3DTo2D(p),this.dataX.push(c2d[1]),this.dataY.push(c2d[2])}this.dataX.push(this.dataX[0]),this.dataY.push(this.dataY[0])}else{for(j=0;j<planes.length;j++){if(3===(p=view.intersectionPlanePlane(this,view.defaultAxes[planes[j]]))[0].length&&3===p[1].length){for(i=0;i<points.length&&!(Geometry.distance(p[0],points[i][0],3)<Mat.eps&&Geometry.distance(p[1],points[i][1],3)<Mat.eps||Geometry.distance(p[0],points[i][1],3)<Mat.eps&&Geometry.distance(p[1],points[i][0],3)<Mat.eps);i++);i===points.length&&points.push(p.slice())}if((p=[0,0,0])[j]=view.D3.bbox3d[j][1],d=Mat.innerProduct(p,view.defaultAxes[planes[j]].D3.normal,3),3===(p=view.intersectionPlanePlane(this,view.defaultAxes[planes[j]],d))[0].length&&3===p[1].length){for(i=0;i<points.length&&!(Geometry.distance(p[0],points[i][0],3)<Mat.eps&&Geometry.distance(p[1],points[i][1],3)<Mat.eps||Geometry.distance(p[0],points[i][1],3)<Mat.eps&&Geometry.distance(p[1],points[i][0],3)<Mat.eps);i++);i===points.length&&points.push(p.slice())}}0,pos=0,i=0;do{for(3===(p=points[pos][i]).length&&(c2d=view.project3DTo2D(p),this.dataX.push(c2d[1]),this.dataY.push(c2d[2])),i=(i+1)%2,p=points[pos][i],pos_akt=pos,j=0;j<points.length;j++){if(j!==pos&&Geometry.distance(p,points[j][0])<Mat.eps){pos=j,i=0;break}if(j!==pos&&Geometry.distance(p,points[j][1])<Mat.eps){pos=j,i=1;break}}if(pos===pos_akt){console.log("Error: update plane3d: did not find next",pos);break}}while(0!==pos);c2d=view.project3DTo2D(points[0][0]),this.dataX.push(c2d[1]),this.dataY.push(c2d[2])}},attr=Type.copyAttributes(attributes.mesh3d,board.options,"mesh3d"),D3.range1&&D3.range2&&(grid=view.create("mesh3d",[point.D3.coords.slice(1),vec1,D3.range1,vec2,D3.range2],attr),el.grid=grid,el.inherits.push(grid)),el},JXG.registerElement("plane3d",ThreeD.createPlane)})),define("3d/point3d",["jxg","base/constants","math/math","math/geometry","utils/type","3d/view3d"],(function(JXG,Const,Mat,Geometry,Type,ThreeD){ThreeD.createPoint=function(board,parents,attributes){var attr,update2D,D3,i,c2d,el,view=parents[0];if(attr=Type.copyAttributes(attributes,board.options,"point3d"),D3={elType:"point3d",coords:[1,0,0,0],X:function(){return this.coords[1]},Y:function(){return this.coords[2]},Z:function(){return this.coords[3]}},parents.length>2&&Type.exists(parents[parents.length-1].D3)?D3.slide=parents.pop():D3.slide=null,2===parents.length)D3.F=parents[1],D3.coords=[1].concat(Type.evaluate(D3.F));else if(4===parents.length)for(D3.F=parents.slice(1),i=0;i<3;i++)D3.coords[i+1]=Type.evaluate(D3.F[i]);return D3.updateCoords=function(){var res,i;if(Type.isFunction(this.F))res=Type.evaluate(this.F),this.coords=[1,res[0],res[1],res[2]];else for(this.coords[0]=1,i=0;i<3;i++)Type.isFunction(this.F[i])&&(this.coords[i+1]=Type.evaluate(this.F[i]));return this},D3.updateCoords(),c2d=view.project3DTo2D(D3.coords),(el=board.create("point",c2d,attr)).D3=D3,el.D3.c2d=el.coords.usrCoords.slice(),update2D=el.update,el.D3.slide&&(el._minFunc=function(n,m,x,con){var surface=el.D3.slide.D3,c3d=[1,surface.X(x[0],x[1]),surface.Y(x[0],x[1]),surface.Z(x[0],x[1])],c2d=view.project3DTo2D(c3d);return con[0]=el.X()-c2d[1],con[1]=el.Y()-c2d[2],con[0]*con[0]+con[1]*con[1]},el.projectCoords2Surface=function(){var c3d,c2d,x=[0,0],surface=this.D3.slide.D3;Type.exists(this.D3.params)&&(x=this.D3.params.slice()),Mat.Nlp.FindMinimum(this._minFunc,2,2,x,5,1e-6,0,200),c3d=[1,surface.X(x[0],x[1]),surface.Y(x[0],x[1]),surface.Z(x[0],x[1])],c2d=view.project3DTo2D(c3d),this.D3.params=x,this.D3.coords=c3d,this.coords.setCoordinates(Const.COORDS_BY_USER,c2d),this.D3.c2d=c2d}),el.update=function(drag){var c3d,foot;return this.needsUpdate?(this.draggable()&&0!==Geometry.distance(this.D3.c2d,this.coords.usrCoords)?this.D3.slide?this.projectCoords2Surface():(foot=[1,0,0,this.D3.coords[3]],0!==(c3d=view.project2DTo3DPlane(el,[1,0,0,1],foot))[0]&&(this.D3.coords=view.project3DToCube(c3d))):(this.D3.updateCoords(),el.coords.setCoordinates(Const.COORDS_BY_USER,view.project3DTo2D([1,this.D3.X(),this.D3.Y(),this.D3.Z()]))),this.D3.c2d=el.coords.usrCoords.slice(),update2D.apply(this,[drag]),this):this},el},JXG.registerElement("point3d",ThreeD.createPoint)})),define("3d/surface3d",["jxg","utils/type","3d/view3d"],(function(JXG,Type,ThreeD){ThreeD.createParametricSurface=function(board,parents,attributes){var attr,D3,el,view=parents[0];return D3={elType:"surface3d",X:parents[1],Y:parents[2],Z:parents[3],range_u:parents[4],range_v:parents[5]},attr=Type.copyAttributes(attributes,board.options,"surface3d"),(el=board.create("curve",[[],[]],attr)).updateDataArray=function(){var steps_u=Type.evaluate(this.visProp.stepsu),steps_v=Type.evaluate(this.visProp.stepsv),r_u=Type.evaluate(this.D3.range_u),r_v=Type.evaluate(this.D3.range_v),res=view.getMesh(this.D3.X,this.D3.Y,this.D3.Z,r_u.concat([steps_u]),r_v.concat([steps_v]));this.dataX=res[0],this.dataY=res[1]},el.D3=D3,el},JXG.registerElement("parametricsurface3d",ThreeD.createParametricSurface),ThreeD.createFunctiongraph=function(board,parents,attributes){var view=parents[0],Z=parents[1],range_u=parents[2],range_v=parents[3];return view.create("parametricsurface3d",[function(u,v){return u},function(u,v){return v},Z,range_u,range_v],attributes)},JXG.registerElement("functiongraph3d",ThreeD.createFunctiongraph)})),define("../build/core.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/probfuncs","math/ia","math/extrapolate","math/qdt","math/numerics","math/nlp","math/plot","math/metapost","math/statistics","math/symbolic","math/geometry","math/clip","math/poly","math/complex","renderer/abstract","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/coordselement","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","parser/datasource","parser/jessiecode","parser/ca","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button","base/foreignobject","options3d","3d/box3d","3d/curve3d","3d/linspace3d","3d/point3d","3d/surface3d","3d/threed","3d/view3d"],(function(JXG,Env){return Env.isBrowser?window.JXG=JXG:Env.isNode()&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=JXG:Env.isWebWorker()&&(self.JXG=JXG),JXG})),require("../build/core.deps.js")}());

//# sourceMappingURL=jsxgraphcore-lazy.min.js.map