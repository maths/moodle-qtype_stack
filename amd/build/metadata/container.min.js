define("qtype_stack/metadata/container",["exports","core/reactive","qtype_stack/metadata/metadata","core_form/events"],(function(_exports,_reactive,_metadata,_events){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;
/**
   * Main STACK metadata component
   *
   * @module     qtype_stack/metadata
   * @copyright  2025 University of Edinburgh
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.
   */
class _default extends _reactive.BaseComponent{create(){this.name="stack-metadata-container",this.selectors={METADATACONTAINER:"[data-for='qtype-stack-metadata']",SUBMIT:"#stack-metadata-update"}}static init(target,selectors){return new this({element:document.querySelector(target),reactive:_metadata.metadata,selectors:selectors})}async stateReady(state){await this.reloadContainerComponent({state:state}),this.addEventListener(this.getElement(this.selectors.SUBMIT),"click",this.update)}getWatchers(){return[{watch:"contributor:updated",handler:this.reloadContainerComponent}]}async reloadContainerComponent(_ref){let{state:state}=_ref;console.log("Refresh");const data={creator:{},contributor:[],language:[],license:state.license,isPartOf:state.isPartOf,additional:[],element:[]};state.contributor.forEach((contributor=>{const element={firstname:{required:!1,element:{hiddenlabel:"Contributor first name",value:contributor.firstName,wrapperid:"fitem_"+contributor.id+"_confirstname",id:"id_"+contributor.id+"_confirstname",name:contributor.id+"_confirstname"}},lastname:{required:!0,element:{hiddenlabel:"Contributor last name",value:contributor.lastName,wrapperid:"fitem_"+contributor.id+"_conlastname",id:"id_"+contributor.id+"_conlastname",name:contributor.id+"_conlastname"}},institution:{required:!1,element:{hiddenlabel:"Contributor institution",value:contributor.institution,wrapperid:"fitem_"+contributor.id+"_coninstitution",id:"id_"+contributor.id+"_coninstitution",name:contributor.id+"_coninstitution"}},year:{required:!1,element:{hiddenlabel:"Contributor year",value:contributor.year,wrapperid:"fitem_"+contributor.id+"_conyear",id:"id_"+contributor.id+"_conyear",name:contributor.id+"_conyear"}}};data.contributor.push({...element})})),state.language.forEach((language=>{data.language.push({...language})})),state.additional.forEach((additional=>{data.additional.push({...additional})})),data.element.push({hiddenlabel:"Course full name",required:!0,element:{wrapperid:"fitem_id_fullname",id:"id_fullname",name:"fullname"}}),data.creator=data.contributor[0],data.json={required:!0,element:{hiddenlabel:"JSON metadata",value:JSON.stringify(state),wrapperid:"fitem_metadata_json",id:"id_metadata_json",name:"metadata_json"}};const metadataContainer=this.getElement(this.selectors.METADATACONTAINER);if(!metadataContainer)throw new Error("Missing metadata container.");await this.renderComponent(metadataContainer,"qtype_stack/metadatacontent",data)}update(event){event.preventDefault();const elements=this.getElements('#qtype-stack-metadata-content input[aria-required="true"]');for(const element of elements)""===element.value?(0,_events.notifyFieldValidationFailure)(element,"Required"):element.classList.contains("is-invalid")&&(0,_events.notifyFieldValidationFailure)(element,"");const first=this.getElement("#id_2_confirstname").value,last=this.getElement("#id_2_conlastname").value;this.reactive.dispatch("updateContributor",2,first,last)}}return _exports.default=_default,_exports.default}));

//# sourceMappingURL=container.min.js.map