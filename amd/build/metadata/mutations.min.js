define("qtype_stack/metadata/mutations",["exports","qtype_stack/metadata/metadata"],(function(_exports,_metadata){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.mutations=void 0;const mutations=new
/**
   * Default mutation manager
   *
   * @module     qtype_stack/metadata
   * @copyright  2025 University of Edinburgh
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.
   */
class{updateAll(stateManager,inputArray){const state=stateManager.state;stateManager.setReadOnly(!1);for(const field of inputArray){const parts=field[0].split("_"),id=parts[1],property=parts[2],subproperty=parts[3];if(0!=id){const existing=state[property].get(id);existing&&(existing[subproperty]=field[1])}else state[property][subproperty]=field[1]}stateManager.setReadOnly(!0),console.log(state)}deleteRow(stateManager,property,id){const state=stateManager.state;if(stateManager.setReadOnly(!1),"scope"===property){const matchingAddInfo=[];state.additional.forEach((addInfo=>{addInfo.scope===id&&matchingAddInfo.push(addInfo.id)}));for(const current of matchingAddInfo)state.additional.delete(current)}else state[property].delete(id);stateManager.setReadOnly(!0)}addItem(stateManager,category,id){const state=stateManager.state;let addCategory=category,newItem=null,existingProperty=null;switch(category){case"language":newItem={value:""};break;case"contributor":newItem={firstName:"user"===id?_metadata.metadata.lib.user.firstname:"",lastName:"user"===id?_metadata.metadata.lib.user.lastname:"",institution:"user"===id?_metadata.metadata.lib.user.institution:"",year:String((new Date).getFullYear())};break;case"scope":newItem={scope:"",property:"",qualifier:"",value:""},addCategory="additional";break;case"property":existingProperty=state.additional.get(id),newItem={scope:existingProperty.scope,property:"",qualifier:"",value:""},addCategory="additional"}const keys=Array.from(state[addCategory]);0===keys.length?newItem.id=1:(keys.sort(((a,b)=>b[0]-a[0])),newItem.id=1+parseInt(keys[0][0])),stateManager.setReadOnly(!1),state[addCategory].add(newItem),stateManager.setReadOnly(!0)}updateFromJson(stateManager,data){const state=stateManager.state;stateManager.setReadOnly(!1);for(const prop in data)state[prop]=data[prop];state.metadataTicker.value+=1,stateManager.setReadOnly(!0),console.log(state)}};_exports.mutations=mutations}));

//# sourceMappingURL=mutations.min.js.map