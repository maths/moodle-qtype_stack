/*!
 * 
 * TeX2Max v1.0.0       Mon Oct 15 2018 00:20:34 GMT+0200 (CEST)
 * by André Storhaug    andr3.storhaug@gmail.com
 * https://github.com/KQMATH/tex2max
 * 
 * Copyright: 2018 NTNU
 * License: GPL-3.0-or-later
 * 
 * Build: 55a2a426f1026ffbf1d2
 * 
 */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.tex2max=r():e.tex2max=r()}(window,function(){return function(e){var r={};function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)n.d(t,i,function(r){return e[r]}.bind(null,i));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=9)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.debug=void 0,r.warn=function(e){console.warn(e)};var t=n(3);r.debug=function(e){(0,t.getOptions)().debugging&&console.debug(e)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.isEquation=function(e){var r=0;if(e.forEach(function(e){"operator"===e.type&&"="===e.value&&r++}),1===r)return!0;if(r>1)throw new Error("Expression contains more than one equal signs");return!1},r.checkForVariable=function e(r){i.debug("Checking expression "+JSON.stringify(r)+" for variable");var n=!1;if(Array.isArray(r))for(var t=0;t<r.length;t++)if("group"===r[t].type){var o=e(r[t].value);o&&(n=!0)}else"variable"===r[t].type&&(n=!0);else n="variable"===r.type;return n},r.buildMaximaFunctionString=function(e,r){var n="";n+=e+"("+r;for(var t=arguments.length,i=Array(t>2?t-2:0),o=2;o<t;o++)i[o-2]=arguments[o];return i.forEach(function(e){!1!==e&&null!==e&&void 0!==e&&(n+=","+e)}),n+=")"},r.searchForOccurrence=function e(r,n,t,i){var o=!1;var a=!1;var u=[];if(Array.isArray(r))for(var l=0;l<r.length;l++)if("group"===r[l].type&&i){var s=void 0;"type"===n?(s=e(r[l].type,"type",t,!0),a=s.isPresent):"value"===n&&(s=e(r[l].value,"value",t,!0),a=s.isPresent),a&&(u.push(s.position),o=!0)}else"type"===n?r[l].type===t&&(o=!0,u.push(l)):"value"===n&&r[l].value===t&&(o=!0,u.push(l));else"type"===n?r.type===t&&(o=!0,u=0):"value"===n?r.value===t&&(o=!0,u=null):o=!1;var f={isPresent:o,position:u};return f},r.wrapForTranspilation=function(e){if(Array.isArray(e))return e;if("object"===(void 0===e?"undefined":t(e))&&"string"!=typeof e)return[e]},r.stripParenthesis=function(e){var r=e.charAt(0),n=e.charAt(-1);return r.match(/[({\[]/)||n.match(/[)}\]]/)?e.substr(1,e.length-2):e},r.stripAllParenthesis=function(e){return e.replace(/[()]/g,"")};var i=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.transpiler=function(e){v.debug("\n------------------ TRANSPILING -> -------------------");var r=(0,c.getOptions)();var n="";var m=0;n+="(";var b=function(){var c=e[m];switch(c.type){case"operator":!function(){var r=e[m-1];if(0===m&&"+"===c.value)v.debug("Structure starts with +, ignoring");else{if(0===m&&"prefix"!==c.operatorType&&"-"!==c.value)throw new Error("Operator "+c.value+" is not an prefix operator");if("+"===c.value||"-"===c.value)n+=c.value;else if("postfix"===c.operatorType){if("operator"===r.type)throw new Error("Operator "+c.value+" has to be an postfix operator");n+=c.value}else if("prefix"===c.operatorType);else if("infix"===c.operatorType){if("operator"===r.type||"operator"===r.type)throw new Error("Operator "+c.value+" has to be an infix operator");n+=c.value}}if(("infix"===c.operatorType||"prefix"===c.operatorType)&&m===e.length-1)throw new Error("Operator "+c.value+" is an invalid end character.")}();break;case"number":b(m,{type:"number"},{type:"operator",operatorType:"infix"}),n+=c.value;break;case"variable":!function(){var e="";if(b(m,{type:"operator",operatorType:"infix"}),null!==(0,p.getName)(c.value)){var t=(0,p.getName)(c.value);r.onlyGreekSymbol&&(t=(0,p.getSymbol)(t)),v.debug("greek letter "+t),e+=t}else e+=c.value;n+=e}();break;case"group":b(m,{type:"function"},{type:"operator"}),n+=g(c.value);break;case"token":!function(){v.debug("Handling token: "+c.value);var t="",i=m;if(null!==(0,p.getSymbol)(c.value)){var a=c.value;r.onlyGreekSymbol&&(a=(0,p.getSymbol)(a)),v.debug("greek letter "+a),t+=a}if(null!==(0,p.getName)(c.value)){var u=c.value;r.onlyGreekName&&(u=(0,p.getName)(u)),v.debug("greek letter "+u),t+=u}if((0,o.isMacro)(c.value)){var l=o.MACROS.get(c.value);null===l?v.debug("Skipping macro "+c.value):void 0!==l&&(v.debug("Adding macro "+l),t+=l)}if("frac"===c.value){if("group"!==e[m+1].type||"group"!==e[m+2].type)throw new Error("Fraction must have 2 following parameters");v.debug("Found fraction"),t+=g(e[m+1].value)+"/"+g(e[m+2].value),m+=2}i>0&&""!==t&&((0,o.isMacro)(c.value)||(0,p.isGreekLetter)(c.value))&&b(i,{type:"operator"});n+=t}();break;case"function":!function(){b(m,{type:"operator"});e[m+1];if("sqrt"===c.value){if("group"!==e[m+1].type)throw new Error("Square root must be followed by [] or {}");var r="";if("square"===e[m+1].symbol&&"group"===e[m+2].type){v.debug("Found function nth-square root");var t=g(e[m+1].value);r+=g(e[m+2].value),r+="^(1/"+t+")",m++}else n+=c.value,v.debug("Found function square root"),r+=g(e[m+1].value);n+=r,m++}else"lim"===c.value?(v.debug('Found function "limit"'),function(){var r="",t="";if("_"!==e[m+1].value||"group"!==e[m+2].type)throw new Error('Limit must have a "from" and "to" value');var o=e[m+2].value;if(o=(0,f.handleLimitArguments)(o),void 0===e[m+3])throw new Error("Missing argument in limit");var a=(0,i.getExpressionLength)(e.slice(m+3));t+=g(e.slice(m+3,m+3+a)),m+=a-1,r=(0,u.buildMaximaFunctionString)("limit",t,o.variable,o.value,o.direction),m+=3;n+=r}()):"binom"===c.value?(v.debug('Found function "binomial"'),function(){var r="",t="",i="",o=e[m+1].type,a=e[m+2].type;if("group"!==o||"group"!==a)throw new Error("Binomial must have 2 following groups");t+=g(e[m+1].value),i+=g(e[m+2].value);r+=(0,u.buildMaximaFunctionString)("binomial",t,i),n+=r,m+=2}()):"sum"===c.value?(v.debug('Found function "sum"'),function(){var r="",t="",o=void 0,a=void 0,l="";if("_"!==e[m+1].value&&"^"!==e[m+1].value)throw new Error("Sum does not contain the correct number of arguments");var f=(0,s.handleUpperAndLowerArgsSum)(e.slice(m+1)),c=f.lowerLimit.value;a=f.upperLimit,m+=4,c=(0,s.handleLowerSumArguments)(c),l=c.variable,o=c.value,v.debug("Sum: arguments are form "+o+" to "+a);if(void 0===e[m+1])throw new Error("Missing argument in sum");var p=(0,i.getExpressionLength)(e.slice(m+1));t+=g(e.slice(m+1,m+1+p)),m+=p;r+=(0,u.buildMaximaFunctionString)("sum",t,l,o,a),n+=r}()):"integral"===c.value?(v.debug('Found function "integral"'),function(){var r="",t="",o=void 0,a=void 0,s="",f=void 0,c=!1;if((0,i.assertNotUndefined)(e[m+1],"Missing argument in integral"),"_"!==e[m+1].value&&"^"!==e[m+1].value)v.debug("Integral is symbolic"),c=!0,m++;else{var p=e.slice(m+1,m+5),d=(0,l.handleUpperAndLowerArgs)(p);o=d.lowerLimit,a=d.upperLimit,v.debug("Integration limits are from "+o+" to "+a),m+=5}var b=(0,l.findIntegralEnd)(e.slice(m));s+=b.variable,f=b.length;var y=e.slice(m,m+f);(0,i.assertNotUndefined)(y[y.length-1],"Missing argument in integral"),"*"===y[y.length-1].value&&y.splice(-1,1);t+=g(y),m+=f,r+=c?(0,u.buildMaximaFunctionString)("integrate",t,s):(0,u.buildMaximaFunctionString)("integrate",t,s,o,a);n+=r}()):(v.debug('Found normal "function"'),function(){var r="",t=!1,o=void 0,a=c.value;if((0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a),"^"===e[m+1].value){if(t=!0,(0,i.assertNotUndefined)(e[m+2],"Missing argument in function: "+a+"^"),o=g((0,u.wrapForTranspilation)(e[m+2])),o=(0,u.stripParenthesis)(o),"-1"===(0,u.stripAllParenthesis)(o)){if(v.debug("Function is inverse"),t=!1,!(0,d.isTrigonometricFunction)(a))throw new Error('Function "'+a+'" is not an trigonometric function');var l=(0,d.getInverseTrigonometricFunction)(a);if(null===l)throw new Error("No inverse trigonometric function found for "+a);a=l}m+=2}r+=a,t?(0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a+"^"+g((0,u.wrapForTranspilation)(e[m]))):(0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a);var s=(0,i.getExpressionLength)(e.slice(m+1));r+=g((0,u.wrapForTranspilation)(e.slice(m+1,m+1+s))),m+=s-1,t&&(r="("+r+")^"+o);m++,n+=r}())}();break;case"environment":!function(){if("begin"===c.state){b(m,{type:"operator"});var r="",i=(0,t.environmentLength)(e.slice(m));"matrix"===c.value&&(v.debug("Found matrix environment"),r+=(0,a.handleMatrix)(e.slice(m+1,m+1+i))),m+=i+1,n+=r}else"end"===c.state&&m++}()}function b(t){var i=e[t-1],o=!0;if(t>0){for(var a=arguments.length,u=Array(a>1?a-1:0),l=1;l<a;l++)u[l-1]=arguments[l];u.forEach(function(e){var r=!0;for(var n in e)e.hasOwnProperty(n)&&i[n]!==e[n]&&(r=!1);!0===r&&(o=!1)}),r.addTimesSign&&o&&(v.debug("Adding * before "+c.type+": "+c.value+", previous item: "+e[t-1].type),n+="*")}}};for(;m<e.length;m++)b();n+=")";if(/(\([ ]*\))/.test(n))throw new Error("Syntax error");if(""===n)throw new Error("EMPTY");return n};var t=n(16),i=n(5),o=n(6),a=n(17),u=n(1),l=n(18),s=n(19),f=n(20),c=n(3),v=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),p=n(8),d=n(7);function g(e){v.debug("\n------------------ TRANSPILING -> -------------------");var r=(0,c.getOptions)();var n="";var m=0;n+="(";var b=function c(){var b=e[m];switch(b.type){case"operator":E();break;case"number":w();break;case"variable":S();break;case"group":O();break;case"token":T();break;case"function":_();break;case"environment":x();break}function y(){return n.substring(1)}function h(t){var i=e[t-1];var o=true;if(t>0){for(var a=arguments.length,u=Array(a>1?a-1:0),l=1;l<a;l++){u[l-1]=arguments[l]}u.forEach(function(e){var r=true;for(var n in e){if(!e.hasOwnProperty(n)){continue}if(i[n]!==e[n]){r=false}}if(r===true)o=false});if(r.addTimesSign&&o){v.debug("Adding * before "+b.type+": "+b.value+", previous item: "+e[t-1].type);n+="*"}}}function E(){var r=e[m-1];if(m===0&&b.value==="+"){v.debug("Structure starts with +, ignoring")}else if(m===0&&b.operatorType!=="prefix"&&b.value!=="-"){throw new Error("Operator "+b.value+" is not an prefix operator")}else{if(b.value==="+"||b.value==="-"){n+=b.value}else if(b.operatorType==="postfix"){if(r.type!=="operator"){n+=b.value}else{throw new Error("Operator "+b.value+" has to be an postfix operator")}}else if(b.operatorType==="prefix"){}else if(b.operatorType==="infix"){if(r.type!=="operator"&&r.type!=="operator"){n+=b.value}else{throw new Error("Operator "+b.value+" has to be an infix operator")}}}if((b.operatorType==="infix"||b.operatorType==="prefix")&&m===e.length-1){throw new Error("Operator "+b.value+" is an invalid end character.")}}function w(){h(m,{type:"number"},{type:"operator",operatorType:"infix"}),n+=b.value}function S(){var e="";if(h(m,{type:"operator",operatorType:"infix"}),null!==(0,p.getName)(b.value)){var t=(0,p.getName)(b.value);if(r.onlyGreekSymbol){t=(0,p.getSymbol)(t)}v.debug("greek letter "+t);e+=t}else{e+=b.value}n+=e}function O(){h(m,{type:"function"},{type:"operator"}),n+=g(b.value)}function T(){v.debug("Handling token: "+b.value);var t="",i=m;if((0,p.getSymbol)(b.value)!==null){var a=b.value;if(r.onlyGreekSymbol){a=(0,p.getSymbol)(a)}v.debug("greek letter "+a);t+=a}if((0,p.getName)(b.value)!==null){var u=b.value;if(r.onlyGreekName){u=(0,p.getName)(u)}v.debug("greek letter "+u);t+=u}if((0,o.isMacro)(b.value)){var l=o.MACROS.get(b.value);if(l===null){v.debug("Skipping macro "+b.value)}else if(l!==undefined){v.debug("Adding macro "+l);t+=l}}if(b.value==="frac"){if(e[m+1].type==="group"&&e[m+2].type==="group"){v.debug("Found fraction");t+=g(e[m+1].value)+"/"+g(e[m+2].value);m+=2}else{throw new Error("Fraction must have 2 following parameters")}}if(i>0&&t!==""&&((0,o.isMacro)(b.value)||(0,p.isGreekLetter)(b.value))){h(i,{type:"operator"})}n+=t}function _(){h(m,{type:"operator"});var r=e[m+1];if(b.value==="sqrt"){if(e[m+1].type==="group"){var t="";if(e[m+1].symbol==="square"&&e[m+2].type==="group"){v.debug("Found function nth-square root");var o=g(e[m+1].value);t+=g(e[m+2].value);t+="^(1/"+o+")";m++}else{n+=b.value;v.debug("Found function square root");t+=g(e[m+1].value)}n+=t;m++}else{throw new Error("Square root must be followed by [] or {}")}}else if(b.value==="lim"){v.debug('Found function "limit"');p()}else if(b.value==="binom"){v.debug('Found function "binomial"');c()}else if(b.value==="sum"){v.debug('Found function "sum"');y()}else if(b.value==="integral"){v.debug('Found function "integral"');E()}else{v.debug('Found normal "function"');a()}function a(){var r="",t=false,o=void 0,a=b.value;if((0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a),"^"===e[m+1].value){t=true;(0,i.assertNotUndefined)(e[m+2],"Missing argument in function: "+a+"^");o=g((0,u.wrapForTranspilation)(e[m+2]));o=(0,u.stripParenthesis)(o);if((0,u.stripAllParenthesis)(o)==="-1"){v.debug("Function is inverse");t=false;if((0,d.isTrigonometricFunction)(a)){var l=(0,d.getInverseTrigonometricFunction)(a);if(l!==null){a=l}else{throw new Error("No inverse trigonometric function found for "+a)}}else{throw new Error('Function "'+a+'" is not an trigonometric function')}}m+=2}if(r+=a,t){(0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a+"^"+g((0,u.wrapForTranspilation)(e[m])))}else{(0,i.assertNotUndefined)(e[m+1],"Missing argument in function: "+a)}var s=(0,i.getExpressionLength)(e.slice(m+1));if(r+=g((0,u.wrapForTranspilation)(e.slice(m+1,m+1+s))),m+=s-1,t){r="("+r+")"+"^"+o}m++,n+=r}function c(){var r="",t="",i="",o=e[m+1].type,a=e[m+2].type;if(o==="group"&&a==="group"){t+=g(e[m+1].value);i+=g(e[m+2].value)}else{throw new Error("Binomial must have 2 following groups")}r+=(0,u.buildMaximaFunctionString)("binomial",t,i),n+=r,m+=2}function p(){var r="",t="";if(e[m+1].value==="_"&&e[m+2].type==="group"){var o=e[m+2].value;o=(0,f.handleLimitArguments)(o);if(typeof e[m+3]!=="undefined"){var a=(0,i.getExpressionLength)(e.slice(m+3));t+=g(e.slice(m+3,m+3+a));m+=a-1}else{throw new Error("Missing argument in limit")}r=(0,u.buildMaximaFunctionString)("limit",t,o.variable,o.value,o.direction);m+=3}else{throw new Error('Limit must have a "from" and "to" value')}n+=r}function y(){var r="",t="",o=void 0,a=void 0,l="";if(e[m+1].value!=="_"&&e[m+1].value!=="^"){throw new Error("Sum does not contain the correct number of arguments")}else{var f=(0,s.handleUpperAndLowerArgsSum)(e.slice(m+1));var c=f.lowerLimit.value;a=f.upperLimit;m+=4;c=(0,s.handleLowerSumArguments)(c);l=c.variable;o=c.value;v.debug("Sum: arguments are form "+o+" to "+a)}if(typeof e[m+1]!=="undefined"){var p=(0,i.getExpressionLength)(e.slice(m+1));t+=g(e.slice(m+1,m+1+p));m+=p}else{throw new Error("Missing argument in sum")}r+=(0,u.buildMaximaFunctionString)("sum",t,l,o,a),n+=r}function E(){var r="",t="",o=void 0,a=void 0,s="",f=void 0,c=false;if((0,i.assertNotUndefined)(e[m+1],"Missing argument in integral"),"_"!==e[m+1].value&&"^"!==e[m+1].value){v.debug("Integral is symbolic");c=true;m++}else{var p=e.slice(m+1,m+5);var d=(0,l.handleUpperAndLowerArgs)(p);o=d.lowerLimit;a=d.upperLimit;v.debug("Integration limits are from "+o+" to "+a);m+=5}var b=(0,l.findIntegralEnd)(e.slice(m));s+=b.variable,f=b.length;var y=e.slice(m,m+f);if((0,i.assertNotUndefined)(y[y.length-1],"Missing argument in integral"),"*"===y[y.length-1].value){y.splice(-1,1)}if(t+=g(y),m+=f,c){r+=(0,u.buildMaximaFunctionString)("integrate",t,s)}else{r+=(0,u.buildMaximaFunctionString)("integrate",t,s,o,a)}n+=r}}function x(){if(b.state==="begin"){h(m,{type:"operator"});var r="";var i=(0,t.environmentLength)(e.slice(m));if(b.value==="matrix"){v.debug("Found matrix environment");r+=(0,a.handleMatrix)(e.slice(m+1,m+1+i))}m+=i+1;n+=r}else if(b.state==="end"){m++}}};for(m;m<e.length;m++){b()}n+=")";if(/(\([ ]*\))/.test(n)){throw new Error("Syntax error")}if(n==="")throw new Error("EMPTY");return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setOptions=a,r.getOptions=function(){0===Object.keys(t).length&&t.constructor===Object&&a();return Object.assign({},t)};var t={},i=r.DEFAULTS={onlySingleVariables:!1,handleEquation:!1,addTimesSign:!0,onlyGreekName:!1,onlyGreekSymbol:!1,debugging:!1};function o(){!function(e){for(var r=0,n=0;n<e.length;n++)if(!0===i[e[n]]&&r++,r>1)throw new Error('Only one of the options: "'+e.join('", "')+'" can be set to "true"')}(["onlyGreekName","onlyGreekSymbol"])}function a(e){t={},t=Object.assign(i,e),o()}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.TOKEN_TYPES={WHITESPACE:{name:"WHITESPACE",symbol:" ",regex:/^\s+/},BACKSLASH:{name:"BACKSLASH",symbol:"\\",regex:/^[\\\\]$/},AMPERSAND:{name:"AMPERSAND",symbol:"&",regex:/^[&]$/},OPENING_BRACE:{name:"OPENING_BRACE",symbol:null,regex:/^[\{]$/},CLOSING_BRACE:{name:"CLOSING_BRACE",symbol:null,regex:/^[\}]$/},OPENING_PARENTHESES:{name:"OPENING_PARENTHESES",symbol:null,regex:/^[\(]$/},CLOSING_PARENTHESES:{name:"CLOSING_PARENTHESES",symbol:null,regex:/^[\)]$/},OPENING_BRACKET:{name:"BRACKET",symbol:null,regex:/^[\[]$/},CLOSING_BRACKET:{name:"BRACKET",symbol:null,regex:/^[\]]$/},NUMBER_LITERAL:{name:"NUMBER_LITERAL",symbol:null,regex:/^[0-9]+$/i},STRING_LITERAL:{name:"STRING_LITERAL",symbol:null,regex:/^[a-zA-Zα-ωΑ-Ω]+$/i},OPERATOR:{name:"OPERATOR",symbol:null,regex:/^[+\-*/=^_!]$/i}}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assertNotUndefined=function(e,r){if(void 0===e)throw new Error(r)},r.getExpressionLength=function(e){var r=0;if("group"===e[0].type&&1===e.length)r=1;else{for(var n=0,t=!1;n<e.length&&!t;)"+"!==e[n].value&&"-"!==e[n].value&&"+-"!==e[n].value||(r=n,t=!0),n++;t||(r=e.length)}return r}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isMacro=function(e){var r=!1;void 0!==t.get(e)&&(r=!0);return r},r.isIgnoredMacro=function(e){var r=!1,n=0;for(;!r&&n<i.length;)e===i[n]&&(r=!0),n++;return r};var t=r.MACROS=new Map([["begin",null],["end",null],["to",null],["cdot",null],["times",null],["ast",null],["div",null],["mod",null],["pm",null],["frac",null],["infty","inf"],["operatorname",null]]),i=r.IGNORED_MACROS=["left","right"];r.MACROS_OVERRIDE=new Map([["cdot",{type:"operator",operatorType:"infix",value:"*"}],["times",{type:"operator",operatorType:"infix",value:"*"}],["ast",{type:"operator",operatorType:"infix",value:"*"}],["div",{type:"operator",operatorType:"infix",value:"/"}],["mod",{type:"operator",operatorType:"infix",value:"%"}],["pm",{type:"operator",operatorType:"infix",value:"+-"}]])},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TRIGONOMETRIC_FUNCTIONS=r.FUNCTIONS=void 0,r.isFunction=function(e){var r=!1;if(a(e))r=!0;else{var n=i.get(e);void 0!==n&&(r=!0)}return r},r.getFunctionName=function(e){var r=void 0;if(a(e))r=e;else if(null===(r=i.get(e)))r=e;else if(void 0===r)throw new Error("Not recognised function: "+r);return r},r.isTrigonometricFunction=a,r.getInverseTrigonometricFunction=function(e){t.debug('Getting the inverse of the function "'+e+'"');var r=void 0;for(var n in o)o[n].name===e?(!0,r=o[n].inverse):o[n].inverse===e&&(!0,r=o[n].name),0;return void 0===r?null:(t.debug("- Found the inverse: "+r),r)};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0));var i=r.FUNCTIONS=new Map([["lg",null],["log",null],["ln",null],["sqrt",null],["max",null],["min",null],["sum",null],["lim",null],["int","integral"],["binom",null],["arccos","acos"],["arccosh","acosh"],["arccot","acot"],["arccoth","acoth"],["arccsc","acsc"],["arccsch","acsch"],["arcsec","asec"],["arcsech","asech"],["arcsin","asin"],["arcsinh","asinh"],["arctan","atan"],["arctanh","atanh"]]),o=r.TRIGONOMETRIC_FUNCTIONS=[{name:"cos",inverse:"acos"},{name:"cosh",inverse:"acosh"},{name:"cot",inverse:"acot"},{name:"coth",inverse:"acoth"},{name:"csc",inverse:"acsc"},{name:"csch",inverse:"acsch"},{name:"sec",inverse:"asec"},{name:"sech",inverse:"asech"},{name:"sin",inverse:"asin"},{name:"sinh",inverse:"asinh"},{name:"tan",inverse:"atan"},{name:"tanh",inverse:"atanh"}];function a(e){var r=o.find(function(r){return r.name===e}),n=o.find(function(r){return r.inverse===e});return void 0!==r||void 0!==n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.letters=void 0,r.toUpperCase=o,r.isUpperCase=a,r.getSymbol=function(e){var r=i.find(function(r){return r.name===e.toLowerCase()});if(void 0===r)return null;r=r.symbol,a(e)&&(r=o(r));return r},r.getName=function(e){var r=i.find(function(r){return r.symbol===e.toLowerCase()});if(void 0===r)return null;r=r.name,a(e)&&(r=o(r));return r},r.isGreekLetter=function(e){var r=i.find(function(r){return r.name===e.toLowerCase()}),n=i.find(function(r){return r.symbol===e.toLowerCase()});return void 0!==r||void 0!==n},r.convertSymbols=function(e){return t.debug("Converting math symbols "+e),i.forEach(function(r){e=(e=e.split(r.symbol).join(r.name)).split(o(r.symbol)).join(o(r.name))}),t.debug("- Converted math symbols "+e),e};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0));var i=r.letters=[{name:"alpha",symbol:"α"},{name:"beta",symbol:"β"},{name:"gamma",symbol:"γ"},{name:"delta",symbol:"δ"},{name:"epsilon",symbol:"ϵ"},{name:"zeta",symbol:"ζ"},{name:"eta",symbol:"η"},{name:"theta",symbol:"θ"},{name:"iota",symbol:"ι"},{name:"kappa",symbol:"κ"},{name:"lambda",symbol:"λ"},{name:"mu",symbol:"μ"},{name:"nu",symbol:"ν"},{name:"omicron",symbol:"ο"},{name:"pi",symbol:"π"},{name:"rho",symbol:"ρ"},{name:"sigma",symbol:"σ"},{name:"tau",symbol:"τ"},{name:"upsilon",symbol:"υ"},{name:"phi",symbol:"ϕ"},{name:"chi",symbol:"χ"},{name:"psi",symbol:"ψ"},{name:"omega",symbol:"ω"}];function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e){return e.charAt(0).toUpperCase()===e.charAt(0)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TeX2Max=void 0;var t=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),i=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),o=n(3),a=n(10),u=n(11),l=n(13),s=n(2),f=n(1);r.TeX2Max=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),(0,o.setOptions)(r),this.options=(0,o.getOptions)(),this.lastInput="",this.lastResult=""}return t(e,[{key:"getLastInput",value:function(){return this.lastInput()}},{key:"getLastResult",value:function(){return this.lastResult}},{key:"updateOptions",value:function(e){(0,o.setOptions)(e),this.options=(0,o.getOptions)()}},{key:"toMaxima",value:function(e){(0,o.setOptions)(this.options);var r=void 0;this.lastInput=e;var n=(0,a.scan)(e);i.debug(n);var t=(0,u.lex)(n);i.debug(t),this.structure=(0,l.parseLatex)(t),i.debug(this.structure);var c=(0,s.transpiler)(this.structure);return r=(0,f.stripParenthesis)(c),this.options.handleEquation&&(0,f.isEquation)(this.structure)&&(r="solve("+r+")"),this.lastResult=r,r}}]),e}()},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.scan=function(e){var r=[];function n(e){r.push(e)}i.debug("\n------------------ SCANNER -> -------------------");var o=0;for(;o<e.length;){var a=!1;for(var u in t.TOKEN_TYPES)t.TOKEN_TYPES.hasOwnProperty(u)&&e[o].match(t.TOKEN_TYPES[u].regex)&&(n(e[o]),a=!0);if(!a)throw new Error("Encountered unsupported character: "+e[o]);o++}return r};var t=n(4),i=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.lex=function(e){var r=0,n=[],a=function(e){return n.push(e)},u=function(){return n};function l(){return o.debug("Consuming position: "+r+", char: "+e[r]),e[r++]}function s(e){if(void 0===e)return null;for(var r in t.TOKEN_TYPES)if(t.TOKEN_TYPES.hasOwnProperty(r)){var n=t.TOKEN_TYPES[r],i=n.regex;if(e.match(i))return n}return null}return function(){o.debug("\n------------------ LEXICAL ANALYSIS -> -------------------");for(;r<e.length;){var n=void 0,t="",f=s(e[r]);t=l(),void 0!==(n=new i.Token(f,t))&&a(n)}return u()}()};var t=n(4),i=n(12),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Token=function e(r,n){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=n,this.type=r}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseLatex=function e(r){var n=(0,l.getOptions)();s.debug("\n------------------ PARSING -> -------------------");var d=0;var g=[];function m(e){g.push(e)}function b(){return s.debug("Consuming position: "+d),r[d++].value}function y(){return s.debug("Skip token at position: "+d),r[d++].value}function h(){return r[d]?r[d].value:void 0}function E(){return r[d+1]?r[d+1].type.name:null}function w(){return s.debug("- Single number"),{type:"number",value:b()}}function S(){s.debug("Parsing number: "+r[d].value);var e=E(),n=function(){var e=r[d-1];return e?e.value:null}(),t=function(e){var r=g[g.length-e];return r?r.type:null}(1);if("^"!==n&&"_"!==n&&"function"!==t){if(null!==e&&e===a.TOKEN_TYPES.NUMBER_LITERAL.name){s.debug('- Found another number "'+r[d+1].value+'", continuing parsing');var i=w().value+P().value;return{type:"number",value:i}}return w()}return w()}function O(){s.debug('- Found letter "'+h()+'"');var e="";return E()===a.TOKEN_TYPES.STRING_LITERAL.name?(s.debug(", continuing parsing"),e=b()+O(a.TOKEN_TYPES.STRING_LITERAL.name),s.debug("current word: "+e)):e=b(),s.debug("current sequence: "+e),e}function T(){s.debug("Parsing variable: "+r[d].value);var e="",t=d;if(e=O(),s.debug("current word: "+e),function(e){var r=!1;for(var n in s.debug("Checking "+e+" for reserved word"),u.RESERVED_WORDS)if(u.RESERVED_WORDS.hasOwnProperty(n)){var t=u.RESERVED_WORDS[n].regex;t.test(e)&&(r=!0)}return r}(e)){s.debug("Variable contains reserved words");var i=void 0,o=function(e){var r="",n="";for(var t in u.RESERVED_WORDS)if(u.RESERVED_WORDS.hasOwnProperty(t)){var i=u.RESERVED_WORDS[t].regex;if(null!==e.match(i)){r=u.RESERVED_WORDS[t].type,n=i.exec(e);break}}return{type:r,value:n}}(e),a=o.value;if(i=a[0].length,s.debug("reserved word: "+a[0]+", length: "+i+", index "+a.index),a.index>0)if(d=t+a.index,e=e.substr(0,a.index),!0===n.onlySingleVariables&&!1===n.addTimesSign){if(e.length>1)throw new Error("The current options only allow for single variables")}else n.onlySingleVariables&&(d=t,e=b());else d=t+i,e=a[0]}else if(!0===n.onlySingleVariables&&!1===n.addTimesSign){if(e.length>1)throw new Error("The current options only allow for single variables")}else n.onlySingleVariables&&(d=t,e=b());return{type:"variable",value:e}}function _(){var t="";switch(h()){case c:t="curly";break;case v:t="normal";break;case p:t="square"}var i=function(e,r){s.debug("Finding matching bracket");var n="",t="";switch(r){case"normal":n="(",t=")";break;case"curly":n="{",t="}";break;case"square":n="[",t="]"}for(var i=0,o=0;o<e.length;o++){var a=e[o].value;if(s.debug("-- Char:"+a),a===n)i++,s.debug("-- Found starting bracket, depth "+i);else if(a===t){if(1===i)return s.debug("-- Found original closing bracket at position "+o),o;i--,s.debug("-- Found closing bracket, depth "+i)}}throw new Error("Brackets do not match up")}(r.slice(d),t);if(i instanceof Error)return i;var o=r.slice(d+1,d+i);return s.debug("New group created"),d+=i+1,{type:"group",symbol:t,value:e(o,n)}}function x(e){if(h()!==c)throw new Error("No argument for environments are present.");y();var r=O();if(y(),function(e){var r=o.environments.reduce(function(r,n){return r||n===e},!1);return s.debug("Is acknowledged environment?: "+r),r}(r)){if("begin"===e||"end"===e)return{type:"environment",state:e,value:r};throw new Error("environment state "+e+" is not valid")}throw new Error("Environment type "+r+" is not supported")}function N(){s.debug("Found backslash");if(E()===a.TOKEN_TYPES.BACKSLASH.name)return{type:"DOUBLE_BACKSLASH",value:b()+b()};if(d++,void 0===h())return null;if(function(e){var r=!1;return[" ","{","}","\\"].forEach(function(n){e===n&&(r=!0,s.debug(e+" is special char"))}),r}(h()))return function(e){var r=null;switch(e){case" ":r=null;break;case"{":r=_();break;case"}":r=null;break;case"\\":r={type:"DOUBLE_BACKSLASH",value:b()+b()};break;default:return!1}return r}(h());var e=O();return"begin"===e?x("begin"):"end"===e?x("end"):"operatorname"===e?function(){var e=null;y();var r=O();return e=A(r),y(),e}():(0,i.isFunction)(e)?A(e):function(e){var r=null,n=(0,t.isMacro)(e),i=(0,f.isGreekLetter)(e);if(n)void 0===(r=t.MACROS_OVERRIDE.get(e))&&(r={type:"token",value:e});else if(i)r={type:"token",value:e};else{if(!(0,t.isIgnoredMacro)(e))throw new Error("Encountered an unsupported macro: "+e);r=null}return r}(e)}function A(e){var r=(0,i.getFunctionName)(e);return{type:"function",value:r}}function P(){var e=null,n=r[d];switch(n.type){case a.TOKEN_TYPES.NUMBER_LITERAL:s.debug('Found NUMBER_LITERAL "'+h()+'"'),e=S();break;case a.TOKEN_TYPES.BACKSLASH:s.debug('Found BACKSLASH "'+h()+'"'),e=N();break;case a.TOKEN_TYPES.OPERATOR:s.debug('Found OPERATOR "'+h()+'"'),e=function(){s.debug("Found operator");var e=r[d];if(/^[+\-*/=^_]$/i.test(e.value))return{type:"operator",operatorType:"infix",value:b()};if(/^[]$/i.test(e.value))return{type:"operator",operatorType:"prefix",value:b()};if(/^[!]$/i.test(e.value))return{type:"operator",operatorType:"postfix",value:b()}}();break;case a.TOKEN_TYPES.STRING_LITERAL:s.debug('Found STRING_LITERAL "'+h()+'"'),e=T();break;case a.TOKEN_TYPES.OPENING_BRACE:case a.TOKEN_TYPES.OPENING_PARENTHESES:case a.TOKEN_TYPES.OPENING_BRACKET:s.debug('Found BRACKET "'+h()+'"'),e=_();break;default:d++}return e}return function(){var e=0;for(;d<r.length;){s.debug("--------- Parsing next token. While loop run: "+e+" ---------");var n=P();if(null!==n){if(void 0===n)throw d=r.length,new Error("node is undefined");if(m(n),s.debug("Parsed result type: "+n.type),++e>1e3)throw new Error("Max count reached, infinite loop encountered.")}}return s.debug("--------- End of while loop. Tokens position: "+(d-1)+" of "+(r.length-1)+" ---------"),g}()};var t=n(6),i=n(7),o=n(14),a=n(4),u=n(15),l=n(3),s=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0)),f=n(8);var c="{",v="(",p="["},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.environments=["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","smallmatrix"]},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.RESERVED_WORDS={INTEGRATION_END:{name:"INTEGRATION_END",symbol:null,regex:/(d)[A-z]/,type:"integral_end"}}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.environmentLength=function(e){for(var r=0,n=0;n<e.length;n++)if("environment"===e[n].type&&"begin"===e[n].state)r++,t.debug('-- Found new "begin" environment, depth '+r);else if("environment"===e[n].type&&"end"===e[n].state){if(1===r)return t.debug("-- Found original environment end at position "+n),n-1;r--,t.debug('-- Found environment "end", depth '+r)}throw new Error('Environments "begin" and "end" doesn\'t match up')};var t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleMatrix=function(e){var r="";r+="matrix(";for(var n=[],a=[],u=0;u<e.length;u++){(0,o.assertNotUndefined)(e[u],"Missing argument in matrix");var l=e[u].type;"DOUBLE_BACKSLASH"===l?(n.push(a),a=[]):a.push((0,t.transpiler)((0,i.wrapForTranspilation)(e[u])))}n.push(a);for(var s=n[0].length,f=0;f<n.length;f++){if(n[f].length!==s)throw new Error("All rows in matrix must be the same length");0!==f&&(r+=","),r+="["+n[f].toString()+"]"}return r+=")"};var t=n(2),i=n(1),o=n(5)},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findIntegralEnd=function(e){o.debug("Finding end of integral");for(var r=1,n="",t=0;t<e.length;t++){var i=e[t].value;if(o.debug("-- Char:"+i),"function"===e[t].type&&"integral"===e[t].value)r++,o.debug("-- Found starting integral, depth "+r);else if("variable"===e[t].type&&"d"===i[0]){var a=i.match(/(d)[A-z]/g);if(null!==a&&a.length>=1){if(1===r)return n=i.substring(1),o.debug("-- Found end of original integral at position "+t),{length:t,variable:n};r--,o.debug("-- Found integral end, depth "+r)}}}throw new Error("No end of integral located")},r.handleUpperAndLowerArgs=function(e){for(var r=void 0,n=void 0,o=0,a=0;a<2;a++)if("_"===e[o+a].value)o++,r=(0,t.transpiler)((0,i.wrapForTranspilation)(e[o+a]));else{if("^"!==e[o+a].value)throw new Error("Finite integral must have both upper and lower limits");o++,n=(0,t.transpiler)((0,i.wrapForTranspilation)(e[o+a]))}return{lowerLimit:r,upperLimit:n}};var t=n(2),i=n(1),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0))},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleUpperAndLowerArgsSum=function(e){for(var r=void 0,n=void 0,o=0,a=0;a<2;a++)if("_"===e[o+a].value)r=e[++o+a];else{if("^"!==e[o+a].value)throw new Error("Finite integral must have both upper and lover limits");o++,n=(0,t.transpiler)((0,i.wrapForTranspilation)(e[o+a]))}return{lowerLimit:r,upperLimit:n}},r.handleLowerSumArguments=function(e){(0,o.assertNotUndefined)(e[0],"Missing index");var r=e[0];(0,o.assertNotUndefined)(e[1],"Index must be assigned. Missing equal sign");var n=e[1].value;if(!(0,i.checkForVariable)(r))throw new Error("Index must be a variable");if("="!==n)throw new Error("Index must be assigned. Missing equal sign");var a=e.slice(2),u="";return u+=(0,t.transpiler)((0,i.wrapForTranspilation)(a)),{variable:r.value,value:u}};var t=n(2),i=n(1),o=n(5)},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleLimitArguments=function(e){if(!(0,t.checkForVariable)(e[0]))throw new Error('Limit: "From" argument must be a symbol');if(!(0,t.searchForOccurrence)(e[1],"value","to",!1).isPresent)throw new Error('Limit: no "to" token provided');if(void 0===e[2])throw new Error('Limit: "To" argument missing');var r=e[0].value,n=e.slice(2),o="";o+=(0,i.transpiler)((0,t.wrapForTranspilation)(n));var u=a(e.slice(2));return{variable:r,value:o,direction:u}},r.isOneSidedLimit=a;var t=n(1),i=n(2),o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r.default=e,r}(n(0));function a(e){o.debug("Checking if limit is one sided");for(var r=!1,n="",t="",i=0;i<e.length;i++){if("group"===e[i].type){var u=a(e[i].value);!1!==u&&(r=!0,t=u)}("+"===e[i].value||"-"===e[i].value)&&i+1>=e.length&&(r=!0,n=e[i].value)}return r?(t="+"===n?"plus":"minus",o.debug("- Limit is one-sided from the "+t+" side")):o.debug("- Limit is not one-sided"),!!r&&t}}])});